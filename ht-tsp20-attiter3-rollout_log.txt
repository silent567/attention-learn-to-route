245


{'baseline': 'rollout',
 'batch_size': 512,
 'bl_alpha': 0.05,
 'bl_warmup_epochs': 1,
 'checkpoint_encoder': False,
 'checkpoint_epochs': 1,
 'data_distribution': None,
 'embedding_dim': 128,
 'epoch_size': 1280000,
 'epoch_start': 0,
 'eval_batch_size': 1024,
 'eval_only': False,
 'exp_beta': 0.8,
 'graph_size': 20,
 'hidden_dim': 128,
 'load_path': None,
 'log_dir': 'logs',
 'log_step': 50,
 'lr_critic': 0.0001,
 'lr_decay': 1.0,
 'lr_model': 0.0001,
 'max_grad_norm': 1.0,
 'model': 'attentioniter3',
 'n_encode_layers': 3,
 'n_epochs': 100,
 'no_cuda': False,
 'no_progress_bar': False,
 'no_tensorboard': False,
 'normalization': 'batch',
 'output_dir': 'outputs',
 'problem': 'tsp',
 'resume': None,
 'run_name': 'tsp20_attiter3_rollout_20200202T054546',
 'save_dir': 'outputs/tsp_20/tsp20_attiter3_rollout_20200202T054546',
 'seed': 1234,
 'shrink_size': None,
 'tanh_clipping': 10.0,
 'use_cuda': True,
 'val_dataset': None,
 'val_size': 10000}
Evaluating baseline model on evaluation dataset
Start train epoch 0, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
342


342


342


342


342


342


342


171


171


epoch: 0, train_batch_id: 0, avg_cost: 8.658262252807617
grad_norm: 48.36814724189282, clipped: 1.0
epoch: 0, train_batch_id: 50, avg_cost: 4.436220169067383
grad_norm: 4.59370502172007, clipped: 1.0
epoch: 0, train_batch_id: 100, avg_cost: 4.221079349517822
grad_norm: 4.493176434487996, clipped: 1.0
epoch: 0, train_batch_id: 150, avg_cost: 4.171070098876953
grad_norm: 5.197426168568303, clipped: 1.0
epoch: 0, train_batch_id: 200, avg_cost: 4.13020658493042
grad_norm: 4.6169952519703115, clipped: 1.0
epoch: 0, train_batch_id: 250, avg_cost: 4.143772125244141
grad_norm: 5.600256385917309, clipped: 1.0
epoch: 0, train_batch_id: 300, avg_cost: 4.070817470550537
grad_norm: 4.377896697535657, clipped: 1.0
epoch: 0, train_batch_id: 350, avg_cost: 4.05811882019043
grad_norm: 3.036185455447832, clipped: 1.0
epoch: 0, train_batch_id: 400, avg_cost: 4.066324234008789
grad_norm: 3.1707326158047877, clipped: 1.0
epoch: 0, train_batch_id: 450, avg_cost: 4.071779251098633
grad_norm: 2.854855794001281, clipped: 1.0
epoch: 0, train_batch_id: 500, avg_cost: 4.0259623527526855
grad_norm: 2.2829943685674268, clipped: 1.0
epoch: 0, train_batch_id: 550, avg_cost: 4.070267677307129
grad_norm: 4.514725202681653, clipped: 1.0
epoch: 0, train_batch_id: 600, avg_cost: 4.042691230773926
grad_norm: 4.1224899160997905, clipped: 1.0
epoch: 0, train_batch_id: 650, avg_cost: 4.042768478393555
grad_norm: 5.732073733571974, clipped: 1.0
epoch: 0, train_batch_id: 700, avg_cost: 4.035345554351807
grad_norm: 2.9799022810741316, clipped: 1.0
epoch: 0, train_batch_id: 750, avg_cost: 4.027192115783691
grad_norm: 3.919052752112229, clipped: 1.0
epoch: 0, train_batch_id: 800, avg_cost: 4.025633811950684
grad_norm: 2.5426285278925618, clipped: 1.0
epoch: 0, train_batch_id: 850, avg_cost: 4.012022972106934
grad_norm: 3.4747463244435526, clipped: 1.0
epoch: 0, train_batch_id: 900, avg_cost: 4.099165916442871
grad_norm: 3.824311685432832, clipped: 1.0
epoch: 0, train_batch_id: 950, avg_cost: 4.044985294342041
grad_norm: 3.9810319181476737, clipped: 1.0
epoch: 0, train_batch_id: 1000, avg_cost: 4.000953197479248
grad_norm: 2.2801682211401073, clipped: 1.0
epoch: 0, train_batch_id: 1050, avg_cost: 4.035154342651367
grad_norm: 3.7064297729044267, clipped: 1.0
epoch: 0, train_batch_id: 1100, avg_cost: 4.040888786315918
grad_norm: 3.30392646979566, clipped: 1.0
epoch: 0, train_batch_id: 1150, avg_cost: 3.9613571166992188
grad_norm: 2.636082126600906, clipped: 1.0
epoch: 0, train_batch_id: 1200, avg_cost: 4.019535541534424
grad_norm: 2.5919308542834103, clipped: 1.0
epoch: 0, train_batch_id: 1250, avg_cost: 4.0215582847595215
grad_norm: 2.323296851286848, clipped: 1.0
epoch: 0, train_batch_id: 1300, avg_cost: 4.01651668548584
grad_norm: 3.623445087275538, clipped: 1.0
epoch: 0, train_batch_id: 1350, avg_cost: 3.9993841648101807
grad_norm: 2.9208300643196785, clipped: 1.0
epoch: 0, train_batch_id: 1400, avg_cost: 3.9950361251831055
grad_norm: 2.472002793775246, clipped: 1.0
epoch: 0, train_batch_id: 1450, avg_cost: 4.04477596282959
grad_norm: 3.211115383895978, clipped: 1.0
epoch: 0, train_batch_id: 1500, avg_cost: 4.009132385253906
grad_norm: 2.7731908229739237, clipped: 1.0
epoch: 0, train_batch_id: 1550, avg_cost: 3.9849119186401367
grad_norm: 2.9726671459160197, clipped: 1.0
epoch: 0, train_batch_id: 1600, avg_cost: 3.969968318939209
grad_norm: 2.5102769366716293, clipped: 1.0
epoch: 0, train_batch_id: 1650, avg_cost: 4.001330375671387
grad_norm: 2.985611794483966, clipped: 1.0
epoch: 0, train_batch_id: 1700, avg_cost: 4.008905410766602
grad_norm: 2.758571321606339, clipped: 1.0
epoch: 0, train_batch_id: 1750, avg_cost: 3.991023540496826
grad_norm: 3.305191362154629, clipped: 1.0
epoch: 0, train_batch_id: 1800, avg_cost: 3.994748592376709
grad_norm: 3.5200698788869627, clipped: 1.0
epoch: 0, train_batch_id: 1850, avg_cost: 4.0055437088012695
grad_norm: 3.2238038839118937, clipped: 1.0
epoch: 0, train_batch_id: 1900, avg_cost: 3.973538398742676
grad_norm: 5.016483781255013, clipped: 1.0
epoch: 0, train_batch_id: 1950, avg_cost: 3.985316753387451
grad_norm: 2.4588542695827744, clipped: 1.0
epoch: 0, train_batch_id: 2000, avg_cost: 3.950670003890991
grad_norm: 2.9877829298018863, clipped: 1.0
epoch: 0, train_batch_id: 2050, avg_cost: 3.9997339248657227
grad_norm: 3.0040911258081415, clipped: 1.0
epoch: 0, train_batch_id: 2100, avg_cost: 3.9525580406188965
grad_norm: 3.47580078043597, clipped: 1.0
epoch: 0, train_batch_id: 2150, avg_cost: 3.981513500213623
grad_norm: 4.3290012089071555, clipped: 1.0
epoch: 0, train_batch_id: 2200, avg_cost: 3.9449501037597656
grad_norm: 3.4353552506100957, clipped: 1.0
epoch: 0, train_batch_id: 2250, avg_cost: 3.9780688285827637
grad_norm: 3.0374887768049907, clipped: 1.0
epoch: 0, train_batch_id: 2300, avg_cost: 3.9779508113861084
grad_norm: 3.8312306650479777, clipped: 1.0
epoch: 0, train_batch_id: 2350, avg_cost: 3.9818525314331055
grad_norm: 3.5438166121943895, clipped: 1.0
epoch: 0, train_batch_id: 2400, avg_cost: 3.959074020385742
grad_norm: 3.457820420140765, clipped: 1.0
epoch: 0, train_batch_id: 2450, avg_cost: 4.0367889404296875
grad_norm: 6.301643649715311, clipped: 1.0
Finished epoch 0, took 00:07:42 s
Saving model and state...
Validating...
Validation overall avg_cost: 5.265644550323486 +- 0.006588520482182503
Evaluating candidate model on evaluation dataset
Epoch 0 candidate mean 5.261094570159912, baseline epoch 0 mean 6.896965503692627, difference -1.6358709335327148
p-value: 0.0
Update baseline
Evaluating baseline model on evaluation dataset
Set warmup alpha = 1.0
Start train epoch 1, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 1, train_batch_id: 0, avg_cost: 3.944060802459717
grad_norm: 9.301531572302434, clipped: 1.0
epoch: 1, train_batch_id: 50, avg_cost: 4.051475524902344
grad_norm: 11.149470347578555, clipped: 1.0
epoch: 1, train_batch_id: 100, avg_cost: 4.047590255737305
grad_norm: 8.656209082471708, clipped: 1.0
epoch: 1, train_batch_id: 150, avg_cost: 4.043151378631592
grad_norm: 12.997503647936766, clipped: 1.0
epoch: 1, train_batch_id: 200, avg_cost: 4.000253677368164
grad_norm: 7.292065891896379, clipped: 1.0
epoch: 1, train_batch_id: 250, avg_cost: 3.9986801147460938
grad_norm: 10.831438501941898, clipped: 1.0
epoch: 1, train_batch_id: 300, avg_cost: 4.01844596862793
grad_norm: 7.779445236392427, clipped: 1.0
epoch: 1, train_batch_id: 350, avg_cost: 3.996063709259033
grad_norm: 9.685503007965506, clipped: 1.0
epoch: 1, train_batch_id: 400, avg_cost: 4.029810428619385
grad_norm: 6.522771254049296, clipped: 1.0
epoch: 1, train_batch_id: 450, avg_cost: 4.02648401260376
grad_norm: 10.842045794596967, clipped: 1.0
epoch: 1, train_batch_id: 500, avg_cost: 4.018278121948242
grad_norm: 8.194115685669008, clipped: 1.0
epoch: 1, train_batch_id: 550, avg_cost: 4.013998985290527
grad_norm: 8.091508962087097, clipped: 1.0
epoch: 1, train_batch_id: 600, avg_cost: 4.039170742034912
grad_norm: 14.780587067921575, clipped: 1.0
epoch: 1, train_batch_id: 650, avg_cost: 4.019933700561523
grad_norm: 7.947777624979224, clipped: 1.0
epoch: 1, train_batch_id: 700, avg_cost: 4.022416114807129
grad_norm: 12.808050522412659, clipped: 1.0
epoch: 1, train_batch_id: 750, avg_cost: 4.027775287628174
grad_norm: 9.586284058787852, clipped: 1.0
epoch: 1, train_batch_id: 800, avg_cost: 4.086799144744873
grad_norm: 10.27805314790416, clipped: 1.0
epoch: 1, train_batch_id: 850, avg_cost: 4.187047004699707
grad_norm: 7.607625996758659, clipped: 1.0
epoch: 1, train_batch_id: 900, avg_cost: 4.057776927947998
grad_norm: 9.855234068880662, clipped: 1.0
epoch: 1, train_batch_id: 950, avg_cost: 4.083078384399414
grad_norm: 9.978802845880322, clipped: 1.0
epoch: 1, train_batch_id: 1000, avg_cost: 4.035947322845459
grad_norm: 10.47756742721016, clipped: 1.0
epoch: 1, train_batch_id: 1050, avg_cost: 4.049498081207275
grad_norm: 9.193221616776313, clipped: 1.0
epoch: 1, train_batch_id: 1100, avg_cost: 4.104475975036621
grad_norm: 9.871189295210604, clipped: 1.0
epoch: 1, train_batch_id: 1150, avg_cost: 4.079486846923828
grad_norm: 7.332965699010379, clipped: 1.0
epoch: 1, train_batch_id: 1200, avg_cost: 4.065685272216797
grad_norm: 7.0213730938399, clipped: 1.0
epoch: 1, train_batch_id: 1250, avg_cost: 4.021663188934326
grad_norm: 7.674546383509922, clipped: 1.0
epoch: 1, train_batch_id: 1300, avg_cost: 4.020575523376465
grad_norm: 10.225733512832923, clipped: 1.0
epoch: 1, train_batch_id: 1350, avg_cost: 4.0364789962768555
grad_norm: 7.442910027105241, clipped: 1.0
epoch: 1, train_batch_id: 1400, avg_cost: 4.055837631225586
grad_norm: 6.209141262005524, clipped: 1.0
epoch: 1, train_batch_id: 1450, avg_cost: 4.034576416015625
grad_norm: 9.297852837180603, clipped: 1.0
epoch: 1, train_batch_id: 1500, avg_cost: 4.032279014587402
grad_norm: 10.932075293800107, clipped: 1.0
epoch: 1, train_batch_id: 1550, avg_cost: 4.049590110778809
grad_norm: 8.0838713974146, clipped: 1.0
epoch: 1, train_batch_id: 1600, avg_cost: 4.065347671508789
grad_norm: 9.298382714777913, clipped: 1.0
epoch: 1, train_batch_id: 1650, avg_cost: 4.023920059204102
grad_norm: 7.741715077399975, clipped: 1.0
epoch: 1, train_batch_id: 1700, avg_cost: 4.0653395652771
grad_norm: 9.775552159299913, clipped: 1.0
epoch: 1, train_batch_id: 1750, avg_cost: 4.078265190124512
grad_norm: 8.080645848752246, clipped: 1.0
epoch: 1, train_batch_id: 1800, avg_cost: 4.059066295623779
grad_norm: 9.026552798149726, clipped: 1.0
epoch: 1, train_batch_id: 1850, avg_cost: 4.056565284729004
grad_norm: 8.19652419010832, clipped: 1.0
epoch: 1, train_batch_id: 1900, avg_cost: 4.051921844482422
grad_norm: 9.417073753557002, clipped: 1.0
epoch: 1, train_batch_id: 1950, avg_cost: 4.0356597900390625
grad_norm: 6.4593539943520595, clipped: 1.0
epoch: 1, train_batch_id: 2000, avg_cost: 4.0552802085876465
grad_norm: 7.482568129271353, clipped: 1.0
epoch: 1, train_batch_id: 2050, avg_cost: 4.057187080383301
grad_norm: 10.679357455470138, clipped: 1.0
epoch: 1, train_batch_id: 2100, avg_cost: 4.056685447692871
grad_norm: 7.534320937388792, clipped: 1.0
epoch: 1, train_batch_id: 2150, avg_cost: 4.037651538848877
grad_norm: 9.727412688303707, clipped: 1.0
epoch: 1, train_batch_id: 2200, avg_cost: 4.041983127593994
grad_norm: 8.993251278963697, clipped: 1.0
epoch: 1, train_batch_id: 2250, avg_cost: 4.030234336853027
grad_norm: 7.240425157920766, clipped: 1.0
epoch: 1, train_batch_id: 2300, avg_cost: 4.0315632820129395
grad_norm: 6.82625281630208, clipped: 1.0
epoch: 1, train_batch_id: 2350, avg_cost: 4.046106338500977
grad_norm: 7.738918226460007, clipped: 1.0
epoch: 1, train_batch_id: 2400, avg_cost: 4.017757892608643
grad_norm: 8.362713598645334, clipped: 1.0
epoch: 1, train_batch_id: 2450, avg_cost: 4.021324157714844
grad_norm: 11.795984403456197, clipped: 1.0
Finished epoch 1, took 00:09:41 s
Saving model and state...
Validating...
Validation overall avg_cost: 5.539290904998779 +- 0.007248918525874615
Evaluating candidate model on evaluation dataset
Epoch 1 candidate mean 5.541569709777832, baseline epoch 0 mean 5.269719123840332, difference 0.2718505859375
Start train epoch 2, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 2, train_batch_id: 0, avg_cost: 4.062870979309082
grad_norm: 6.692911785417312, clipped: 1.0
epoch: 2, train_batch_id: 50, avg_cost: 4.032092094421387
grad_norm: 7.5858104416880625, clipped: 1.0
epoch: 2, train_batch_id: 100, avg_cost: 4.047415733337402
grad_norm: 8.054243245341071, clipped: 1.0
epoch: 2, train_batch_id: 150, avg_cost: 4.010367393493652
grad_norm: 8.683019853700078, clipped: 1.0
epoch: 2, train_batch_id: 200, avg_cost: 3.9997189044952393
grad_norm: 6.772078327960575, clipped: 1.0
epoch: 2, train_batch_id: 250, avg_cost: 4.048240661621094
grad_norm: 11.63366966610931, clipped: 1.0
epoch: 2, train_batch_id: 300, avg_cost: 4.039658546447754
grad_norm: 7.7721959159912135, clipped: 1.0
epoch: 2, train_batch_id: 350, avg_cost: 4.010571479797363
grad_norm: 8.246511842575218, clipped: 1.0
epoch: 2, train_batch_id: 400, avg_cost: 4.025744915008545
grad_norm: 8.174450345286047, clipped: 1.0
epoch: 2, train_batch_id: 450, avg_cost: 4.015172958374023
grad_norm: 7.210960256844877, clipped: 1.0
epoch: 2, train_batch_id: 500, avg_cost: 4.010773658752441
grad_norm: 6.97459237325428, clipped: 1.0
epoch: 2, train_batch_id: 550, avg_cost: 4.066253185272217
grad_norm: 7.140003650235324, clipped: 1.0
epoch: 2, train_batch_id: 600, avg_cost: 4.030017852783203
grad_norm: 8.505745207845429, clipped: 1.0
epoch: 2, train_batch_id: 650, avg_cost: 4.029350280761719
grad_norm: 7.902289635495626, clipped: 1.0
epoch: 2, train_batch_id: 700, avg_cost: 4.014591217041016
grad_norm: 10.200712631534271, clipped: 1.0
epoch: 2, train_batch_id: 750, avg_cost: 4.0179619789123535
grad_norm: 9.156231951464077, clipped: 1.0
epoch: 2, train_batch_id: 800, avg_cost: 4.068689346313477
grad_norm: 5.536636004304396, clipped: 1.0
epoch: 2, train_batch_id: 850, avg_cost: 3.985769748687744
grad_norm: 10.0740725277405, clipped: 1.0
epoch: 2, train_batch_id: 900, avg_cost: 4.03437614440918
grad_norm: 7.829891580637466, clipped: 1.0
epoch: 2, train_batch_id: 950, avg_cost: 4.028471946716309
grad_norm: 7.756576349929795, clipped: 1.0
epoch: 2, train_batch_id: 1000, avg_cost: 4.006657123565674
grad_norm: 12.710631329243943, clipped: 1.0
epoch: 2, train_batch_id: 1050, avg_cost: 4.049846649169922
grad_norm: 14.318084644625834, clipped: 1.0
epoch: 2, train_batch_id: 1100, avg_cost: 4.041610240936279
grad_norm: 9.322707543608498, clipped: 1.0
epoch: 2, train_batch_id: 1150, avg_cost: 4.0256805419921875
grad_norm: 7.229308455586038, clipped: 1.0
epoch: 2, train_batch_id: 1200, avg_cost: 4.024239540100098
grad_norm: 8.310567974987539, clipped: 1.0
epoch: 2, train_batch_id: 1250, avg_cost: 4.012848854064941
grad_norm: 10.568185509373569, clipped: 1.0
epoch: 2, train_batch_id: 1300, avg_cost: 4.0079755783081055
grad_norm: 9.286653315332536, clipped: 1.0
epoch: 2, train_batch_id: 1350, avg_cost: 4.021885871887207
grad_norm: 8.198841026962121, clipped: 1.0
epoch: 2, train_batch_id: 1400, avg_cost: 4.082141876220703
grad_norm: 7.862326195433469, clipped: 1.0
epoch: 2, train_batch_id: 1450, avg_cost: 4.015076637268066
grad_norm: 8.3278952513129, clipped: 1.0
epoch: 2, train_batch_id: 1500, avg_cost: 4.009472846984863
grad_norm: 7.422915030284038, clipped: 1.0
epoch: 2, train_batch_id: 1550, avg_cost: 4.041938781738281
grad_norm: 8.550747051974291, clipped: 1.0
epoch: 2, train_batch_id: 1600, avg_cost: 4.049677848815918
grad_norm: 6.700521364524533, clipped: 1.0
epoch: 2, train_batch_id: 1650, avg_cost: 4.0518083572387695
grad_norm: 7.515865828830691, clipped: 1.0
epoch: 2, train_batch_id: 1700, avg_cost: 4.025331497192383
grad_norm: 7.536614573953182, clipped: 1.0
epoch: 2, train_batch_id: 1750, avg_cost: 4.062009811401367
grad_norm: 8.74924645504631, clipped: 1.0
epoch: 2, train_batch_id: 1800, avg_cost: 4.048436164855957
grad_norm: 8.907913343875201, clipped: 1.0
epoch: 2, train_batch_id: 1850, avg_cost: 3.9932186603546143
grad_norm: 7.692800384507899, clipped: 1.0
epoch: 2, train_batch_id: 1900, avg_cost: 4.0136566162109375
grad_norm: 7.81081423388065, clipped: 1.0
epoch: 2, train_batch_id: 1950, avg_cost: 3.998429298400879
grad_norm: 7.402625447840403, clipped: 1.0
epoch: 2, train_batch_id: 2000, avg_cost: 4.055441856384277
grad_norm: 7.2292048608909045, clipped: 1.0
epoch: 2, train_batch_id: 2050, avg_cost: 4.0406599044799805
grad_norm: 8.420645291246375, clipped: 1.0
epoch: 2, train_batch_id: 2100, avg_cost: 4.0237650871276855
grad_norm: 7.452939593202177, clipped: 1.0
epoch: 2, train_batch_id: 2150, avg_cost: 4.035470962524414
grad_norm: 11.485209649808183, clipped: 1.0
epoch: 2, train_batch_id: 2200, avg_cost: 4.06376838684082
grad_norm: 7.2677916606329696, clipped: 1.0
epoch: 2, train_batch_id: 2250, avg_cost: 4.063648223876953
grad_norm: 8.6024518720476, clipped: 1.0
epoch: 2, train_batch_id: 2300, avg_cost: 4.0295915603637695
grad_norm: 9.681083031226118, clipped: 1.0
epoch: 2, train_batch_id: 2350, avg_cost: 4.0059309005737305
grad_norm: 6.206558005865833, clipped: 1.0
epoch: 2, train_batch_id: 2400, avg_cost: 4.068592071533203
grad_norm: 8.471682870326664, clipped: 1.0
epoch: 2, train_batch_id: 2450, avg_cost: 4.030954360961914
grad_norm: 7.9715498579724455, clipped: 1.0
Finished epoch 2, took 00:09:27 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.9922194480896 +- 0.006066104397177696
Evaluating candidate model on evaluation dataset
Epoch 2 candidate mean 4.991230487823486, baseline epoch 0 mean 5.269719123840332, difference -0.2784886360168457
p-value: 0.0
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 3, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 3, train_batch_id: 0, avg_cost: 4.0197343826293945
grad_norm: 4.302421760238403, clipped: 1.0
epoch: 3, train_batch_id: 50, avg_cost: 4.0179314613342285
grad_norm: 6.389817562272315, clipped: 1.0
epoch: 3, train_batch_id: 100, avg_cost: 4.0169782638549805
grad_norm: 5.994752570000579, clipped: 1.0
epoch: 3, train_batch_id: 150, avg_cost: 3.9993135929107666
grad_norm: 9.029165953468386, clipped: 1.0
epoch: 3, train_batch_id: 200, avg_cost: 3.9803128242492676
grad_norm: 11.794990334811866, clipped: 1.0
epoch: 3, train_batch_id: 250, avg_cost: 4.019309997558594
grad_norm: 4.5787285977986185, clipped: 1.0
epoch: 3, train_batch_id: 300, avg_cost: 4.006572246551514
grad_norm: 6.414915658318115, clipped: 1.0
epoch: 3, train_batch_id: 350, avg_cost: 3.973691940307617
grad_norm: 5.994397856413863, clipped: 1.0
epoch: 3, train_batch_id: 400, avg_cost: 4.0386176109313965
grad_norm: 6.973717081741919, clipped: 1.0
epoch: 3, train_batch_id: 450, avg_cost: 3.981663465499878
grad_norm: 7.057652602719633, clipped: 1.0
epoch: 3, train_batch_id: 500, avg_cost: 3.99119234085083
grad_norm: 6.653860273935564, clipped: 1.0
epoch: 3, train_batch_id: 550, avg_cost: 4.084381103515625
grad_norm: 6.1446126814860325, clipped: 1.0
epoch: 3, train_batch_id: 600, avg_cost: 4.0188517570495605
grad_norm: 7.640818499509967, clipped: 1.0
epoch: 3, train_batch_id: 650, avg_cost: 4.0167646408081055
grad_norm: 7.469440199419291, clipped: 1.0
epoch: 3, train_batch_id: 700, avg_cost: 4.016709327697754
grad_norm: 6.115858464147496, clipped: 1.0
epoch: 3, train_batch_id: 750, avg_cost: 3.9990923404693604
grad_norm: 8.050850436902337, clipped: 1.0
epoch: 3, train_batch_id: 800, avg_cost: 4.011161804199219
grad_norm: 7.119812722791671, clipped: 1.0
epoch: 3, train_batch_id: 850, avg_cost: 4.041852951049805
grad_norm: 8.068930919558833, clipped: 1.0
epoch: 3, train_batch_id: 900, avg_cost: 4.043830394744873
grad_norm: 7.2106184322033835, clipped: 1.0
epoch: 3, train_batch_id: 950, avg_cost: 4.007221698760986
grad_norm: 5.932437812592423, clipped: 1.0
epoch: 3, train_batch_id: 1000, avg_cost: 4.014842510223389
grad_norm: 7.737775479598504, clipped: 1.0
epoch: 3, train_batch_id: 1050, avg_cost: 4.009167194366455
grad_norm: 6.191381868135895, clipped: 1.0
epoch: 3, train_batch_id: 1100, avg_cost: 4.013456344604492
grad_norm: 6.972645632014595, clipped: 1.0
epoch: 3, train_batch_id: 1150, avg_cost: 4.017706871032715
grad_norm: 6.217641788131973, clipped: 1.0
epoch: 3, train_batch_id: 1200, avg_cost: 4.028974533081055
grad_norm: 7.678704215854128, clipped: 1.0
epoch: 3, train_batch_id: 1250, avg_cost: 3.9827375411987305
grad_norm: 5.754181110367255, clipped: 1.0
epoch: 3, train_batch_id: 1300, avg_cost: 3.9887781143188477
grad_norm: 7.058449077237953, clipped: 1.0
epoch: 3, train_batch_id: 1350, avg_cost: 3.9857988357543945
grad_norm: 6.034062380740672, clipped: 1.0
epoch: 3, train_batch_id: 1400, avg_cost: 3.9856014251708984
grad_norm: 6.011197672251132, clipped: 1.0
epoch: 3, train_batch_id: 1450, avg_cost: 3.9895458221435547
grad_norm: 6.464699007437396, clipped: 1.0
epoch: 3, train_batch_id: 1500, avg_cost: 4.00242280960083
grad_norm: 7.175090723957865, clipped: 1.0
epoch: 3, train_batch_id: 1550, avg_cost: 4.0068206787109375
grad_norm: 5.72963382077345, clipped: 1.0
epoch: 3, train_batch_id: 1600, avg_cost: 4.023999214172363
grad_norm: 6.351986358659204, clipped: 1.0
epoch: 3, train_batch_id: 1650, avg_cost: 3.992427349090576
grad_norm: 7.633201886856586, clipped: 1.0
epoch: 3, train_batch_id: 1700, avg_cost: 3.9768834114074707
grad_norm: 6.961421539875837, clipped: 1.0
epoch: 3, train_batch_id: 1750, avg_cost: 4.046648979187012
grad_norm: 6.355997622214548, clipped: 1.0
epoch: 3, train_batch_id: 1800, avg_cost: 4.035268783569336
grad_norm: 6.704792839940585, clipped: 1.0
epoch: 3, train_batch_id: 1850, avg_cost: 4.0218915939331055
grad_norm: 5.223696606144886, clipped: 1.0
epoch: 3, train_batch_id: 1900, avg_cost: 4.01869010925293
grad_norm: 6.126126709372571, clipped: 1.0
epoch: 3, train_batch_id: 1950, avg_cost: 3.9923033714294434
grad_norm: 6.497009468668376, clipped: 1.0
epoch: 3, train_batch_id: 2000, avg_cost: 4.047977447509766
grad_norm: 6.7151731502452146, clipped: 1.0
epoch: 3, train_batch_id: 2050, avg_cost: 4.001463890075684
grad_norm: 5.515434833685041, clipped: 1.0
epoch: 3, train_batch_id: 2100, avg_cost: 4.00472354888916
grad_norm: 5.1019589013009785, clipped: 1.0
epoch: 3, train_batch_id: 2150, avg_cost: 4.033751487731934
grad_norm: 6.1026502989984825, clipped: 1.0
epoch: 3, train_batch_id: 2200, avg_cost: 4.005641937255859
grad_norm: 6.31449351324923, clipped: 1.0
epoch: 3, train_batch_id: 2250, avg_cost: 4.0408101081848145
grad_norm: 6.246442141903507, clipped: 1.0
epoch: 3, train_batch_id: 2300, avg_cost: 4.0145769119262695
grad_norm: 5.928851089127314, clipped: 1.0
epoch: 3, train_batch_id: 2350, avg_cost: 4.065464019775391
grad_norm: 5.092190559801155, clipped: 1.0
epoch: 3, train_batch_id: 2400, avg_cost: 4.0292510986328125
grad_norm: 6.430110226844081, clipped: 1.0
epoch: 3, train_batch_id: 2450, avg_cost: 3.9832491874694824
grad_norm: 6.788537685335867, clipped: 1.0
Finished epoch 3, took 00:09:31 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.787547588348389 +- 0.0055862534791231155
Evaluating candidate model on evaluation dataset
Epoch 3 candidate mean 4.790640830993652, baseline epoch 2 mean 4.98275089263916, difference -0.1921100616455078
p-value: 5.469738152957195e-204
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 4, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 4, train_batch_id: 0, avg_cost: 4.026876926422119
grad_norm: 4.044515306578142, clipped: 1.0
epoch: 4, train_batch_id: 50, avg_cost: 4.007983207702637
grad_norm: 4.137447181947264, clipped: 1.0
epoch: 4, train_batch_id: 100, avg_cost: 4.016282081604004
grad_norm: 7.673258626517302, clipped: 1.0
epoch: 4, train_batch_id: 150, avg_cost: 4.028629302978516
grad_norm: 3.82986367347963, clipped: 1.0
epoch: 4, train_batch_id: 200, avg_cost: 3.9902095794677734
grad_norm: 4.5039101420974665, clipped: 1.0
epoch: 4, train_batch_id: 250, avg_cost: 4.00180721282959
grad_norm: 5.291888032826174, clipped: 1.0
epoch: 4, train_batch_id: 300, avg_cost: 3.9951319694519043
grad_norm: 5.826271570038178, clipped: 1.0
epoch: 4, train_batch_id: 350, avg_cost: 4.0459136962890625
grad_norm: 3.907140943734803, clipped: 1.0
epoch: 4, train_batch_id: 400, avg_cost: 3.9430692195892334
grad_norm: 3.622709577205504, clipped: 1.0
epoch: 4, train_batch_id: 450, avg_cost: 3.994027853012085
grad_norm: 6.112349343137541, clipped: 1.0
epoch: 4, train_batch_id: 500, avg_cost: 3.9645323753356934
grad_norm: 5.985547343387247, clipped: 1.0
epoch: 4, train_batch_id: 550, avg_cost: 3.9845046997070312
grad_norm: 4.5556573168677055, clipped: 1.0
epoch: 4, train_batch_id: 600, avg_cost: 4.004137992858887
grad_norm: 4.179103947819369, clipped: 1.0
epoch: 4, train_batch_id: 650, avg_cost: 4.029849052429199
grad_norm: 5.304435895341466, clipped: 1.0
epoch: 4, train_batch_id: 700, avg_cost: 3.9908671379089355
grad_norm: 6.469490851095026, clipped: 1.0
epoch: 4, train_batch_id: 750, avg_cost: 4.000276565551758
grad_norm: 6.732645950296267, clipped: 1.0
epoch: 4, train_batch_id: 800, avg_cost: 4.004368782043457
grad_norm: 4.232094459753525, clipped: 1.0
epoch: 4, train_batch_id: 850, avg_cost: 3.989809036254883
grad_norm: 3.864736827302184, clipped: 1.0
epoch: 4, train_batch_id: 900, avg_cost: 3.990746259689331
grad_norm: 4.905920891441898, clipped: 1.0
epoch: 4, train_batch_id: 950, avg_cost: 4.0001983642578125
grad_norm: 4.978194487197683, clipped: 1.0
epoch: 4, train_batch_id: 1000, avg_cost: 4.00356388092041
grad_norm: 4.126054918032065, clipped: 1.0
epoch: 4, train_batch_id: 1050, avg_cost: 3.980557918548584
grad_norm: 10.257184158447705, clipped: 1.0
epoch: 4, train_batch_id: 1100, avg_cost: 4.036691665649414
grad_norm: 7.110812160296424, clipped: 1.0
epoch: 4, train_batch_id: 1150, avg_cost: 3.9872028827667236
grad_norm: 4.345802640872451, clipped: 1.0
epoch: 4, train_batch_id: 1200, avg_cost: 3.985121250152588
grad_norm: 5.416336496759172, clipped: 1.0
epoch: 4, train_batch_id: 1250, avg_cost: 4.013398170471191
grad_norm: 4.996350609858279, clipped: 1.0
epoch: 4, train_batch_id: 1300, avg_cost: 3.993900775909424
grad_norm: 4.539262332693975, clipped: 1.0
epoch: 4, train_batch_id: 1350, avg_cost: 3.978365421295166
grad_norm: 4.644877041418117, clipped: 1.0
epoch: 4, train_batch_id: 1400, avg_cost: 4.012019634246826
grad_norm: 7.331711683861508, clipped: 1.0
epoch: 4, train_batch_id: 1450, avg_cost: 3.9830145835876465
grad_norm: 4.935111132007874, clipped: 1.0
epoch: 4, train_batch_id: 1500, avg_cost: 3.9765381813049316
grad_norm: 6.254358920414343, clipped: 1.0
epoch: 4, train_batch_id: 1550, avg_cost: 4.022618293762207
grad_norm: 5.381762253098451, clipped: 1.0
epoch: 4, train_batch_id: 1600, avg_cost: 3.9568638801574707
grad_norm: 4.563795535359468, clipped: 1.0
epoch: 4, train_batch_id: 1650, avg_cost: 4.012086868286133
grad_norm: 4.10999154651374, clipped: 1.0
epoch: 4, train_batch_id: 1700, avg_cost: 4.023003578186035
grad_norm: 4.941448879409659, clipped: 1.0
epoch: 4, train_batch_id: 1750, avg_cost: 3.988917589187622
grad_norm: 4.391091468962037, clipped: 1.0
epoch: 4, train_batch_id: 1800, avg_cost: 3.9674925804138184
grad_norm: 4.535569300254438, clipped: 1.0
epoch: 4, train_batch_id: 1850, avg_cost: 4.006699085235596
grad_norm: 5.415635123211204, clipped: 1.0
epoch: 4, train_batch_id: 1900, avg_cost: 3.9711251258850098
grad_norm: 5.360150672086221, clipped: 1.0
epoch: 4, train_batch_id: 1950, avg_cost: 3.969987154006958
grad_norm: 4.942279292932387, clipped: 1.0
epoch: 4, train_batch_id: 2000, avg_cost: 4.014968395233154
grad_norm: 4.538290783663802, clipped: 1.0
epoch: 4, train_batch_id: 2050, avg_cost: 3.975452423095703
grad_norm: 6.24809664550487, clipped: 1.0
epoch: 4, train_batch_id: 2100, avg_cost: 3.995588541030884
grad_norm: 5.4714209036618655, clipped: 1.0
epoch: 4, train_batch_id: 2150, avg_cost: 3.9960861206054688
grad_norm: 3.8146779237601756, clipped: 1.0
epoch: 4, train_batch_id: 2200, avg_cost: 3.980048656463623
grad_norm: 6.216759322688838, clipped: 1.0
epoch: 4, train_batch_id: 2250, avg_cost: 3.988774061203003
grad_norm: 3.624964321765872, clipped: 1.0
epoch: 4, train_batch_id: 2300, avg_cost: 3.9813480377197266
grad_norm: 4.577794894926766, clipped: 1.0
epoch: 4, train_batch_id: 2350, avg_cost: 3.975214958190918
grad_norm: 4.001718605782243, clipped: 1.0
epoch: 4, train_batch_id: 2400, avg_cost: 3.9826478958129883
grad_norm: 4.745307489330587, clipped: 1.0
epoch: 4, train_batch_id: 2450, avg_cost: 3.9901604652404785
grad_norm: 5.357625888369554, clipped: 1.0
Finished epoch 4, took 00:09:34 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.639176845550537 +- 0.005148772615939379
Evaluating candidate model on evaluation dataset
Epoch 4 candidate mean 4.644667148590088, baseline epoch 3 mean 4.79405403137207, difference -0.14938688278198242
p-value: 0.0
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 5, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 5, train_batch_id: 0, avg_cost: 3.9869208335876465
grad_norm: 4.71174280200459, clipped: 1.0
epoch: 5, train_batch_id: 50, avg_cost: 3.98488712310791
grad_norm: 5.474068829035849, clipped: 1.0
epoch: 5, train_batch_id: 100, avg_cost: 3.9481115341186523
grad_norm: 5.762496921707233, clipped: 1.0
epoch: 5, train_batch_id: 150, avg_cost: 3.994576930999756
grad_norm: 5.566336220213099, clipped: 1.0
epoch: 5, train_batch_id: 200, avg_cost: 3.9754443168640137
grad_norm: 3.424309830463914, clipped: 1.0
epoch: 5, train_batch_id: 250, avg_cost: 3.9885544776916504
grad_norm: 3.1410296823880857, clipped: 1.0
epoch: 5, train_batch_id: 300, avg_cost: 4.002601623535156
grad_norm: 4.832224424911697, clipped: 1.0
epoch: 5, train_batch_id: 350, avg_cost: 3.9532833099365234
grad_norm: 4.0439990589680095, clipped: 1.0
epoch: 5, train_batch_id: 400, avg_cost: 3.958754062652588
grad_norm: 5.08717242144816, clipped: 1.0
epoch: 5, train_batch_id: 450, avg_cost: 3.95023512840271
grad_norm: 4.298736566918119, clipped: 1.0
epoch: 5, train_batch_id: 500, avg_cost: 3.9546704292297363
grad_norm: 4.48438208919141, clipped: 1.0
epoch: 5, train_batch_id: 550, avg_cost: 3.9568886756896973
grad_norm: 3.7190642081053946, clipped: 1.0
epoch: 5, train_batch_id: 600, avg_cost: 3.9760303497314453
grad_norm: 8.18084128432441, clipped: 1.0
epoch: 5, train_batch_id: 650, avg_cost: 3.9607629776000977
grad_norm: 3.6627361059630745, clipped: 1.0
epoch: 5, train_batch_id: 700, avg_cost: 3.97224760055542
grad_norm: 3.64461889068005, clipped: 1.0
epoch: 5, train_batch_id: 750, avg_cost: 3.9674735069274902
grad_norm: 3.3930069674510586, clipped: 1.0
epoch: 5, train_batch_id: 800, avg_cost: 3.953430414199829
grad_norm: 4.648765332803029, clipped: 1.0
epoch: 5, train_batch_id: 850, avg_cost: 3.9530344009399414
grad_norm: 4.946866422032149, clipped: 1.0
epoch: 5, train_batch_id: 900, avg_cost: 3.930039882659912
grad_norm: 5.174836150575154, clipped: 1.0
epoch: 5, train_batch_id: 950, avg_cost: 3.989701271057129
grad_norm: 3.265706053518678, clipped: 1.0
epoch: 5, train_batch_id: 1000, avg_cost: 4.0125627517700195
grad_norm: 5.480615847931878, clipped: 1.0
epoch: 5, train_batch_id: 1050, avg_cost: 3.9847304821014404
grad_norm: 4.439994666903705, clipped: 1.0
epoch: 5, train_batch_id: 1100, avg_cost: 3.9437499046325684
grad_norm: 4.8202187198319075, clipped: 1.0
epoch: 5, train_batch_id: 1150, avg_cost: 3.9853715896606445
grad_norm: 5.216755666420936, clipped: 1.0
epoch: 5, train_batch_id: 1200, avg_cost: 3.9776864051818848
grad_norm: 4.948302728158991, clipped: 1.0
epoch: 5, train_batch_id: 1250, avg_cost: 3.9619781970977783
grad_norm: 4.380467522591207, clipped: 1.0
epoch: 5, train_batch_id: 1300, avg_cost: 3.947195529937744
grad_norm: 3.3704137781011494, clipped: 1.0
epoch: 5, train_batch_id: 1350, avg_cost: 3.966010093688965
grad_norm: 5.068320333187857, clipped: 1.0
epoch: 5, train_batch_id: 1400, avg_cost: 3.981924057006836
grad_norm: 4.561567514262189, clipped: 1.0
epoch: 5, train_batch_id: 1450, avg_cost: 3.9589576721191406
grad_norm: 3.533923211770127, clipped: 1.0
epoch: 5, train_batch_id: 1500, avg_cost: 3.9471096992492676
grad_norm: 3.594737200692718, clipped: 1.0
epoch: 5, train_batch_id: 1550, avg_cost: 3.996936798095703
grad_norm: 3.9364546458736935, clipped: 1.0
epoch: 5, train_batch_id: 1600, avg_cost: 3.964820623397827
grad_norm: 3.904237147066536, clipped: 1.0
epoch: 5, train_batch_id: 1650, avg_cost: 3.9720425605773926
grad_norm: 5.042175448551241, clipped: 1.0
epoch: 5, train_batch_id: 1700, avg_cost: 3.999509334564209
grad_norm: 3.5476901060313453, clipped: 1.0
epoch: 5, train_batch_id: 1750, avg_cost: 3.9813876152038574
grad_norm: 3.7273274472337237, clipped: 1.0
epoch: 5, train_batch_id: 1800, avg_cost: 3.9732799530029297
grad_norm: 3.244777291905424, clipped: 1.0
epoch: 5, train_batch_id: 1850, avg_cost: 3.9801788330078125
grad_norm: 5.572969717019241, clipped: 1.0
epoch: 5, train_batch_id: 1900, avg_cost: 3.9805057048797607
grad_norm: 4.419997390971145, clipped: 1.0
epoch: 5, train_batch_id: 1950, avg_cost: 3.9782674312591553
grad_norm: 4.995697323010904, clipped: 1.0
epoch: 5, train_batch_id: 2000, avg_cost: 3.9658522605895996
grad_norm: 4.5388054015837715, clipped: 1.0
epoch: 5, train_batch_id: 2050, avg_cost: 3.981046438217163
grad_norm: 3.9796504145725295, clipped: 1.0
epoch: 5, train_batch_id: 2100, avg_cost: 3.951738119125366
grad_norm: 3.481213952957042, clipped: 1.0
epoch: 5, train_batch_id: 2150, avg_cost: 3.9524781703948975
grad_norm: 3.1914188442825324, clipped: 1.0
epoch: 5, train_batch_id: 2200, avg_cost: 3.952535390853882
grad_norm: 4.131400400146119, clipped: 1.0
epoch: 5, train_batch_id: 2250, avg_cost: 3.9548964500427246
grad_norm: 3.861933721800824, clipped: 1.0
epoch: 5, train_batch_id: 2300, avg_cost: 3.9938995838165283
grad_norm: 4.348381849013189, clipped: 1.0
epoch: 5, train_batch_id: 2350, avg_cost: 3.9629557132720947
grad_norm: 5.431731500259393, clipped: 1.0
epoch: 5, train_batch_id: 2400, avg_cost: 3.957944869995117
grad_norm: 4.198488297064792, clipped: 1.0
epoch: 5, train_batch_id: 2450, avg_cost: 3.9577531814575195
grad_norm: 6.014018459583577, clipped: 1.0
Finished epoch 5, took 00:09:30 s
Saving model and state...
Validating...
Validation overall avg_cost: 5.32290506362915 +- 0.0057119280099868774
Evaluating candidate model on evaluation dataset
Epoch 5 candidate mean 5.318220615386963, baseline epoch 4 mean 4.6429314613342285, difference 0.6752891540527344
Start train epoch 6, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 6, train_batch_id: 0, avg_cost: 3.9893736839294434
grad_norm: 5.1654308268527425, clipped: 1.0
epoch: 6, train_batch_id: 50, avg_cost: 3.9744484424591064
grad_norm: 4.637160788378693, clipped: 1.0
epoch: 6, train_batch_id: 100, avg_cost: 3.9730887413024902
grad_norm: 3.4889445573795337, clipped: 1.0
epoch: 6, train_batch_id: 150, avg_cost: 3.9354066848754883
grad_norm: 4.047231547145447, clipped: 1.0
epoch: 6, train_batch_id: 200, avg_cost: 3.975092649459839
grad_norm: 4.732143706487333, clipped: 1.0
epoch: 6, train_batch_id: 250, avg_cost: 3.9379093647003174
grad_norm: 3.8365607703096978, clipped: 1.0
epoch: 6, train_batch_id: 300, avg_cost: 3.9636764526367188
grad_norm: 6.070409547849168, clipped: 1.0
epoch: 6, train_batch_id: 350, avg_cost: 4.005549907684326
grad_norm: 4.863274570287857, clipped: 1.0
epoch: 6, train_batch_id: 400, avg_cost: 3.9369852542877197
grad_norm: 5.615384097830025, clipped: 1.0
epoch: 6, train_batch_id: 450, avg_cost: 3.956021308898926
grad_norm: 4.0479358039094615, clipped: 1.0
epoch: 6, train_batch_id: 500, avg_cost: 3.9607276916503906
grad_norm: 4.469789629258063, clipped: 1.0
epoch: 6, train_batch_id: 550, avg_cost: 3.9849464893341064
grad_norm: 6.302195910533453, clipped: 1.0
epoch: 6, train_batch_id: 600, avg_cost: 3.9553720951080322
grad_norm: 4.068885569417951, clipped: 1.0
epoch: 6, train_batch_id: 650, avg_cost: 3.9534614086151123
grad_norm: 3.9290202457868517, clipped: 1.0
epoch: 6, train_batch_id: 700, avg_cost: 3.9687867164611816
grad_norm: 5.1311030712427455, clipped: 1.0
epoch: 6, train_batch_id: 750, avg_cost: 3.9703495502471924
grad_norm: 4.140626481961683, clipped: 1.0
epoch: 6, train_batch_id: 800, avg_cost: 3.99515962600708
grad_norm: 4.831318791734304, clipped: 1.0
epoch: 6, train_batch_id: 850, avg_cost: 3.975903034210205
grad_norm: 4.2637488791097065, clipped: 1.0
epoch: 6, train_batch_id: 900, avg_cost: 3.9557223320007324
grad_norm: 3.6203892264116986, clipped: 1.0
epoch: 6, train_batch_id: 950, avg_cost: 3.979468584060669
grad_norm: 3.687571937759399, clipped: 1.0
epoch: 6, train_batch_id: 1000, avg_cost: 3.9538979530334473
grad_norm: 4.56838010842993, clipped: 1.0
epoch: 6, train_batch_id: 1050, avg_cost: 3.978480815887451
grad_norm: 6.105767900559269, clipped: 1.0
epoch: 6, train_batch_id: 1100, avg_cost: 3.9596898555755615
grad_norm: 5.071424968229332, clipped: 1.0
epoch: 6, train_batch_id: 1150, avg_cost: 3.995054244995117
grad_norm: 3.7445567259376893, clipped: 1.0
epoch: 6, train_batch_id: 1200, avg_cost: 3.955596446990967
grad_norm: 3.95317272448134, clipped: 1.0
epoch: 6, train_batch_id: 1250, avg_cost: 3.976982593536377
grad_norm: 4.854432997401733, clipped: 1.0
epoch: 6, train_batch_id: 1300, avg_cost: 3.9228320121765137
grad_norm: 4.38063715268271, clipped: 1.0
epoch: 6, train_batch_id: 1350, avg_cost: 3.9618887901306152
grad_norm: 4.092505886812903, clipped: 1.0
epoch: 6, train_batch_id: 1400, avg_cost: 3.987250804901123
grad_norm: 5.01644692882967, clipped: 1.0
epoch: 6, train_batch_id: 1450, avg_cost: 3.936924457550049
grad_norm: 3.436255376283502, clipped: 1.0
epoch: 6, train_batch_id: 1500, avg_cost: 3.9447107315063477
grad_norm: 5.24066916582595, clipped: 1.0
epoch: 6, train_batch_id: 1550, avg_cost: 3.962378740310669
grad_norm: 5.569693817061834, clipped: 1.0
epoch: 6, train_batch_id: 1600, avg_cost: 3.9651055335998535
grad_norm: 5.088873106578709, clipped: 1.0
epoch: 6, train_batch_id: 1650, avg_cost: 3.9463117122650146
grad_norm: 6.698280718817204, clipped: 1.0
epoch: 6, train_batch_id: 1700, avg_cost: 3.9749951362609863
grad_norm: 4.117736066633308, clipped: 1.0
epoch: 6, train_batch_id: 1750, avg_cost: 3.9701621532440186
grad_norm: 5.136355901599102, clipped: 1.0
epoch: 6, train_batch_id: 1800, avg_cost: 3.94873046875
grad_norm: 6.34373592505909, clipped: 1.0
epoch: 6, train_batch_id: 1850, avg_cost: 3.9074645042419434
grad_norm: 3.3528509674460403, clipped: 1.0
epoch: 6, train_batch_id: 1900, avg_cost: 3.9825356006622314
grad_norm: 5.111052342537423, clipped: 1.0
epoch: 6, train_batch_id: 1950, avg_cost: 3.966479778289795
grad_norm: 6.43174847918547, clipped: 1.0
epoch: 6, train_batch_id: 2000, avg_cost: 3.950389862060547
grad_norm: 4.476938630781967, clipped: 1.0
epoch: 6, train_batch_id: 2050, avg_cost: 3.95173978805542
grad_norm: 3.9420796449475626, clipped: 1.0
epoch: 6, train_batch_id: 2100, avg_cost: 3.9475247859954834
grad_norm: 5.569790889851348, clipped: 1.0
epoch: 6, train_batch_id: 2150, avg_cost: 3.9231133460998535
grad_norm: 5.276316492170504, clipped: 1.0
epoch: 6, train_batch_id: 2200, avg_cost: 3.987067222595215
grad_norm: 4.616777283651725, clipped: 1.0
epoch: 6, train_batch_id: 2250, avg_cost: 3.9468488693237305
grad_norm: 4.969567842967019, clipped: 1.0
epoch: 6, train_batch_id: 2300, avg_cost: 3.9592394828796387
grad_norm: 4.320786257414448, clipped: 1.0
epoch: 6, train_batch_id: 2350, avg_cost: 3.947216510772705
grad_norm: 4.079181271286918, clipped: 1.0
epoch: 6, train_batch_id: 2400, avg_cost: 3.9370954036712646
grad_norm: 5.036462247623388, clipped: 1.0
epoch: 6, train_batch_id: 2450, avg_cost: 3.9494452476501465
grad_norm: 4.2175743178592935, clipped: 1.0
Finished epoch 6, took 00:09:29 s
Saving model and state...
Validating...
Validation overall avg_cost: 5.01828145980835 +- 0.00559238949790597
Evaluating candidate model on evaluation dataset
Epoch 6 candidate mean 5.01287317276001, baseline epoch 4 mean 4.6429314613342285, difference 0.36994171142578125
Start train epoch 7, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 7, train_batch_id: 0, avg_cost: 3.938656806945801
grad_norm: 3.7257139348342116, clipped: 1.0
epoch: 7, train_batch_id: 50, avg_cost: 3.9393599033355713
grad_norm: 6.080783013498745, clipped: 1.0
epoch: 7, train_batch_id: 100, avg_cost: 3.9383316040039062
grad_norm: 3.40692247234007, clipped: 1.0
epoch: 7, train_batch_id: 150, avg_cost: 3.945241928100586
grad_norm: 4.840102138372748, clipped: 1.0
epoch: 7, train_batch_id: 200, avg_cost: 3.9445319175720215
grad_norm: 3.781360650943524, clipped: 1.0
epoch: 7, train_batch_id: 250, avg_cost: 3.9686107635498047
grad_norm: 4.796805843031725, clipped: 1.0
epoch: 7, train_batch_id: 300, avg_cost: 3.9641387462615967
grad_norm: 5.2587553607874815, clipped: 1.0
epoch: 7, train_batch_id: 350, avg_cost: 3.975973606109619
grad_norm: 5.798248771129613, clipped: 1.0
epoch: 7, train_batch_id: 400, avg_cost: 3.959463596343994
grad_norm: 3.584486207460949, clipped: 1.0
epoch: 7, train_batch_id: 450, avg_cost: 3.9520769119262695
grad_norm: 4.303622409356362, clipped: 1.0
epoch: 7, train_batch_id: 500, avg_cost: 3.9654123783111572
grad_norm: 4.3610111700253125, clipped: 1.0
epoch: 7, train_batch_id: 550, avg_cost: 3.9369945526123047
grad_norm: 5.302188798278599, clipped: 1.0
epoch: 7, train_batch_id: 600, avg_cost: 3.964954376220703
grad_norm: 4.0016597615331655, clipped: 1.0
epoch: 7, train_batch_id: 650, avg_cost: 3.956467628479004
grad_norm: 4.107472810370732, clipped: 1.0
epoch: 7, train_batch_id: 700, avg_cost: 3.999781847000122
grad_norm: 5.705270291260147, clipped: 1.0
epoch: 7, train_batch_id: 750, avg_cost: 3.939366579055786
grad_norm: 3.9351483127879314, clipped: 1.0
epoch: 7, train_batch_id: 800, avg_cost: 3.9703989028930664
grad_norm: 7.045524565023582, clipped: 1.0
epoch: 7, train_batch_id: 850, avg_cost: 3.960172176361084
grad_norm: 5.620069018216285, clipped: 1.0
epoch: 7, train_batch_id: 900, avg_cost: 3.9518966674804688
grad_norm: 4.259273442547957, clipped: 1.0
epoch: 7, train_batch_id: 950, avg_cost: 3.945219039916992
grad_norm: 5.636534561859616, clipped: 1.0
epoch: 7, train_batch_id: 1000, avg_cost: 3.939089298248291
grad_norm: 5.058039185296844, clipped: 1.0
epoch: 7, train_batch_id: 1050, avg_cost: 3.939157724380493
grad_norm: 3.8411152444075847, clipped: 1.0
epoch: 7, train_batch_id: 1100, avg_cost: 3.997893810272217
grad_norm: 5.916484097548265, clipped: 1.0
epoch: 7, train_batch_id: 1150, avg_cost: 3.9727954864501953
grad_norm: 4.899381979558729, clipped: 1.0
epoch: 7, train_batch_id: 1200, avg_cost: 3.9564998149871826
grad_norm: 4.204258620246888, clipped: 1.0
epoch: 7, train_batch_id: 1250, avg_cost: 3.952208995819092
grad_norm: 3.6537959011858354, clipped: 1.0
epoch: 7, train_batch_id: 1300, avg_cost: 3.956329107284546
grad_norm: 3.5477555262819798, clipped: 1.0
epoch: 7, train_batch_id: 1350, avg_cost: 3.948866367340088
grad_norm: 4.005523634658577, clipped: 1.0
epoch: 7, train_batch_id: 1400, avg_cost: 3.9593420028686523
grad_norm: 4.252819364994429, clipped: 1.0
epoch: 7, train_batch_id: 1450, avg_cost: 3.9612321853637695
grad_norm: 5.004041563980293, clipped: 1.0
epoch: 7, train_batch_id: 1500, avg_cost: 3.93149995803833
grad_norm: 4.408046918818827, clipped: 1.0
epoch: 7, train_batch_id: 1550, avg_cost: 3.9311656951904297
grad_norm: 4.418631727619747, clipped: 1.0
epoch: 7, train_batch_id: 1600, avg_cost: 3.977451801300049
grad_norm: 3.646779383634723, clipped: 1.0
epoch: 7, train_batch_id: 1650, avg_cost: 3.9466874599456787
grad_norm: 4.077800689605197, clipped: 1.0
epoch: 7, train_batch_id: 1700, avg_cost: 3.9393792152404785
grad_norm: 3.4322013460079783, clipped: 1.0
epoch: 7, train_batch_id: 1750, avg_cost: 3.92643404006958
grad_norm: 3.984412807513805, clipped: 1.0
epoch: 7, train_batch_id: 1800, avg_cost: 3.964999198913574
grad_norm: 4.291396900429476, clipped: 1.0
epoch: 7, train_batch_id: 1850, avg_cost: 3.9434046745300293
grad_norm: 5.060220371790505, clipped: 1.0
epoch: 7, train_batch_id: 1900, avg_cost: 3.954176425933838
grad_norm: 5.073743876055401, clipped: 1.0
epoch: 7, train_batch_id: 1950, avg_cost: 3.962596893310547
grad_norm: 5.478299138854489, clipped: 1.0
epoch: 7, train_batch_id: 2000, avg_cost: 3.981259346008301
grad_norm: 5.3407057542336975, clipped: 1.0
epoch: 7, train_batch_id: 2050, avg_cost: 3.964871406555176
grad_norm: 4.248643095436848, clipped: 1.0
epoch: 7, train_batch_id: 2100, avg_cost: 3.9386754035949707
grad_norm: 4.60681949688735, clipped: 1.0
epoch: 7, train_batch_id: 2150, avg_cost: 3.993121385574341
grad_norm: 6.016122432109107, clipped: 1.0
epoch: 7, train_batch_id: 2200, avg_cost: 3.9756784439086914
grad_norm: 3.1713975000683194, clipped: 1.0
epoch: 7, train_batch_id: 2250, avg_cost: 3.9802746772766113
grad_norm: 5.027427997188865, clipped: 1.0
epoch: 7, train_batch_id: 2300, avg_cost: 3.9610884189605713
grad_norm: 4.344332768896421, clipped: 1.0
epoch: 7, train_batch_id: 2350, avg_cost: 3.9569170475006104
grad_norm: 4.528184236802492, clipped: 1.0
epoch: 7, train_batch_id: 2400, avg_cost: 3.922376871109009
grad_norm: 4.357406997213907, clipped: 1.0
epoch: 7, train_batch_id: 2450, avg_cost: 3.9518380165100098
grad_norm: 4.385636943751411, clipped: 1.0
Finished epoch 7, took 00:09:29 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.547576904296875 +- 0.004829939920455217
Evaluating candidate model on evaluation dataset
Epoch 7 candidate mean 4.551450729370117, baseline epoch 4 mean 4.6429314613342285, difference -0.09148073196411133
p-value: 9.744314338833758e-113
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 8, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 8, train_batch_id: 0, avg_cost: 3.936159610748291
grad_norm: 2.8436340176548502, clipped: 1.0
epoch: 8, train_batch_id: 50, avg_cost: 3.9892470836639404
grad_norm: 4.755228570552674, clipped: 1.0
epoch: 8, train_batch_id: 100, avg_cost: 3.9190917015075684
grad_norm: 3.206000849724954, clipped: 1.0
epoch: 8, train_batch_id: 150, avg_cost: 3.954411506652832
grad_norm: 4.207826735074159, clipped: 1.0
epoch: 8, train_batch_id: 200, avg_cost: 3.9100120067596436
grad_norm: 3.825833451641627, clipped: 1.0
epoch: 8, train_batch_id: 250, avg_cost: 3.9505927562713623
grad_norm: 3.3965796613065384, clipped: 1.0
epoch: 8, train_batch_id: 300, avg_cost: 3.9709856510162354
grad_norm: 3.1941750170816965, clipped: 1.0
epoch: 8, train_batch_id: 350, avg_cost: 3.9514050483703613
grad_norm: 3.5977741900795017, clipped: 1.0
epoch: 8, train_batch_id: 400, avg_cost: 3.9517927169799805
grad_norm: 4.432705566431526, clipped: 1.0
epoch: 8, train_batch_id: 450, avg_cost: 3.9008920192718506
grad_norm: 2.829149718275939, clipped: 1.0
epoch: 8, train_batch_id: 500, avg_cost: 3.918053150177002
grad_norm: 3.5630323433511553, clipped: 1.0
epoch: 8, train_batch_id: 550, avg_cost: 3.9404659271240234
grad_norm: 3.240467561391563, clipped: 1.0
epoch: 8, train_batch_id: 600, avg_cost: 3.9255576133728027
grad_norm: 3.610530260213074, clipped: 1.0
epoch: 8, train_batch_id: 650, avg_cost: 3.955765962600708
grad_norm: 4.384368833750096, clipped: 1.0
epoch: 8, train_batch_id: 700, avg_cost: 3.935359239578247
grad_norm: 5.328387221864882, clipped: 1.0
epoch: 8, train_batch_id: 750, avg_cost: 3.962345600128174
grad_norm: 4.190033986792331, clipped: 1.0
epoch: 8, train_batch_id: 800, avg_cost: 3.9442291259765625
grad_norm: 3.121191624176968, clipped: 1.0
epoch: 8, train_batch_id: 850, avg_cost: 3.933180570602417
grad_norm: 3.4054860972746854, clipped: 1.0
epoch: 8, train_batch_id: 900, avg_cost: 3.9827728271484375
grad_norm: 3.301935210994986, clipped: 1.0
epoch: 8, train_batch_id: 950, avg_cost: 3.9687695503234863
grad_norm: 2.9046514264387153, clipped: 1.0
epoch: 8, train_batch_id: 1000, avg_cost: 3.955637216567993
grad_norm: 3.7560432272148, clipped: 1.0
epoch: 8, train_batch_id: 1050, avg_cost: 3.958649158477783
grad_norm: 3.510032467878693, clipped: 1.0
epoch: 8, train_batch_id: 1100, avg_cost: 3.9327292442321777
grad_norm: 3.4104612872501363, clipped: 1.0
epoch: 8, train_batch_id: 1150, avg_cost: 3.953336477279663
grad_norm: 5.398843412802999, clipped: 1.0
epoch: 8, train_batch_id: 1200, avg_cost: 3.9460649490356445
grad_norm: 4.617673837761981, clipped: 1.0
epoch: 8, train_batch_id: 1250, avg_cost: 3.943380117416382
grad_norm: 3.203999212395924, clipped: 1.0
epoch: 8, train_batch_id: 1300, avg_cost: 3.9592490196228027
grad_norm: 3.070383454579572, clipped: 1.0
epoch: 8, train_batch_id: 1350, avg_cost: 3.9867796897888184
grad_norm: 3.318229314036514, clipped: 1.0
epoch: 8, train_batch_id: 1400, avg_cost: 3.924520254135132
grad_norm: 5.431903000978079, clipped: 1.0
epoch: 8, train_batch_id: 1450, avg_cost: 3.965486526489258
grad_norm: 4.7647756834248085, clipped: 1.0
epoch: 8, train_batch_id: 1500, avg_cost: 3.944244384765625
grad_norm: 4.079643668600773, clipped: 1.0
epoch: 8, train_batch_id: 1550, avg_cost: 3.9365830421447754
grad_norm: 4.06532154803509, clipped: 1.0
epoch: 8, train_batch_id: 1600, avg_cost: 3.9596145153045654
grad_norm: 3.7421222615091763, clipped: 1.0
epoch: 8, train_batch_id: 1650, avg_cost: 3.951446056365967
grad_norm: 3.469133293605928, clipped: 1.0
epoch: 8, train_batch_id: 1700, avg_cost: 3.953737735748291
grad_norm: 4.488254513763507, clipped: 1.0
epoch: 8, train_batch_id: 1750, avg_cost: 3.9495909214019775
grad_norm: 4.351470793247108, clipped: 1.0
epoch: 8, train_batch_id: 1800, avg_cost: 3.947988986968994
grad_norm: 2.9695663132517223, clipped: 1.0
epoch: 8, train_batch_id: 1850, avg_cost: 3.950469493865967
grad_norm: 3.9091734599367043, clipped: 1.0
epoch: 8, train_batch_id: 1900, avg_cost: 3.9555959701538086
grad_norm: 4.084907765968832, clipped: 1.0
epoch: 8, train_batch_id: 1950, avg_cost: 3.9588828086853027
grad_norm: 4.093503732349495, clipped: 1.0
epoch: 8, train_batch_id: 2000, avg_cost: 3.930920124053955
grad_norm: 3.921717777014922, clipped: 1.0
epoch: 8, train_batch_id: 2050, avg_cost: 3.975531578063965
grad_norm: 4.882204007776388, clipped: 1.0
epoch: 8, train_batch_id: 2100, avg_cost: 3.9442691802978516
grad_norm: 4.398416916700326, clipped: 1.0
epoch: 8, train_batch_id: 2150, avg_cost: 3.951577663421631
grad_norm: 5.2410855357733315, clipped: 1.0
epoch: 8, train_batch_id: 2200, avg_cost: 3.931842803955078
grad_norm: 4.759344355318575, clipped: 1.0
epoch: 8, train_batch_id: 2250, avg_cost: 3.9354066848754883
grad_norm: 3.0766688845886123, clipped: 1.0
epoch: 8, train_batch_id: 2300, avg_cost: 3.9689159393310547
grad_norm: 3.769442829708675, clipped: 1.0
epoch: 8, train_batch_id: 2350, avg_cost: 3.918555498123169
grad_norm: 3.6554561215908166, clipped: 1.0
epoch: 8, train_batch_id: 2400, avg_cost: 3.941516876220703
grad_norm: 3.520472204003547, clipped: 1.0
epoch: 8, train_batch_id: 2450, avg_cost: 3.9576470851898193
grad_norm: 4.968182630231811, clipped: 1.0
Finished epoch 8, took 00:09:26 s
Saving model and state...
Validating...
Validation overall avg_cost: 5.087080001831055 +- 0.00545726902782917
Evaluating candidate model on evaluation dataset
Epoch 8 candidate mean 5.085230350494385, baseline epoch 7 mean 4.548694133758545, difference 0.5365362167358398
Start train epoch 9, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 9, train_batch_id: 0, avg_cost: 3.9280481338500977
grad_norm: 4.635325073292878, clipped: 1.0
epoch: 9, train_batch_id: 50, avg_cost: 3.9546761512756348
grad_norm: 4.9242022717190315, clipped: 1.0
epoch: 9, train_batch_id: 100, avg_cost: 3.9588146209716797
grad_norm: 3.616359921915338, clipped: 1.0
epoch: 9, train_batch_id: 150, avg_cost: 3.949662923812866
grad_norm: 3.466722246617596, clipped: 1.0
epoch: 9, train_batch_id: 200, avg_cost: 3.9586215019226074
grad_norm: 3.7017029881770487, clipped: 1.0
epoch: 9, train_batch_id: 250, avg_cost: 3.9349560737609863
grad_norm: 3.642203798014213, clipped: 1.0
epoch: 9, train_batch_id: 300, avg_cost: 3.961366653442383
grad_norm: 4.139793539415901, clipped: 1.0
epoch: 9, train_batch_id: 350, avg_cost: 3.941072702407837
grad_norm: 4.28954589767815, clipped: 1.0
epoch: 9, train_batch_id: 400, avg_cost: 3.9464492797851562
grad_norm: 4.964596634267458, clipped: 1.0
epoch: 9, train_batch_id: 450, avg_cost: 3.9439339637756348
grad_norm: 4.244145411662978, clipped: 1.0
epoch: 9, train_batch_id: 500, avg_cost: 3.9612128734588623
grad_norm: 3.490666322784148, clipped: 1.0
epoch: 9, train_batch_id: 550, avg_cost: 3.9575531482696533
grad_norm: 2.6838912844167346, clipped: 1.0
epoch: 9, train_batch_id: 600, avg_cost: 3.9481611251831055
grad_norm: 2.8955220187546575, clipped: 1.0
epoch: 9, train_batch_id: 650, avg_cost: 3.9611310958862305
grad_norm: 3.3865236505931904, clipped: 1.0
epoch: 9, train_batch_id: 700, avg_cost: 3.946143627166748
grad_norm: 4.2211060380299665, clipped: 1.0
epoch: 9, train_batch_id: 750, avg_cost: 3.947660446166992
grad_norm: 3.489347735990738, clipped: 1.0
epoch: 9, train_batch_id: 800, avg_cost: 3.982494592666626
grad_norm: 3.8011089293163884, clipped: 1.0
epoch: 9, train_batch_id: 850, avg_cost: 3.944552421569824
grad_norm: 4.15290090297968, clipped: 1.0
epoch: 9, train_batch_id: 900, avg_cost: 3.929973602294922
grad_norm: 4.398130522139681, clipped: 1.0
epoch: 9, train_batch_id: 950, avg_cost: 3.952770471572876
grad_norm: 2.9685926523583754, clipped: 1.0
epoch: 9, train_batch_id: 1000, avg_cost: 3.9540634155273438
grad_norm: 3.598649653402899, clipped: 1.0
epoch: 9, train_batch_id: 1050, avg_cost: 3.9413671493530273
grad_norm: 3.595444997177959, clipped: 1.0
epoch: 9, train_batch_id: 1100, avg_cost: 3.941958427429199
grad_norm: 2.721530574418236, clipped: 1.0
epoch: 9, train_batch_id: 1150, avg_cost: 3.973186492919922
grad_norm: 3.6203464183794942, clipped: 1.0
epoch: 9, train_batch_id: 1200, avg_cost: 3.964731216430664
grad_norm: 6.22941639021239, clipped: 1.0
epoch: 9, train_batch_id: 1250, avg_cost: 3.97236967086792
grad_norm: 3.146176217520824, clipped: 1.0
epoch: 9, train_batch_id: 1300, avg_cost: 3.999485969543457
grad_norm: 2.879428344932979, clipped: 1.0
epoch: 9, train_batch_id: 1350, avg_cost: 3.954145908355713
grad_norm: 3.8696683108214684, clipped: 1.0
epoch: 9, train_batch_id: 1400, avg_cost: 3.964900493621826
grad_norm: 3.916793756779631, clipped: 1.0
epoch: 9, train_batch_id: 1450, avg_cost: 3.9503345489501953
grad_norm: 4.2904555936210445, clipped: 1.0
epoch: 9, train_batch_id: 1500, avg_cost: 3.9500174522399902
grad_norm: 3.2052555162778193, clipped: 1.0
epoch: 9, train_batch_id: 1550, avg_cost: 3.9611573219299316
grad_norm: 4.879927779547663, clipped: 1.0
epoch: 9, train_batch_id: 1600, avg_cost: 3.9406161308288574
grad_norm: 4.3602773308268095, clipped: 1.0
epoch: 9, train_batch_id: 1650, avg_cost: 3.929563283920288
grad_norm: 3.5211301284550798, clipped: 1.0
epoch: 9, train_batch_id: 1700, avg_cost: 3.915102958679199
grad_norm: 4.612959647461466, clipped: 1.0
epoch: 9, train_batch_id: 1750, avg_cost: 3.93336820602417
grad_norm: 3.4056241718109845, clipped: 1.0
epoch: 9, train_batch_id: 1800, avg_cost: 3.956141233444214
grad_norm: 3.846714851562571, clipped: 1.0
epoch: 9, train_batch_id: 1850, avg_cost: 3.9394493103027344
grad_norm: 3.154007210581195, clipped: 1.0
epoch: 9, train_batch_id: 1900, avg_cost: 3.9588446617126465
grad_norm: 3.418588021077481, clipped: 1.0
epoch: 9, train_batch_id: 1950, avg_cost: 3.959651470184326
grad_norm: 5.13735485642564, clipped: 1.0
epoch: 9, train_batch_id: 2000, avg_cost: 3.924288272857666
grad_norm: 3.8748324245882193, clipped: 1.0
epoch: 9, train_batch_id: 2050, avg_cost: 3.9351699352264404
grad_norm: 4.4812153715344705, clipped: 1.0
epoch: 9, train_batch_id: 2100, avg_cost: 3.9877424240112305
grad_norm: 4.548570684515691, clipped: 1.0
epoch: 9, train_batch_id: 2150, avg_cost: 3.989096164703369
grad_norm: 3.4649463069906568, clipped: 1.0
epoch: 9, train_batch_id: 2200, avg_cost: 3.94340181350708
grad_norm: 3.7964084502893276, clipped: 1.0
epoch: 9, train_batch_id: 2250, avg_cost: 3.965280771255493
grad_norm: 3.674219888144942, clipped: 1.0
epoch: 9, train_batch_id: 2300, avg_cost: 3.935065746307373
grad_norm: 3.173897458179961, clipped: 1.0
epoch: 9, train_batch_id: 2350, avg_cost: 3.9738047122955322
grad_norm: 3.5246617317280053, clipped: 1.0
epoch: 9, train_batch_id: 2400, avg_cost: 3.9663729667663574
grad_norm: 3.454236714590042, clipped: 1.0
epoch: 9, train_batch_id: 2450, avg_cost: 3.976613759994507
grad_norm: 5.387902915752279, clipped: 1.0
Finished epoch 9, took 00:09:27 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.532812118530273 +- 0.004716269671916962
Evaluating candidate model on evaluation dataset
Epoch 9 candidate mean 4.535760879516602, baseline epoch 7 mean 4.548694133758545, difference -0.01293325424194336
p-value: 0.00013510830063003058
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 10, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 10, train_batch_id: 0, avg_cost: 3.969391107559204
grad_norm: 3.5958868252608074, clipped: 1.0
epoch: 10, train_batch_id: 50, avg_cost: 3.9447598457336426
grad_norm: 5.370545021985548, clipped: 1.0
epoch: 10, train_batch_id: 100, avg_cost: 3.954468250274658
grad_norm: 2.921259840003582, clipped: 1.0
epoch: 10, train_batch_id: 150, avg_cost: 3.955042839050293
grad_norm: 3.006844244171991, clipped: 1.0
epoch: 10, train_batch_id: 200, avg_cost: 3.9311203956604004
grad_norm: 4.299517872749475, clipped: 1.0
epoch: 10, train_batch_id: 250, avg_cost: 3.9543514251708984
grad_norm: 3.8975128386975606, clipped: 1.0
epoch: 10, train_batch_id: 300, avg_cost: 3.9245781898498535
grad_norm: 4.175647370929121, clipped: 1.0
epoch: 10, train_batch_id: 350, avg_cost: 3.9536948204040527
grad_norm: 3.34047654719273, clipped: 1.0
epoch: 10, train_batch_id: 400, avg_cost: 3.9409756660461426
grad_norm: 3.618073859119916, clipped: 1.0
epoch: 10, train_batch_id: 450, avg_cost: 3.9471802711486816
grad_norm: 4.021818934882119, clipped: 1.0
epoch: 10, train_batch_id: 500, avg_cost: 3.9496686458587646
grad_norm: 4.27903094948223, clipped: 1.0
epoch: 10, train_batch_id: 550, avg_cost: 3.932673931121826
grad_norm: 4.754822595508703, clipped: 1.0
epoch: 10, train_batch_id: 600, avg_cost: 3.9178507328033447
grad_norm: 3.445676128183732, clipped: 1.0
epoch: 10, train_batch_id: 650, avg_cost: 3.9270663261413574
grad_norm: 4.17143863758311, clipped: 1.0
epoch: 10, train_batch_id: 700, avg_cost: 3.935129165649414
grad_norm: 3.1780901767379715, clipped: 1.0
epoch: 10, train_batch_id: 750, avg_cost: 3.9267640113830566
grad_norm: 3.941810433356723, clipped: 1.0
epoch: 10, train_batch_id: 800, avg_cost: 3.9234628677368164
grad_norm: 5.250394397614979, clipped: 1.0
epoch: 10, train_batch_id: 850, avg_cost: 3.9435031414031982
grad_norm: 4.345351636674056, clipped: 1.0
epoch: 10, train_batch_id: 900, avg_cost: 3.959744691848755
grad_norm: 3.571384630674722, clipped: 1.0
epoch: 10, train_batch_id: 950, avg_cost: 3.937171459197998
grad_norm: 2.8012521423058794, clipped: 1.0
epoch: 10, train_batch_id: 1000, avg_cost: 3.9672443866729736
grad_norm: 3.532211433674294, clipped: 1.0
epoch: 10, train_batch_id: 1050, avg_cost: 3.976670980453491
grad_norm: 3.60953505661579, clipped: 1.0
epoch: 10, train_batch_id: 1100, avg_cost: 3.912322998046875
grad_norm: 2.8231005280529198, clipped: 1.0
epoch: 10, train_batch_id: 1150, avg_cost: 3.9268765449523926
grad_norm: 3.9817481859119264, clipped: 1.0
epoch: 10, train_batch_id: 1200, avg_cost: 3.947026491165161
grad_norm: 3.906663449327807, clipped: 1.0
epoch: 10, train_batch_id: 1250, avg_cost: 3.9222559928894043
grad_norm: 4.118566319824705, clipped: 1.0
epoch: 10, train_batch_id: 1300, avg_cost: 3.920891523361206
grad_norm: 6.168733935197087, clipped: 1.0
epoch: 10, train_batch_id: 1350, avg_cost: 3.955338478088379
grad_norm: 3.0132833203664835, clipped: 1.0
epoch: 10, train_batch_id: 1400, avg_cost: 3.9395034313201904
grad_norm: 3.537338954350604, clipped: 1.0
epoch: 10, train_batch_id: 1450, avg_cost: 3.93686580657959
grad_norm: 3.774642467788731, clipped: 1.0
epoch: 10, train_batch_id: 1500, avg_cost: 3.9252045154571533
grad_norm: 3.5221966551237345, clipped: 1.0
epoch: 10, train_batch_id: 1550, avg_cost: 3.9620683193206787
grad_norm: 4.225823989566859, clipped: 1.0
epoch: 10, train_batch_id: 1600, avg_cost: 3.961704730987549
grad_norm: 3.6710436820041425, clipped: 1.0
epoch: 10, train_batch_id: 1650, avg_cost: 3.9622745513916016
grad_norm: 4.307124885415649, clipped: 1.0
epoch: 10, train_batch_id: 1700, avg_cost: 3.9322667121887207
grad_norm: 5.384739453622063, clipped: 1.0
epoch: 10, train_batch_id: 1750, avg_cost: 3.9367618560791016
grad_norm: 3.471740832326614, clipped: 1.0
epoch: 10, train_batch_id: 1800, avg_cost: 3.936473846435547
grad_norm: 4.082819545704868, clipped: 1.0
epoch: 10, train_batch_id: 1850, avg_cost: 3.9033775329589844
grad_norm: 3.85370483527751, clipped: 1.0
epoch: 10, train_batch_id: 1900, avg_cost: 3.977799892425537
grad_norm: 4.392457116929174, clipped: 1.0
epoch: 10, train_batch_id: 1950, avg_cost: 3.9529781341552734
grad_norm: 2.933426042842274, clipped: 1.0
epoch: 10, train_batch_id: 2000, avg_cost: 3.976942539215088
grad_norm: 6.305735742183693, clipped: 1.0
epoch: 10, train_batch_id: 2050, avg_cost: 3.935055732727051
grad_norm: 5.048622041668953, clipped: 1.0
epoch: 10, train_batch_id: 2100, avg_cost: 3.953948497772217
grad_norm: 4.170505031696011, clipped: 1.0
epoch: 10, train_batch_id: 2150, avg_cost: 3.9424500465393066
grad_norm: 3.6141715920865765, clipped: 1.0
epoch: 10, train_batch_id: 2200, avg_cost: 3.944744110107422
grad_norm: 4.527812500278003, clipped: 1.0
epoch: 10, train_batch_id: 2250, avg_cost: 3.9446616172790527
grad_norm: 4.961194765437784, clipped: 1.0
epoch: 10, train_batch_id: 2300, avg_cost: 3.9456024169921875
grad_norm: 4.796855814928886, clipped: 1.0
epoch: 10, train_batch_id: 2350, avg_cost: 3.994415283203125
grad_norm: 5.8673516901655915, clipped: 1.0
epoch: 10, train_batch_id: 2400, avg_cost: 3.9706270694732666
grad_norm: 3.7056317743653953, clipped: 1.0
epoch: 10, train_batch_id: 2450, avg_cost: 3.9723496437072754
grad_norm: 3.7011943986029716, clipped: 1.0
Finished epoch 10, took 00:09:32 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.354856491088867 +- 0.0042470116168260574
Evaluating candidate model on evaluation dataset
Epoch 10 candidate mean 4.350247859954834, baseline epoch 9 mean 4.534901142120361, difference -0.18465328216552734
p-value: 0.0
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 11, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


epoch: 11, train_batch_id: 0, avg_cost: 3.9658164978027344
grad_norm: 3.1845312490795052, clipped: 1.0
epoch: 11, train_batch_id: 50, avg_cost: 3.9554455280303955
grad_norm: 3.2074648301710655, clipped: 1.0
epoch: 11, train_batch_id: 100, avg_cost: 3.9149696826934814
grad_norm: 2.8425791936747706, clipped: 1.0
epoch: 11, train_batch_id: 150, avg_cost: 3.951801061630249
grad_norm: 2.401954474486847, clipped: 1.0
epoch: 11, train_batch_id: 200, avg_cost: 3.925210952758789
grad_norm: 2.3527517384215737, clipped: 1.0
epoch: 11, train_batch_id: 250, avg_cost: 3.9381985664367676
grad_norm: 3.2567718689868554, clipped: 1.0
epoch: 11, train_batch_id: 300, avg_cost: 3.926187038421631
grad_norm: 2.5642946428986804, clipped: 1.0
epoch: 11, train_batch_id: 350, avg_cost: 3.9282150268554688
grad_norm: 3.0312618320293567, clipped: 1.0
epoch: 11, train_batch_id: 400, avg_cost: 3.9285688400268555
grad_norm: 2.822944745553361, clipped: 1.0
epoch: 11, train_batch_id: 450, avg_cost: 3.942697048187256
grad_norm: 3.452202673170905, clipped: 1.0
epoch: 11, train_batch_id: 500, avg_cost: 3.947056293487549
grad_norm: 2.587507189488996, clipped: 1.0
epoch: 11, train_batch_id: 550, avg_cost: 3.93740177154541
grad_norm: 2.2319593732774488, clipped: 1.0
epoch: 11, train_batch_id: 600, avg_cost: 3.920652389526367
grad_norm: 3.3938999521861892, clipped: 1.0
epoch: 11, train_batch_id: 650, avg_cost: 3.9172444343566895
grad_norm: 2.334163977553614, clipped: 1.0
epoch: 11, train_batch_id: 700, avg_cost: 3.932389736175537
grad_norm: 3.172491261796653, clipped: 1.0
epoch: 11, train_batch_id: 750, avg_cost: 3.9215986728668213
grad_norm: 3.617580080089319, clipped: 1.0
epoch: 11, train_batch_id: 800, avg_cost: 3.898937225341797
grad_norm: 2.891669391573748, clipped: 1.0
epoch: 11, train_batch_id: 850, avg_cost: 3.956716299057007
grad_norm: 2.6290699828423247, clipped: 1.0
epoch: 11, train_batch_id: 900, avg_cost: 3.949439764022827
grad_norm: 3.670942960708764, clipped: 1.0
epoch: 11, train_batch_id: 950, avg_cost: 3.93721866607666
grad_norm: 2.2800594693648, clipped: 1.0
epoch: 11, train_batch_id: 1000, avg_cost: 3.947310447692871
grad_norm: 3.2237352532671024, clipped: 1.0
epoch: 11, train_batch_id: 1050, avg_cost: 3.9375076293945312
grad_norm: 4.383047491640473, clipped: 1.0
epoch: 11, train_batch_id: 1100, avg_cost: 3.8912887573242188
grad_norm: 2.790786231507047, clipped: 1.0
epoch: 11, train_batch_id: 1150, avg_cost: 3.937547206878662
grad_norm: 4.011111980339751, clipped: 1.0
epoch: 11, train_batch_id: 1200, avg_cost: 3.8906350135803223
grad_norm: 3.15581058864568, clipped: 1.0
epoch: 11, train_batch_id: 1250, avg_cost: 3.935255765914917
grad_norm: 3.288755201765255, clipped: 1.0
epoch: 11, train_batch_id: 1300, avg_cost: 3.921994924545288
grad_norm: 2.974896856949536, clipped: 1.0
epoch: 11, train_batch_id: 1350, avg_cost: 3.915759325027466
grad_norm: 2.581301904392876, clipped: 1.0
epoch: 11, train_batch_id: 1400, avg_cost: 3.9090352058410645
grad_norm: 3.8600746979858593, clipped: 1.0
epoch: 11, train_batch_id: 1450, avg_cost: 3.961052417755127
grad_norm: 2.4763252028999334, clipped: 1.0
epoch: 11, train_batch_id: 1500, avg_cost: 3.924337863922119
grad_norm: 2.6411710702551927, clipped: 1.0
epoch: 11, train_batch_id: 1550, avg_cost: 3.9500324726104736
grad_norm: 3.578343982179757, clipped: 1.0
epoch: 11, train_batch_id: 1600, avg_cost: 3.949983596801758
grad_norm: 3.1768558354990533, clipped: 1.0
epoch: 11, train_batch_id: 1650, avg_cost: 3.9249513149261475
grad_norm: 2.333943374700831, clipped: 1.0
epoch: 11, train_batch_id: 1700, avg_cost: 3.9351110458374023
grad_norm: 2.6202997226899236, clipped: 1.0
epoch: 11, train_batch_id: 1750, avg_cost: 3.907341957092285
grad_norm: 2.597784596887549, clipped: 1.0
epoch: 11, train_batch_id: 1800, avg_cost: 3.9749069213867188
grad_norm: 5.131191630793007, clipped: 1.0
epoch: 11, train_batch_id: 1850, avg_cost: 3.9410905838012695
grad_norm: 3.0386202980455947, clipped: 1.0
epoch: 11, train_batch_id: 1900, avg_cost: 3.9240429401397705
grad_norm: 2.477974159686745, clipped: 1.0
epoch: 11, train_batch_id: 1950, avg_cost: 3.898627996444702
grad_norm: 3.4238241271635688, clipped: 1.0
epoch: 11, train_batch_id: 2000, avg_cost: 3.9259796142578125
grad_norm: 4.294599620312704, clipped: 1.0
epoch: 11, train_batch_id: 2050, avg_cost: 3.925116777420044
grad_norm: 3.8784183411366544, clipped: 1.0
epoch: 11, train_batch_id: 2100, avg_cost: 3.9353222846984863
grad_norm: 3.5824322353865243, clipped: 1.0
epoch: 11, train_batch_id: 2150, avg_cost: 3.9748787879943848
grad_norm: 3.3415289736434093, clipped: 1.0
epoch: 11, train_batch_id: 2200, avg_cost: 3.941561698913574
grad_norm: 3.2331115591905593, clipped: 1.0
epoch: 11, train_batch_id: 2250, avg_cost: 3.911475658416748
grad_norm: 3.9987095433418895, clipped: 1.0
epoch: 11, train_batch_id: 2300, avg_cost: 3.9692914485931396
grad_norm: 3.338137101371179, clipped: 1.0
epoch: 11, train_batch_id: 2350, avg_cost: 3.9023146629333496
grad_norm: 2.9098082020742426, clipped: 1.0
epoch: 11, train_batch_id: 2400, avg_cost: 3.9254355430603027
grad_norm: 4.200853170110811, clipped: 1.0
epoch: 11, train_batch_id: 2450, avg_cost: 3.9533567428588867
grad_norm: 2.695266553062387, clipped: 1.0
Finished epoch 11, took 00:09:25 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.644519329071045 +- 0.005100893788039684
Evaluating candidate model on evaluation dataset
Epoch 11 candidate mean 4.639587879180908, baseline epoch 10 mean 4.355447769165039, difference 0.28414011001586914
Start train epoch 12, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 12, train_batch_id: 0, avg_cost: 3.923691511154175
grad_norm: 3.149741632511416, clipped: 1.0
epoch: 12, train_batch_id: 50, avg_cost: 3.9665679931640625
grad_norm: 2.380912739594116, clipped: 1.0
epoch: 12, train_batch_id: 100, avg_cost: 3.9026150703430176
grad_norm: 2.4679943403049363, clipped: 1.0
epoch: 12, train_batch_id: 150, avg_cost: 3.920653820037842
grad_norm: 3.1065853593495327, clipped: 1.0
epoch: 12, train_batch_id: 200, avg_cost: 3.9568850994110107
grad_norm: 2.6928855206535816, clipped: 1.0
epoch: 12, train_batch_id: 250, avg_cost: 3.9398422241210938
grad_norm: 3.009239883812142, clipped: 1.0
epoch: 12, train_batch_id: 300, avg_cost: 3.937042236328125
grad_norm: 4.067291206182866, clipped: 1.0
epoch: 12, train_batch_id: 350, avg_cost: 3.9570822715759277
grad_norm: 2.450808800176041, clipped: 1.0
epoch: 12, train_batch_id: 400, avg_cost: 3.924246311187744
grad_norm: 2.478313635623568, clipped: 1.0
epoch: 12, train_batch_id: 450, avg_cost: 3.934340476989746
grad_norm: 3.695132317859182, clipped: 1.0
epoch: 12, train_batch_id: 500, avg_cost: 3.9154725074768066
grad_norm: 3.0132319743326623, clipped: 1.0
epoch: 12, train_batch_id: 550, avg_cost: 3.9143142700195312
grad_norm: 3.6829933245546855, clipped: 1.0
epoch: 12, train_batch_id: 600, avg_cost: 3.949779510498047
grad_norm: 2.3851035962512324, clipped: 1.0
epoch: 12, train_batch_id: 650, avg_cost: 3.92000675201416
grad_norm: 3.37455329309441, clipped: 1.0
epoch: 12, train_batch_id: 700, avg_cost: 3.9209280014038086
grad_norm: 2.628722373956643, clipped: 1.0
epoch: 12, train_batch_id: 750, avg_cost: 3.9362668991088867
grad_norm: 3.814225318109966, clipped: 1.0
epoch: 12, train_batch_id: 800, avg_cost: 3.9492428302764893
grad_norm: 2.333059627755693, clipped: 1.0
epoch: 12, train_batch_id: 850, avg_cost: 3.9142799377441406
grad_norm: 2.8722552363067013, clipped: 1.0
epoch: 12, train_batch_id: 900, avg_cost: 3.933648109436035
grad_norm: 3.0715209582621235, clipped: 1.0
epoch: 12, train_batch_id: 950, avg_cost: 3.9078938961029053
grad_norm: 2.996265312621114, clipped: 1.0
epoch: 12, train_batch_id: 1000, avg_cost: 3.941213607788086
grad_norm: 3.2197250501147776, clipped: 1.0
epoch: 12, train_batch_id: 1050, avg_cost: 3.936880588531494
grad_norm: 2.2434979601839564, clipped: 1.0
epoch: 12, train_batch_id: 1100, avg_cost: 3.9166626930236816
grad_norm: 2.3847133737425548, clipped: 1.0
epoch: 12, train_batch_id: 1150, avg_cost: 3.975154399871826
grad_norm: 2.8354139406940657, clipped: 1.0
epoch: 12, train_batch_id: 1200, avg_cost: 3.942335605621338
grad_norm: 2.502847171780815, clipped: 1.0
epoch: 12, train_batch_id: 1250, avg_cost: 3.9295787811279297
grad_norm: 2.098192524899947, clipped: 1.0
epoch: 12, train_batch_id: 1300, avg_cost: 3.9012532234191895
grad_norm: 2.8993366343087907, clipped: 1.0
epoch: 12, train_batch_id: 1350, avg_cost: 3.9115591049194336
grad_norm: 2.8705059329912763, clipped: 1.0
epoch: 12, train_batch_id: 1400, avg_cost: 3.918187379837036
grad_norm: 3.377653169083449, clipped: 1.0
epoch: 12, train_batch_id: 1450, avg_cost: 3.9190595149993896
grad_norm: 2.6439628420205907, clipped: 1.0
epoch: 12, train_batch_id: 1500, avg_cost: 3.903886318206787
grad_norm: 2.46341188296354, clipped: 1.0
epoch: 12, train_batch_id: 1550, avg_cost: 3.935194969177246
grad_norm: 2.943704990200417, clipped: 1.0
epoch: 12, train_batch_id: 1600, avg_cost: 3.9395627975463867
grad_norm: 3.158053473475658, clipped: 1.0
epoch: 12, train_batch_id: 1650, avg_cost: 3.948763370513916
grad_norm: 2.81884980974662, clipped: 1.0
epoch: 12, train_batch_id: 1700, avg_cost: 3.9583702087402344
grad_norm: 3.2379985071639448, clipped: 1.0
epoch: 12, train_batch_id: 1750, avg_cost: 3.9428510665893555
grad_norm: 4.004496149190622, clipped: 1.0
epoch: 12, train_batch_id: 1800, avg_cost: 3.9144012928009033
grad_norm: 2.475077738439453, clipped: 1.0
epoch: 12, train_batch_id: 1850, avg_cost: 3.9429988861083984
grad_norm: 2.953011339112391, clipped: 1.0
epoch: 12, train_batch_id: 1900, avg_cost: 3.952744245529175
grad_norm: 3.3488685463293724, clipped: 1.0
epoch: 12, train_batch_id: 1950, avg_cost: 3.924821376800537
grad_norm: 3.039487233318144, clipped: 1.0
epoch: 12, train_batch_id: 2000, avg_cost: 3.9325246810913086
grad_norm: 2.8087657112515507, clipped: 1.0
epoch: 12, train_batch_id: 2050, avg_cost: 3.928800106048584
grad_norm: 4.444234182199373, clipped: 1.0
epoch: 12, train_batch_id: 2100, avg_cost: 3.941586971282959
grad_norm: 2.802772855235017, clipped: 1.0
epoch: 12, train_batch_id: 2150, avg_cost: 3.9468111991882324
grad_norm: 2.068943262390953, clipped: 1.0
epoch: 12, train_batch_id: 2200, avg_cost: 3.8878417015075684
grad_norm: 2.317101452369328, clipped: 1.0
epoch: 12, train_batch_id: 2250, avg_cost: 3.8944778442382812
grad_norm: 3.255079082129572, clipped: 1.0
epoch: 12, train_batch_id: 2300, avg_cost: 3.9376749992370605
grad_norm: 2.6321978745903727, clipped: 1.0
epoch: 12, train_batch_id: 2350, avg_cost: 3.9257307052612305
grad_norm: 3.765616211645225, clipped: 1.0
epoch: 12, train_batch_id: 2400, avg_cost: 3.9513683319091797
grad_norm: 2.0100421215299265, clipped: 1.0
epoch: 12, train_batch_id: 2450, avg_cost: 3.932793617248535
grad_norm: 3.0527150960607146, clipped: 1.0
Finished epoch 12, took 00:09:19 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.458076477050781 +- 0.0044134994968771935
Evaluating candidate model on evaluation dataset
Epoch 12 candidate mean 4.456623077392578, baseline epoch 10 mean 4.355447769165039, difference 0.10117530822753906
Start train epoch 13, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 13, train_batch_id: 0, avg_cost: 3.9123034477233887
grad_norm: 2.6837298705100134, clipped: 1.0
epoch: 13, train_batch_id: 50, avg_cost: 3.9305355548858643
grad_norm: 3.181605291039801, clipped: 1.0
epoch: 13, train_batch_id: 100, avg_cost: 3.9163503646850586
grad_norm: 2.6934664433207547, clipped: 1.0
epoch: 13, train_batch_id: 150, avg_cost: 3.9108972549438477
grad_norm: 2.7645626037728723, clipped: 1.0
epoch: 13, train_batch_id: 200, avg_cost: 3.9098424911499023
grad_norm: 3.037680838516473, clipped: 1.0
epoch: 13, train_batch_id: 250, avg_cost: 3.9489598274230957
grad_norm: 3.8142240079112786, clipped: 1.0
epoch: 13, train_batch_id: 300, avg_cost: 3.9225149154663086
grad_norm: 2.6747757804541332, clipped: 1.0
epoch: 13, train_batch_id: 350, avg_cost: 3.9417238235473633
grad_norm: 2.9199547995372437, clipped: 1.0
epoch: 13, train_batch_id: 400, avg_cost: 3.9533185958862305
grad_norm: 3.0636823491623346, clipped: 1.0
epoch: 13, train_batch_id: 450, avg_cost: 3.8915014266967773
grad_norm: 2.84810351914335, clipped: 1.0
epoch: 13, train_batch_id: 500, avg_cost: 3.907621383666992
grad_norm: 3.178059693846853, clipped: 1.0
epoch: 13, train_batch_id: 550, avg_cost: 3.9099597930908203
grad_norm: 2.80390005471814, clipped: 1.0
epoch: 13, train_batch_id: 600, avg_cost: 3.9442176818847656
grad_norm: 2.9193004122856276, clipped: 1.0
epoch: 13, train_batch_id: 650, avg_cost: 3.9129638671875
grad_norm: 3.679199193604909, clipped: 1.0
epoch: 13, train_batch_id: 700, avg_cost: 3.9179062843322754
grad_norm: 3.036748962982139, clipped: 1.0
epoch: 13, train_batch_id: 750, avg_cost: 3.921347141265869
grad_norm: 3.373238104509429, clipped: 1.0
epoch: 13, train_batch_id: 800, avg_cost: 3.9403228759765625
grad_norm: 3.734005768798462, clipped: 1.0
epoch: 13, train_batch_id: 850, avg_cost: 3.9350314140319824
grad_norm: 2.7976411889672086, clipped: 1.0
epoch: 13, train_batch_id: 900, avg_cost: 3.911738634109497
grad_norm: 2.375305835509423, clipped: 1.0
epoch: 13, train_batch_id: 950, avg_cost: 3.9170727729797363
grad_norm: 3.308477003585519, clipped: 1.0
epoch: 13, train_batch_id: 1000, avg_cost: 3.92867112159729
grad_norm: 4.082850737931163, clipped: 1.0
epoch: 13, train_batch_id: 1050, avg_cost: 3.9341917037963867
grad_norm: 4.0101086129628385, clipped: 1.0
epoch: 13, train_batch_id: 1100, avg_cost: 3.902111768722534
grad_norm: 5.104114307159889, clipped: 1.0
epoch: 13, train_batch_id: 1150, avg_cost: 3.883254051208496
grad_norm: 3.4937770817644678, clipped: 1.0
epoch: 13, train_batch_id: 1200, avg_cost: 3.9185807704925537
grad_norm: 2.9228510397432625, clipped: 1.0
epoch: 13, train_batch_id: 1250, avg_cost: 3.9152603149414062
grad_norm: 4.204821563793978, clipped: 1.0
epoch: 13, train_batch_id: 1300, avg_cost: 3.897371768951416
grad_norm: 4.514039401866169, clipped: 1.0
epoch: 13, train_batch_id: 1350, avg_cost: 3.905402898788452
grad_norm: 2.5345946140218008, clipped: 1.0
epoch: 13, train_batch_id: 1400, avg_cost: 3.932274580001831
grad_norm: 2.228696059925004, clipped: 1.0
epoch: 13, train_batch_id: 1450, avg_cost: 3.9261763095855713
grad_norm: 2.2724023423421187, clipped: 1.0
epoch: 13, train_batch_id: 1500, avg_cost: 3.934513807296753
grad_norm: 3.4931447252687935, clipped: 1.0
epoch: 13, train_batch_id: 1550, avg_cost: 3.9424796104431152
grad_norm: 2.7787957227842517, clipped: 1.0
epoch: 13, train_batch_id: 1600, avg_cost: 3.929272174835205
grad_norm: 2.835964981830849, clipped: 1.0
epoch: 13, train_batch_id: 1650, avg_cost: 3.916961669921875
grad_norm: 3.050358671940875, clipped: 1.0
epoch: 13, train_batch_id: 1700, avg_cost: 3.907050609588623
grad_norm: 3.0474627586454277, clipped: 1.0
epoch: 13, train_batch_id: 1750, avg_cost: 3.915937900543213
grad_norm: 2.9900421156381074, clipped: 1.0
epoch: 13, train_batch_id: 1800, avg_cost: 3.931382656097412
grad_norm: 3.1485418504797567, clipped: 1.0
epoch: 13, train_batch_id: 1850, avg_cost: 3.9286093711853027
grad_norm: 2.4100046751150987, clipped: 1.0
epoch: 13, train_batch_id: 1900, avg_cost: 3.9169516563415527
grad_norm: 2.895501563771258, clipped: 1.0
epoch: 13, train_batch_id: 1950, avg_cost: 3.9363934993743896
grad_norm: 3.217944770792464, clipped: 1.0
epoch: 13, train_batch_id: 2000, avg_cost: 3.9341323375701904
grad_norm: 2.899170445985554, clipped: 1.0
epoch: 13, train_batch_id: 2050, avg_cost: 3.9416096210479736
grad_norm: 2.532195032215569, clipped: 1.0
epoch: 13, train_batch_id: 2100, avg_cost: 3.8927128314971924
grad_norm: 2.92441438958175, clipped: 1.0
epoch: 13, train_batch_id: 2150, avg_cost: 3.9374706745147705
grad_norm: 2.512753835699646, clipped: 1.0
epoch: 13, train_batch_id: 2200, avg_cost: 3.93418025970459
grad_norm: 3.0172792775191026, clipped: 1.0
epoch: 13, train_batch_id: 2250, avg_cost: 3.9274744987487793
grad_norm: 3.3278945581411015, clipped: 1.0
epoch: 13, train_batch_id: 2300, avg_cost: 3.9324159622192383
grad_norm: 2.8493251950891683, clipped: 1.0
epoch: 13, train_batch_id: 2350, avg_cost: 3.9156618118286133
grad_norm: 2.8368784915170018, clipped: 1.0
epoch: 13, train_batch_id: 2400, avg_cost: 3.917989730834961
grad_norm: 2.8650711951104064, clipped: 1.0
epoch: 13, train_batch_id: 2450, avg_cost: 3.9131665229797363
grad_norm: 2.3683026619788343, clipped: 1.0
Finished epoch 13, took 00:09:17 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.570402145385742 +- 0.004909266717731953
Evaluating candidate model on evaluation dataset
Epoch 13 candidate mean 4.568195343017578, baseline epoch 10 mean 4.355447769165039, difference 0.21274757385253906
Start train epoch 14, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


epoch: 14, train_batch_id: 0, avg_cost: 3.9303009510040283
grad_norm: 2.3839017024161238, clipped: 1.0
epoch: 14, train_batch_id: 50, avg_cost: 3.912729501724243
grad_norm: 2.1230396210729694, clipped: 1.0
epoch: 14, train_batch_id: 100, avg_cost: 3.922351837158203
grad_norm: 3.0011878129216365, clipped: 1.0
epoch: 14, train_batch_id: 150, avg_cost: 3.9365899562835693
grad_norm: 3.2623671626271045, clipped: 1.0
epoch: 14, train_batch_id: 200, avg_cost: 3.9085404872894287
grad_norm: 4.387147528816936, clipped: 1.0
epoch: 14, train_batch_id: 250, avg_cost: 3.8945348262786865
grad_norm: 2.52981369193751, clipped: 1.0
epoch: 14, train_batch_id: 300, avg_cost: 3.9022459983825684
grad_norm: 4.505055642679445, clipped: 1.0
epoch: 14, train_batch_id: 350, avg_cost: 3.936903238296509
grad_norm: 2.3450559649132097, clipped: 1.0
epoch: 14, train_batch_id: 400, avg_cost: 3.9244823455810547
grad_norm: 2.7408604895491835, clipped: 1.0
epoch: 14, train_batch_id: 450, avg_cost: 3.9226646423339844
grad_norm: 3.432413323528691, clipped: 1.0
epoch: 14, train_batch_id: 500, avg_cost: 3.907013416290283
grad_norm: 2.0083177672134194, clipped: 1.0
epoch: 14, train_batch_id: 550, avg_cost: 3.9395673274993896
grad_norm: 4.211555118391913, clipped: 1.0
epoch: 14, train_batch_id: 600, avg_cost: 3.9458632469177246
grad_norm: 3.5705299187502577, clipped: 1.0
epoch: 14, train_batch_id: 650, avg_cost: 3.9371449947357178
grad_norm: 3.054729840669282, clipped: 1.0
epoch: 14, train_batch_id: 700, avg_cost: 3.931396007537842
grad_norm: 2.2658332603815725, clipped: 1.0
epoch: 14, train_batch_id: 750, avg_cost: 3.9342281818389893
grad_norm: 2.8309922966065977, clipped: 1.0
epoch: 14, train_batch_id: 800, avg_cost: 3.94164776802063
grad_norm: 2.698859535179644, clipped: 1.0
epoch: 14, train_batch_id: 850, avg_cost: 3.924100399017334
grad_norm: 2.83929318727397, clipped: 1.0
epoch: 14, train_batch_id: 900, avg_cost: 3.9454965591430664
grad_norm: 3.049045024240376, clipped: 1.0
epoch: 14, train_batch_id: 950, avg_cost: 3.941311836242676
grad_norm: 2.889362598389219, clipped: 1.0
epoch: 14, train_batch_id: 1000, avg_cost: 3.9314653873443604
grad_norm: 2.5413547806088945, clipped: 1.0
epoch: 14, train_batch_id: 1050, avg_cost: 3.9220175743103027
grad_norm: 4.007493874590023, clipped: 1.0
epoch: 14, train_batch_id: 1100, avg_cost: 3.9466471672058105
grad_norm: 4.271279847105099, clipped: 1.0
epoch: 14, train_batch_id: 1150, avg_cost: 3.9523937702178955
grad_norm: 2.751992311481531, clipped: 1.0
epoch: 14, train_batch_id: 1200, avg_cost: 3.938303232192993
grad_norm: 4.121023687089194, clipped: 1.0
epoch: 14, train_batch_id: 1250, avg_cost: 3.933541774749756
grad_norm: 2.700115224748543, clipped: 1.0
epoch: 14, train_batch_id: 1300, avg_cost: 3.9130735397338867
grad_norm: 3.9372001608019755, clipped: 1.0
epoch: 14, train_batch_id: 1350, avg_cost: 3.9339537620544434
grad_norm: 2.2335550523981693, clipped: 1.0
epoch: 14, train_batch_id: 1400, avg_cost: 3.9225759506225586
grad_norm: 2.7321193772233556, clipped: 1.0
epoch: 14, train_batch_id: 1450, avg_cost: 3.932157516479492
grad_norm: 5.098164787126638, clipped: 1.0
epoch: 14, train_batch_id: 1500, avg_cost: 3.9327821731567383
grad_norm: 2.8306291407711814, clipped: 1.0
epoch: 14, train_batch_id: 1550, avg_cost: 3.9393157958984375
grad_norm: 3.4329769863403796, clipped: 1.0
epoch: 14, train_batch_id: 1600, avg_cost: 3.9087371826171875
grad_norm: 3.1820337502163616, clipped: 1.0
epoch: 14, train_batch_id: 1650, avg_cost: 3.9384727478027344
grad_norm: 3.17376102083798, clipped: 1.0
epoch: 14, train_batch_id: 1700, avg_cost: 3.9001147747039795
grad_norm: 4.037949014198397, clipped: 1.0
epoch: 14, train_batch_id: 1750, avg_cost: 3.919020891189575
grad_norm: 3.1902955386885092, clipped: 1.0
epoch: 14, train_batch_id: 1800, avg_cost: 3.9473836421966553
grad_norm: 2.7446424795838036, clipped: 1.0
epoch: 14, train_batch_id: 1850, avg_cost: 3.9276950359344482
grad_norm: 4.177820810047745, clipped: 1.0
epoch: 14, train_batch_id: 1900, avg_cost: 3.9440314769744873
grad_norm: 3.0981169163926703, clipped: 1.0
epoch: 14, train_batch_id: 1950, avg_cost: 3.9458892345428467
grad_norm: 4.053090062968592, clipped: 1.0
epoch: 14, train_batch_id: 2000, avg_cost: 3.914670467376709
grad_norm: 2.827178341046865, clipped: 1.0
epoch: 14, train_batch_id: 2050, avg_cost: 3.9134249687194824
grad_norm: 3.845779653033253, clipped: 1.0
epoch: 14, train_batch_id: 2100, avg_cost: 3.9227418899536133
grad_norm: 2.679270756921982, clipped: 1.0
epoch: 14, train_batch_id: 2150, avg_cost: 3.9204487800598145
grad_norm: 2.038666724682773, clipped: 1.0
epoch: 14, train_batch_id: 2200, avg_cost: 3.905518054962158
grad_norm: 3.3851483703960046, clipped: 1.0
epoch: 14, train_batch_id: 2250, avg_cost: 3.951611280441284
grad_norm: 3.270879306132318, clipped: 1.0
epoch: 14, train_batch_id: 2300, avg_cost: 3.900918960571289
grad_norm: 2.3555578471559655, clipped: 1.0
epoch: 14, train_batch_id: 2350, avg_cost: 3.927088737487793
grad_norm: 3.028336956306462, clipped: 1.0
epoch: 14, train_batch_id: 2400, avg_cost: 3.9264931678771973
grad_norm: 3.328146428597578, clipped: 1.0
epoch: 14, train_batch_id: 2450, avg_cost: 3.9398183822631836
grad_norm: 2.392804603543318, clipped: 1.0
Finished epoch 14, took 00:09:17 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.470930099487305 +- 0.004750794265419245
Evaluating candidate model on evaluation dataset
Epoch 14 candidate mean 4.469822406768799, baseline epoch 10 mean 4.355447769165039, difference 0.11437463760375977
Start train epoch 15, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 15, train_batch_id: 0, avg_cost: 3.9165854454040527
grad_norm: 3.0170927581737823, clipped: 1.0
epoch: 15, train_batch_id: 50, avg_cost: 3.906304359436035
grad_norm: 4.741971232138407, clipped: 1.0
epoch: 15, train_batch_id: 100, avg_cost: 3.924785614013672
grad_norm: 3.018770425032534, clipped: 1.0
epoch: 15, train_batch_id: 150, avg_cost: 3.9586687088012695
grad_norm: 2.738480540473092, clipped: 1.0
epoch: 15, train_batch_id: 200, avg_cost: 3.9395813941955566
grad_norm: 2.7480492515402184, clipped: 1.0
epoch: 15, train_batch_id: 250, avg_cost: 3.926175117492676
grad_norm: 6.2403622751161665, clipped: 1.0
epoch: 15, train_batch_id: 300, avg_cost: 3.9045374393463135
grad_norm: 2.436193832000336, clipped: 1.0
epoch: 15, train_batch_id: 350, avg_cost: 3.9108457565307617
grad_norm: 3.4219278407360867, clipped: 1.0
epoch: 15, train_batch_id: 400, avg_cost: 3.9182145595550537
grad_norm: 2.5357301852497423, clipped: 1.0
epoch: 15, train_batch_id: 450, avg_cost: 3.9084348678588867
grad_norm: 2.7884732510292145, clipped: 1.0
epoch: 15, train_batch_id: 500, avg_cost: 3.941446304321289
grad_norm: 3.453421602121186, clipped: 1.0
epoch: 15, train_batch_id: 550, avg_cost: 3.919701099395752
grad_norm: 2.4916548921131683, clipped: 1.0
epoch: 15, train_batch_id: 600, avg_cost: 3.912942409515381
grad_norm: 3.084101411685756, clipped: 1.0
epoch: 15, train_batch_id: 650, avg_cost: 3.9177167415618896
grad_norm: 2.8132298072758135, clipped: 1.0
epoch: 15, train_batch_id: 700, avg_cost: 3.967278242111206
grad_norm: 2.9509901667063114, clipped: 1.0
epoch: 15, train_batch_id: 750, avg_cost: 3.906312942504883
grad_norm: 3.222858465999957, clipped: 1.0
epoch: 15, train_batch_id: 800, avg_cost: 3.9618570804595947
grad_norm: 2.5789798104273896, clipped: 1.0
epoch: 15, train_batch_id: 850, avg_cost: 3.920668601989746
grad_norm: 3.2007018434744223, clipped: 1.0
epoch: 15, train_batch_id: 900, avg_cost: 3.922203302383423
grad_norm: 3.140204942651268, clipped: 1.0
epoch: 15, train_batch_id: 950, avg_cost: 3.9095101356506348
grad_norm: 3.673936548643397, clipped: 1.0
epoch: 15, train_batch_id: 1000, avg_cost: 3.9389567375183105
grad_norm: 3.036814545433662, clipped: 1.0
epoch: 15, train_batch_id: 1050, avg_cost: 3.9381885528564453
grad_norm: 2.7326859132719106, clipped: 1.0
epoch: 15, train_batch_id: 1100, avg_cost: 3.895016670227051
grad_norm: 3.580370744928069, clipped: 1.0
epoch: 15, train_batch_id: 1150, avg_cost: 3.9436986446380615
grad_norm: 4.333126371001289, clipped: 1.0
epoch: 15, train_batch_id: 1200, avg_cost: 3.928877592086792
grad_norm: 3.6540942396177782, clipped: 1.0
epoch: 15, train_batch_id: 1250, avg_cost: 3.9207305908203125
grad_norm: 2.9514091099956046, clipped: 1.0
epoch: 15, train_batch_id: 1300, avg_cost: 3.946681499481201
grad_norm: 2.3587386684591016, clipped: 1.0
epoch: 15, train_batch_id: 1350, avg_cost: 3.8972558975219727
grad_norm: 2.419642304282701, clipped: 1.0
epoch: 15, train_batch_id: 1400, avg_cost: 3.9209437370300293
grad_norm: 3.020161049197942, clipped: 1.0
epoch: 15, train_batch_id: 1450, avg_cost: 3.9279487133026123
grad_norm: 2.4574045113474723, clipped: 1.0
epoch: 15, train_batch_id: 1500, avg_cost: 3.961138963699341
grad_norm: 2.683634679593368, clipped: 1.0
epoch: 15, train_batch_id: 1550, avg_cost: 3.912966012954712
grad_norm: 2.4583648288686626, clipped: 1.0
epoch: 15, train_batch_id: 1600, avg_cost: 3.9324371814727783
grad_norm: 2.78360934635317, clipped: 1.0
epoch: 15, train_batch_id: 1650, avg_cost: 3.937720775604248
grad_norm: 3.0206984531921743, clipped: 1.0
epoch: 15, train_batch_id: 1700, avg_cost: 3.9323458671569824
grad_norm: 3.1919356002969854, clipped: 1.0
epoch: 15, train_batch_id: 1750, avg_cost: 3.9160852432250977
grad_norm: 2.100520226545998, clipped: 1.0
epoch: 15, train_batch_id: 1800, avg_cost: 3.9118824005126953
grad_norm: 2.5615797800429303, clipped: 1.0
epoch: 15, train_batch_id: 1850, avg_cost: 3.9610660076141357
grad_norm: 2.7570216370537364, clipped: 1.0
epoch: 15, train_batch_id: 1900, avg_cost: 3.923827886581421
grad_norm: 3.016301090426441, clipped: 1.0
epoch: 15, train_batch_id: 1950, avg_cost: 3.930464267730713
grad_norm: 2.784514874923891, clipped: 1.0
epoch: 15, train_batch_id: 2000, avg_cost: 3.907991409301758
grad_norm: 3.039823337722056, clipped: 1.0
epoch: 15, train_batch_id: 2050, avg_cost: 3.943908214569092
grad_norm: 3.978089373288827, clipped: 1.0
epoch: 15, train_batch_id: 2100, avg_cost: 3.937188148498535
grad_norm: 3.016844949817417, clipped: 1.0
epoch: 15, train_batch_id: 2150, avg_cost: 3.919667959213257
grad_norm: 4.615714959444877, clipped: 1.0
epoch: 15, train_batch_id: 2200, avg_cost: 3.948853015899658
grad_norm: 2.637444663200378, clipped: 1.0
epoch: 15, train_batch_id: 2250, avg_cost: 3.939042568206787
grad_norm: 2.4357860732064, clipped: 1.0
epoch: 15, train_batch_id: 2300, avg_cost: 3.918882131576538
grad_norm: 3.1756646151462564, clipped: 1.0
epoch: 15, train_batch_id: 2350, avg_cost: 3.9327750205993652
grad_norm: 2.2836285493969917, clipped: 1.0
epoch: 15, train_batch_id: 2400, avg_cost: 3.9334771633148193
grad_norm: 3.0461442759256134, clipped: 1.0
epoch: 15, train_batch_id: 2450, avg_cost: 3.948650598526001
grad_norm: 2.347193513299578, clipped: 1.0
Finished epoch 15, took 00:09:17 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.486039161682129 +- 0.00464442977681756
Evaluating candidate model on evaluation dataset
Epoch 15 candidate mean 4.481228351593018, baseline epoch 10 mean 4.355447769165039, difference 0.12578058242797852
Start train epoch 16, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 16, train_batch_id: 0, avg_cost: 3.917729139328003
grad_norm: 2.917389066060197, clipped: 1.0
epoch: 16, train_batch_id: 50, avg_cost: 3.913243293762207
grad_norm: 2.6102451298471685, clipped: 1.0
epoch: 16, train_batch_id: 100, avg_cost: 3.933026075363159
grad_norm: 2.7721895736712403, clipped: 1.0
epoch: 16, train_batch_id: 150, avg_cost: 3.9254045486450195
grad_norm: 3.0576660546221857, clipped: 1.0
epoch: 16, train_batch_id: 200, avg_cost: 3.8960976600646973
grad_norm: 2.1653150665967225, clipped: 1.0
epoch: 16, train_batch_id: 250, avg_cost: 3.928281307220459
grad_norm: 2.5278425190372693, clipped: 1.0
epoch: 16, train_batch_id: 300, avg_cost: 3.92257022857666
grad_norm: 2.882878800714318, clipped: 1.0
epoch: 16, train_batch_id: 350, avg_cost: 3.9125142097473145
grad_norm: 2.252354188063921, clipped: 1.0
epoch: 16, train_batch_id: 400, avg_cost: 3.931796073913574
grad_norm: 2.4016223366686362, clipped: 1.0
epoch: 16, train_batch_id: 450, avg_cost: 3.9166510105133057
grad_norm: 2.5881014768472586, clipped: 1.0
epoch: 16, train_batch_id: 500, avg_cost: 3.8977389335632324
grad_norm: 2.4912071397607454, clipped: 1.0
epoch: 16, train_batch_id: 550, avg_cost: 3.944413661956787
grad_norm: 3.2704111511037017, clipped: 1.0
epoch: 16, train_batch_id: 600, avg_cost: 3.902845859527588
grad_norm: 3.0979290116377753, clipped: 1.0
epoch: 16, train_batch_id: 650, avg_cost: 3.936544179916382
grad_norm: 2.830615197118688, clipped: 1.0
epoch: 16, train_batch_id: 700, avg_cost: 3.8954107761383057
grad_norm: 2.568000250463601, clipped: 1.0
epoch: 16, train_batch_id: 750, avg_cost: 3.9256908893585205
grad_norm: 2.568592705396949, clipped: 1.0
epoch: 16, train_batch_id: 800, avg_cost: 3.9067957401275635
grad_norm: 6.20842290504557, clipped: 1.0
epoch: 16, train_batch_id: 850, avg_cost: 3.9197700023651123
grad_norm: 3.268612193466795, clipped: 1.0
epoch: 16, train_batch_id: 900, avg_cost: 3.8986964225769043
grad_norm: 3.099010182218705, clipped: 1.0
epoch: 16, train_batch_id: 950, avg_cost: 3.932955503463745
grad_norm: 2.725303371149998, clipped: 1.0
epoch: 16, train_batch_id: 1000, avg_cost: 3.938072681427002
grad_norm: 2.7003189537604038, clipped: 1.0
epoch: 16, train_batch_id: 1050, avg_cost: 3.9241721630096436
grad_norm: 2.804510634204125, clipped: 1.0
epoch: 16, train_batch_id: 1100, avg_cost: 3.935328483581543
grad_norm: 2.4867895487042464, clipped: 1.0
epoch: 16, train_batch_id: 1150, avg_cost: 3.904973030090332
grad_norm: 2.1759482222720923, clipped: 1.0
epoch: 16, train_batch_id: 1200, avg_cost: 3.915294647216797
grad_norm: 3.5137968728370046, clipped: 1.0
epoch: 16, train_batch_id: 1250, avg_cost: 3.9327480792999268
grad_norm: 3.3193907260337894, clipped: 1.0
epoch: 16, train_batch_id: 1300, avg_cost: 3.901315450668335
grad_norm: 3.109326863324382, clipped: 1.0
epoch: 16, train_batch_id: 1350, avg_cost: 3.9233474731445312
grad_norm: 2.914210547868536, clipped: 1.0
epoch: 16, train_batch_id: 1400, avg_cost: 3.8984344005584717
grad_norm: 3.8490334014180103, clipped: 1.0
epoch: 16, train_batch_id: 1450, avg_cost: 3.9209399223327637
grad_norm: 2.311345359800179, clipped: 1.0
epoch: 16, train_batch_id: 1500, avg_cost: 3.9229049682617188
grad_norm: 3.5302354398655256, clipped: 1.0
epoch: 16, train_batch_id: 1550, avg_cost: 3.9027304649353027
grad_norm: 4.341924681059917, clipped: 1.0
epoch: 16, train_batch_id: 1600, avg_cost: 3.932356834411621
grad_norm: 2.5584812448525174, clipped: 1.0
epoch: 16, train_batch_id: 1650, avg_cost: 3.9143104553222656
grad_norm: 2.8568110845740393, clipped: 1.0
epoch: 16, train_batch_id: 1700, avg_cost: 3.9480206966400146
grad_norm: 2.9081239202791442, clipped: 1.0
epoch: 16, train_batch_id: 1750, avg_cost: 3.8964014053344727
grad_norm: 3.124291738658396, clipped: 1.0
epoch: 16, train_batch_id: 1800, avg_cost: 3.9372916221618652
grad_norm: 2.4708817336054727, clipped: 1.0
epoch: 16, train_batch_id: 1850, avg_cost: 3.912982225418091
grad_norm: 2.099238736684686, clipped: 1.0
epoch: 16, train_batch_id: 1900, avg_cost: 3.910892963409424
grad_norm: 3.222083065907836, clipped: 1.0
epoch: 16, train_batch_id: 1950, avg_cost: 3.910381317138672
grad_norm: 4.222382394808277, clipped: 1.0
epoch: 16, train_batch_id: 2000, avg_cost: 3.9191293716430664
grad_norm: 3.512890059566359, clipped: 1.0
epoch: 16, train_batch_id: 2050, avg_cost: 3.9322142601013184
grad_norm: 3.374221202583332, clipped: 1.0
epoch: 16, train_batch_id: 2100, avg_cost: 3.947812080383301
grad_norm: 3.8023036779138626, clipped: 1.0
epoch: 16, train_batch_id: 2150, avg_cost: 3.9465975761413574
grad_norm: 2.7453686733225213, clipped: 1.0
epoch: 16, train_batch_id: 2200, avg_cost: 3.917173147201538
grad_norm: 3.2391382411953904, clipped: 1.0
epoch: 16, train_batch_id: 2250, avg_cost: 3.927499771118164
grad_norm: 2.612644649533691, clipped: 1.0
epoch: 16, train_batch_id: 2300, avg_cost: 3.9345171451568604
grad_norm: 2.882110953902845, clipped: 1.0
epoch: 16, train_batch_id: 2350, avg_cost: 3.924950122833252
grad_norm: 3.6256751980939903, clipped: 1.0
epoch: 16, train_batch_id: 2400, avg_cost: 3.9316797256469727
grad_norm: 3.505329001884138, clipped: 1.0
epoch: 16, train_batch_id: 2450, avg_cost: 3.9207043647766113
grad_norm: 3.23904155693747, clipped: 1.0
Finished epoch 16, took 00:09:19 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.503058433532715 +- 0.004744993057101965
Evaluating candidate model on evaluation dataset
Epoch 16 candidate mean 4.501274585723877, baseline epoch 10 mean 4.355447769165039, difference 0.1458268165588379
Start train epoch 17, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 17, train_batch_id: 0, avg_cost: 3.920164108276367
grad_norm: 2.758583708822111, clipped: 1.0
epoch: 17, train_batch_id: 50, avg_cost: 3.8925352096557617
grad_norm: 4.274651033022628, clipped: 1.0
epoch: 17, train_batch_id: 100, avg_cost: 3.9170265197753906
grad_norm: 2.590665860615546, clipped: 1.0
epoch: 17, train_batch_id: 150, avg_cost: 3.921231269836426
grad_norm: 2.659889716583195, clipped: 1.0
epoch: 17, train_batch_id: 200, avg_cost: 3.925651788711548
grad_norm: 2.580317957604825, clipped: 1.0
epoch: 17, train_batch_id: 250, avg_cost: 3.930159568786621
grad_norm: 2.2645702698047834, clipped: 1.0
epoch: 17, train_batch_id: 300, avg_cost: 3.9286458492279053
grad_norm: 3.430159929825755, clipped: 1.0
epoch: 17, train_batch_id: 350, avg_cost: 3.909318685531616
grad_norm: 3.1498758197965557, clipped: 1.0
epoch: 17, train_batch_id: 400, avg_cost: 3.9207355976104736
grad_norm: 4.028194334624088, clipped: 1.0
epoch: 17, train_batch_id: 450, avg_cost: 3.9249348640441895
grad_norm: 2.8608217811911762, clipped: 1.0
epoch: 17, train_batch_id: 500, avg_cost: 3.9510316848754883
grad_norm: 2.8821535227462753, clipped: 1.0
epoch: 17, train_batch_id: 550, avg_cost: 3.9419641494750977
grad_norm: 2.842677759969499, clipped: 1.0
epoch: 17, train_batch_id: 600, avg_cost: 3.943779230117798
grad_norm: 3.150675914718518, clipped: 1.0
epoch: 17, train_batch_id: 650, avg_cost: 3.9103951454162598
grad_norm: 2.643049638152395, clipped: 1.0
epoch: 17, train_batch_id: 700, avg_cost: 3.946014881134033
grad_norm: 2.751275986712648, clipped: 1.0
epoch: 17, train_batch_id: 750, avg_cost: 3.920250415802002
grad_norm: 3.0012673339749742, clipped: 1.0
epoch: 17, train_batch_id: 800, avg_cost: 3.9131813049316406
grad_norm: 3.6697815475563926, clipped: 1.0
epoch: 17, train_batch_id: 850, avg_cost: 3.9254560470581055
grad_norm: 3.2566655953482644, clipped: 1.0
epoch: 17, train_batch_id: 900, avg_cost: 3.910417079925537
grad_norm: 3.5857516442487287, clipped: 1.0
epoch: 17, train_batch_id: 950, avg_cost: 3.9278135299682617
grad_norm: 3.8826076897723896, clipped: 1.0
epoch: 17, train_batch_id: 1000, avg_cost: 3.9135851860046387
grad_norm: 4.2739700609270646, clipped: 1.0
epoch: 17, train_batch_id: 1050, avg_cost: 3.9065585136413574
grad_norm: 2.317875990268345, clipped: 1.0
epoch: 17, train_batch_id: 1100, avg_cost: 3.920173168182373
grad_norm: 3.1613010911512434, clipped: 1.0
epoch: 17, train_batch_id: 1150, avg_cost: 3.896787166595459
grad_norm: 2.89580355058345, clipped: 1.0
epoch: 17, train_batch_id: 1200, avg_cost: 3.929067373275757
grad_norm: 2.991629941888223, clipped: 1.0
epoch: 17, train_batch_id: 1250, avg_cost: 3.922724723815918
grad_norm: 2.9192383709655116, clipped: 1.0
epoch: 17, train_batch_id: 1300, avg_cost: 3.91706919670105
grad_norm: 3.537331693697727, clipped: 1.0
epoch: 17, train_batch_id: 1350, avg_cost: 3.918076515197754
grad_norm: 2.3307372667654263, clipped: 1.0
epoch: 17, train_batch_id: 1400, avg_cost: 3.9313926696777344
grad_norm: 3.0162946369648926, clipped: 1.0
epoch: 17, train_batch_id: 1450, avg_cost: 3.8990416526794434
grad_norm: 4.194468604408586, clipped: 1.0
epoch: 17, train_batch_id: 1500, avg_cost: 3.9279465675354004
grad_norm: 3.4971951589998995, clipped: 1.0
epoch: 17, train_batch_id: 1550, avg_cost: 3.93790864944458
grad_norm: 3.8567926162800297, clipped: 1.0
epoch: 17, train_batch_id: 1600, avg_cost: 3.9186904430389404
grad_norm: 3.2038079752550543, clipped: 1.0
epoch: 17, train_batch_id: 1650, avg_cost: 3.924342393875122
grad_norm: 4.345174588829249, clipped: 1.0
epoch: 17, train_batch_id: 1700, avg_cost: 3.922741413116455
grad_norm: 3.005765061241062, clipped: 1.0
epoch: 17, train_batch_id: 1750, avg_cost: 3.934116840362549
grad_norm: 3.081755868648841, clipped: 1.0
epoch: 17, train_batch_id: 1800, avg_cost: 3.928443670272827
grad_norm: 6.3964005369057855, clipped: 1.0
epoch: 17, train_batch_id: 1850, avg_cost: 3.9425387382507324
grad_norm: 3.751161637085617, clipped: 1.0
epoch: 17, train_batch_id: 1900, avg_cost: 3.897801399230957
grad_norm: 3.9377167605828522, clipped: 1.0
epoch: 17, train_batch_id: 1950, avg_cost: 3.9053561687469482
grad_norm: 3.2009477943006015, clipped: 1.0
epoch: 17, train_batch_id: 2000, avg_cost: 3.9420175552368164
grad_norm: 3.733073034015598, clipped: 1.0
epoch: 17, train_batch_id: 2050, avg_cost: 3.910780906677246
grad_norm: 2.5798974864051716, clipped: 1.0
epoch: 17, train_batch_id: 2100, avg_cost: 3.9231514930725098
grad_norm: 2.5577628471680067, clipped: 1.0
epoch: 17, train_batch_id: 2150, avg_cost: 3.917996644973755
grad_norm: 3.018011929797948, clipped: 1.0
epoch: 17, train_batch_id: 2200, avg_cost: 3.9130210876464844
grad_norm: 3.416620331119428, clipped: 1.0
epoch: 17, train_batch_id: 2250, avg_cost: 3.919644355773926
grad_norm: 2.475237321857546, clipped: 1.0
epoch: 17, train_batch_id: 2300, avg_cost: 3.9099063873291016
grad_norm: 2.935190134074297, clipped: 1.0
epoch: 17, train_batch_id: 2350, avg_cost: 3.9229350090026855
grad_norm: 3.4187492465418767, clipped: 1.0
epoch: 17, train_batch_id: 2400, avg_cost: 3.9053077697753906
grad_norm: 2.334171493304594, clipped: 1.0
epoch: 17, train_batch_id: 2450, avg_cost: 3.910404682159424
grad_norm: 3.677335062761947, clipped: 1.0
Finished epoch 17, took 00:09:23 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.408029556274414 +- 0.004445511847734451
Evaluating candidate model on evaluation dataset
Epoch 17 candidate mean 4.407614231109619, baseline epoch 10 mean 4.355447769165039, difference 0.05216646194458008
Start train epoch 18, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 18, train_batch_id: 0, avg_cost: 3.9332008361816406
grad_norm: 4.850500717048621, clipped: 1.0
epoch: 18, train_batch_id: 50, avg_cost: 3.9442861080169678
grad_norm: 3.7569454649856917, clipped: 1.0
epoch: 18, train_batch_id: 100, avg_cost: 3.877042770385742
grad_norm: 2.1470485889684405, clipped: 1.0
epoch: 18, train_batch_id: 150, avg_cost: 3.923464298248291
grad_norm: 2.571633422702904, clipped: 1.0
epoch: 18, train_batch_id: 200, avg_cost: 3.9202136993408203
grad_norm: 3.581230263688377, clipped: 1.0
epoch: 18, train_batch_id: 250, avg_cost: 3.922672986984253
grad_norm: 2.9350547525025252, clipped: 1.0
epoch: 18, train_batch_id: 300, avg_cost: 3.907921314239502
grad_norm: 2.4063226675552736, clipped: 1.0
epoch: 18, train_batch_id: 350, avg_cost: 3.912494659423828
grad_norm: 4.63838073178312, clipped: 1.0
epoch: 18, train_batch_id: 400, avg_cost: 3.9160332679748535
grad_norm: 4.085920431215921, clipped: 1.0
epoch: 18, train_batch_id: 450, avg_cost: 3.9362261295318604
grad_norm: 2.8641768816197453, clipped: 1.0
epoch: 18, train_batch_id: 500, avg_cost: 3.9161930084228516
grad_norm: 2.637229957893168, clipped: 1.0
epoch: 18, train_batch_id: 550, avg_cost: 3.910653591156006
grad_norm: 3.7384547747796963, clipped: 1.0
epoch: 18, train_batch_id: 600, avg_cost: 3.9040884971618652
grad_norm: 2.945428588360782, clipped: 1.0
epoch: 18, train_batch_id: 650, avg_cost: 3.930290460586548
grad_norm: 3.3117877155704845, clipped: 1.0
epoch: 18, train_batch_id: 700, avg_cost: 3.9184091091156006
grad_norm: 2.560299263791945, clipped: 1.0
epoch: 18, train_batch_id: 750, avg_cost: 3.908987522125244
grad_norm: 3.127045805982974, clipped: 1.0
epoch: 18, train_batch_id: 800, avg_cost: 3.892256021499634
grad_norm: 3.6596716967550176, clipped: 1.0
epoch: 18, train_batch_id: 850, avg_cost: 3.9251983165740967
grad_norm: 2.5739730349497836, clipped: 1.0
epoch: 18, train_batch_id: 900, avg_cost: 3.911375045776367
grad_norm: 2.048158808780935, clipped: 1.0
epoch: 18, train_batch_id: 950, avg_cost: 3.8993706703186035
grad_norm: 3.4826188141406185, clipped: 1.0
epoch: 18, train_batch_id: 1000, avg_cost: 3.889817953109741
grad_norm: 3.093394537975797, clipped: 1.0
epoch: 18, train_batch_id: 1050, avg_cost: 3.928342342376709
grad_norm: 3.0119254696776903, clipped: 1.0
epoch: 18, train_batch_id: 1100, avg_cost: 3.9130420684814453
grad_norm: 2.562716468181686, clipped: 1.0
epoch: 18, train_batch_id: 1150, avg_cost: 3.909912109375
grad_norm: 3.1467372711163732, clipped: 1.0
epoch: 18, train_batch_id: 1200, avg_cost: 3.901632785797119
grad_norm: 4.484070800187324, clipped: 1.0
epoch: 18, train_batch_id: 1250, avg_cost: 3.885958671569824
grad_norm: 3.500052540153344, clipped: 1.0
epoch: 18, train_batch_id: 1300, avg_cost: 3.9448845386505127
grad_norm: 2.988281619826083, clipped: 1.0
epoch: 18, train_batch_id: 1350, avg_cost: 3.9213106632232666
grad_norm: 3.0518135630908327, clipped: 1.0
epoch: 18, train_batch_id: 1400, avg_cost: 3.914045810699463
grad_norm: 2.9036775949526343, clipped: 1.0
epoch: 18, train_batch_id: 1450, avg_cost: 3.9064481258392334
grad_norm: 2.5509385959936544, clipped: 1.0
epoch: 18, train_batch_id: 1500, avg_cost: 3.8848490715026855
grad_norm: 2.6772432179111423, clipped: 1.0
epoch: 18, train_batch_id: 1550, avg_cost: 3.880303382873535
grad_norm: 2.4216955237158135, clipped: 1.0
epoch: 18, train_batch_id: 1600, avg_cost: 3.9238383769989014
grad_norm: 3.101646580987767, clipped: 1.0
epoch: 18, train_batch_id: 1650, avg_cost: 3.9036645889282227
grad_norm: 2.8677901595274635, clipped: 1.0
epoch: 18, train_batch_id: 1700, avg_cost: 3.9122328758239746
grad_norm: 2.715828311512166, clipped: 1.0
epoch: 18, train_batch_id: 1750, avg_cost: 3.9133572578430176
grad_norm: 3.1085992730831653, clipped: 1.0
epoch: 18, train_batch_id: 1800, avg_cost: 3.906123161315918
grad_norm: 2.966967143299749, clipped: 1.0
epoch: 18, train_batch_id: 1850, avg_cost: 3.9109103679656982
grad_norm: 3.2289239849855167, clipped: 1.0
epoch: 18, train_batch_id: 1900, avg_cost: 3.9281997680664062
grad_norm: 2.9454183830134175, clipped: 1.0
epoch: 18, train_batch_id: 1950, avg_cost: 3.892387866973877
grad_norm: 2.8570125308348597, clipped: 1.0
epoch: 18, train_batch_id: 2000, avg_cost: 3.9268579483032227
grad_norm: 1.9547743583845383, clipped: 1.0
epoch: 18, train_batch_id: 2050, avg_cost: 3.904374122619629
grad_norm: 2.794839952888918, clipped: 1.0
epoch: 18, train_batch_id: 2100, avg_cost: 3.9366116523742676
grad_norm: 3.041245516276505, clipped: 1.0
epoch: 18, train_batch_id: 2150, avg_cost: 3.9522995948791504
grad_norm: 2.8000334746241546, clipped: 1.0
epoch: 18, train_batch_id: 2200, avg_cost: 3.910496711730957
grad_norm: 2.8526560697763403, clipped: 1.0
epoch: 18, train_batch_id: 2250, avg_cost: 3.914295196533203
grad_norm: 3.139363781910747, clipped: 1.0
epoch: 18, train_batch_id: 2300, avg_cost: 3.950685977935791
grad_norm: 2.4138663547439108, clipped: 1.0
epoch: 18, train_batch_id: 2350, avg_cost: 3.914564609527588
grad_norm: 3.779269130645266, clipped: 1.0
epoch: 18, train_batch_id: 2400, avg_cost: 3.9287772178649902
grad_norm: 2.3569499094805466, clipped: 1.0
epoch: 18, train_batch_id: 2450, avg_cost: 3.9262869358062744
grad_norm: 2.7974427489296065, clipped: 1.0
Finished epoch 18, took 00:09:22 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.427281856536865 +- 0.004277453757822514
Evaluating candidate model on evaluation dataset
Epoch 18 candidate mean 4.424264907836914, baseline epoch 10 mean 4.355447769165039, difference 0.068817138671875
Start train epoch 19, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 19, train_batch_id: 0, avg_cost: 3.9383513927459717
grad_norm: 3.7185104231823485, clipped: 1.0
epoch: 19, train_batch_id: 50, avg_cost: 3.9170196056365967
grad_norm: 3.348261256479626, clipped: 1.0
epoch: 19, train_batch_id: 100, avg_cost: 3.923508644104004
grad_norm: 3.239362486706808, clipped: 1.0
epoch: 19, train_batch_id: 150, avg_cost: 3.926028251647949
grad_norm: 2.332360298793866, clipped: 1.0
epoch: 19, train_batch_id: 200, avg_cost: 3.9157919883728027
grad_norm: 3.0501200612658415, clipped: 1.0
epoch: 19, train_batch_id: 250, avg_cost: 3.8885271549224854
grad_norm: 3.2663500549880915, clipped: 1.0
epoch: 19, train_batch_id: 300, avg_cost: 3.9308948516845703
grad_norm: 4.019025153234319, clipped: 1.0
epoch: 19, train_batch_id: 350, avg_cost: 3.902979850769043
grad_norm: 2.766131290310727, clipped: 1.0
epoch: 19, train_batch_id: 400, avg_cost: 3.9079833030700684
grad_norm: 3.4095154214643295, clipped: 1.0
epoch: 19, train_batch_id: 450, avg_cost: 3.917250156402588
grad_norm: 3.4320900133791734, clipped: 1.0
epoch: 19, train_batch_id: 500, avg_cost: 3.9215641021728516
grad_norm: 3.0245577437419047, clipped: 1.0
epoch: 19, train_batch_id: 550, avg_cost: 3.929966688156128
grad_norm: 3.7740268316870016, clipped: 1.0
epoch: 19, train_batch_id: 600, avg_cost: 3.89788818359375
grad_norm: 3.220305167745675, clipped: 1.0
epoch: 19, train_batch_id: 650, avg_cost: 3.9264485836029053
grad_norm: 2.7565732445837225, clipped: 1.0
epoch: 19, train_batch_id: 700, avg_cost: 3.9114089012145996
grad_norm: 3.9158605945157925, clipped: 1.0
epoch: 19, train_batch_id: 750, avg_cost: 3.914220094680786
grad_norm: 4.051974832050124, clipped: 1.0
epoch: 19, train_batch_id: 800, avg_cost: 3.900271415710449
grad_norm: 4.085187237614179, clipped: 1.0
epoch: 19, train_batch_id: 850, avg_cost: 3.9366068840026855
grad_norm: 5.032905624988405, clipped: 1.0
epoch: 19, train_batch_id: 900, avg_cost: 3.911703109741211
grad_norm: 2.9711976480886437, clipped: 1.0
epoch: 19, train_batch_id: 950, avg_cost: 3.9229025840759277
grad_norm: 4.1126024584464815, clipped: 1.0
epoch: 19, train_batch_id: 1000, avg_cost: 3.9187045097351074
grad_norm: 2.732180694701344, clipped: 1.0
epoch: 19, train_batch_id: 1050, avg_cost: 3.9116902351379395
grad_norm: 3.3662574509961782, clipped: 1.0
epoch: 19, train_batch_id: 1100, avg_cost: 3.948359966278076
grad_norm: 2.2145317350520086, clipped: 1.0
epoch: 19, train_batch_id: 1150, avg_cost: 3.9346415996551514
grad_norm: 3.0892636439344883, clipped: 1.0
epoch: 19, train_batch_id: 1200, avg_cost: 3.8967771530151367
grad_norm: 3.6764478385582033, clipped: 1.0
epoch: 19, train_batch_id: 1250, avg_cost: 3.918355941772461
grad_norm: 2.770352506027888, clipped: 1.0
epoch: 19, train_batch_id: 1300, avg_cost: 3.933547019958496
grad_norm: 3.343287220433607, clipped: 1.0
epoch: 19, train_batch_id: 1350, avg_cost: 3.8897523880004883
grad_norm: 2.791395217416051, clipped: 1.0
epoch: 19, train_batch_id: 1400, avg_cost: 3.9018473625183105
grad_norm: 2.8931044936023946, clipped: 1.0
epoch: 19, train_batch_id: 1450, avg_cost: 3.92830491065979
grad_norm: 2.764387732576078, clipped: 1.0
epoch: 19, train_batch_id: 1500, avg_cost: 3.9103660583496094
grad_norm: 2.443363316564888, clipped: 1.0
epoch: 19, train_batch_id: 1550, avg_cost: 3.9309656620025635
grad_norm: 3.546452644084786, clipped: 1.0
epoch: 19, train_batch_id: 1600, avg_cost: 3.9108290672302246
grad_norm: 2.7133130544196895, clipped: 1.0
epoch: 19, train_batch_id: 1650, avg_cost: 3.9105780124664307
grad_norm: 4.248254443588543, clipped: 1.0
epoch: 19, train_batch_id: 1700, avg_cost: 3.9151809215545654
grad_norm: 4.237679308792069, clipped: 1.0
epoch: 19, train_batch_id: 1750, avg_cost: 3.8920705318450928
grad_norm: 3.5802989996797914, clipped: 1.0
epoch: 19, train_batch_id: 1800, avg_cost: 3.9090991020202637
grad_norm: 2.242227360910346, clipped: 1.0
epoch: 19, train_batch_id: 1850, avg_cost: 3.9099857807159424
grad_norm: 2.7401764485381417, clipped: 1.0
epoch: 19, train_batch_id: 1900, avg_cost: 3.9179744720458984
grad_norm: 2.735405580993409, clipped: 1.0
epoch: 19, train_batch_id: 1950, avg_cost: 3.920788526535034
grad_norm: 2.8578286609384214, clipped: 1.0
epoch: 19, train_batch_id: 2000, avg_cost: 3.908562183380127
grad_norm: 2.5846269444105774, clipped: 1.0
epoch: 19, train_batch_id: 2050, avg_cost: 3.9153518676757812
grad_norm: 4.174505114020218, clipped: 1.0
epoch: 19, train_batch_id: 2100, avg_cost: 3.8978943824768066
grad_norm: 3.0027551527006384, clipped: 1.0
epoch: 19, train_batch_id: 2150, avg_cost: 3.913055181503296
grad_norm: 3.4621079888769297, clipped: 1.0
epoch: 19, train_batch_id: 2200, avg_cost: 3.898782253265381
grad_norm: 3.5585611737292977, clipped: 1.0
epoch: 19, train_batch_id: 2250, avg_cost: 3.911339282989502
grad_norm: 3.0102878019417543, clipped: 1.0
epoch: 19, train_batch_id: 2300, avg_cost: 3.9052343368530273
grad_norm: 2.3300683296010467, clipped: 1.0
epoch: 19, train_batch_id: 2350, avg_cost: 3.9202446937561035
grad_norm: 1.9890099579347365, clipped: 1.0
epoch: 19, train_batch_id: 2400, avg_cost: 3.936861038208008
grad_norm: 3.1730340965443107, clipped: 1.0
epoch: 19, train_batch_id: 2450, avg_cost: 3.9080166816711426
grad_norm: 3.2855319590510343, clipped: 1.0
Finished epoch 19, took 00:09:25 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.4837775230407715 +- 0.0045104422606527805
Evaluating candidate model on evaluation dataset
Epoch 19 candidate mean 4.481848239898682, baseline epoch 10 mean 4.355447769165039, difference 0.12640047073364258
Start train epoch 20, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 20, train_batch_id: 0, avg_cost: 3.9133291244506836
grad_norm: 3.425725237391876, clipped: 1.0
epoch: 20, train_batch_id: 50, avg_cost: 3.8977227210998535
grad_norm: 2.786624075606069, clipped: 1.0
epoch: 20, train_batch_id: 100, avg_cost: 3.8653435707092285
grad_norm: 3.5717233739353644, clipped: 1.0
epoch: 20, train_batch_id: 150, avg_cost: 3.9121692180633545
grad_norm: 2.03047582536041, clipped: 1.0
epoch: 20, train_batch_id: 200, avg_cost: 3.9191129207611084
grad_norm: 2.869467211995118, clipped: 1.0
epoch: 20, train_batch_id: 250, avg_cost: 3.9249539375305176
grad_norm: 4.508703221897473, clipped: 1.0
epoch: 20, train_batch_id: 300, avg_cost: 3.8937201499938965
grad_norm: 4.812073379850031, clipped: 1.0
epoch: 20, train_batch_id: 350, avg_cost: 3.9349968433380127
grad_norm: 2.319833569339409, clipped: 1.0
epoch: 20, train_batch_id: 400, avg_cost: 3.9199349880218506
grad_norm: 2.6730308819948023, clipped: 1.0
epoch: 20, train_batch_id: 450, avg_cost: 3.9443321228027344
grad_norm: 2.7371925751587316, clipped: 1.0
epoch: 20, train_batch_id: 500, avg_cost: 3.895237445831299
grad_norm: 3.0187477175388087, clipped: 1.0
epoch: 20, train_batch_id: 550, avg_cost: 3.913905143737793
grad_norm: 3.359237713138411, clipped: 1.0
epoch: 20, train_batch_id: 600, avg_cost: 3.9133448600769043
grad_norm: 2.816285974784914, clipped: 1.0
epoch: 20, train_batch_id: 650, avg_cost: 3.9328222274780273
grad_norm: 3.3972083037805967, clipped: 1.0
epoch: 20, train_batch_id: 700, avg_cost: 3.919844627380371
grad_norm: 3.8283334316735673, clipped: 1.0
epoch: 20, train_batch_id: 750, avg_cost: 3.921046733856201
grad_norm: 3.1473535090692177, clipped: 1.0
epoch: 20, train_batch_id: 800, avg_cost: 3.9152932167053223
grad_norm: 2.8854866069035325, clipped: 1.0
epoch: 20, train_batch_id: 850, avg_cost: 3.9175832271575928
grad_norm: 2.649055456411203, clipped: 1.0
epoch: 20, train_batch_id: 900, avg_cost: 3.941394567489624
grad_norm: 2.645412356103306, clipped: 1.0
epoch: 20, train_batch_id: 950, avg_cost: 3.940314769744873
grad_norm: 2.9119547939960437, clipped: 1.0
epoch: 20, train_batch_id: 1000, avg_cost: 3.932981014251709
grad_norm: 2.6908221412081614, clipped: 1.0
epoch: 20, train_batch_id: 1050, avg_cost: 3.8981480598449707
grad_norm: 3.3485996171052075, clipped: 1.0
epoch: 20, train_batch_id: 1100, avg_cost: 3.916903257369995
grad_norm: 2.774144265302566, clipped: 1.0
epoch: 20, train_batch_id: 1150, avg_cost: 3.9208593368530273
grad_norm: 3.251236180639867, clipped: 1.0
epoch: 20, train_batch_id: 1200, avg_cost: 3.9152462482452393
grad_norm: 2.720788423042494, clipped: 1.0
epoch: 20, train_batch_id: 1250, avg_cost: 3.923760414123535
grad_norm: 3.338417148438483, clipped: 1.0
epoch: 20, train_batch_id: 1300, avg_cost: 3.9158082008361816
grad_norm: 2.3643589312057944, clipped: 1.0
epoch: 20, train_batch_id: 1350, avg_cost: 3.909698963165283
grad_norm: 3.498252746677449, clipped: 1.0
epoch: 20, train_batch_id: 1400, avg_cost: 3.9219894409179688
grad_norm: 2.485225462329219, clipped: 1.0
epoch: 20, train_batch_id: 1450, avg_cost: 3.912114143371582
grad_norm: 3.332912081144247, clipped: 1.0
epoch: 20, train_batch_id: 1500, avg_cost: 3.903494358062744
grad_norm: 3.4614404035669937, clipped: 1.0
epoch: 20, train_batch_id: 1550, avg_cost: 3.892334461212158
grad_norm: 3.2693460142939417, clipped: 1.0
epoch: 20, train_batch_id: 1600, avg_cost: 3.909914970397949
grad_norm: 2.9624967669608164, clipped: 1.0
epoch: 20, train_batch_id: 1650, avg_cost: 3.9074792861938477
grad_norm: 2.1141475099615277, clipped: 1.0
epoch: 20, train_batch_id: 1700, avg_cost: 3.8975837230682373
grad_norm: 3.072053594636056, clipped: 1.0
epoch: 20, train_batch_id: 1750, avg_cost: 3.888972520828247
grad_norm: 3.5260443991796224, clipped: 1.0
epoch: 20, train_batch_id: 1800, avg_cost: 3.8969390392303467
grad_norm: 4.433841156486986, clipped: 1.0
epoch: 20, train_batch_id: 1850, avg_cost: 3.8937249183654785
grad_norm: 2.964765436325866, clipped: 1.0
epoch: 20, train_batch_id: 1900, avg_cost: 3.878830909729004
grad_norm: 3.0845370505852663, clipped: 1.0
epoch: 20, train_batch_id: 1950, avg_cost: 3.8852343559265137
grad_norm: 3.3789557706037763, clipped: 1.0
epoch: 20, train_batch_id: 2000, avg_cost: 3.917086124420166
grad_norm: 4.085506054224271, clipped: 1.0
epoch: 20, train_batch_id: 2050, avg_cost: 3.905665874481201
grad_norm: 3.355222388074473, clipped: 1.0
epoch: 20, train_batch_id: 2100, avg_cost: 3.91762113571167
grad_norm: 3.10918357798304, clipped: 1.0
epoch: 20, train_batch_id: 2150, avg_cost: 3.9174065589904785
grad_norm: 3.4766998010319483, clipped: 1.0
epoch: 20, train_batch_id: 2200, avg_cost: 3.929791212081909
grad_norm: 3.6190240877201387, clipped: 1.0
epoch: 20, train_batch_id: 2250, avg_cost: 3.8957467079162598
grad_norm: 3.2805004866756753, clipped: 1.0
epoch: 20, train_batch_id: 2300, avg_cost: 3.916170835494995
grad_norm: 3.6755444592839774, clipped: 1.0
epoch: 20, train_batch_id: 2350, avg_cost: 3.8927221298217773
grad_norm: 2.5483465102712253, clipped: 1.0
epoch: 20, train_batch_id: 2400, avg_cost: 3.9097585678100586
grad_norm: 2.9097241192388648, clipped: 1.0
epoch: 20, train_batch_id: 2450, avg_cost: 3.935553550720215
grad_norm: 3.604963195510753, clipped: 1.0
Finished epoch 20, took 00:09:23 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.546673774719238 +- 0.004735968075692654
Evaluating candidate model on evaluation dataset
Epoch 20 candidate mean 4.538692474365234, baseline epoch 10 mean 4.355447769165039, difference 0.1832447052001953
Start train epoch 21, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


epoch: 21, train_batch_id: 0, avg_cost: 3.881732940673828
grad_norm: 2.6570475978843744, clipped: 1.0
epoch: 21, train_batch_id: 50, avg_cost: 3.8944668769836426
grad_norm: 4.692451426287987, clipped: 1.0
epoch: 21, train_batch_id: 100, avg_cost: 3.8982810974121094
grad_norm: 2.8310645685479274, clipped: 1.0
epoch: 21, train_batch_id: 150, avg_cost: 3.8956456184387207
grad_norm: 2.559289253451607, clipped: 1.0
epoch: 21, train_batch_id: 200, avg_cost: 3.9052205085754395
grad_norm: 2.88727214548086, clipped: 1.0
epoch: 21, train_batch_id: 250, avg_cost: 3.899569511413574
grad_norm: 3.2310387163208727, clipped: 1.0
epoch: 21, train_batch_id: 300, avg_cost: 3.9001986980438232
grad_norm: 2.568931874621149, clipped: 1.0
epoch: 21, train_batch_id: 350, avg_cost: 3.9012608528137207
grad_norm: 1.985532645530959, clipped: 1.0
epoch: 21, train_batch_id: 400, avg_cost: 3.9084486961364746
grad_norm: 3.2442667184601, clipped: 1.0
epoch: 21, train_batch_id: 450, avg_cost: 3.9114980697631836
grad_norm: 3.7699165859222195, clipped: 1.0
epoch: 21, train_batch_id: 500, avg_cost: 3.902061939239502
grad_norm: 3.1032927410234823, clipped: 1.0
epoch: 21, train_batch_id: 550, avg_cost: 3.903337001800537
grad_norm: 2.8330235730138607, clipped: 1.0
epoch: 21, train_batch_id: 600, avg_cost: 3.9311437606811523
grad_norm: 3.7048979438726275, clipped: 1.0
epoch: 21, train_batch_id: 650, avg_cost: 3.92685604095459
grad_norm: 3.3300233528565184, clipped: 1.0
epoch: 21, train_batch_id: 700, avg_cost: 3.942387104034424
grad_norm: 3.0942159207210764, clipped: 1.0
epoch: 21, train_batch_id: 750, avg_cost: 3.916693925857544
grad_norm: 2.805983045631981, clipped: 1.0
epoch: 21, train_batch_id: 800, avg_cost: 3.8982672691345215
grad_norm: 3.494544755666118, clipped: 1.0
epoch: 21, train_batch_id: 850, avg_cost: 3.9151201248168945
grad_norm: 2.8851077726125127, clipped: 1.0
epoch: 21, train_batch_id: 900, avg_cost: 3.9132027626037598
grad_norm: 2.994553070644875, clipped: 1.0
epoch: 21, train_batch_id: 950, avg_cost: 3.94203519821167
grad_norm: 2.7538302417401246, clipped: 1.0
epoch: 21, train_batch_id: 1000, avg_cost: 3.925154209136963
grad_norm: 4.379567754569955, clipped: 1.0
epoch: 21, train_batch_id: 1050, avg_cost: 3.9157896041870117
grad_norm: 2.3836615605144478, clipped: 1.0
epoch: 21, train_batch_id: 1100, avg_cost: 3.905533790588379
grad_norm: 2.4949776651641833, clipped: 1.0
epoch: 21, train_batch_id: 1150, avg_cost: 3.928788661956787
grad_norm: 3.282941691550857, clipped: 1.0
epoch: 21, train_batch_id: 1200, avg_cost: 3.9153099060058594
grad_norm: 2.389312284639983, clipped: 1.0
epoch: 21, train_batch_id: 1250, avg_cost: 3.917645215988159
grad_norm: 2.8355561839511916, clipped: 1.0
epoch: 21, train_batch_id: 1300, avg_cost: 3.8965494632720947
grad_norm: 2.2742846351521933, clipped: 1.0
epoch: 21, train_batch_id: 1350, avg_cost: 3.9173362255096436
grad_norm: 2.2084682904518624, clipped: 1.0
epoch: 21, train_batch_id: 1400, avg_cost: 3.9186904430389404
grad_norm: 2.769568726656132, clipped: 1.0
epoch: 21, train_batch_id: 1450, avg_cost: 3.914217948913574
grad_norm: 3.308184360079705, clipped: 1.0
epoch: 21, train_batch_id: 1500, avg_cost: 3.909579277038574
grad_norm: 2.43058972442928, clipped: 1.0
epoch: 21, train_batch_id: 1550, avg_cost: 3.892094612121582
grad_norm: 3.115759507745483, clipped: 1.0
epoch: 21, train_batch_id: 1600, avg_cost: 3.8987722396850586
grad_norm: 3.0011194176180074, clipped: 1.0
epoch: 21, train_batch_id: 1650, avg_cost: 3.9094438552856445
grad_norm: 2.7000347139957057, clipped: 1.0
epoch: 21, train_batch_id: 1700, avg_cost: 3.923403739929199
grad_norm: 2.293316092797367, clipped: 1.0
epoch: 21, train_batch_id: 1750, avg_cost: 3.9320292472839355
grad_norm: 2.705658633999525, clipped: 1.0
epoch: 21, train_batch_id: 1800, avg_cost: 3.8998420238494873
grad_norm: 2.3027935495988934, clipped: 1.0
epoch: 21, train_batch_id: 1850, avg_cost: 3.9105722904205322
grad_norm: 2.9995315614413816, clipped: 1.0
epoch: 21, train_batch_id: 1900, avg_cost: 3.885770082473755
grad_norm: 2.891856210650698, clipped: 1.0
epoch: 21, train_batch_id: 1950, avg_cost: 3.929703950881958
grad_norm: 2.644985856035236, clipped: 1.0
epoch: 21, train_batch_id: 2000, avg_cost: 3.9125571250915527
grad_norm: 1.9547816330354322, clipped: 1.0
epoch: 21, train_batch_id: 2050, avg_cost: 3.9171972274780273
grad_norm: 4.023265675152722, clipped: 1.0
epoch: 21, train_batch_id: 2100, avg_cost: 3.933504581451416
grad_norm: 2.7854623576053514, clipped: 1.0
epoch: 21, train_batch_id: 2150, avg_cost: 3.9275918006896973
grad_norm: 2.2340504896684266, clipped: 1.0
epoch: 21, train_batch_id: 2200, avg_cost: 3.90911602973938
grad_norm: 2.4565727881760404, clipped: 1.0
epoch: 21, train_batch_id: 2250, avg_cost: 3.907280921936035
grad_norm: 2.762991400631623, clipped: 1.0
epoch: 21, train_batch_id: 2300, avg_cost: 3.9224724769592285
grad_norm: 2.7538864808446983, clipped: 1.0
epoch: 21, train_batch_id: 2350, avg_cost: 3.9156315326690674
grad_norm: 2.4109826220087167, clipped: 1.0
epoch: 21, train_batch_id: 2400, avg_cost: 3.9201154708862305
grad_norm: 2.546208243601796, clipped: 1.0
epoch: 21, train_batch_id: 2450, avg_cost: 3.9013123512268066
grad_norm: 3.467075450268423, clipped: 1.0
Finished epoch 21, took 00:09:21 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.6233110427856445 +- 0.0049309502355754375
Evaluating candidate model on evaluation dataset
Epoch 21 candidate mean 4.621163368225098, baseline epoch 10 mean 4.355447769165039, difference 0.2657155990600586
Start train epoch 22, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 22, train_batch_id: 0, avg_cost: 3.936372995376587
grad_norm: 2.2804161518004866, clipped: 1.0
epoch: 22, train_batch_id: 50, avg_cost: 3.893484115600586
grad_norm: 3.0747615318462853, clipped: 1.0
epoch: 22, train_batch_id: 100, avg_cost: 3.9193472862243652
grad_norm: 3.2007952736268446, clipped: 1.0
epoch: 22, train_batch_id: 150, avg_cost: 3.916287660598755
grad_norm: 2.919435562901411, clipped: 1.0
epoch: 22, train_batch_id: 200, avg_cost: 3.90146541595459
grad_norm: 2.9848939275935598, clipped: 1.0
epoch: 22, train_batch_id: 250, avg_cost: 3.905233383178711
grad_norm: 2.9838347587581078, clipped: 1.0
epoch: 22, train_batch_id: 300, avg_cost: 3.9186925888061523
grad_norm: 3.196302675971864, clipped: 1.0
epoch: 22, train_batch_id: 350, avg_cost: 3.91090726852417
grad_norm: 2.5403304928444896, clipped: 1.0
epoch: 22, train_batch_id: 400, avg_cost: 3.897960901260376
grad_norm: 2.8835054817739825, clipped: 1.0
epoch: 22, train_batch_id: 450, avg_cost: 3.921051502227783
grad_norm: 3.1553711734567935, clipped: 1.0
epoch: 22, train_batch_id: 500, avg_cost: 3.892690896987915
grad_norm: 3.523114517996867, clipped: 1.0
epoch: 22, train_batch_id: 550, avg_cost: 3.915374517440796
grad_norm: 3.0470109803515038, clipped: 1.0
epoch: 22, train_batch_id: 600, avg_cost: 3.9085569381713867
grad_norm: 2.471050269316922, clipped: 1.0
epoch: 22, train_batch_id: 650, avg_cost: 3.939159870147705
grad_norm: 3.4255875282778776, clipped: 1.0
epoch: 22, train_batch_id: 700, avg_cost: 3.9149484634399414
grad_norm: 4.219262889509064, clipped: 1.0
epoch: 22, train_batch_id: 750, avg_cost: 3.908245325088501
grad_norm: 4.354352890608462, clipped: 1.0
epoch: 22, train_batch_id: 800, avg_cost: 3.935305595397949
grad_norm: 3.3834897455641824, clipped: 1.0
epoch: 22, train_batch_id: 850, avg_cost: 3.8973422050476074
grad_norm: 2.4870516285242523, clipped: 1.0
epoch: 22, train_batch_id: 900, avg_cost: 3.9275763034820557
grad_norm: 3.657474895566534, clipped: 1.0
epoch: 22, train_batch_id: 950, avg_cost: 3.9337198734283447
grad_norm: 2.5511650601012414, clipped: 1.0
epoch: 22, train_batch_id: 1000, avg_cost: 3.91375470161438
grad_norm: 2.156535240474471, clipped: 1.0
epoch: 22, train_batch_id: 1050, avg_cost: 3.9256701469421387
grad_norm: 5.297297480405848, clipped: 1.0
epoch: 22, train_batch_id: 1100, avg_cost: 3.903963565826416
grad_norm: 2.6256464833389, clipped: 1.0
epoch: 22, train_batch_id: 1150, avg_cost: 3.908918857574463
grad_norm: 3.111750492224292, clipped: 1.0
epoch: 22, train_batch_id: 1200, avg_cost: 3.9098100662231445
grad_norm: 2.616113561552472, clipped: 1.0
epoch: 22, train_batch_id: 1250, avg_cost: 3.9110145568847656
grad_norm: 2.6980614141753354, clipped: 1.0
epoch: 22, train_batch_id: 1300, avg_cost: 3.9152369499206543
grad_norm: 2.8437240863655777, clipped: 1.0
epoch: 22, train_batch_id: 1350, avg_cost: 3.9284772872924805
grad_norm: 2.807585353581327, clipped: 1.0
epoch: 22, train_batch_id: 1400, avg_cost: 3.909162998199463
grad_norm: 2.4132421145219953, clipped: 1.0
epoch: 22, train_batch_id: 1450, avg_cost: 3.939655303955078
grad_norm: 2.931347330082208, clipped: 1.0
epoch: 22, train_batch_id: 1500, avg_cost: 3.922863483428955
grad_norm: 3.606261674900755, clipped: 1.0
epoch: 22, train_batch_id: 1550, avg_cost: 3.931694507598877
grad_norm: 2.6202957250171988, clipped: 1.0
epoch: 22, train_batch_id: 1600, avg_cost: 3.9002652168273926
grad_norm: 3.0839098665196083, clipped: 1.0
epoch: 22, train_batch_id: 1650, avg_cost: 3.917490005493164
grad_norm: 2.754618564146647, clipped: 1.0
epoch: 22, train_batch_id: 1700, avg_cost: 3.8958630561828613
grad_norm: 2.6058830566484303, clipped: 1.0
epoch: 22, train_batch_id: 1750, avg_cost: 3.9237542152404785
grad_norm: 3.204292138858695, clipped: 1.0
epoch: 22, train_batch_id: 1800, avg_cost: 3.9000964164733887
grad_norm: 2.4142135606482054, clipped: 1.0
epoch: 22, train_batch_id: 1850, avg_cost: 3.922919750213623
grad_norm: 2.4718006305326043, clipped: 1.0
epoch: 22, train_batch_id: 1900, avg_cost: 3.899412155151367
grad_norm: 3.0415600352528926, clipped: 1.0
epoch: 22, train_batch_id: 1950, avg_cost: 3.9355549812316895
grad_norm: 3.066389699110279, clipped: 1.0
epoch: 22, train_batch_id: 2000, avg_cost: 3.894803524017334
grad_norm: 2.8151300388188805, clipped: 1.0
epoch: 22, train_batch_id: 2050, avg_cost: 3.9106903076171875
grad_norm: 3.123391122413445, clipped: 1.0
epoch: 22, train_batch_id: 2100, avg_cost: 3.9009294509887695
grad_norm: 2.6940453858647166, clipped: 1.0
epoch: 22, train_batch_id: 2150, avg_cost: 3.898822546005249
grad_norm: 2.2343740052676497, clipped: 1.0
epoch: 22, train_batch_id: 2200, avg_cost: 3.9007699489593506
grad_norm: 2.348236280924224, clipped: 1.0
epoch: 22, train_batch_id: 2250, avg_cost: 3.930155038833618
grad_norm: 1.798566474873753, clipped: 1.0
epoch: 22, train_batch_id: 2300, avg_cost: 3.8940234184265137
grad_norm: 2.8284694267355786, clipped: 1.0
epoch: 22, train_batch_id: 2350, avg_cost: 3.928922176361084
grad_norm: 3.155940846655802, clipped: 1.0
epoch: 22, train_batch_id: 2400, avg_cost: 3.930997848510742
grad_norm: 5.328466127157526, clipped: 1.0
epoch: 22, train_batch_id: 2450, avg_cost: 3.9226527214050293
grad_norm: 2.195294977793212, clipped: 1.0
Finished epoch 22, took 00:09:19 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.459636688232422 +- 0.004456577822566032
Evaluating candidate model on evaluation dataset
Epoch 22 candidate mean 4.454178333282471, baseline epoch 10 mean 4.355447769165039, difference 0.09873056411743164
Start train epoch 23, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 23, train_batch_id: 0, avg_cost: 3.9298906326293945
grad_norm: 2.286241224889872, clipped: 1.0
epoch: 23, train_batch_id: 50, avg_cost: 3.9251480102539062
grad_norm: 3.7928613440992844, clipped: 1.0
epoch: 23, train_batch_id: 100, avg_cost: 3.9159865379333496
grad_norm: 3.9573849205366565, clipped: 1.0
epoch: 23, train_batch_id: 150, avg_cost: 3.9311888217926025
grad_norm: 2.8205600371384176, clipped: 1.0
epoch: 23, train_batch_id: 200, avg_cost: 3.9315121173858643
grad_norm: 2.7334529413669197, clipped: 1.0
epoch: 23, train_batch_id: 250, avg_cost: 3.8923282623291016
grad_norm: 4.004840681071898, clipped: 1.0
epoch: 23, train_batch_id: 300, avg_cost: 3.895698070526123
grad_norm: 2.948665152968829, clipped: 1.0
epoch: 23, train_batch_id: 350, avg_cost: 3.9162275791168213
grad_norm: 2.6431149307913286, clipped: 1.0
epoch: 23, train_batch_id: 400, avg_cost: 3.928419351577759
grad_norm: 3.2159600792975835, clipped: 1.0
epoch: 23, train_batch_id: 450, avg_cost: 3.917870044708252
grad_norm: 2.4851949116399563, clipped: 1.0
epoch: 23, train_batch_id: 500, avg_cost: 3.9113030433654785
grad_norm: 2.3504069779499512, clipped: 1.0
epoch: 23, train_batch_id: 550, avg_cost: 3.9624924659729004
grad_norm: 4.147682905890792, clipped: 1.0
epoch: 23, train_batch_id: 600, avg_cost: 3.892909049987793
grad_norm: 4.675256877709778, clipped: 1.0
epoch: 23, train_batch_id: 650, avg_cost: 3.9333882331848145
grad_norm: 2.0119203744453706, clipped: 1.0
epoch: 23, train_batch_id: 700, avg_cost: 3.9317474365234375
grad_norm: 2.105148410164006, clipped: 1.0
epoch: 23, train_batch_id: 750, avg_cost: 3.9023046493530273
grad_norm: 3.186774370758885, clipped: 1.0
epoch: 23, train_batch_id: 800, avg_cost: 3.901028633117676
grad_norm: 3.2133309667459344, clipped: 1.0
epoch: 23, train_batch_id: 850, avg_cost: 3.931737184524536
grad_norm: 2.4170196996930713, clipped: 1.0
epoch: 23, train_batch_id: 900, avg_cost: 3.8915226459503174
grad_norm: 2.9955711620534937, clipped: 1.0
epoch: 23, train_batch_id: 950, avg_cost: 3.9123597145080566
grad_norm: 3.753239288667758, clipped: 1.0
epoch: 23, train_batch_id: 1000, avg_cost: 3.926144599914551
grad_norm: 3.0465609319918494, clipped: 1.0
epoch: 23, train_batch_id: 1050, avg_cost: 3.905330181121826
grad_norm: 2.843860345302114, clipped: 1.0
epoch: 23, train_batch_id: 1100, avg_cost: 3.9339733123779297
grad_norm: 3.6276212136400083, clipped: 1.0
epoch: 23, train_batch_id: 1150, avg_cost: 3.937314987182617
grad_norm: 3.179236167214521, clipped: 1.0
epoch: 23, train_batch_id: 1200, avg_cost: 3.9167370796203613
grad_norm: 2.2794887815725993, clipped: 1.0
epoch: 23, train_batch_id: 1250, avg_cost: 3.9231860637664795
grad_norm: 3.9694354894768145, clipped: 1.0
epoch: 23, train_batch_id: 1300, avg_cost: 3.9533586502075195
grad_norm: 7.441233747834502, clipped: 1.0
epoch: 23, train_batch_id: 1350, avg_cost: 3.891288995742798
grad_norm: 2.7251253682863297, clipped: 1.0
epoch: 23, train_batch_id: 1400, avg_cost: 3.924156665802002
grad_norm: 3.3712364541586233, clipped: 1.0
epoch: 23, train_batch_id: 1450, avg_cost: 3.8891124725341797
grad_norm: 3.727434449668061, clipped: 1.0
epoch: 23, train_batch_id: 1500, avg_cost: 3.906661033630371
grad_norm: 3.074484084085939, clipped: 1.0
epoch: 23, train_batch_id: 1550, avg_cost: 3.8794150352478027
grad_norm: 2.832075579225385, clipped: 1.0
epoch: 23, train_batch_id: 1600, avg_cost: 3.9344892501831055
grad_norm: 3.223312760352662, clipped: 1.0
epoch: 23, train_batch_id: 1650, avg_cost: 3.919189214706421
grad_norm: 3.683041323932633, clipped: 1.0
epoch: 23, train_batch_id: 1700, avg_cost: 3.941437244415283
grad_norm: 3.993974323309117, clipped: 1.0
epoch: 23, train_batch_id: 1750, avg_cost: 3.913569211959839
grad_norm: 3.2316231173145202, clipped: 1.0
epoch: 23, train_batch_id: 1800, avg_cost: 3.9079103469848633
grad_norm: 2.858663508000856, clipped: 1.0
epoch: 23, train_batch_id: 1850, avg_cost: 3.900665283203125
grad_norm: 4.639590844331376, clipped: 1.0
epoch: 23, train_batch_id: 1900, avg_cost: 3.895627021789551
grad_norm: 2.6212461680757735, clipped: 1.0
epoch: 23, train_batch_id: 1950, avg_cost: 3.930431842803955
grad_norm: 2.2786605109541895, clipped: 1.0
epoch: 23, train_batch_id: 2000, avg_cost: 3.91964054107666
grad_norm: 3.589685382162954, clipped: 1.0
epoch: 23, train_batch_id: 2050, avg_cost: 3.8925225734710693
grad_norm: 2.23256989374256, clipped: 1.0
epoch: 23, train_batch_id: 2100, avg_cost: 3.9154648780822754
grad_norm: 2.327835233631701, clipped: 1.0
epoch: 23, train_batch_id: 2150, avg_cost: 3.9063117504119873
grad_norm: 2.7767055521766957, clipped: 1.0
epoch: 23, train_batch_id: 2200, avg_cost: 3.9078896045684814
grad_norm: 4.259339753844079, clipped: 1.0
epoch: 23, train_batch_id: 2250, avg_cost: 3.925147533416748
grad_norm: 3.1666189841791375, clipped: 1.0
epoch: 23, train_batch_id: 2300, avg_cost: 3.9185569286346436
grad_norm: 2.6311480453987355, clipped: 1.0
epoch: 23, train_batch_id: 2350, avg_cost: 3.919328451156616
grad_norm: 4.134490207993955, clipped: 1.0
epoch: 23, train_batch_id: 2400, avg_cost: 3.9650120735168457
grad_norm: 5.160306889430279, clipped: 1.0
epoch: 23, train_batch_id: 2450, avg_cost: 3.897183656692505
grad_norm: 4.8492922506379506, clipped: 1.0
Finished epoch 23, took 00:09:19 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.444450855255127 +- 0.00512204272672534
Evaluating candidate model on evaluation dataset
Epoch 23 candidate mean 4.431339263916016, baseline epoch 10 mean 4.355447769165039, difference 0.07589149475097656
Start train epoch 24, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 24, train_batch_id: 0, avg_cost: 3.8989312648773193
grad_norm: 2.3683511776401867, clipped: 1.0
epoch: 24, train_batch_id: 50, avg_cost: 3.945187568664551
grad_norm: 2.80174904276536, clipped: 1.0
epoch: 24, train_batch_id: 100, avg_cost: 3.894904851913452
grad_norm: 2.64792952919182, clipped: 1.0
epoch: 24, train_batch_id: 150, avg_cost: 3.8896262645721436
grad_norm: 2.9106747227586673, clipped: 1.0
epoch: 24, train_batch_id: 200, avg_cost: 3.914334774017334
grad_norm: 2.6749685416369364, clipped: 1.0
epoch: 24, train_batch_id: 250, avg_cost: 3.9252471923828125
grad_norm: 4.4728358517522375, clipped: 1.0
epoch: 24, train_batch_id: 300, avg_cost: 3.9350805282592773
grad_norm: 3.515158503238864, clipped: 1.0
epoch: 24, train_batch_id: 350, avg_cost: 3.8932414054870605
grad_norm: 4.388448682455732, clipped: 1.0
epoch: 24, train_batch_id: 400, avg_cost: 3.9087162017822266
grad_norm: 3.7103374395152318, clipped: 1.0
epoch: 24, train_batch_id: 450, avg_cost: 3.903075695037842
grad_norm: 2.9286631184281466, clipped: 1.0
epoch: 24, train_batch_id: 500, avg_cost: 3.903618812561035
grad_norm: 2.5620338074011166, clipped: 1.0
epoch: 24, train_batch_id: 550, avg_cost: 3.93209171295166
grad_norm: 2.617411850357889, clipped: 1.0
epoch: 24, train_batch_id: 600, avg_cost: 3.931734561920166
grad_norm: 2.8810460743141246, clipped: 1.0
epoch: 24, train_batch_id: 650, avg_cost: 3.9052343368530273
grad_norm: 2.6733611251852616, clipped: 1.0
epoch: 24, train_batch_id: 700, avg_cost: 3.9046783447265625
grad_norm: 3.0905583987800442, clipped: 1.0
epoch: 24, train_batch_id: 750, avg_cost: 3.9114174842834473
grad_norm: 4.23838816509313, clipped: 1.0
epoch: 24, train_batch_id: 800, avg_cost: 3.904747486114502
grad_norm: 3.4769154282930166, clipped: 1.0
epoch: 24, train_batch_id: 850, avg_cost: 3.9088406562805176
grad_norm: 3.0185795652363274, clipped: 1.0
epoch: 24, train_batch_id: 900, avg_cost: 3.9445037841796875
grad_norm: 2.7386417735076027, clipped: 1.0
epoch: 24, train_batch_id: 950, avg_cost: 3.896413564682007
grad_norm: 2.711882348763655, clipped: 1.0
epoch: 24, train_batch_id: 1000, avg_cost: 3.909461498260498
grad_norm: 3.165276130765858, clipped: 1.0
epoch: 24, train_batch_id: 1050, avg_cost: 3.916656732559204
grad_norm: 4.299953810851762, clipped: 1.0
epoch: 24, train_batch_id: 1100, avg_cost: 3.879790782928467
grad_norm: 3.2935104292490816, clipped: 1.0
epoch: 24, train_batch_id: 1150, avg_cost: 3.9131014347076416
grad_norm: 3.825063523721185, clipped: 1.0
epoch: 24, train_batch_id: 1200, avg_cost: 3.9394373893737793
grad_norm: 3.332116241979775, clipped: 1.0
epoch: 24, train_batch_id: 1250, avg_cost: 3.9082999229431152
grad_norm: 3.0861793357901868, clipped: 1.0
epoch: 24, train_batch_id: 1300, avg_cost: 3.9199438095092773
grad_norm: 2.641099401224898, clipped: 1.0
epoch: 24, train_batch_id: 1350, avg_cost: 3.9402031898498535
grad_norm: 3.2345384471892915, clipped: 1.0
epoch: 24, train_batch_id: 1400, avg_cost: 3.9354281425476074
grad_norm: 4.937149670165164, clipped: 1.0
epoch: 24, train_batch_id: 1450, avg_cost: 3.9427638053894043
grad_norm: 2.620342179360533, clipped: 1.0
epoch: 24, train_batch_id: 1500, avg_cost: 3.92696475982666
grad_norm: 2.8283177732731763, clipped: 1.0
epoch: 24, train_batch_id: 1550, avg_cost: 3.9077937602996826
grad_norm: 3.9945755900692883, clipped: 1.0
epoch: 24, train_batch_id: 1600, avg_cost: 3.923964738845825
grad_norm: 2.634146185481076, clipped: 1.0
epoch: 24, train_batch_id: 1650, avg_cost: 3.9386861324310303
grad_norm: 2.8222279051829235, clipped: 1.0
epoch: 24, train_batch_id: 1700, avg_cost: 3.9304511547088623
grad_norm: 3.74036567391529, clipped: 1.0
epoch: 24, train_batch_id: 1750, avg_cost: 3.9042792320251465
grad_norm: 2.739198478344789, clipped: 1.0
epoch: 24, train_batch_id: 1800, avg_cost: 3.91670560836792
grad_norm: 4.40009046889779, clipped: 1.0
epoch: 24, train_batch_id: 1850, avg_cost: 3.9035542011260986
grad_norm: 3.5872048331497, clipped: 1.0
epoch: 24, train_batch_id: 1900, avg_cost: 3.894967555999756
grad_norm: 2.59334609637868, clipped: 1.0
epoch: 24, train_batch_id: 1950, avg_cost: 3.9616003036499023
grad_norm: 4.141818675906535, clipped: 1.0
epoch: 24, train_batch_id: 2000, avg_cost: 3.9208855628967285
grad_norm: 3.949773666556135, clipped: 1.0
epoch: 24, train_batch_id: 2050, avg_cost: 3.933475971221924
grad_norm: 3.648486720096456, clipped: 1.0
epoch: 24, train_batch_id: 2100, avg_cost: 3.9339823722839355
grad_norm: 3.764914868215015, clipped: 1.0
epoch: 24, train_batch_id: 2150, avg_cost: 3.903885841369629
grad_norm: 3.446430522805499, clipped: 1.0
epoch: 24, train_batch_id: 2200, avg_cost: 3.9340507984161377
grad_norm: 5.918879882739641, clipped: 1.0
epoch: 24, train_batch_id: 2250, avg_cost: 3.913241386413574
grad_norm: 2.464640870834589, clipped: 1.0
epoch: 24, train_batch_id: 2300, avg_cost: 3.938528060913086
grad_norm: 3.18767342538998, clipped: 1.0
epoch: 24, train_batch_id: 2350, avg_cost: 3.9036097526550293
grad_norm: 3.1115258437367515, clipped: 1.0
epoch: 24, train_batch_id: 2400, avg_cost: 3.906723976135254
grad_norm: 3.7985819680563897, clipped: 1.0
epoch: 24, train_batch_id: 2450, avg_cost: 3.9012997150421143
grad_norm: 3.1018437096199127, clipped: 1.0
Finished epoch 24, took 00:09:19 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.330552577972412 +- 0.004153608810156584
Evaluating candidate model on evaluation dataset
Epoch 24 candidate mean 4.323466777801514, baseline epoch 10 mean 4.355447769165039, difference -0.03198099136352539
p-value: 2.051254563249049e-30
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 25, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 25, train_batch_id: 0, avg_cost: 3.8899848461151123
grad_norm: 2.57938381919875, clipped: 1.0
epoch: 25, train_batch_id: 50, avg_cost: 3.950927257537842
grad_norm: 3.1039539095228768, clipped: 1.0
epoch: 25, train_batch_id: 100, avg_cost: 3.9139506816864014
grad_norm: 3.638915751185886, clipped: 1.0
epoch: 25, train_batch_id: 150, avg_cost: 3.958134651184082
grad_norm: 2.622773250091243, clipped: 1.0
epoch: 25, train_batch_id: 200, avg_cost: 3.9262208938598633
grad_norm: 2.3817720952891768, clipped: 1.0
epoch: 25, train_batch_id: 250, avg_cost: 3.8938345909118652
grad_norm: 2.622728848351565, clipped: 1.0
epoch: 25, train_batch_id: 300, avg_cost: 3.8843674659729004
grad_norm: 5.719998354369832, clipped: 1.0
epoch: 25, train_batch_id: 350, avg_cost: 3.9031004905700684
grad_norm: 2.570777465920039, clipped: 1.0
epoch: 25, train_batch_id: 400, avg_cost: 3.9191160202026367
grad_norm: 4.539541249096523, clipped: 1.0
epoch: 25, train_batch_id: 450, avg_cost: 3.907048225402832
grad_norm: 3.510088035541217, clipped: 1.0
epoch: 25, train_batch_id: 500, avg_cost: 3.9047365188598633
grad_norm: 2.772957575436291, clipped: 1.0
epoch: 25, train_batch_id: 550, avg_cost: 3.9075474739074707
grad_norm: 3.791204786385971, clipped: 1.0
epoch: 25, train_batch_id: 600, avg_cost: 3.9068527221679688
grad_norm: 3.672978555868397, clipped: 1.0
epoch: 25, train_batch_id: 650, avg_cost: 3.9163661003112793
grad_norm: 4.091968099347726, clipped: 1.0
epoch: 25, train_batch_id: 700, avg_cost: 3.8825182914733887
grad_norm: 5.602973878265193, clipped: 1.0
epoch: 25, train_batch_id: 750, avg_cost: 3.902326822280884
grad_norm: 3.5748057517022196, clipped: 1.0
epoch: 25, train_batch_id: 800, avg_cost: 3.9036128520965576
grad_norm: 2.8286828972405775, clipped: 1.0
epoch: 25, train_batch_id: 850, avg_cost: 3.9283318519592285
grad_norm: 2.2297485282243468, clipped: 1.0
epoch: 25, train_batch_id: 900, avg_cost: 3.914860725402832
grad_norm: 3.209148442651678, clipped: 1.0
epoch: 25, train_batch_id: 950, avg_cost: 3.901704788208008
grad_norm: 2.343596204214399, clipped: 1.0
epoch: 25, train_batch_id: 1000, avg_cost: 3.906280517578125
grad_norm: 3.414794800674797, clipped: 1.0
epoch: 25, train_batch_id: 1050, avg_cost: 3.931488513946533
grad_norm: 3.3402106549234887, clipped: 1.0
epoch: 25, train_batch_id: 1100, avg_cost: 3.919437885284424
grad_norm: 2.657772084730886, clipped: 1.0
epoch: 25, train_batch_id: 1150, avg_cost: 3.9038379192352295
grad_norm: 2.6058233825881483, clipped: 1.0
epoch: 25, train_batch_id: 1200, avg_cost: 3.9357175827026367
grad_norm: 3.167775169917157, clipped: 1.0
epoch: 25, train_batch_id: 1250, avg_cost: 3.908289909362793
grad_norm: 2.9724006603168127, clipped: 1.0
epoch: 25, train_batch_id: 1300, avg_cost: 3.907637596130371
grad_norm: 4.173672003781562, clipped: 1.0
epoch: 25, train_batch_id: 1350, avg_cost: 3.912353515625
grad_norm: 4.873417767227356, clipped: 1.0
epoch: 25, train_batch_id: 1400, avg_cost: 3.9265265464782715
grad_norm: 2.8693528192086846, clipped: 1.0
epoch: 25, train_batch_id: 1450, avg_cost: 3.9429244995117188
grad_norm: 3.7716978815927584, clipped: 1.0
epoch: 25, train_batch_id: 1500, avg_cost: 3.9273030757904053
grad_norm: 2.1981709186314804, clipped: 1.0
epoch: 25, train_batch_id: 1550, avg_cost: 3.910391330718994
grad_norm: 1.8254579583203498, clipped: 1.0
epoch: 25, train_batch_id: 1600, avg_cost: 3.9226057529449463
grad_norm: 2.3160425392242594, clipped: 1.0
epoch: 25, train_batch_id: 1650, avg_cost: 3.899794578552246
grad_norm: 2.671869025743043, clipped: 1.0
epoch: 25, train_batch_id: 1700, avg_cost: 3.9041872024536133
grad_norm: 3.2146842741027934, clipped: 1.0
epoch: 25, train_batch_id: 1750, avg_cost: 3.8947830200195312
grad_norm: 2.0568167061134397, clipped: 1.0
epoch: 25, train_batch_id: 1800, avg_cost: 3.882418632507324
grad_norm: 3.0775819517824945, clipped: 1.0
epoch: 25, train_batch_id: 1850, avg_cost: 3.890872001647949
grad_norm: 2.431756675342124, clipped: 1.0
epoch: 25, train_batch_id: 1900, avg_cost: 3.922067165374756
grad_norm: 2.26920965216003, clipped: 1.0
epoch: 25, train_batch_id: 1950, avg_cost: 3.8812594413757324
grad_norm: 3.875562178463142, clipped: 1.0
epoch: 25, train_batch_id: 2000, avg_cost: 3.8746697902679443
grad_norm: 2.506471808844567, clipped: 1.0
epoch: 25, train_batch_id: 2050, avg_cost: 3.9047327041625977
grad_norm: 2.561670879853223, clipped: 1.0
epoch: 25, train_batch_id: 2100, avg_cost: 3.9034347534179688
grad_norm: 2.869198730691021, clipped: 1.0
epoch: 25, train_batch_id: 2150, avg_cost: 3.9196860790252686
grad_norm: 2.6043562491784753, clipped: 1.0
epoch: 25, train_batch_id: 2200, avg_cost: 3.902489185333252
grad_norm: 3.492725836822334, clipped: 1.0
epoch: 25, train_batch_id: 2250, avg_cost: 3.9127345085144043
grad_norm: 3.7022200316878995, clipped: 1.0
epoch: 25, train_batch_id: 2300, avg_cost: 3.912689447402954
grad_norm: 2.9068935884805067, clipped: 1.0
epoch: 25, train_batch_id: 2350, avg_cost: 3.9086713790893555
grad_norm: 2.3473084450158765, clipped: 1.0
epoch: 25, train_batch_id: 2400, avg_cost: 3.9015917778015137
grad_norm: 3.196060343778934, clipped: 1.0
epoch: 25, train_batch_id: 2450, avg_cost: 3.931924343109131
grad_norm: 3.0986236882619873, clipped: 1.0
Finished epoch 25, took 00:09:22 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.382441997528076 +- 0.004241623915731907
Evaluating candidate model on evaluation dataset
Epoch 25 candidate mean 4.375634670257568, baseline epoch 24 mean 4.323680400848389, difference 0.05195426940917969
Start train epoch 26, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 26, train_batch_id: 0, avg_cost: 3.9238603115081787
grad_norm: 5.053123141424332, clipped: 1.0
epoch: 26, train_batch_id: 50, avg_cost: 3.9144930839538574
grad_norm: 3.284095136465209, clipped: 1.0
epoch: 26, train_batch_id: 100, avg_cost: 3.9097371101379395
grad_norm: 3.3882667276639387, clipped: 1.0
epoch: 26, train_batch_id: 150, avg_cost: 3.932609796524048
grad_norm: 2.7847209818628373, clipped: 1.0
epoch: 26, train_batch_id: 200, avg_cost: 3.9069666862487793
grad_norm: 2.890048927972844, clipped: 1.0
epoch: 26, train_batch_id: 250, avg_cost: 3.9313278198242188
grad_norm: 2.5213543485176313, clipped: 1.0
epoch: 26, train_batch_id: 300, avg_cost: 3.8964645862579346
grad_norm: 2.4895484247463937, clipped: 1.0
epoch: 26, train_batch_id: 350, avg_cost: 3.891333818435669
grad_norm: 2.3355530504938353, clipped: 1.0
epoch: 26, train_batch_id: 400, avg_cost: 3.9229085445404053
grad_norm: 5.31580308302739, clipped: 1.0
epoch: 26, train_batch_id: 450, avg_cost: 3.9160099029541016
grad_norm: 3.6405705122436713, clipped: 1.0
epoch: 26, train_batch_id: 500, avg_cost: 3.911811351776123
grad_norm: 2.6693792956477007, clipped: 1.0
epoch: 26, train_batch_id: 550, avg_cost: 3.909755229949951
grad_norm: 2.4199575061597134, clipped: 1.0
epoch: 26, train_batch_id: 600, avg_cost: 3.9124703407287598
grad_norm: 3.1519563799008665, clipped: 1.0
epoch: 26, train_batch_id: 650, avg_cost: 3.912257194519043
grad_norm: 2.320371120392362, clipped: 1.0
epoch: 26, train_batch_id: 700, avg_cost: 3.919515371322632
grad_norm: 3.0526291598416417, clipped: 1.0
epoch: 26, train_batch_id: 750, avg_cost: 3.9251437187194824
grad_norm: 5.214787490690359, clipped: 1.0
epoch: 26, train_batch_id: 800, avg_cost: 3.9258360862731934
grad_norm: 2.0960241972270817, clipped: 1.0
epoch: 26, train_batch_id: 850, avg_cost: 3.943086624145508
grad_norm: 4.884573924035252, clipped: 1.0
epoch: 26, train_batch_id: 900, avg_cost: 3.9126856327056885
grad_norm: 2.8383660973747875, clipped: 1.0
epoch: 26, train_batch_id: 950, avg_cost: 3.9206342697143555
grad_norm: 3.8302082504484267, clipped: 1.0
epoch: 26, train_batch_id: 1000, avg_cost: 3.9104084968566895
grad_norm: 2.2498952346502072, clipped: 1.0
epoch: 26, train_batch_id: 1050, avg_cost: 3.898934841156006
grad_norm: 2.765621026402843, clipped: 1.0
epoch: 26, train_batch_id: 1100, avg_cost: 3.92343807220459
grad_norm: 3.1326708775301593, clipped: 1.0
epoch: 26, train_batch_id: 1150, avg_cost: 3.912785053253174
grad_norm: 3.68743240742358, clipped: 1.0
epoch: 26, train_batch_id: 1200, avg_cost: 3.9221911430358887
grad_norm: 2.545461075557326, clipped: 1.0
epoch: 26, train_batch_id: 1250, avg_cost: 3.9072821140289307
grad_norm: 2.413638553903776, clipped: 1.0
epoch: 26, train_batch_id: 1300, avg_cost: 3.9066731929779053
grad_norm: 2.5412521447274092, clipped: 1.0
epoch: 26, train_batch_id: 1350, avg_cost: 3.9334495067596436
grad_norm: 3.4450784775165353, clipped: 1.0
epoch: 26, train_batch_id: 1400, avg_cost: 3.9183287620544434
grad_norm: 2.7319758989345515, clipped: 1.0
epoch: 26, train_batch_id: 1450, avg_cost: 3.9084396362304688
grad_norm: 3.4011356453771358, clipped: 1.0
epoch: 26, train_batch_id: 1500, avg_cost: 3.8845667839050293
grad_norm: 2.501626606987678, clipped: 1.0
epoch: 26, train_batch_id: 1550, avg_cost: 3.9018826484680176
grad_norm: 3.6509429810980745, clipped: 1.0
epoch: 26, train_batch_id: 1600, avg_cost: 3.9003686904907227
grad_norm: 2.409458466007752, clipped: 1.0
epoch: 26, train_batch_id: 1650, avg_cost: 3.89678955078125
grad_norm: 3.750326726132465, clipped: 1.0
epoch: 26, train_batch_id: 1700, avg_cost: 3.9139037132263184
grad_norm: 2.8074743543251595, clipped: 1.0
epoch: 26, train_batch_id: 1750, avg_cost: 3.9181008338928223
grad_norm: 2.8556611149957, clipped: 1.0
epoch: 26, train_batch_id: 1800, avg_cost: 3.8960986137390137
grad_norm: 3.431933106723744, clipped: 1.0
epoch: 26, train_batch_id: 1850, avg_cost: 3.910496234893799
grad_norm: 2.692501266297629, clipped: 1.0
epoch: 26, train_batch_id: 1900, avg_cost: 3.9162511825561523
grad_norm: 3.1786391976252935, clipped: 1.0
epoch: 26, train_batch_id: 1950, avg_cost: 3.9299683570861816
grad_norm: 3.534276549374505, clipped: 1.0
epoch: 26, train_batch_id: 2000, avg_cost: 3.922574996948242
grad_norm: 2.184392086902523, clipped: 1.0
epoch: 26, train_batch_id: 2050, avg_cost: 3.900481700897217
grad_norm: 1.9561435656967305, clipped: 1.0
epoch: 26, train_batch_id: 2100, avg_cost: 3.9252474308013916
grad_norm: 2.2631299072598856, clipped: 1.0
epoch: 26, train_batch_id: 2150, avg_cost: 3.917856216430664
grad_norm: 2.7386031788261818, clipped: 1.0
epoch: 26, train_batch_id: 2200, avg_cost: 3.871436595916748
grad_norm: 3.007034387124841, clipped: 1.0
epoch: 26, train_batch_id: 2250, avg_cost: 3.8949670791625977
grad_norm: 2.679933767659418, clipped: 1.0
epoch: 26, train_batch_id: 2300, avg_cost: 3.9079668521881104
grad_norm: 3.444526196832494, clipped: 1.0
epoch: 26, train_batch_id: 2350, avg_cost: 3.903785467147827
grad_norm: 3.479600237748173, clipped: 1.0
epoch: 26, train_batch_id: 2400, avg_cost: 3.928431749343872
grad_norm: 3.6089645329698072, clipped: 1.0
epoch: 26, train_batch_id: 2450, avg_cost: 3.894155979156494
grad_norm: 2.513670760599849, clipped: 1.0
Finished epoch 26, took 00:09:28 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.313236713409424 +- 0.004318219609558582
Evaluating candidate model on evaluation dataset
Epoch 26 candidate mean 4.305795192718506, baseline epoch 24 mean 4.323680400848389, difference -0.017885208129882812
p-value: 1.3252565507525607e-07
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 27, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 27, train_batch_id: 0, avg_cost: 3.898685932159424
grad_norm: 2.9055889728356052, clipped: 1.0
epoch: 27, train_batch_id: 50, avg_cost: 3.931969165802002
grad_norm: 2.4027469773193997, clipped: 1.0
epoch: 27, train_batch_id: 100, avg_cost: 3.8922722339630127
grad_norm: 2.5921718587059495, clipped: 1.0
epoch: 27, train_batch_id: 150, avg_cost: 3.8858888149261475
grad_norm: 2.7290304745021254, clipped: 1.0
epoch: 27, train_batch_id: 200, avg_cost: 3.93190336227417
grad_norm: 2.3080030788175527, clipped: 1.0
epoch: 27, train_batch_id: 250, avg_cost: 3.9042060375213623
grad_norm: 2.3903952925769376, clipped: 1.0
epoch: 27, train_batch_id: 300, avg_cost: 3.9356887340545654
grad_norm: 2.3219559066484363, clipped: 1.0
epoch: 27, train_batch_id: 350, avg_cost: 3.897907018661499
grad_norm: 3.4482950555234506, clipped: 1.0
epoch: 27, train_batch_id: 400, avg_cost: 3.910292863845825
grad_norm: 2.594567246664179, clipped: 1.0
epoch: 27, train_batch_id: 450, avg_cost: 3.9207818508148193
grad_norm: 2.3568120886859396, clipped: 1.0
epoch: 27, train_batch_id: 500, avg_cost: 3.9350929260253906
grad_norm: 2.8159113934991273, clipped: 1.0
epoch: 27, train_batch_id: 550, avg_cost: 3.8910865783691406
grad_norm: 2.008975175454703, clipped: 1.0
epoch: 27, train_batch_id: 600, avg_cost: 3.9384074211120605
grad_norm: 2.283173421720399, clipped: 1.0
epoch: 27, train_batch_id: 650, avg_cost: 3.8985276222229004
grad_norm: 3.1638383474411995, clipped: 1.0
epoch: 27, train_batch_id: 700, avg_cost: 3.932300567626953
grad_norm: 2.875414101688015, clipped: 1.0
epoch: 27, train_batch_id: 750, avg_cost: 3.910572052001953
grad_norm: 2.816875298254934, clipped: 1.0
epoch: 27, train_batch_id: 800, avg_cost: 3.913930654525757
grad_norm: 1.9723036603828537, clipped: 1.0
epoch: 27, train_batch_id: 850, avg_cost: 3.9203288555145264
grad_norm: 2.4095199514217915, clipped: 1.0
epoch: 27, train_batch_id: 900, avg_cost: 3.9431710243225098
grad_norm: 2.7893020602810648, clipped: 1.0
epoch: 27, train_batch_id: 950, avg_cost: 3.9180521965026855
grad_norm: 2.7928259249387697, clipped: 1.0
epoch: 27, train_batch_id: 1000, avg_cost: 3.897876262664795
grad_norm: 2.4523910728763547, clipped: 1.0
epoch: 27, train_batch_id: 1050, avg_cost: 3.898930788040161
grad_norm: 2.4203345274300485, clipped: 1.0
epoch: 27, train_batch_id: 1100, avg_cost: 3.8837621212005615
grad_norm: 2.4771416413513574, clipped: 1.0
epoch: 27, train_batch_id: 1150, avg_cost: 3.909285545349121
grad_norm: 2.3464163596561076, clipped: 1.0
epoch: 27, train_batch_id: 1200, avg_cost: 3.913083076477051
grad_norm: 3.514153793012772, clipped: 1.0
epoch: 27, train_batch_id: 1250, avg_cost: 3.921609401702881
grad_norm: 2.6764343557590276, clipped: 1.0
epoch: 27, train_batch_id: 1300, avg_cost: 3.8891420364379883
grad_norm: 2.909475832111527, clipped: 1.0
epoch: 27, train_batch_id: 1350, avg_cost: 3.9377827644348145
grad_norm: 2.7572263419457075, clipped: 1.0
epoch: 27, train_batch_id: 1400, avg_cost: 3.8908486366271973
grad_norm: 2.0780651302293913, clipped: 1.0
epoch: 27, train_batch_id: 1450, avg_cost: 3.9118247032165527
grad_norm: 2.9931932400309758, clipped: 1.0
epoch: 27, train_batch_id: 1500, avg_cost: 3.8910653591156006
grad_norm: 3.1553311630330567, clipped: 1.0
epoch: 27, train_batch_id: 1550, avg_cost: 3.9034831523895264
grad_norm: 2.117436969147082, clipped: 1.0
epoch: 27, train_batch_id: 1600, avg_cost: 3.8681836128234863
grad_norm: 2.0775414821891856, clipped: 1.0
epoch: 27, train_batch_id: 1650, avg_cost: 3.9140877723693848
grad_norm: 3.621086513834302, clipped: 1.0
epoch: 27, train_batch_id: 1700, avg_cost: 3.900300979614258
grad_norm: 3.1226166518644387, clipped: 1.0
epoch: 27, train_batch_id: 1750, avg_cost: 3.9245033264160156
grad_norm: 5.688160281422566, clipped: 1.0
epoch: 27, train_batch_id: 1800, avg_cost: 3.9200100898742676
grad_norm: 2.7414850730695046, clipped: 1.0
epoch: 27, train_batch_id: 1850, avg_cost: 3.902698040008545
grad_norm: 3.360122276792517, clipped: 1.0
epoch: 27, train_batch_id: 1900, avg_cost: 3.9143495559692383
grad_norm: 2.8692763536871637, clipped: 1.0
epoch: 27, train_batch_id: 1950, avg_cost: 3.9201953411102295
grad_norm: 2.5101798146598546, clipped: 1.0
epoch: 27, train_batch_id: 2000, avg_cost: 3.923377513885498
grad_norm: 2.6923252785635254, clipped: 1.0
epoch: 27, train_batch_id: 2050, avg_cost: 3.867382049560547
grad_norm: 2.3814324254505075, clipped: 1.0
epoch: 27, train_batch_id: 2100, avg_cost: 3.9268529415130615
grad_norm: 2.9130170128641746, clipped: 1.0
epoch: 27, train_batch_id: 2150, avg_cost: 3.9422945976257324
grad_norm: 2.6305019018712783, clipped: 1.0
epoch: 27, train_batch_id: 2200, avg_cost: 3.914144992828369
grad_norm: 3.2267926014751924, clipped: 1.0
epoch: 27, train_batch_id: 2250, avg_cost: 3.896183490753174
grad_norm: 2.825569817908465, clipped: 1.0
epoch: 27, train_batch_id: 2300, avg_cost: 3.946183919906616
grad_norm: 3.3640273954687165, clipped: 1.0
epoch: 27, train_batch_id: 2350, avg_cost: 3.9266066551208496
grad_norm: 3.1433308589815914, clipped: 1.0
epoch: 27, train_batch_id: 2400, avg_cost: 3.8992180824279785
grad_norm: 2.756192853366191, clipped: 1.0
epoch: 27, train_batch_id: 2450, avg_cost: 3.894455671310425
grad_norm: 2.5609718037635654, clipped: 1.0
Finished epoch 27, took 00:09:27 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.376867294311523 +- 0.004451796878129244
Evaluating candidate model on evaluation dataset
Epoch 27 candidate mean 4.375612258911133, baseline epoch 26 mean 4.311145782470703, difference 0.06446647644042969
Start train epoch 28, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 28, train_batch_id: 0, avg_cost: 3.8842649459838867
grad_norm: 3.3607768286478605, clipped: 1.0
epoch: 28, train_batch_id: 50, avg_cost: 3.873215436935425
grad_norm: 2.099724645541551, clipped: 1.0
epoch: 28, train_batch_id: 100, avg_cost: 3.9008116722106934
grad_norm: 2.0419430959674862, clipped: 1.0
epoch: 28, train_batch_id: 150, avg_cost: 3.9010729789733887
grad_norm: 3.1104096047807395, clipped: 1.0
epoch: 28, train_batch_id: 200, avg_cost: 3.9095816612243652
grad_norm: 2.000298013358205, clipped: 1.0
epoch: 28, train_batch_id: 250, avg_cost: 3.9222702980041504
grad_norm: 4.619799993968107, clipped: 1.0
epoch: 28, train_batch_id: 300, avg_cost: 3.927957534790039
grad_norm: 2.32681871865783, clipped: 1.0
epoch: 28, train_batch_id: 350, avg_cost: 3.902153253555298
grad_norm: 3.317489205427939, clipped: 1.0
epoch: 28, train_batch_id: 400, avg_cost: 3.88948917388916
grad_norm: 2.057114385331158, clipped: 1.0
epoch: 28, train_batch_id: 450, avg_cost: 3.9048826694488525
grad_norm: 4.098359760541525, clipped: 1.0
epoch: 28, train_batch_id: 500, avg_cost: 3.9037632942199707
grad_norm: 2.4184787462350275, clipped: 1.0
epoch: 28, train_batch_id: 550, avg_cost: 3.9216933250427246
grad_norm: 2.074344782226595, clipped: 1.0
epoch: 28, train_batch_id: 600, avg_cost: 3.910109281539917
grad_norm: 2.395704229705751, clipped: 1.0
epoch: 28, train_batch_id: 650, avg_cost: 3.9016799926757812
grad_norm: 2.1165734207680984, clipped: 1.0
epoch: 28, train_batch_id: 700, avg_cost: 3.890904664993286
grad_norm: 5.008925569863434, clipped: 1.0
epoch: 28, train_batch_id: 750, avg_cost: 3.9046854972839355
grad_norm: 2.897817179382753, clipped: 1.0
epoch: 28, train_batch_id: 800, avg_cost: 3.8738927841186523
grad_norm: 2.615512858820941, clipped: 1.0
epoch: 28, train_batch_id: 850, avg_cost: 3.921407461166382
grad_norm: 2.27490383210009, clipped: 1.0
epoch: 28, train_batch_id: 900, avg_cost: 3.9222311973571777
grad_norm: 4.200891279592092, clipped: 1.0
epoch: 28, train_batch_id: 950, avg_cost: 3.901209592819214
grad_norm: 3.306680901839759, clipped: 1.0
epoch: 28, train_batch_id: 1000, avg_cost: 3.9051904678344727
grad_norm: 1.995010571675171, clipped: 1.0
epoch: 28, train_batch_id: 1050, avg_cost: 3.8955509662628174
grad_norm: 3.303878653615458, clipped: 1.0
epoch: 28, train_batch_id: 1100, avg_cost: 3.9211959838867188
grad_norm: 2.589063288176001, clipped: 1.0
epoch: 28, train_batch_id: 1150, avg_cost: 3.9101815223693848
grad_norm: 2.9545395305797437, clipped: 1.0
epoch: 28, train_batch_id: 1200, avg_cost: 3.9199635982513428
grad_norm: 2.613527521413834, clipped: 1.0
epoch: 28, train_batch_id: 1250, avg_cost: 3.9116106033325195
grad_norm: 2.191867292266116, clipped: 1.0
epoch: 28, train_batch_id: 1300, avg_cost: 3.9082138538360596
grad_norm: 2.4761723269524896, clipped: 1.0
epoch: 28, train_batch_id: 1350, avg_cost: 3.910400867462158
grad_norm: 2.2496602360509574, clipped: 1.0
epoch: 28, train_batch_id: 1400, avg_cost: 3.890286922454834
grad_norm: 1.9509711660188167, clipped: 1.0
epoch: 28, train_batch_id: 1450, avg_cost: 3.893557548522949
grad_norm: 2.7165977590937667, clipped: 1.0
epoch: 28, train_batch_id: 1500, avg_cost: 3.8950934410095215
grad_norm: 2.003627500391071, clipped: 1.0
epoch: 28, train_batch_id: 1550, avg_cost: 3.9059386253356934
grad_norm: 2.5844478362976706, clipped: 1.0
epoch: 28, train_batch_id: 1600, avg_cost: 3.910557270050049
grad_norm: 2.5733335076107533, clipped: 1.0
epoch: 28, train_batch_id: 1650, avg_cost: 3.9385995864868164
grad_norm: 3.378806118039553, clipped: 1.0
epoch: 28, train_batch_id: 1700, avg_cost: 3.923790454864502
grad_norm: 2.487968296724234, clipped: 1.0
epoch: 28, train_batch_id: 1750, avg_cost: 3.8770933151245117
grad_norm: 3.664507438460125, clipped: 1.0
epoch: 28, train_batch_id: 1800, avg_cost: 3.908851385116577
grad_norm: 2.893450208181533, clipped: 1.0
epoch: 28, train_batch_id: 1850, avg_cost: 3.8966336250305176
grad_norm: 2.2289836245467365, clipped: 1.0
epoch: 28, train_batch_id: 1900, avg_cost: 3.915037155151367
grad_norm: 2.284031724007774, clipped: 1.0
epoch: 28, train_batch_id: 1950, avg_cost: 3.9050590991973877
grad_norm: 3.110646811050541, clipped: 1.0
epoch: 28, train_batch_id: 2000, avg_cost: 3.898277521133423
grad_norm: 3.340515512879736, clipped: 1.0
epoch: 28, train_batch_id: 2050, avg_cost: 3.9191434383392334
grad_norm: 3.4667577419016395, clipped: 1.0
epoch: 28, train_batch_id: 2100, avg_cost: 3.9042129516601562
grad_norm: 2.6168967485440393, clipped: 1.0
epoch: 28, train_batch_id: 2150, avg_cost: 3.8979454040527344
grad_norm: 3.1459248034760066, clipped: 1.0
epoch: 28, train_batch_id: 2200, avg_cost: 3.9136314392089844
grad_norm: 2.316629335876235, clipped: 1.0
epoch: 28, train_batch_id: 2250, avg_cost: 3.8954086303710938
grad_norm: 2.6033306877366575, clipped: 1.0
epoch: 28, train_batch_id: 2300, avg_cost: 3.931685447692871
grad_norm: 2.4706188067934263, clipped: 1.0
epoch: 28, train_batch_id: 2350, avg_cost: 3.908015251159668
grad_norm: 2.8266731196048953, clipped: 1.0
epoch: 28, train_batch_id: 2400, avg_cost: 3.9191408157348633
grad_norm: 2.75145398773287, clipped: 1.0
epoch: 28, train_batch_id: 2450, avg_cost: 3.90088152885437
grad_norm: 4.944404302369271, clipped: 1.0
Finished epoch 28, took 00:09:23 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.392555236816406 +- 0.004678964614868164
Evaluating candidate model on evaluation dataset
Epoch 28 candidate mean 4.4002366065979, baseline epoch 26 mean 4.311145782470703, difference 0.08909082412719727
Start train epoch 29, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 29, train_batch_id: 0, avg_cost: 3.910564661026001
grad_norm: 2.326430185812056, clipped: 1.0
epoch: 29, train_batch_id: 50, avg_cost: 3.884967565536499
grad_norm: 3.0311563697614075, clipped: 1.0
epoch: 29, train_batch_id: 100, avg_cost: 3.9038472175598145
grad_norm: 2.283347159654668, clipped: 1.0
epoch: 29, train_batch_id: 150, avg_cost: 3.8858375549316406
grad_norm: 2.747921144147946, clipped: 1.0
epoch: 29, train_batch_id: 200, avg_cost: 3.8913846015930176
grad_norm: 2.507541256278161, clipped: 1.0
epoch: 29, train_batch_id: 250, avg_cost: 3.8966073989868164
grad_norm: 2.33903461999862, clipped: 1.0
epoch: 29, train_batch_id: 300, avg_cost: 3.9209821224212646
grad_norm: 2.985273238016123, clipped: 1.0
epoch: 29, train_batch_id: 350, avg_cost: 3.9146995544433594
grad_norm: 2.5895835642067837, clipped: 1.0
epoch: 29, train_batch_id: 400, avg_cost: 3.9132556915283203
grad_norm: 2.1895339807292293, clipped: 1.0
epoch: 29, train_batch_id: 450, avg_cost: 3.9463160037994385
grad_norm: 2.6919647887708287, clipped: 1.0
epoch: 29, train_batch_id: 500, avg_cost: 3.8864312171936035
grad_norm: 2.4894233950884055, clipped: 1.0
epoch: 29, train_batch_id: 550, avg_cost: 3.902355194091797
grad_norm: 2.1773478962048345, clipped: 1.0
epoch: 29, train_batch_id: 600, avg_cost: 3.890770673751831
grad_norm: 2.0123853068752084, clipped: 1.0
epoch: 29, train_batch_id: 650, avg_cost: 3.9294509887695312
grad_norm: 2.49545143681684, clipped: 1.0
epoch: 29, train_batch_id: 700, avg_cost: 3.9103832244873047
grad_norm: 2.0845277316746245, clipped: 1.0
epoch: 29, train_batch_id: 750, avg_cost: 3.911881923675537
grad_norm: 2.726527227536533, clipped: 1.0
epoch: 29, train_batch_id: 800, avg_cost: 3.9186203479766846
grad_norm: 2.6125923129126347, clipped: 1.0
epoch: 29, train_batch_id: 850, avg_cost: 3.9065494537353516
grad_norm: 2.555475173778173, clipped: 1.0
epoch: 29, train_batch_id: 900, avg_cost: 3.9162399768829346
grad_norm: 4.116025997616632, clipped: 1.0
epoch: 29, train_batch_id: 950, avg_cost: 3.918348789215088
grad_norm: 2.137598443450778, clipped: 1.0
epoch: 29, train_batch_id: 1000, avg_cost: 3.8864152431488037
grad_norm: 2.557045763026252, clipped: 1.0
epoch: 29, train_batch_id: 1050, avg_cost: 3.9051198959350586
grad_norm: 2.4529438562664314, clipped: 1.0
epoch: 29, train_batch_id: 1100, avg_cost: 3.885798931121826
grad_norm: 3.544835194242177, clipped: 1.0
epoch: 29, train_batch_id: 1150, avg_cost: 3.897683620452881
grad_norm: 2.572730956437467, clipped: 1.0
epoch: 29, train_batch_id: 1200, avg_cost: 3.9051854610443115
grad_norm: 2.8175170866992207, clipped: 1.0
epoch: 29, train_batch_id: 1250, avg_cost: 3.88199520111084
grad_norm: 2.655478321062319, clipped: 1.0
epoch: 29, train_batch_id: 1300, avg_cost: 3.904284954071045
grad_norm: 4.152067153486187, clipped: 1.0
epoch: 29, train_batch_id: 1350, avg_cost: 3.9237265586853027
grad_norm: 3.977052090798416, clipped: 1.0
epoch: 29, train_batch_id: 1400, avg_cost: 3.8939945697784424
grad_norm: 2.3828943313306983, clipped: 1.0
epoch: 29, train_batch_id: 1450, avg_cost: 3.909391164779663
grad_norm: 2.7810261227339934, clipped: 1.0
epoch: 29, train_batch_id: 1500, avg_cost: 3.9306869506835938
grad_norm: 2.4987171589741775, clipped: 1.0
epoch: 29, train_batch_id: 1550, avg_cost: 3.9038872718811035
grad_norm: 2.2033321467091778, clipped: 1.0
epoch: 29, train_batch_id: 1600, avg_cost: 3.873094320297241
grad_norm: 2.2023516908896816, clipped: 1.0
epoch: 29, train_batch_id: 1650, avg_cost: 3.8748607635498047
grad_norm: 2.4934990001275956, clipped: 1.0
epoch: 29, train_batch_id: 1700, avg_cost: 3.949192523956299
grad_norm: 2.9917188887407664, clipped: 1.0
epoch: 29, train_batch_id: 1750, avg_cost: 3.9072494506835938
grad_norm: 2.181928077864203, clipped: 1.0
epoch: 29, train_batch_id: 1800, avg_cost: 3.900895118713379
grad_norm: 2.4159742872581895, clipped: 1.0
epoch: 29, train_batch_id: 1850, avg_cost: 3.9299662113189697
grad_norm: 1.9718790125007788, clipped: 1.0
epoch: 29, train_batch_id: 1900, avg_cost: 3.905580997467041
grad_norm: 2.8277714477949023, clipped: 1.0
epoch: 29, train_batch_id: 1950, avg_cost: 3.9145889282226562
grad_norm: 2.5833959247512417, clipped: 1.0
epoch: 29, train_batch_id: 2000, avg_cost: 3.9077844619750977
grad_norm: 2.5422182237750874, clipped: 1.0
epoch: 29, train_batch_id: 2050, avg_cost: 3.9060707092285156
grad_norm: 2.478474455836129, clipped: 1.0
epoch: 29, train_batch_id: 2100, avg_cost: 3.912830352783203
grad_norm: 2.360893698486802, clipped: 1.0
epoch: 29, train_batch_id: 2150, avg_cost: 3.932189464569092
grad_norm: 3.309800584498397, clipped: 1.0
epoch: 29, train_batch_id: 2200, avg_cost: 3.9103407859802246
grad_norm: 3.7618269547964234, clipped: 1.0
epoch: 29, train_batch_id: 2250, avg_cost: 3.890137195587158
grad_norm: 2.5260304748385822, clipped: 1.0
epoch: 29, train_batch_id: 2300, avg_cost: 3.8856077194213867
grad_norm: 2.1413957760303255, clipped: 1.0
epoch: 29, train_batch_id: 2350, avg_cost: 3.9294352531433105
grad_norm: 2.6308471915276583, clipped: 1.0
epoch: 29, train_batch_id: 2400, avg_cost: 3.9039182662963867
grad_norm: 2.909643692352137, clipped: 1.0
epoch: 29, train_batch_id: 2450, avg_cost: 3.914156913757324
grad_norm: 3.2545734493489062, clipped: 1.0
Finished epoch 29, took 00:09:26 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.306370735168457 +- 0.004075892735272646
Evaluating candidate model on evaluation dataset
Epoch 29 candidate mean 4.306476593017578, baseline epoch 26 mean 4.311145782470703, difference -0.004669189453125
p-value: 0.05799547265331251
Start train epoch 30, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


epoch: 30, train_batch_id: 0, avg_cost: 3.899221897125244
grad_norm: 2.9293883306217463, clipped: 1.0
epoch: 30, train_batch_id: 50, avg_cost: 3.894900321960449
grad_norm: 3.2604157116695536, clipped: 1.0
epoch: 30, train_batch_id: 100, avg_cost: 3.9207677841186523
grad_norm: 2.2676007789778367, clipped: 1.0
epoch: 30, train_batch_id: 150, avg_cost: 3.8860576152801514
grad_norm: 2.3701788324155175, clipped: 1.0
epoch: 30, train_batch_id: 200, avg_cost: 3.8955774307250977
grad_norm: 4.224786318512401, clipped: 1.0
epoch: 30, train_batch_id: 250, avg_cost: 3.9011168479919434
grad_norm: 2.9484853702117864, clipped: 1.0
epoch: 30, train_batch_id: 300, avg_cost: 3.8919267654418945
grad_norm: 3.2353486427587863, clipped: 1.0
epoch: 30, train_batch_id: 350, avg_cost: 3.8967623710632324
grad_norm: 1.9873784538074861, clipped: 1.0
epoch: 30, train_batch_id: 400, avg_cost: 3.903250217437744
grad_norm: 2.7540733076517454, clipped: 1.0
epoch: 30, train_batch_id: 450, avg_cost: 3.8862318992614746
grad_norm: 2.923251203272228, clipped: 1.0
epoch: 30, train_batch_id: 500, avg_cost: 3.8997886180877686
grad_norm: 2.8733629372783525, clipped: 1.0
epoch: 30, train_batch_id: 550, avg_cost: 3.8976404666900635
grad_norm: 3.2611324582791634, clipped: 1.0
epoch: 30, train_batch_id: 600, avg_cost: 3.916208505630493
grad_norm: 2.261037698130683, clipped: 1.0
epoch: 30, train_batch_id: 650, avg_cost: 3.896289825439453
grad_norm: 3.6044107612017817, clipped: 1.0
epoch: 30, train_batch_id: 700, avg_cost: 3.917405605316162
grad_norm: 2.8476806926446665, clipped: 1.0
epoch: 30, train_batch_id: 750, avg_cost: 3.9034337997436523
grad_norm: 3.435238871798066, clipped: 1.0
epoch: 30, train_batch_id: 800, avg_cost: 3.8932580947875977
grad_norm: 3.2447800206815494, clipped: 1.0
epoch: 30, train_batch_id: 850, avg_cost: 3.9134225845336914
grad_norm: 3.128784142923829, clipped: 1.0
epoch: 30, train_batch_id: 900, avg_cost: 3.9292075634002686
grad_norm: 2.5078541353167716, clipped: 1.0
epoch: 30, train_batch_id: 950, avg_cost: 3.9045968055725098
grad_norm: 2.27461666080435, clipped: 1.0
epoch: 30, train_batch_id: 1000, avg_cost: 3.9161343574523926
grad_norm: 1.958736273220127, clipped: 1.0
epoch: 30, train_batch_id: 1050, avg_cost: 3.9258928298950195
grad_norm: 2.531910500429105, clipped: 1.0
epoch: 30, train_batch_id: 1100, avg_cost: 3.9101152420043945
grad_norm: 2.4929859252092412, clipped: 1.0
epoch: 30, train_batch_id: 1150, avg_cost: 3.900007486343384
grad_norm: 2.628489606454079, clipped: 1.0
epoch: 30, train_batch_id: 1200, avg_cost: 3.8835244178771973
grad_norm: 3.0507858010968896, clipped: 1.0
epoch: 30, train_batch_id: 1250, avg_cost: 3.8841233253479004
grad_norm: 2.0003374115294603, clipped: 1.0
epoch: 30, train_batch_id: 1300, avg_cost: 3.9225211143493652
grad_norm: 2.738202380907442, clipped: 1.0
epoch: 30, train_batch_id: 1350, avg_cost: 3.917694091796875
grad_norm: 2.0762241835887867, clipped: 1.0
epoch: 30, train_batch_id: 1400, avg_cost: 3.875316619873047
grad_norm: 2.416797896694299, clipped: 1.0
epoch: 30, train_batch_id: 1450, avg_cost: 3.910677909851074
grad_norm: 7.34463715982221, clipped: 1.0
epoch: 30, train_batch_id: 1500, avg_cost: 3.9120028018951416
grad_norm: 2.2541419855133595, clipped: 1.0
epoch: 30, train_batch_id: 1550, avg_cost: 3.8912723064422607
grad_norm: 3.405806399703906, clipped: 1.0
epoch: 30, train_batch_id: 1600, avg_cost: 3.9252710342407227
grad_norm: 2.2651300254129962, clipped: 1.0
epoch: 30, train_batch_id: 1650, avg_cost: 3.8757548332214355
grad_norm: 3.0852729350811363, clipped: 1.0
epoch: 30, train_batch_id: 1700, avg_cost: 3.889225482940674
grad_norm: 3.8885486328464887, clipped: 1.0
epoch: 30, train_batch_id: 1750, avg_cost: 3.8836312294006348
grad_norm: 3.461101044032038, clipped: 1.0
epoch: 30, train_batch_id: 1800, avg_cost: 3.9126105308532715
grad_norm: 2.2818716665738243, clipped: 1.0
epoch: 30, train_batch_id: 1850, avg_cost: 3.9052038192749023
grad_norm: 2.9875517891031333, clipped: 1.0
epoch: 30, train_batch_id: 1900, avg_cost: 3.8851771354675293
grad_norm: 3.5427869535149394, clipped: 1.0
epoch: 30, train_batch_id: 1950, avg_cost: 3.904205083847046
grad_norm: 2.758501091085164, clipped: 1.0
epoch: 30, train_batch_id: 2000, avg_cost: 3.909834861755371
grad_norm: 2.887354846900154, clipped: 1.0
epoch: 30, train_batch_id: 2050, avg_cost: 3.9003963470458984
grad_norm: 2.6788171846057685, clipped: 1.0
epoch: 30, train_batch_id: 2100, avg_cost: 3.9081194400787354
grad_norm: 2.027231126339308, clipped: 1.0
epoch: 30, train_batch_id: 2150, avg_cost: 3.9020657539367676
grad_norm: 2.5268675166007166, clipped: 1.0
epoch: 30, train_batch_id: 2200, avg_cost: 3.9077038764953613
grad_norm: 3.44475624852038, clipped: 1.0
epoch: 30, train_batch_id: 2250, avg_cost: 3.9155220985412598
grad_norm: 2.5421880271293062, clipped: 1.0
epoch: 30, train_batch_id: 2300, avg_cost: 3.9353551864624023
grad_norm: 3.3329464457603466, clipped: 1.0
epoch: 30, train_batch_id: 2350, avg_cost: 3.8891804218292236
grad_norm: 3.2461324497898807, clipped: 1.0
epoch: 30, train_batch_id: 2400, avg_cost: 3.89943790435791
grad_norm: 2.6238224703354396, clipped: 1.0
epoch: 30, train_batch_id: 2450, avg_cost: 3.8930227756500244
grad_norm: 2.5697103355434097, clipped: 1.0
Finished epoch 30, took 00:09:24 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.341259956359863 +- 0.004260759800672531
Evaluating candidate model on evaluation dataset
Epoch 30 candidate mean 4.341679096221924, baseline epoch 26 mean 4.311145782470703, difference 0.030533313751220703
Start train epoch 31, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 31, train_batch_id: 0, avg_cost: 3.8712873458862305
grad_norm: 3.9189520083890526, clipped: 1.0
epoch: 31, train_batch_id: 50, avg_cost: 3.8968758583068848
grad_norm: 2.63084170316859, clipped: 1.0
epoch: 31, train_batch_id: 100, avg_cost: 3.928586006164551
grad_norm: 2.3563635931266296, clipped: 1.0
epoch: 31, train_batch_id: 150, avg_cost: 3.9203882217407227
grad_norm: 2.070785707809179, clipped: 1.0
epoch: 31, train_batch_id: 200, avg_cost: 3.9024434089660645
grad_norm: 2.3888529672620655, clipped: 1.0
epoch: 31, train_batch_id: 250, avg_cost: 3.89154314994812
grad_norm: 3.781137221731803, clipped: 1.0
epoch: 31, train_batch_id: 300, avg_cost: 3.9115676879882812
grad_norm: 2.5625149799826286, clipped: 1.0
epoch: 31, train_batch_id: 350, avg_cost: 3.9209225177764893
grad_norm: 2.6057752114440382, clipped: 1.0
epoch: 31, train_batch_id: 400, avg_cost: 3.8773245811462402
grad_norm: 2.095478704931588, clipped: 1.0
epoch: 31, train_batch_id: 450, avg_cost: 3.888922929763794
grad_norm: 3.226828881548325, clipped: 1.0
epoch: 31, train_batch_id: 500, avg_cost: 3.9017062187194824
grad_norm: 3.622696072585517, clipped: 1.0
epoch: 31, train_batch_id: 550, avg_cost: 3.8818776607513428
grad_norm: 3.3174693939486457, clipped: 1.0
epoch: 31, train_batch_id: 600, avg_cost: 3.8925113677978516
grad_norm: 2.4337506667703495, clipped: 1.0
epoch: 31, train_batch_id: 650, avg_cost: 3.899181604385376
grad_norm: 2.77195917816985, clipped: 1.0
epoch: 31, train_batch_id: 700, avg_cost: 3.9117937088012695
grad_norm: 2.703009153919698, clipped: 1.0
epoch: 31, train_batch_id: 750, avg_cost: 3.933032274246216
grad_norm: 2.290325741216533, clipped: 1.0
epoch: 31, train_batch_id: 800, avg_cost: 3.903560161590576
grad_norm: 2.666894932813775, clipped: 1.0
epoch: 31, train_batch_id: 850, avg_cost: 3.897970676422119
grad_norm: 2.639082705802998, clipped: 1.0
epoch: 31, train_batch_id: 900, avg_cost: 3.9040050506591797
grad_norm: 2.8824973705896286, clipped: 1.0
epoch: 31, train_batch_id: 950, avg_cost: 3.9158082008361816
grad_norm: 2.347156585891698, clipped: 1.0
epoch: 31, train_batch_id: 1000, avg_cost: 3.915930986404419
grad_norm: 2.965574177732401, clipped: 1.0
epoch: 31, train_batch_id: 1050, avg_cost: 3.90291690826416
grad_norm: 2.714810238463089, clipped: 1.0
epoch: 31, train_batch_id: 1100, avg_cost: 3.919158935546875
grad_norm: 1.917588201177049, clipped: 1.0
epoch: 31, train_batch_id: 1150, avg_cost: 3.8991386890411377
grad_norm: 3.23341878411577, clipped: 1.0
epoch: 31, train_batch_id: 1200, avg_cost: 3.948423385620117
grad_norm: 3.021196860162305, clipped: 1.0
epoch: 31, train_batch_id: 1250, avg_cost: 3.9025051593780518
grad_norm: 1.985515131474275, clipped: 1.0
epoch: 31, train_batch_id: 1300, avg_cost: 3.925875663757324
grad_norm: 1.9815673349898908, clipped: 1.0
epoch: 31, train_batch_id: 1350, avg_cost: 3.8859081268310547
grad_norm: 1.897228318257795, clipped: 1.0
epoch: 31, train_batch_id: 1400, avg_cost: 3.907543182373047
grad_norm: 2.7254034577330026, clipped: 1.0
epoch: 31, train_batch_id: 1450, avg_cost: 3.8926286697387695
grad_norm: 2.755187082047968, clipped: 1.0
epoch: 31, train_batch_id: 1500, avg_cost: 3.886460304260254
grad_norm: 3.7417819431528883, clipped: 1.0
epoch: 31, train_batch_id: 1550, avg_cost: 3.9023635387420654
grad_norm: 2.324218847472734, clipped: 1.0
epoch: 31, train_batch_id: 1600, avg_cost: 3.9020490646362305
grad_norm: 2.6525007454445255, clipped: 1.0
epoch: 31, train_batch_id: 1650, avg_cost: 3.8929247856140137
grad_norm: 2.388984349670884, clipped: 1.0
epoch: 31, train_batch_id: 1700, avg_cost: 3.9355406761169434
grad_norm: 2.349763364211389, clipped: 1.0
epoch: 31, train_batch_id: 1750, avg_cost: 3.9128241539001465
grad_norm: 3.195072239429627, clipped: 1.0
epoch: 31, train_batch_id: 1800, avg_cost: 3.92887020111084
grad_norm: 2.13224147019944, clipped: 1.0
epoch: 31, train_batch_id: 1850, avg_cost: 3.8564705848693848
grad_norm: 2.2275144173605925, clipped: 1.0
epoch: 31, train_batch_id: 1900, avg_cost: 3.9278218746185303
grad_norm: 3.0186518264320883, clipped: 1.0
epoch: 31, train_batch_id: 1950, avg_cost: 3.899172782897949
grad_norm: 3.8177645989731213, clipped: 1.0
epoch: 31, train_batch_id: 2000, avg_cost: 3.908315658569336
grad_norm: 2.8082440296750564, clipped: 1.0
epoch: 31, train_batch_id: 2050, avg_cost: 3.8951845169067383
grad_norm: 3.2372418727308245, clipped: 1.0
epoch: 31, train_batch_id: 2100, avg_cost: 3.9011619091033936
grad_norm: 2.5549526557851254, clipped: 1.0
epoch: 31, train_batch_id: 2150, avg_cost: 3.91987943649292
grad_norm: 2.5563145861324936, clipped: 1.0
epoch: 31, train_batch_id: 2200, avg_cost: 3.907231569290161
grad_norm: 3.534127797007549, clipped: 1.0
epoch: 31, train_batch_id: 2250, avg_cost: 3.882108211517334
grad_norm: 3.6233140166112454, clipped: 1.0
epoch: 31, train_batch_id: 2300, avg_cost: 3.909836769104004
grad_norm: 3.0066370669913893, clipped: 1.0
epoch: 31, train_batch_id: 2350, avg_cost: 3.8825230598449707
grad_norm: 3.736162491618018, clipped: 1.0
epoch: 31, train_batch_id: 2400, avg_cost: 3.922954797744751
grad_norm: 2.222074776993503, clipped: 1.0
epoch: 31, train_batch_id: 2450, avg_cost: 3.931046485900879
grad_norm: 1.8845885282918045, clipped: 1.0
Finished epoch 31, took 00:09:22 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.439947605133057 +- 0.005092242266982794
Evaluating candidate model on evaluation dataset
Epoch 31 candidate mean 4.442513465881348, baseline epoch 26 mean 4.311145782470703, difference 0.13136768341064453
Start train epoch 32, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


epoch: 32, train_batch_id: 0, avg_cost: 3.9449872970581055
grad_norm: 2.812440049209471, clipped: 1.0
epoch: 32, train_batch_id: 50, avg_cost: 3.9070305824279785
grad_norm: 2.3638590672031072, clipped: 1.0
epoch: 32, train_batch_id: 100, avg_cost: 3.8694586753845215
grad_norm: 2.8901129148546754, clipped: 1.0
epoch: 32, train_batch_id: 150, avg_cost: 3.912973165512085
grad_norm: 2.4861890422206065, clipped: 1.0
epoch: 32, train_batch_id: 200, avg_cost: 3.8950932025909424
grad_norm: 3.3727838792866858, clipped: 1.0
epoch: 32, train_batch_id: 250, avg_cost: 3.923628330230713
grad_norm: 4.87038924607407, clipped: 1.0
epoch: 32, train_batch_id: 300, avg_cost: 3.8854784965515137
grad_norm: 3.1133025221118134, clipped: 1.0
epoch: 32, train_batch_id: 350, avg_cost: 3.909393548965454
grad_norm: 3.0721583375897725, clipped: 1.0
epoch: 32, train_batch_id: 400, avg_cost: 3.9037137031555176
grad_norm: 3.553687542253179, clipped: 1.0
epoch: 32, train_batch_id: 450, avg_cost: 3.9017553329467773
grad_norm: 2.5389643152144794, clipped: 1.0
epoch: 32, train_batch_id: 500, avg_cost: 3.8880209922790527
grad_norm: 2.6603864529705064, clipped: 1.0
epoch: 32, train_batch_id: 550, avg_cost: 3.8858747482299805
grad_norm: 3.6823468296520603, clipped: 1.0
epoch: 32, train_batch_id: 600, avg_cost: 3.908329486846924
grad_norm: 2.1083817597383057, clipped: 1.0
epoch: 32, train_batch_id: 650, avg_cost: 3.9014530181884766
grad_norm: 2.761708326925853, clipped: 1.0
epoch: 32, train_batch_id: 700, avg_cost: 3.9300355911254883
grad_norm: 2.795292770013432, clipped: 1.0
epoch: 32, train_batch_id: 750, avg_cost: 3.9022464752197266
grad_norm: 2.253656730372341, clipped: 1.0
epoch: 32, train_batch_id: 800, avg_cost: 3.901038408279419
grad_norm: 2.829903278372288, clipped: 1.0
epoch: 32, train_batch_id: 850, avg_cost: 3.910012722015381
grad_norm: 2.269623403792519, clipped: 1.0
epoch: 32, train_batch_id: 900, avg_cost: 3.891019582748413
grad_norm: 2.4996280241601605, clipped: 1.0
epoch: 32, train_batch_id: 950, avg_cost: 3.9035632610321045
grad_norm: 2.2316860592592325, clipped: 1.0
epoch: 32, train_batch_id: 1000, avg_cost: 3.90840220451355
grad_norm: 2.3842242059090926, clipped: 1.0
epoch: 32, train_batch_id: 1050, avg_cost: 3.8915138244628906
grad_norm: 2.4779424962219294, clipped: 1.0
epoch: 32, train_batch_id: 1100, avg_cost: 3.916490077972412
grad_norm: 3.039151672251329, clipped: 1.0
epoch: 32, train_batch_id: 1150, avg_cost: 3.882516384124756
grad_norm: 3.275491702248895, clipped: 1.0
epoch: 32, train_batch_id: 1200, avg_cost: 3.937052011489868
grad_norm: 2.568120485385518, clipped: 1.0
epoch: 32, train_batch_id: 1250, avg_cost: 3.9035000801086426
grad_norm: 3.3992295545679774, clipped: 1.0
epoch: 32, train_batch_id: 1300, avg_cost: 3.9062819480895996
grad_norm: 2.833951014539363, clipped: 1.0
epoch: 32, train_batch_id: 1350, avg_cost: 3.885559558868408
grad_norm: 2.982850221478069, clipped: 1.0
epoch: 32, train_batch_id: 1400, avg_cost: 3.9296369552612305
grad_norm: 3.9032640595463226, clipped: 1.0
epoch: 32, train_batch_id: 1450, avg_cost: 3.9206576347351074
grad_norm: 2.7452091092928312, clipped: 1.0
epoch: 32, train_batch_id: 1500, avg_cost: 3.9196295738220215
grad_norm: 2.8616538891616, clipped: 1.0
epoch: 32, train_batch_id: 1550, avg_cost: 3.8854801654815674
grad_norm: 2.132113192261278, clipped: 1.0
epoch: 32, train_batch_id: 1600, avg_cost: 3.8760533332824707
grad_norm: 2.271881371617882, clipped: 1.0
epoch: 32, train_batch_id: 1650, avg_cost: 3.9056875705718994
grad_norm: 2.519435156200458, clipped: 1.0
epoch: 32, train_batch_id: 1700, avg_cost: 3.9161276817321777
grad_norm: 3.044266061982862, clipped: 1.0
epoch: 32, train_batch_id: 1750, avg_cost: 3.8927574157714844
grad_norm: 2.936077684007818, clipped: 1.0
epoch: 32, train_batch_id: 1800, avg_cost: 3.8618004322052
grad_norm: 1.9501788182641766, clipped: 1.0
epoch: 32, train_batch_id: 1850, avg_cost: 3.901580810546875
grad_norm: 2.1049449517394185, clipped: 1.0
epoch: 32, train_batch_id: 1900, avg_cost: 3.8884429931640625
grad_norm: 2.2912403265190817, clipped: 1.0
epoch: 32, train_batch_id: 1950, avg_cost: 3.9162001609802246
grad_norm: 4.637526356694034, clipped: 1.0
epoch: 32, train_batch_id: 2000, avg_cost: 3.8865976333618164
grad_norm: 1.9854208883024453, clipped: 1.0
epoch: 32, train_batch_id: 2050, avg_cost: 3.936630964279175
grad_norm: 3.6743137310840877, clipped: 1.0
epoch: 32, train_batch_id: 2100, avg_cost: 3.875943660736084
grad_norm: 3.671939456120185, clipped: 1.0
epoch: 32, train_batch_id: 2150, avg_cost: 3.8983192443847656
grad_norm: 3.012670463638362, clipped: 1.0
epoch: 32, train_batch_id: 2200, avg_cost: 3.9117863178253174
grad_norm: 2.9436249457674264, clipped: 1.0
epoch: 32, train_batch_id: 2250, avg_cost: 3.8982911109924316
grad_norm: 4.0078525076938405, clipped: 1.0
epoch: 32, train_batch_id: 2300, avg_cost: 3.9021811485290527
grad_norm: 2.2213541609218077, clipped: 1.0
epoch: 32, train_batch_id: 2350, avg_cost: 3.8932483196258545
grad_norm: 2.3067927865023594, clipped: 1.0
epoch: 32, train_batch_id: 2400, avg_cost: 3.8645668029785156
grad_norm: 1.964913643029416, clipped: 1.0
epoch: 32, train_batch_id: 2450, avg_cost: 3.914095640182495
grad_norm: 2.1228401132236425, clipped: 1.0
Finished epoch 32, took 00:09:24 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.373558044433594 +- 0.004301972687244415
Evaluating candidate model on evaluation dataset
Epoch 32 candidate mean 4.378324508666992, baseline epoch 26 mean 4.311145782470703, difference 0.06717872619628906
Start train epoch 33, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 33, train_batch_id: 0, avg_cost: 3.8801355361938477
grad_norm: 2.133456918775309, clipped: 1.0
epoch: 33, train_batch_id: 50, avg_cost: 3.883479356765747
grad_norm: 4.764089651955988, clipped: 1.0
epoch: 33, train_batch_id: 100, avg_cost: 3.894195795059204
grad_norm: 2.302774034475563, clipped: 1.0
epoch: 33, train_batch_id: 150, avg_cost: 3.920227289199829
grad_norm: 4.369228034113687, clipped: 1.0
epoch: 33, train_batch_id: 200, avg_cost: 3.923274517059326
grad_norm: 2.5895002114601957, clipped: 1.0
epoch: 33, train_batch_id: 250, avg_cost: 3.8873207569122314
grad_norm: 2.8287432448072636, clipped: 1.0
epoch: 33, train_batch_id: 300, avg_cost: 3.902860641479492
grad_norm: 3.4647572869424708, clipped: 1.0
epoch: 33, train_batch_id: 350, avg_cost: 3.929777145385742
grad_norm: 2.9640551423873496, clipped: 1.0
epoch: 33, train_batch_id: 400, avg_cost: 3.8944778442382812
grad_norm: 2.8688262302782617, clipped: 1.0
epoch: 33, train_batch_id: 450, avg_cost: 3.9057161808013916
grad_norm: 2.7341606465018073, clipped: 1.0
epoch: 33, train_batch_id: 500, avg_cost: 3.893325090408325
grad_norm: 3.277782963105764, clipped: 1.0
epoch: 33, train_batch_id: 550, avg_cost: 3.907701015472412
grad_norm: 2.6913153904209692, clipped: 1.0
epoch: 33, train_batch_id: 600, avg_cost: 3.906144857406616
grad_norm: 2.035137521977439, clipped: 1.0
epoch: 33, train_batch_id: 650, avg_cost: 3.889535427093506
grad_norm: 2.7808079996054427, clipped: 1.0
epoch: 33, train_batch_id: 700, avg_cost: 3.9031319618225098
grad_norm: 3.523729045440793, clipped: 1.0
epoch: 33, train_batch_id: 750, avg_cost: 3.913825273513794
grad_norm: 2.3623776558787006, clipped: 1.0
epoch: 33, train_batch_id: 800, avg_cost: 3.8645834922790527
grad_norm: 2.533561788520679, clipped: 1.0
epoch: 33, train_batch_id: 850, avg_cost: 3.9124622344970703
grad_norm: 2.2829738211519066, clipped: 1.0
epoch: 33, train_batch_id: 900, avg_cost: 3.896963357925415
grad_norm: 2.756624214689669, clipped: 1.0
epoch: 33, train_batch_id: 950, avg_cost: 3.9069318771362305
grad_norm: 2.4555662370271443, clipped: 1.0
epoch: 33, train_batch_id: 1000, avg_cost: 3.906981945037842
grad_norm: 2.5099682829226064, clipped: 1.0
epoch: 33, train_batch_id: 1050, avg_cost: 3.905498504638672
grad_norm: 2.302545883752357, clipped: 1.0
epoch: 33, train_batch_id: 1100, avg_cost: 3.9033288955688477
grad_norm: 2.738665470298207, clipped: 1.0
epoch: 33, train_batch_id: 1150, avg_cost: 3.9057750701904297
grad_norm: 2.461432700254136, clipped: 1.0
epoch: 33, train_batch_id: 1200, avg_cost: 3.9489264488220215
grad_norm: 2.4345801908851414, clipped: 1.0
epoch: 33, train_batch_id: 1250, avg_cost: 3.9123692512512207
grad_norm: 5.171477444433619, clipped: 1.0
epoch: 33, train_batch_id: 1300, avg_cost: 3.9033172130584717
grad_norm: 1.5736579136326148, clipped: 1.0
epoch: 33, train_batch_id: 1350, avg_cost: 3.902097225189209
grad_norm: 2.434667742882486, clipped: 1.0
epoch: 33, train_batch_id: 1400, avg_cost: 3.9069652557373047
grad_norm: 2.6273944683770893, clipped: 1.0
epoch: 33, train_batch_id: 1450, avg_cost: 3.918707847595215
grad_norm: 5.323787955738132, clipped: 1.0
epoch: 33, train_batch_id: 1500, avg_cost: 3.8914096355438232
grad_norm: 3.2832547351974926, clipped: 1.0
epoch: 33, train_batch_id: 1550, avg_cost: 3.906252384185791
grad_norm: 3.202599976368096, clipped: 1.0
epoch: 33, train_batch_id: 1600, avg_cost: 3.8970327377319336
grad_norm: 2.492414201508246, clipped: 1.0
epoch: 33, train_batch_id: 1650, avg_cost: 3.8868374824523926
grad_norm: 3.8133725011857997, clipped: 1.0
epoch: 33, train_batch_id: 1700, avg_cost: 3.9223809242248535
grad_norm: 2.76671010116306, clipped: 1.0
epoch: 33, train_batch_id: 1750, avg_cost: 3.913236618041992
grad_norm: 2.7975509422019673, clipped: 1.0
epoch: 33, train_batch_id: 1800, avg_cost: 3.899919033050537
grad_norm: 3.9732629795639895, clipped: 1.0
epoch: 33, train_batch_id: 1850, avg_cost: 3.9126288890838623
grad_norm: 2.4015031884340012, clipped: 1.0
epoch: 33, train_batch_id: 1900, avg_cost: 3.8978052139282227
grad_norm: 2.3959368140038038, clipped: 1.0
epoch: 33, train_batch_id: 1950, avg_cost: 3.8888003826141357
grad_norm: 3.2351809158259006, clipped: 1.0
epoch: 33, train_batch_id: 2000, avg_cost: 3.895754814147949
grad_norm: 3.4796386003460436, clipped: 1.0
epoch: 33, train_batch_id: 2050, avg_cost: 3.8967363834381104
grad_norm: 3.134892668444879, clipped: 1.0
epoch: 33, train_batch_id: 2100, avg_cost: 3.8879804611206055
grad_norm: 2.1537894729612015, clipped: 1.0
epoch: 33, train_batch_id: 2150, avg_cost: 3.889033079147339
grad_norm: 2.662646992295632, clipped: 1.0
epoch: 33, train_batch_id: 2200, avg_cost: 3.889543056488037
grad_norm: 3.4500819154036115, clipped: 1.0
epoch: 33, train_batch_id: 2250, avg_cost: 3.895364284515381
grad_norm: 2.5587263517331675, clipped: 1.0
epoch: 33, train_batch_id: 2300, avg_cost: 3.915414333343506
grad_norm: 2.7576921771818808, clipped: 1.0
epoch: 33, train_batch_id: 2350, avg_cost: 3.9122071266174316
grad_norm: 2.169390828005117, clipped: 1.0
epoch: 33, train_batch_id: 2400, avg_cost: 3.8804078102111816
grad_norm: 3.4840253291366063, clipped: 1.0
epoch: 33, train_batch_id: 2450, avg_cost: 3.8577041625976562
grad_norm: 2.1534360552718166, clipped: 1.0
Finished epoch 33, took 00:09:28 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.358382225036621 +- 0.004501321818679571
Evaluating candidate model on evaluation dataset
Epoch 33 candidate mean 4.361417770385742, baseline epoch 26 mean 4.311145782470703, difference 0.05027198791503906
Start train epoch 34, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


epoch: 34, train_batch_id: 0, avg_cost: 3.9039900302886963
grad_norm: 2.7941014548441867, clipped: 1.0
epoch: 34, train_batch_id: 50, avg_cost: 3.890634059906006
grad_norm: 2.6923638589367327, clipped: 1.0
epoch: 34, train_batch_id: 100, avg_cost: 3.9194655418395996
grad_norm: 2.729312294790254, clipped: 1.0
epoch: 34, train_batch_id: 150, avg_cost: 3.897076368331909
grad_norm: 2.710694927446418, clipped: 1.0
epoch: 34, train_batch_id: 200, avg_cost: 3.907728910446167
grad_norm: 3.430314505439389, clipped: 1.0
epoch: 34, train_batch_id: 250, avg_cost: 3.903449535369873
grad_norm: 4.216696042064898, clipped: 1.0
epoch: 34, train_batch_id: 300, avg_cost: 3.8969006538391113
grad_norm: 2.5678722759986883, clipped: 1.0
epoch: 34, train_batch_id: 350, avg_cost: 3.890580177307129
grad_norm: 2.5628654506684634, clipped: 1.0
epoch: 34, train_batch_id: 400, avg_cost: 3.9081521034240723
grad_norm: 2.6101814858423995, clipped: 1.0
epoch: 34, train_batch_id: 450, avg_cost: 3.8890843391418457
grad_norm: 2.993678290082333, clipped: 1.0
epoch: 34, train_batch_id: 500, avg_cost: 3.902198314666748
grad_norm: 3.1960670224687067, clipped: 1.0
epoch: 34, train_batch_id: 550, avg_cost: 3.9093480110168457
grad_norm: 2.4037915126365386, clipped: 1.0
epoch: 34, train_batch_id: 600, avg_cost: 3.9102182388305664
grad_norm: 4.683738097334178, clipped: 1.0
epoch: 34, train_batch_id: 650, avg_cost: 3.903534173965454
grad_norm: 3.0758798113610872, clipped: 1.0
epoch: 34, train_batch_id: 700, avg_cost: 3.925441026687622
grad_norm: 3.533882901931852, clipped: 1.0
epoch: 34, train_batch_id: 750, avg_cost: 3.894021511077881
grad_norm: 2.0536822009730895, clipped: 1.0
epoch: 34, train_batch_id: 800, avg_cost: 3.9145216941833496
grad_norm: 2.315598436046441, clipped: 1.0
epoch: 34, train_batch_id: 850, avg_cost: 3.9204821586608887
grad_norm: 3.7987272649986936, clipped: 1.0
epoch: 34, train_batch_id: 900, avg_cost: 3.897128105163574
grad_norm: 3.310312350747487, clipped: 1.0
epoch: 34, train_batch_id: 950, avg_cost: 3.9030301570892334
grad_norm: 2.59578217072062, clipped: 1.0
epoch: 34, train_batch_id: 1000, avg_cost: 3.8946831226348877
grad_norm: 3.369954443637955, clipped: 1.0
epoch: 34, train_batch_id: 1050, avg_cost: 3.924764633178711
grad_norm: 2.932747697279969, clipped: 1.0
epoch: 34, train_batch_id: 1100, avg_cost: 3.8919670581817627
grad_norm: 2.2700868010545663, clipped: 1.0
epoch: 34, train_batch_id: 1150, avg_cost: 3.9093973636627197
grad_norm: 2.594864904432203, clipped: 1.0
epoch: 34, train_batch_id: 1200, avg_cost: 3.906665325164795
grad_norm: 2.985709611944696, clipped: 1.0
epoch: 34, train_batch_id: 1250, avg_cost: 3.8921051025390625
grad_norm: 2.9155046103350473, clipped: 1.0
epoch: 34, train_batch_id: 1300, avg_cost: 3.9130098819732666
grad_norm: 2.557771310516987, clipped: 1.0
epoch: 34, train_batch_id: 1350, avg_cost: 3.906672716140747
grad_norm: 2.9187896257643686, clipped: 1.0
epoch: 34, train_batch_id: 1400, avg_cost: 3.906383991241455
grad_norm: 2.163172623462718, clipped: 1.0
epoch: 34, train_batch_id: 1450, avg_cost: 3.8582816123962402
grad_norm: 2.317982982779168, clipped: 1.0
epoch: 34, train_batch_id: 1500, avg_cost: 3.8672616481781006
grad_norm: 1.976883318103966, clipped: 1.0
epoch: 34, train_batch_id: 1550, avg_cost: 3.912858009338379
grad_norm: 3.0191237541640636, clipped: 1.0
epoch: 34, train_batch_id: 1600, avg_cost: 3.9300079345703125
grad_norm: 3.3453320022147146, clipped: 1.0
epoch: 34, train_batch_id: 1650, avg_cost: 3.9034647941589355
grad_norm: 1.8792021373465533, clipped: 1.0
epoch: 34, train_batch_id: 1700, avg_cost: 3.8821682929992676
grad_norm: 2.0868214164398817, clipped: 1.0
epoch: 34, train_batch_id: 1750, avg_cost: 3.8902230262756348
grad_norm: 2.469893053052246, clipped: 1.0
epoch: 34, train_batch_id: 1800, avg_cost: 3.883270502090454
grad_norm: 2.341087716139927, clipped: 1.0
epoch: 34, train_batch_id: 1850, avg_cost: 3.918879508972168
grad_norm: 3.4973808157237536, clipped: 1.0
epoch: 34, train_batch_id: 1900, avg_cost: 3.900540828704834
grad_norm: 2.653194327278529, clipped: 1.0
epoch: 34, train_batch_id: 1950, avg_cost: 3.8991808891296387
grad_norm: 2.5622503245830552, clipped: 1.0
epoch: 34, train_batch_id: 2000, avg_cost: 3.86987042427063
grad_norm: 2.489486327768476, clipped: 1.0
epoch: 34, train_batch_id: 2050, avg_cost: 3.871601104736328
grad_norm: 3.2528974664022194, clipped: 1.0
epoch: 34, train_batch_id: 2100, avg_cost: 3.8880016803741455
grad_norm: 3.2319853898118613, clipped: 1.0
epoch: 34, train_batch_id: 2150, avg_cost: 3.8964016437530518
grad_norm: 3.291819324625651, clipped: 1.0
epoch: 34, train_batch_id: 2200, avg_cost: 3.883042335510254
grad_norm: 2.5213549476257207, clipped: 1.0
epoch: 34, train_batch_id: 2250, avg_cost: 3.940737247467041
grad_norm: 4.367994777771485, clipped: 1.0
epoch: 34, train_batch_id: 2300, avg_cost: 3.891360282897949
grad_norm: 3.0024809601737545, clipped: 1.0
epoch: 34, train_batch_id: 2350, avg_cost: 3.903001308441162
grad_norm: 3.222363950883405, clipped: 1.0
epoch: 34, train_batch_id: 2400, avg_cost: 3.8651680946350098
grad_norm: 4.537993420598297, clipped: 1.0
epoch: 34, train_batch_id: 2450, avg_cost: 3.8975114822387695
grad_norm: 2.8130643954242607, clipped: 1.0
Finished epoch 34, took 00:09:24 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.318136692047119 +- 0.0041108145378530025
Evaluating candidate model on evaluation dataset
Epoch 34 candidate mean 4.322083950042725, baseline epoch 26 mean 4.311145782470703, difference 0.010938167572021484
Start train epoch 35, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 35, train_batch_id: 0, avg_cost: 3.93700909614563
grad_norm: 2.3320130428405736, clipped: 1.0
epoch: 35, train_batch_id: 50, avg_cost: 3.8962817192077637
grad_norm: 3.287056585598656, clipped: 1.0
epoch: 35, train_batch_id: 100, avg_cost: 3.925088882446289
grad_norm: 2.7829413937991916, clipped: 1.0
epoch: 35, train_batch_id: 150, avg_cost: 3.911065101623535
grad_norm: 3.334238170326547, clipped: 1.0
epoch: 35, train_batch_id: 200, avg_cost: 3.8884358406066895
grad_norm: 1.9824772576760232, clipped: 1.0
epoch: 35, train_batch_id: 250, avg_cost: 3.9041686058044434
grad_norm: 2.0338197851957136, clipped: 1.0
epoch: 35, train_batch_id: 300, avg_cost: 3.8914542198181152
grad_norm: 3.6639014340515974, clipped: 1.0
epoch: 35, train_batch_id: 350, avg_cost: 3.891720771789551
grad_norm: 2.775852882557978, clipped: 1.0
epoch: 35, train_batch_id: 400, avg_cost: 3.8951685428619385
grad_norm: 2.005960122518784, clipped: 1.0
epoch: 35, train_batch_id: 450, avg_cost: 3.888901472091675
grad_norm: 2.183047142594072, clipped: 1.0
epoch: 35, train_batch_id: 500, avg_cost: 3.900282621383667
grad_norm: 3.024336849980128, clipped: 1.0
epoch: 35, train_batch_id: 550, avg_cost: 3.90987491607666
grad_norm: 2.7908921854301334, clipped: 1.0
epoch: 35, train_batch_id: 600, avg_cost: 3.9235644340515137
grad_norm: 2.51048406003509, clipped: 1.0
epoch: 35, train_batch_id: 650, avg_cost: 3.92978572845459
grad_norm: 3.1483900639942966, clipped: 1.0
epoch: 35, train_batch_id: 700, avg_cost: 3.9052085876464844
grad_norm: 2.61826648783169, clipped: 1.0
epoch: 35, train_batch_id: 750, avg_cost: 3.8725926876068115
grad_norm: 2.162451681040119, clipped: 1.0
epoch: 35, train_batch_id: 800, avg_cost: 3.897066116333008
grad_norm: 2.3980720644673523, clipped: 1.0
epoch: 35, train_batch_id: 850, avg_cost: 3.8865678310394287
grad_norm: 2.5119377733278476, clipped: 1.0
epoch: 35, train_batch_id: 900, avg_cost: 3.8937792778015137
grad_norm: 4.94293390940055, clipped: 1.0
epoch: 35, train_batch_id: 950, avg_cost: 3.8964686393737793
grad_norm: 2.782542104248001, clipped: 1.0
epoch: 35, train_batch_id: 1000, avg_cost: 3.899623394012451
grad_norm: 2.9311207806760686, clipped: 1.0
epoch: 35, train_batch_id: 1050, avg_cost: 3.900625705718994
grad_norm: 2.6412903096074776, clipped: 1.0
epoch: 35, train_batch_id: 1100, avg_cost: 3.890671730041504
grad_norm: 2.0256633877939607, clipped: 1.0
epoch: 35, train_batch_id: 1150, avg_cost: 3.9148340225219727
grad_norm: 2.605670687889771, clipped: 1.0
epoch: 35, train_batch_id: 1200, avg_cost: 3.9019947052001953
grad_norm: 3.1309273426805557, clipped: 1.0
epoch: 35, train_batch_id: 1250, avg_cost: 3.885097026824951
grad_norm: 2.220591811948962, clipped: 1.0
epoch: 35, train_batch_id: 1300, avg_cost: 3.9162445068359375
grad_norm: 2.249840725042808, clipped: 1.0
epoch: 35, train_batch_id: 1350, avg_cost: 3.8970346450805664
grad_norm: 2.9491433229928385, clipped: 1.0
epoch: 35, train_batch_id: 1400, avg_cost: 3.9139342308044434
grad_norm: 4.0634487613013714, clipped: 1.0
epoch: 35, train_batch_id: 1450, avg_cost: 3.906003952026367
grad_norm: 3.019525360369884, clipped: 1.0
epoch: 35, train_batch_id: 1500, avg_cost: 3.89793062210083
grad_norm: 3.0465649085079893, clipped: 1.0
epoch: 35, train_batch_id: 1550, avg_cost: 3.908127546310425
grad_norm: 2.6952717971068254, clipped: 1.0
epoch: 35, train_batch_id: 1600, avg_cost: 3.8878414630889893
grad_norm: 1.9834116267183672, clipped: 1.0
epoch: 35, train_batch_id: 1650, avg_cost: 3.9089455604553223
grad_norm: 2.8017798278039208, clipped: 1.0
epoch: 35, train_batch_id: 1700, avg_cost: 3.9082584381103516
grad_norm: 2.170549199373557, clipped: 1.0
epoch: 35, train_batch_id: 1750, avg_cost: 3.8855347633361816
grad_norm: 3.7658893828465563, clipped: 1.0
epoch: 35, train_batch_id: 1800, avg_cost: 3.9035720825195312
grad_norm: 3.044169192044672, clipped: 1.0
epoch: 35, train_batch_id: 1850, avg_cost: 3.880880355834961
grad_norm: 4.022254361602209, clipped: 1.0
epoch: 35, train_batch_id: 1900, avg_cost: 3.912616491317749
grad_norm: 2.9226075652558485, clipped: 1.0
epoch: 35, train_batch_id: 1950, avg_cost: 3.925691604614258
grad_norm: 1.922876885332412, clipped: 1.0
epoch: 35, train_batch_id: 2000, avg_cost: 3.882882595062256
grad_norm: 3.001932042413606, clipped: 1.0
epoch: 35, train_batch_id: 2050, avg_cost: 3.8823728561401367
grad_norm: 3.309660200702505, clipped: 1.0
epoch: 35, train_batch_id: 2100, avg_cost: 3.905773878097534
grad_norm: 2.840273321276797, clipped: 1.0
epoch: 35, train_batch_id: 2150, avg_cost: 3.891988754272461
grad_norm: 2.1748243349389083, clipped: 1.0
epoch: 35, train_batch_id: 2200, avg_cost: 3.886241912841797
grad_norm: 2.8113978110226276, clipped: 1.0
epoch: 35, train_batch_id: 2250, avg_cost: 3.888106346130371
grad_norm: 2.9387549439783083, clipped: 1.0
epoch: 35, train_batch_id: 2300, avg_cost: 3.8940482139587402
grad_norm: 2.244255983523582, clipped: 1.0
epoch: 35, train_batch_id: 2350, avg_cost: 3.868424892425537
grad_norm: 3.997769233059515, clipped: 1.0
epoch: 35, train_batch_id: 2400, avg_cost: 3.898037910461426
grad_norm: 3.002445157511916, clipped: 1.0
epoch: 35, train_batch_id: 2450, avg_cost: 3.901369333267212
grad_norm: 8.17035288314834, clipped: 1.0
Finished epoch 35, took 00:09:27 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.282806873321533 +- 0.004085880238562822
Evaluating candidate model on evaluation dataset
Epoch 35 candidate mean 4.282024383544922, baseline epoch 26 mean 4.311145782470703, difference -0.02912139892578125
p-value: 3.2231030059883695e-26
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 36, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


epoch: 36, train_batch_id: 0, avg_cost: 3.904071092605591
grad_norm: 1.9763418584517847, clipped: 1.0
epoch: 36, train_batch_id: 50, avg_cost: 3.9044368267059326
grad_norm: 2.517947039219208, clipped: 1.0
epoch: 36, train_batch_id: 100, avg_cost: 3.897010326385498
grad_norm: 2.607166604562048, clipped: 1.0
epoch: 36, train_batch_id: 150, avg_cost: 3.881626605987549
grad_norm: 2.539227897971714, clipped: 1.0
epoch: 36, train_batch_id: 200, avg_cost: 3.881133556365967
grad_norm: 2.0123630021396868, clipped: 1.0
epoch: 36, train_batch_id: 250, avg_cost: 3.8885865211486816
grad_norm: 3.3637511939021447, clipped: 1.0
epoch: 36, train_batch_id: 300, avg_cost: 3.92110013961792
grad_norm: 1.9064878935933192, clipped: 1.0
epoch: 36, train_batch_id: 350, avg_cost: 3.8847849369049072
grad_norm: 2.183897209083988, clipped: 1.0
epoch: 36, train_batch_id: 400, avg_cost: 3.898738384246826
grad_norm: 2.0090507934398825, clipped: 1.0
epoch: 36, train_batch_id: 450, avg_cost: 3.887589931488037
grad_norm: 2.0672686424078552, clipped: 1.0
epoch: 36, train_batch_id: 500, avg_cost: 3.9132862091064453
grad_norm: 2.1705964935959505, clipped: 1.0
epoch: 36, train_batch_id: 550, avg_cost: 3.902806282043457
grad_norm: 2.9053176299082963, clipped: 1.0
epoch: 36, train_batch_id: 600, avg_cost: 3.876995325088501
grad_norm: 3.413014575669213, clipped: 1.0
epoch: 36, train_batch_id: 650, avg_cost: 3.920379400253296
grad_norm: 2.4065286461958606, clipped: 1.0
epoch: 36, train_batch_id: 700, avg_cost: 3.9033515453338623
grad_norm: 2.390883739382089, clipped: 1.0
epoch: 36, train_batch_id: 750, avg_cost: 3.896238327026367
grad_norm: 4.012974147437261, clipped: 1.0
epoch: 36, train_batch_id: 800, avg_cost: 3.9020824432373047
grad_norm: 3.7925926327155697, clipped: 1.0
epoch: 36, train_batch_id: 850, avg_cost: 3.919194459915161
grad_norm: 3.3482882606324407, clipped: 1.0
epoch: 36, train_batch_id: 900, avg_cost: 3.8802967071533203
grad_norm: 4.096108154601529, clipped: 1.0
epoch: 36, train_batch_id: 950, avg_cost: 3.912580728530884
grad_norm: 2.803998479898186, clipped: 1.0
epoch: 36, train_batch_id: 1000, avg_cost: 3.8933706283569336
grad_norm: 2.7602769186023433, clipped: 1.0
epoch: 36, train_batch_id: 1050, avg_cost: 3.8816866874694824
grad_norm: 2.170763477080567, clipped: 1.0
epoch: 36, train_batch_id: 1100, avg_cost: 3.8888580799102783
grad_norm: 2.602609790422274, clipped: 1.0
epoch: 36, train_batch_id: 1150, avg_cost: 3.884859085083008
grad_norm: 2.312551226121808, clipped: 1.0
epoch: 36, train_batch_id: 1200, avg_cost: 3.9093689918518066
grad_norm: 3.4512394356815848, clipped: 1.0
epoch: 36, train_batch_id: 1250, avg_cost: 3.8963141441345215
grad_norm: 2.223332172136969, clipped: 1.0
epoch: 36, train_batch_id: 1300, avg_cost: 3.8883516788482666
grad_norm: 2.3425368756859886, clipped: 1.0
epoch: 36, train_batch_id: 1350, avg_cost: 3.900602340698242
grad_norm: 2.228696861176235, clipped: 1.0
epoch: 36, train_batch_id: 1400, avg_cost: 3.917318105697632
grad_norm: 2.3573669537358373, clipped: 1.0
epoch: 36, train_batch_id: 1450, avg_cost: 3.890404462814331
grad_norm: 1.6763983652756447, clipped: 1.0
epoch: 36, train_batch_id: 1500, avg_cost: 3.8993399143218994
grad_norm: 2.2051811549271303, clipped: 1.0
epoch: 36, train_batch_id: 1550, avg_cost: 3.90348482131958
grad_norm: 2.8119562475676343, clipped: 1.0
epoch: 36, train_batch_id: 1600, avg_cost: 3.8953802585601807
grad_norm: 2.1078198352392556, clipped: 1.0
epoch: 36, train_batch_id: 1650, avg_cost: 3.8853235244750977
grad_norm: 1.869975182116773, clipped: 1.0
epoch: 36, train_batch_id: 1700, avg_cost: 3.900430202484131
grad_norm: 2.3161744632265915, clipped: 1.0
epoch: 36, train_batch_id: 1750, avg_cost: 3.8987441062927246
grad_norm: 2.9585913158682953, clipped: 1.0
epoch: 36, train_batch_id: 1800, avg_cost: 3.8989925384521484
grad_norm: 3.369870666778862, clipped: 1.0
epoch: 36, train_batch_id: 1850, avg_cost: 3.868082046508789
grad_norm: 2.583124546529317, clipped: 1.0
epoch: 36, train_batch_id: 1900, avg_cost: 3.898766040802002
grad_norm: 2.248380510471867, clipped: 1.0
epoch: 36, train_batch_id: 1950, avg_cost: 3.900308132171631
grad_norm: 2.5324922843475535, clipped: 1.0
epoch: 36, train_batch_id: 2000, avg_cost: 3.901400566101074
grad_norm: 2.5606639131089084, clipped: 1.0
epoch: 36, train_batch_id: 2050, avg_cost: 3.9310221672058105
grad_norm: 3.457342814355355, clipped: 1.0
epoch: 36, train_batch_id: 2100, avg_cost: 3.903632164001465
grad_norm: 3.301220204547146, clipped: 1.0
epoch: 36, train_batch_id: 2150, avg_cost: 3.8881759643554688
grad_norm: 2.346427439696567, clipped: 1.0
epoch: 36, train_batch_id: 2200, avg_cost: 3.8847503662109375
grad_norm: 2.6672534138220336, clipped: 1.0
epoch: 36, train_batch_id: 2250, avg_cost: 3.889763832092285
grad_norm: 2.079607059747014, clipped: 1.0
epoch: 36, train_batch_id: 2300, avg_cost: 3.905498743057251
grad_norm: 2.927006454531778, clipped: 1.0
epoch: 36, train_batch_id: 2350, avg_cost: 3.885758638381958
grad_norm: 4.904890405834754, clipped: 1.0
epoch: 36, train_batch_id: 2400, avg_cost: 3.899139881134033
grad_norm: 1.790875755567347, clipped: 1.0
epoch: 36, train_batch_id: 2450, avg_cost: 3.9219586849212646
grad_norm: 2.360836725383526, clipped: 1.0
Finished epoch 36, took 00:09:24 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.254479885101318 +- 0.003992740996181965
Evaluating candidate model on evaluation dataset
Epoch 36 candidate mean 4.257394313812256, baseline epoch 35 mean 4.280114650726318, difference -0.0227203369140625
p-value: 4.4569899116514495e-18
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 37, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 37, train_batch_id: 0, avg_cost: 3.8735337257385254
grad_norm: 2.3478497514474017, clipped: 1.0
epoch: 37, train_batch_id: 50, avg_cost: 3.8979849815368652
grad_norm: 1.621815735898365, clipped: 1.0
epoch: 37, train_batch_id: 100, avg_cost: 3.8974618911743164
grad_norm: 1.7219030010752578, clipped: 1.0
epoch: 37, train_batch_id: 150, avg_cost: 3.9105777740478516
grad_norm: 1.9453688606552284, clipped: 1.0
epoch: 37, train_batch_id: 200, avg_cost: 3.896700859069824
grad_norm: 2.0245856130531523, clipped: 1.0
epoch: 37, train_batch_id: 250, avg_cost: 3.903559923171997
grad_norm: 2.5606065370687516, clipped: 1.0
epoch: 37, train_batch_id: 300, avg_cost: 3.9165265560150146
grad_norm: 2.471102596072888, clipped: 1.0
epoch: 37, train_batch_id: 350, avg_cost: 3.9186086654663086
grad_norm: 1.910714140339593, clipped: 1.0
epoch: 37, train_batch_id: 400, avg_cost: 3.882505178451538
grad_norm: 2.188193731916182, clipped: 1.0
epoch: 37, train_batch_id: 450, avg_cost: 3.8875856399536133
grad_norm: 2.6540849155584536, clipped: 1.0
epoch: 37, train_batch_id: 500, avg_cost: 3.89345645904541
grad_norm: 3.530295365459019, clipped: 1.0
epoch: 37, train_batch_id: 550, avg_cost: 3.903156042098999
grad_norm: 2.2358760109775013, clipped: 1.0
epoch: 37, train_batch_id: 600, avg_cost: 3.907496690750122
grad_norm: 2.4770768990409398, clipped: 1.0
epoch: 37, train_batch_id: 650, avg_cost: 3.9022932052612305
grad_norm: 2.076211380074728, clipped: 1.0
epoch: 37, train_batch_id: 700, avg_cost: 3.89778995513916
grad_norm: 2.662749589347099, clipped: 1.0
epoch: 37, train_batch_id: 750, avg_cost: 3.8944618701934814
grad_norm: 2.3572542553050266, clipped: 1.0
epoch: 37, train_batch_id: 800, avg_cost: 3.8934383392333984
grad_norm: 2.1797796638875444, clipped: 1.0
epoch: 37, train_batch_id: 850, avg_cost: 3.9141921997070312
grad_norm: 3.0259650954414554, clipped: 1.0
epoch: 37, train_batch_id: 900, avg_cost: 3.902888774871826
grad_norm: 2.4308316444281397, clipped: 1.0
epoch: 37, train_batch_id: 950, avg_cost: 3.8686141967773438
grad_norm: 1.7541353132034845, clipped: 1.0
epoch: 37, train_batch_id: 1000, avg_cost: 3.897111177444458
grad_norm: 2.241224225638012, clipped: 1.0
epoch: 37, train_batch_id: 1050, avg_cost: 3.8814194202423096
grad_norm: 2.429714970455514, clipped: 1.0
epoch: 37, train_batch_id: 1100, avg_cost: 3.9044270515441895
grad_norm: 1.9350453972494681, clipped: 1.0
epoch: 37, train_batch_id: 1150, avg_cost: 3.8810274600982666
grad_norm: 2.4098603706459305, clipped: 1.0
epoch: 37, train_batch_id: 1200, avg_cost: 3.8963308334350586
grad_norm: 2.1397118409427938, clipped: 1.0
epoch: 37, train_batch_id: 1250, avg_cost: 3.9054553508758545
grad_norm: 1.9834823864605553, clipped: 1.0
epoch: 37, train_batch_id: 1300, avg_cost: 3.9097471237182617
grad_norm: 3.2619400895251207, clipped: 1.0
epoch: 37, train_batch_id: 1350, avg_cost: 3.910341501235962
grad_norm: 1.8420701963655028, clipped: 1.0
epoch: 37, train_batch_id: 1400, avg_cost: 3.8902883529663086
grad_norm: 4.2793340597105995, clipped: 1.0
epoch: 37, train_batch_id: 1450, avg_cost: 3.891178607940674
grad_norm: 3.248670142355095, clipped: 1.0
epoch: 37, train_batch_id: 1500, avg_cost: 3.89617919921875
grad_norm: 2.831326012113958, clipped: 1.0
epoch: 37, train_batch_id: 1550, avg_cost: 3.9100685119628906
grad_norm: 2.1168457277736477, clipped: 1.0
epoch: 37, train_batch_id: 1600, avg_cost: 3.8965952396392822
grad_norm: 2.0184883626903676, clipped: 1.0
epoch: 37, train_batch_id: 1650, avg_cost: 3.8953933715820312
grad_norm: 2.5410774840691692, clipped: 1.0
epoch: 37, train_batch_id: 1700, avg_cost: 3.8869073390960693
grad_norm: 2.9933931500255913, clipped: 1.0
epoch: 37, train_batch_id: 1750, avg_cost: 3.8884501457214355
grad_norm: 2.051551734093183, clipped: 1.0
epoch: 37, train_batch_id: 1800, avg_cost: 3.878262996673584
grad_norm: 2.5977772145598172, clipped: 1.0
epoch: 37, train_batch_id: 1850, avg_cost: 3.8956806659698486
grad_norm: 1.589755405363146, clipped: 1.0
epoch: 37, train_batch_id: 1900, avg_cost: 3.8747763633728027
grad_norm: 2.0236660353238887, clipped: 1.0
epoch: 37, train_batch_id: 1950, avg_cost: 3.888326644897461
grad_norm: 2.396589053148186, clipped: 1.0
epoch: 37, train_batch_id: 2000, avg_cost: 3.877271890640259
grad_norm: 2.5130139658546398, clipped: 1.0
epoch: 37, train_batch_id: 2050, avg_cost: 3.91105318069458
grad_norm: 1.9366252319168695, clipped: 1.0
epoch: 37, train_batch_id: 2100, avg_cost: 3.9183642864227295
grad_norm: 3.625421188855976, clipped: 1.0
epoch: 37, train_batch_id: 2150, avg_cost: 3.910083770751953
grad_norm: 2.687092569210871, clipped: 1.0
epoch: 37, train_batch_id: 2200, avg_cost: 3.892448902130127
grad_norm: 2.9404511135625464, clipped: 1.0
epoch: 37, train_batch_id: 2250, avg_cost: 3.8906633853912354
grad_norm: 2.164473847483306, clipped: 1.0
epoch: 37, train_batch_id: 2300, avg_cost: 3.89221453666687
grad_norm: 2.3243043970448722, clipped: 1.0
epoch: 37, train_batch_id: 2350, avg_cost: 3.9187183380126953
grad_norm: 2.193207876755363, clipped: 1.0
epoch: 37, train_batch_id: 2400, avg_cost: 3.8809218406677246
grad_norm: 2.000981621995211, clipped: 1.0
epoch: 37, train_batch_id: 2450, avg_cost: 3.912006378173828
grad_norm: 2.243099333281451, clipped: 1.0
Finished epoch 37, took 00:09:27 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.3479485511779785 +- 0.004298681393265724
Evaluating candidate model on evaluation dataset
Epoch 37 candidate mean 4.341804504394531, baseline epoch 36 mean 4.251097679138184, difference 0.09070682525634766
Start train epoch 38, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


epoch: 38, train_batch_id: 0, avg_cost: 3.889085292816162
grad_norm: 1.6351189546138118, clipped: 1.0
epoch: 38, train_batch_id: 50, avg_cost: 3.896561622619629
grad_norm: 2.3325984853342696, clipped: 1.0
epoch: 38, train_batch_id: 100, avg_cost: 3.868894577026367
grad_norm: 2.4703582817895335, clipped: 1.0
epoch: 38, train_batch_id: 150, avg_cost: 3.9154062271118164
grad_norm: 2.651279915028626, clipped: 1.0
epoch: 38, train_batch_id: 200, avg_cost: 3.9225711822509766
grad_norm: 2.527301379589628, clipped: 1.0
epoch: 38, train_batch_id: 250, avg_cost: 3.8993210792541504
grad_norm: 2.370426161364426, clipped: 1.0
epoch: 38, train_batch_id: 300, avg_cost: 3.8833327293395996
grad_norm: 10.231502532730264, clipped: 1.0
epoch: 38, train_batch_id: 350, avg_cost: 3.912458658218384
grad_norm: 1.9103720961714228, clipped: 1.0
epoch: 38, train_batch_id: 400, avg_cost: 3.906733274459839
grad_norm: 2.4287113659628177, clipped: 1.0
epoch: 38, train_batch_id: 450, avg_cost: 3.888789176940918
grad_norm: 2.3278593374662213, clipped: 1.0
epoch: 38, train_batch_id: 500, avg_cost: 3.9154021739959717
grad_norm: 5.975715992831879, clipped: 1.0
epoch: 38, train_batch_id: 550, avg_cost: 3.894383668899536
grad_norm: 3.3530107320255205, clipped: 1.0
epoch: 38, train_batch_id: 600, avg_cost: 3.886942148208618
grad_norm: 3.317571712749339, clipped: 1.0
epoch: 38, train_batch_id: 650, avg_cost: 3.9142909049987793
grad_norm: 2.8040059439723155, clipped: 1.0
epoch: 38, train_batch_id: 700, avg_cost: 3.891575813293457
grad_norm: 3.267505922976148, clipped: 1.0
epoch: 38, train_batch_id: 750, avg_cost: 3.9036595821380615
grad_norm: 2.902975918191386, clipped: 1.0
epoch: 38, train_batch_id: 800, avg_cost: 3.9157040119171143
grad_norm: 3.0898232409257638, clipped: 1.0
epoch: 38, train_batch_id: 850, avg_cost: 3.916170597076416
grad_norm: 3.4769813683257413, clipped: 1.0
epoch: 38, train_batch_id: 900, avg_cost: 3.886669158935547
grad_norm: 2.3912893602429337, clipped: 1.0
epoch: 38, train_batch_id: 950, avg_cost: 3.918538808822632
grad_norm: 2.0178974455540715, clipped: 1.0
epoch: 38, train_batch_id: 1000, avg_cost: 3.897317886352539
grad_norm: 2.1557020337432973, clipped: 1.0
epoch: 38, train_batch_id: 1050, avg_cost: 3.892097234725952
grad_norm: 2.4785883268199522, clipped: 1.0
epoch: 38, train_batch_id: 1100, avg_cost: 3.8752245903015137
grad_norm: 1.721274166454725, clipped: 1.0
epoch: 38, train_batch_id: 1150, avg_cost: 3.9107167720794678
grad_norm: 1.9619194985630173, clipped: 1.0
epoch: 38, train_batch_id: 1200, avg_cost: 3.8973684310913086
grad_norm: 2.6970815953466927, clipped: 1.0
epoch: 38, train_batch_id: 1250, avg_cost: 3.889552116394043
grad_norm: 1.8445148991836342, clipped: 1.0
epoch: 38, train_batch_id: 1300, avg_cost: 3.896087646484375
grad_norm: 2.838792356605534, clipped: 1.0
epoch: 38, train_batch_id: 1350, avg_cost: 3.867936134338379
grad_norm: 2.3097068679961676, clipped: 1.0
epoch: 38, train_batch_id: 1400, avg_cost: 3.9095678329467773
grad_norm: 2.4653396226203728, clipped: 1.0
epoch: 38, train_batch_id: 1450, avg_cost: 3.89872407913208
grad_norm: 2.412595587571107, clipped: 1.0
epoch: 38, train_batch_id: 1500, avg_cost: 3.8993771076202393
grad_norm: 3.5175081174720333, clipped: 1.0
epoch: 38, train_batch_id: 1550, avg_cost: 3.9058585166931152
grad_norm: 2.1854658553856052, clipped: 1.0
epoch: 38, train_batch_id: 1600, avg_cost: 3.8959240913391113
grad_norm: 2.440207587929912, clipped: 1.0
epoch: 38, train_batch_id: 1650, avg_cost: 3.9034318923950195
grad_norm: 3.973325632810607, clipped: 1.0
epoch: 38, train_batch_id: 1700, avg_cost: 3.9063172340393066
grad_norm: 2.6436731365729127, clipped: 1.0
epoch: 38, train_batch_id: 1750, avg_cost: 3.897573947906494
grad_norm: 2.833552729917262, clipped: 1.0
epoch: 38, train_batch_id: 1800, avg_cost: 3.8932509422302246
grad_norm: 2.196337438752636, clipped: 1.0
epoch: 38, train_batch_id: 1850, avg_cost: 3.9056499004364014
grad_norm: 2.296877552962579, clipped: 1.0
epoch: 38, train_batch_id: 1900, avg_cost: 3.9271976947784424
grad_norm: 1.8477630192451524, clipped: 1.0
epoch: 38, train_batch_id: 1950, avg_cost: 3.91410231590271
grad_norm: 2.838667849660441, clipped: 1.0
epoch: 38, train_batch_id: 2000, avg_cost: 3.8967833518981934
grad_norm: 2.395722692210556, clipped: 1.0
epoch: 38, train_batch_id: 2050, avg_cost: 3.8996469974517822
grad_norm: 1.9049983824314658, clipped: 1.0
epoch: 38, train_batch_id: 2100, avg_cost: 3.8849945068359375
grad_norm: 3.7760022282473718, clipped: 1.0
epoch: 38, train_batch_id: 2150, avg_cost: 3.896944999694824
grad_norm: 3.4105289057576496, clipped: 1.0
epoch: 38, train_batch_id: 2200, avg_cost: 3.899078845977783
grad_norm: 2.116412865611005, clipped: 1.0
epoch: 38, train_batch_id: 2250, avg_cost: 3.905808925628662
grad_norm: 2.4797344847179863, clipped: 1.0
epoch: 38, train_batch_id: 2300, avg_cost: 3.9143459796905518
grad_norm: 2.246754633338685, clipped: 1.0
epoch: 38, train_batch_id: 2350, avg_cost: 3.9043843746185303
grad_norm: 1.8337240764039784, clipped: 1.0
epoch: 38, train_batch_id: 2400, avg_cost: 3.8710179328918457
grad_norm: 2.2873512349305294, clipped: 1.0
epoch: 38, train_batch_id: 2450, avg_cost: 3.8806910514831543
grad_norm: 1.868124983214045, clipped: 1.0
Finished epoch 38, took 00:09:21 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.270813465118408 +- 0.004066512454301119
Evaluating candidate model on evaluation dataset
Epoch 38 candidate mean 4.272153377532959, baseline epoch 36 mean 4.251097679138184, difference 0.02105569839477539
Start train epoch 39, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 39, train_batch_id: 0, avg_cost: 3.882028579711914
grad_norm: 1.7681283478723135, clipped: 1.0
epoch: 39, train_batch_id: 50, avg_cost: 3.8909289836883545
grad_norm: 1.5978205680031519, clipped: 1.0
epoch: 39, train_batch_id: 100, avg_cost: 3.876131057739258
grad_norm: 2.3809548956319024, clipped: 1.0
epoch: 39, train_batch_id: 150, avg_cost: 3.9022440910339355
grad_norm: 1.7440337476508687, clipped: 1.0
epoch: 39, train_batch_id: 200, avg_cost: 3.8922252655029297
grad_norm: 2.6313686316237885, clipped: 1.0
epoch: 39, train_batch_id: 250, avg_cost: 3.918708086013794
grad_norm: 2.462727634470876, clipped: 1.0
epoch: 39, train_batch_id: 300, avg_cost: 3.8900861740112305
grad_norm: 3.637152029261257, clipped: 1.0
epoch: 39, train_batch_id: 350, avg_cost: 3.9164438247680664
grad_norm: 2.4503253606521316, clipped: 1.0
epoch: 39, train_batch_id: 400, avg_cost: 3.9106884002685547
grad_norm: 2.504965743877942, clipped: 1.0
epoch: 39, train_batch_id: 450, avg_cost: 3.8830270767211914
grad_norm: 2.595945210354042, clipped: 1.0
epoch: 39, train_batch_id: 500, avg_cost: 3.882185697555542
grad_norm: 2.3401314068536796, clipped: 1.0
epoch: 39, train_batch_id: 550, avg_cost: 3.887002944946289
grad_norm: 2.1459192879486784, clipped: 1.0
epoch: 39, train_batch_id: 600, avg_cost: 3.8939573764801025
grad_norm: 3.0023354093537176, clipped: 1.0
epoch: 39, train_batch_id: 650, avg_cost: 3.891767978668213
grad_norm: 2.127178076563424, clipped: 1.0
epoch: 39, train_batch_id: 700, avg_cost: 3.86354923248291
grad_norm: 2.0855500218627143, clipped: 1.0
epoch: 39, train_batch_id: 750, avg_cost: 3.909451484680176
grad_norm: 2.4788152793507012, clipped: 1.0
epoch: 39, train_batch_id: 800, avg_cost: 3.9229793548583984
grad_norm: 2.777107409939996, clipped: 1.0
epoch: 39, train_batch_id: 850, avg_cost: 3.872985601425171
grad_norm: 2.2940610154233503, clipped: 1.0
epoch: 39, train_batch_id: 900, avg_cost: 3.905508518218994
grad_norm: 2.2745148509975217, clipped: 1.0
epoch: 39, train_batch_id: 950, avg_cost: 3.8674585819244385
grad_norm: 2.787581625646292, clipped: 1.0
epoch: 39, train_batch_id: 1000, avg_cost: 3.893716335296631
grad_norm: 1.775752805465502, clipped: 1.0
epoch: 39, train_batch_id: 1050, avg_cost: 3.911665916442871
grad_norm: 2.9672853559539933, clipped: 1.0
epoch: 39, train_batch_id: 1100, avg_cost: 3.8982601165771484
grad_norm: 3.236108077927951, clipped: 1.0
epoch: 39, train_batch_id: 1150, avg_cost: 3.892129421234131
grad_norm: 1.99411727845451, clipped: 1.0
epoch: 39, train_batch_id: 1200, avg_cost: 3.9006361961364746
grad_norm: 3.6943282800666872, clipped: 1.0
epoch: 39, train_batch_id: 1250, avg_cost: 3.885707378387451
grad_norm: 1.7381437872400967, clipped: 1.0
epoch: 39, train_batch_id: 1300, avg_cost: 3.933743476867676
grad_norm: 1.8909606252810884, clipped: 1.0
epoch: 39, train_batch_id: 1350, avg_cost: 3.8988728523254395
grad_norm: 2.1625629991958504, clipped: 1.0
epoch: 39, train_batch_id: 1400, avg_cost: 3.881784677505493
grad_norm: 3.266347479338679, clipped: 1.0
epoch: 39, train_batch_id: 1450, avg_cost: 3.877352237701416
grad_norm: 1.9942378194213632, clipped: 1.0
epoch: 39, train_batch_id: 1500, avg_cost: 3.909766674041748
grad_norm: 2.1115397456529523, clipped: 1.0
epoch: 39, train_batch_id: 1550, avg_cost: 3.9125595092773438
grad_norm: 1.7889786387126685, clipped: 1.0
epoch: 39, train_batch_id: 1600, avg_cost: 3.8958611488342285
grad_norm: 2.4316732835911528, clipped: 1.0
epoch: 39, train_batch_id: 1650, avg_cost: 3.887434482574463
grad_norm: 1.9562589719453074, clipped: 1.0
epoch: 39, train_batch_id: 1700, avg_cost: 3.9103899002075195
grad_norm: 2.867089362872937, clipped: 1.0
epoch: 39, train_batch_id: 1750, avg_cost: 3.8858180046081543
grad_norm: 2.695713978574849, clipped: 1.0
epoch: 39, train_batch_id: 1800, avg_cost: 3.885930061340332
grad_norm: 2.409313879011497, clipped: 1.0
epoch: 39, train_batch_id: 1850, avg_cost: 3.905027389526367
grad_norm: 2.0401505953406502, clipped: 1.0
epoch: 39, train_batch_id: 1900, avg_cost: 3.8696656227111816
grad_norm: 2.254077590543346, clipped: 1.0
epoch: 39, train_batch_id: 1950, avg_cost: 3.8910531997680664
grad_norm: 2.346153376520853, clipped: 1.0
epoch: 39, train_batch_id: 2000, avg_cost: 3.877565383911133
grad_norm: 2.4905197506694585, clipped: 1.0
epoch: 39, train_batch_id: 2050, avg_cost: 3.8710484504699707
grad_norm: 2.432383167655812, clipped: 1.0
epoch: 39, train_batch_id: 2100, avg_cost: 3.885377883911133
grad_norm: 2.001549198433413, clipped: 1.0
epoch: 39, train_batch_id: 2150, avg_cost: 3.8890342712402344
grad_norm: 2.8494221044358015, clipped: 1.0
epoch: 39, train_batch_id: 2200, avg_cost: 3.887958288192749
grad_norm: 2.200528160092491, clipped: 1.0
epoch: 39, train_batch_id: 2250, avg_cost: 3.898125171661377
grad_norm: 2.1758023800706785, clipped: 1.0
epoch: 39, train_batch_id: 2300, avg_cost: 3.892127513885498
grad_norm: 2.863405584422175, clipped: 1.0
epoch: 39, train_batch_id: 2350, avg_cost: 3.852264165878296
grad_norm: 2.86652652362644, clipped: 1.0
epoch: 39, train_batch_id: 2400, avg_cost: 3.9044604301452637
grad_norm: 3.22651873525115, clipped: 1.0
epoch: 39, train_batch_id: 2450, avg_cost: 3.9098129272460938
grad_norm: 2.122378215930145, clipped: 1.0
Finished epoch 39, took 00:09:21 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.134068965911865 +- 0.003759914543479681
Evaluating candidate model on evaluation dataset
Epoch 39 candidate mean 4.129347801208496, baseline epoch 36 mean 4.251097679138184, difference -0.1217498779296875
p-value: 0.0
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 40, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 40, train_batch_id: 0, avg_cost: 3.8900985717773438
grad_norm: 1.7176721437776052, clipped: 1.0
epoch: 40, train_batch_id: 50, avg_cost: 3.9000651836395264
grad_norm: 2.3156248005206463, clipped: 1.0
epoch: 40, train_batch_id: 100, avg_cost: 3.8743066787719727
grad_norm: 1.4709142573483414, clipped: 1.0
epoch: 40, train_batch_id: 150, avg_cost: 3.906949996948242
grad_norm: 1.72289440348598, clipped: 1.0
epoch: 40, train_batch_id: 200, avg_cost: 3.9069414138793945
grad_norm: 1.4510919760970518, clipped: 1.0
epoch: 40, train_batch_id: 250, avg_cost: 3.886350154876709
grad_norm: 1.7606176183348423, clipped: 1.0
epoch: 40, train_batch_id: 300, avg_cost: 3.855846881866455
grad_norm: 1.316196755397036, clipped: 1.0
epoch: 40, train_batch_id: 350, avg_cost: 3.8805174827575684
grad_norm: 1.672462714890538, clipped: 1.0
epoch: 40, train_batch_id: 400, avg_cost: 3.8886523246765137
grad_norm: 2.1854423307134687, clipped: 1.0
epoch: 40, train_batch_id: 450, avg_cost: 3.8938546180725098
grad_norm: 1.9790875460798427, clipped: 1.0
epoch: 40, train_batch_id: 500, avg_cost: 3.8673243522644043
grad_norm: 1.5497088526997778, clipped: 1.0
epoch: 40, train_batch_id: 550, avg_cost: 3.9081296920776367
grad_norm: 1.528295654004136, clipped: 1.0
epoch: 40, train_batch_id: 600, avg_cost: 3.9168882369995117
grad_norm: 1.957436439456375, clipped: 1.0
epoch: 40, train_batch_id: 650, avg_cost: 3.8898656368255615
grad_norm: 1.2737705475114236, clipped: 1.0
epoch: 40, train_batch_id: 700, avg_cost: 3.896904706954956
grad_norm: 1.4982379420577443, clipped: 1.0
epoch: 40, train_batch_id: 750, avg_cost: 3.897125482559204
grad_norm: 2.2702287764882176, clipped: 1.0
epoch: 40, train_batch_id: 800, avg_cost: 3.85943865776062
grad_norm: 2.328040103794638, clipped: 1.0
epoch: 40, train_batch_id: 850, avg_cost: 3.923039197921753
grad_norm: 1.7088927984384386, clipped: 1.0
epoch: 40, train_batch_id: 900, avg_cost: 3.900075912475586
grad_norm: 2.2191471442286526, clipped: 1.0
epoch: 40, train_batch_id: 950, avg_cost: 3.8766531944274902
grad_norm: 2.120648881527427, clipped: 1.0
epoch: 40, train_batch_id: 1000, avg_cost: 3.8791821002960205
grad_norm: 1.7247977722039156, clipped: 1.0
epoch: 40, train_batch_id: 1050, avg_cost: 3.8788537979125977
grad_norm: 1.7052643237179776, clipped: 1.0
epoch: 40, train_batch_id: 1100, avg_cost: 3.9074978828430176
grad_norm: 1.6259038992787331, clipped: 1.0
epoch: 40, train_batch_id: 1150, avg_cost: 3.8843894004821777
grad_norm: 1.5790697599795671, clipped: 1.0
epoch: 40, train_batch_id: 1200, avg_cost: 3.8677165508270264
grad_norm: 1.5346984221729216, clipped: 1.0
epoch: 40, train_batch_id: 1250, avg_cost: 3.88828444480896
grad_norm: 1.6471991388360019, clipped: 1.0
epoch: 40, train_batch_id: 1300, avg_cost: 3.8929266929626465
grad_norm: 1.9603204023625034, clipped: 1.0
epoch: 40, train_batch_id: 1350, avg_cost: 3.8802592754364014
grad_norm: 2.0838896876516504, clipped: 1.0
epoch: 40, train_batch_id: 1400, avg_cost: 3.8419976234436035
grad_norm: 1.7824189450837784, clipped: 1.0
epoch: 40, train_batch_id: 1450, avg_cost: 3.8927180767059326
grad_norm: 1.2567222598861099, clipped: 1.0
epoch: 40, train_batch_id: 1500, avg_cost: 3.8932812213897705
grad_norm: 1.6405940014367137, clipped: 1.0
epoch: 40, train_batch_id: 1550, avg_cost: 3.9004340171813965
grad_norm: 1.5589743801853309, clipped: 1.0
epoch: 40, train_batch_id: 1600, avg_cost: 3.891085147857666
grad_norm: 1.307800911651702, clipped: 1.0
epoch: 40, train_batch_id: 1650, avg_cost: 3.8758575916290283
grad_norm: 1.9476198044838176, clipped: 1.0
epoch: 40, train_batch_id: 1700, avg_cost: 3.8751487731933594
grad_norm: 1.6472346253042973, clipped: 1.0
epoch: 40, train_batch_id: 1750, avg_cost: 3.8755311965942383
grad_norm: 1.812828537367891, clipped: 1.0
epoch: 40, train_batch_id: 1800, avg_cost: 3.9142768383026123
grad_norm: 1.6649850060903781, clipped: 1.0
epoch: 40, train_batch_id: 1850, avg_cost: 3.893719434738159
grad_norm: 1.9074142476956613, clipped: 1.0
epoch: 40, train_batch_id: 1900, avg_cost: 3.8514933586120605
grad_norm: 2.106579885245868, clipped: 1.0
epoch: 40, train_batch_id: 1950, avg_cost: 3.8846435546875
grad_norm: 1.7491831293157267, clipped: 1.0
epoch: 40, train_batch_id: 2000, avg_cost: 3.9066545963287354
grad_norm: 2.7619829035061345, clipped: 1.0
epoch: 40, train_batch_id: 2050, avg_cost: 3.8837547302246094
grad_norm: 1.7206691802622933, clipped: 1.0
epoch: 40, train_batch_id: 2100, avg_cost: 3.894984722137451
grad_norm: 3.080876545146722, clipped: 1.0
epoch: 40, train_batch_id: 2150, avg_cost: 3.884460926055908
grad_norm: 2.195373846664049, clipped: 1.0
epoch: 40, train_batch_id: 2200, avg_cost: 3.8620545864105225
grad_norm: 2.306762807903355, clipped: 1.0
epoch: 40, train_batch_id: 2250, avg_cost: 3.901118040084839
grad_norm: 1.8730229153638942, clipped: 1.0
epoch: 40, train_batch_id: 2300, avg_cost: 3.852816104888916
grad_norm: 1.7976049899502706, clipped: 1.0
epoch: 40, train_batch_id: 2350, avg_cost: 3.89740252494812
grad_norm: 1.7368739518926775, clipped: 1.0
epoch: 40, train_batch_id: 2400, avg_cost: 3.873920440673828
grad_norm: 2.836622906883448, clipped: 1.0
epoch: 40, train_batch_id: 2450, avg_cost: 3.8887109756469727
grad_norm: 1.7870273596749502, clipped: 1.0
Finished epoch 40, took 00:09:20 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.249828338623047 +- 0.003983451519161463
Evaluating candidate model on evaluation dataset
Epoch 40 candidate mean 4.243110656738281, baseline epoch 39 mean 4.126363277435303, difference 0.11674737930297852
Start train epoch 41, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 41, train_batch_id: 0, avg_cost: 3.8856754302978516
grad_norm: 1.8616007800426775, clipped: 1.0
epoch: 41, train_batch_id: 50, avg_cost: 3.899515390396118
grad_norm: 2.402926541721066, clipped: 1.0
epoch: 41, train_batch_id: 100, avg_cost: 3.878432512283325
grad_norm: 1.5118383175338843, clipped: 1.0
epoch: 41, train_batch_id: 150, avg_cost: 3.8995656967163086
grad_norm: 2.268717660770865, clipped: 1.0
epoch: 41, train_batch_id: 200, avg_cost: 3.884411334991455
grad_norm: 1.6613903055253172, clipped: 1.0
epoch: 41, train_batch_id: 250, avg_cost: 3.8660809993743896
grad_norm: 1.8698011787923967, clipped: 1.0
epoch: 41, train_batch_id: 300, avg_cost: 3.8970072269439697
grad_norm: 1.801769305336758, clipped: 1.0
epoch: 41, train_batch_id: 350, avg_cost: 3.8966588973999023
grad_norm: 1.6383286178947225, clipped: 1.0
epoch: 41, train_batch_id: 400, avg_cost: 3.880892753601074
grad_norm: 1.461847502507668, clipped: 1.0
epoch: 41, train_batch_id: 450, avg_cost: 3.898120880126953
grad_norm: 1.4540280256503442, clipped: 1.0
epoch: 41, train_batch_id: 500, avg_cost: 3.9049453735351562
grad_norm: 2.090475717895453, clipped: 1.0
epoch: 41, train_batch_id: 550, avg_cost: 3.889185905456543
grad_norm: 1.813436191811573, clipped: 1.0
epoch: 41, train_batch_id: 600, avg_cost: 3.9040422439575195
grad_norm: 1.642973528837161, clipped: 1.0
epoch: 41, train_batch_id: 650, avg_cost: 3.8826136589050293
grad_norm: 2.0927467676304565, clipped: 1.0
epoch: 41, train_batch_id: 700, avg_cost: 3.8642427921295166
grad_norm: 1.4204734792859028, clipped: 1.0
epoch: 41, train_batch_id: 750, avg_cost: 3.875011444091797
grad_norm: 1.7555564499665675, clipped: 1.0
epoch: 41, train_batch_id: 800, avg_cost: 3.8912711143493652
grad_norm: 2.319514506168483, clipped: 1.0
epoch: 41, train_batch_id: 850, avg_cost: 3.8855223655700684
grad_norm: 2.040656119687552, clipped: 1.0
epoch: 41, train_batch_id: 900, avg_cost: 3.8749778270721436
grad_norm: 1.3635568821144977, clipped: 1.0
epoch: 41, train_batch_id: 950, avg_cost: 3.8790454864501953
grad_norm: 1.6235613696275908, clipped: 1.0
epoch: 41, train_batch_id: 1000, avg_cost: 3.8602070808410645
grad_norm: 1.3884582719227188, clipped: 1.0
epoch: 41, train_batch_id: 1050, avg_cost: 3.8627686500549316
grad_norm: 1.4411120907481991, clipped: 1.0
epoch: 41, train_batch_id: 1100, avg_cost: 3.8875434398651123
grad_norm: 2.1060209715482667, clipped: 1.0
epoch: 41, train_batch_id: 1150, avg_cost: 3.884518623352051
grad_norm: 1.30521435606771, clipped: 1.0
epoch: 41, train_batch_id: 1200, avg_cost: 3.912909507751465
grad_norm: 2.4794208531726176, clipped: 1.0
epoch: 41, train_batch_id: 1250, avg_cost: 3.879855155944824
grad_norm: 1.9740182019622876, clipped: 1.0
epoch: 41, train_batch_id: 1300, avg_cost: 3.8840513229370117
grad_norm: 1.4494124667156612, clipped: 1.0
epoch: 41, train_batch_id: 1350, avg_cost: 3.890533447265625
grad_norm: 1.3495992855649623, clipped: 1.0
epoch: 41, train_batch_id: 1400, avg_cost: 3.892998456954956
grad_norm: 1.4598942909907209, clipped: 1.0
epoch: 41, train_batch_id: 1450, avg_cost: 3.8901314735412598
grad_norm: 1.640828105822535, clipped: 1.0
epoch: 41, train_batch_id: 1500, avg_cost: 3.9014675617218018
grad_norm: 1.2891053862649797, clipped: 1.0
epoch: 41, train_batch_id: 1550, avg_cost: 3.880007743835449
grad_norm: 1.7054716953087128, clipped: 1.0
epoch: 41, train_batch_id: 1600, avg_cost: 3.8871657848358154
grad_norm: 1.809228478537889, clipped: 1.0
epoch: 41, train_batch_id: 1650, avg_cost: 3.874875068664551
grad_norm: 2.298945097834168, clipped: 1.0
epoch: 41, train_batch_id: 1700, avg_cost: 3.901550054550171
grad_norm: 1.5659709268303474, clipped: 1.0
epoch: 41, train_batch_id: 1750, avg_cost: 3.8877034187316895
grad_norm: 1.701968831293406, clipped: 1.0
epoch: 41, train_batch_id: 1800, avg_cost: 3.893247127532959
grad_norm: 1.7525006866863468, clipped: 1.0
epoch: 41, train_batch_id: 1850, avg_cost: 3.883481502532959
grad_norm: 1.5400790309581054, clipped: 1.0
epoch: 41, train_batch_id: 1900, avg_cost: 3.866251230239868
grad_norm: 3.249849777475839, clipped: 1.0
epoch: 41, train_batch_id: 1950, avg_cost: 3.8977785110473633
grad_norm: 2.1607926426305153, clipped: 1.0
epoch: 41, train_batch_id: 2000, avg_cost: 3.8808658123016357
grad_norm: 2.32330939350189, clipped: 1.0
epoch: 41, train_batch_id: 2050, avg_cost: 3.8912439346313477
grad_norm: 1.4563774744073499, clipped: 1.0
epoch: 41, train_batch_id: 2100, avg_cost: 3.8832969665527344
grad_norm: 1.4948228412768223, clipped: 1.0
epoch: 41, train_batch_id: 2150, avg_cost: 3.8638083934783936
grad_norm: 1.3436323619050317, clipped: 1.0
epoch: 41, train_batch_id: 2200, avg_cost: 3.875821590423584
grad_norm: 1.5450545208926902, clipped: 1.0
epoch: 41, train_batch_id: 2250, avg_cost: 3.8846421241760254
grad_norm: 2.050011664274371, clipped: 1.0
epoch: 41, train_batch_id: 2300, avg_cost: 3.901503086090088
grad_norm: 2.4281248834089793, clipped: 1.0
epoch: 41, train_batch_id: 2350, avg_cost: 3.9123756885528564
grad_norm: 1.5986582358063073, clipped: 1.0
epoch: 41, train_batch_id: 2400, avg_cost: 3.873075485229492
grad_norm: 1.6480107716363945, clipped: 1.0
epoch: 41, train_batch_id: 2450, avg_cost: 3.909290075302124
grad_norm: 1.58846450506498, clipped: 1.0
Finished epoch 41, took 00:09:23 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.207820415496826 +- 0.0038929057773202658
Evaluating candidate model on evaluation dataset
Epoch 41 candidate mean 4.201399803161621, baseline epoch 39 mean 4.126363277435303, difference 0.07503652572631836
Start train epoch 42, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 42, train_batch_id: 0, avg_cost: 3.8655450344085693
grad_norm: 1.7239743623738555, clipped: 1.0
epoch: 42, train_batch_id: 50, avg_cost: 3.8821144104003906
grad_norm: 5.63608407411971, clipped: 1.0
epoch: 42, train_batch_id: 100, avg_cost: 3.8853235244750977
grad_norm: 1.6837664021469776, clipped: 1.0
epoch: 42, train_batch_id: 150, avg_cost: 3.8724613189697266
grad_norm: 2.3451269177951635, clipped: 1.0
epoch: 42, train_batch_id: 200, avg_cost: 3.897401809692383
grad_norm: 1.688267834268339, clipped: 1.0
epoch: 42, train_batch_id: 250, avg_cost: 3.8874387741088867
grad_norm: 2.148507176433479, clipped: 1.0
epoch: 42, train_batch_id: 300, avg_cost: 3.8825879096984863
grad_norm: 1.3819470274071, clipped: 1.0
epoch: 42, train_batch_id: 350, avg_cost: 3.878758668899536
grad_norm: 1.811593409930999, clipped: 1.0
epoch: 42, train_batch_id: 400, avg_cost: 3.876532554626465
grad_norm: 1.4191263955178373, clipped: 1.0
epoch: 42, train_batch_id: 450, avg_cost: 3.8859925270080566
grad_norm: 1.58318732701053, clipped: 1.0
epoch: 42, train_batch_id: 500, avg_cost: 3.8941311836242676
grad_norm: 1.8190333427373395, clipped: 1.0
epoch: 42, train_batch_id: 550, avg_cost: 3.876103401184082
grad_norm: 2.6009932403525275, clipped: 1.0
epoch: 42, train_batch_id: 600, avg_cost: 3.8697714805603027
grad_norm: 1.489561767843029, clipped: 1.0
epoch: 42, train_batch_id: 650, avg_cost: 3.889655113220215
grad_norm: 1.1523487905118726, clipped: 1.0
epoch: 42, train_batch_id: 700, avg_cost: 3.904637336730957
grad_norm: 1.5740836280538646, clipped: 1.0
epoch: 42, train_batch_id: 750, avg_cost: 3.8905341625213623
grad_norm: 1.3919676902590143, clipped: 1.0
epoch: 42, train_batch_id: 800, avg_cost: 3.872483968734741
grad_norm: 1.2706383170163433, clipped: 1.0
epoch: 42, train_batch_id: 850, avg_cost: 3.8854827880859375
grad_norm: 1.5453708607118037, clipped: 1.0
epoch: 42, train_batch_id: 900, avg_cost: 3.903503179550171
grad_norm: 1.5502096752028343, clipped: 1.0
epoch: 42, train_batch_id: 950, avg_cost: 3.8844258785247803
grad_norm: 2.0409422721846435, clipped: 1.0
epoch: 42, train_batch_id: 1000, avg_cost: 3.882864236831665
grad_norm: 1.6529865090365425, clipped: 1.0
epoch: 42, train_batch_id: 1050, avg_cost: 3.8835840225219727
grad_norm: 1.3317379760471646, clipped: 1.0
epoch: 42, train_batch_id: 1100, avg_cost: 3.8792471885681152
grad_norm: 2.273086822260324, clipped: 1.0
epoch: 42, train_batch_id: 1150, avg_cost: 3.893739700317383
grad_norm: 2.0262080184152214, clipped: 1.0
epoch: 42, train_batch_id: 1200, avg_cost: 3.9015884399414062
grad_norm: 1.960320908784967, clipped: 1.0
epoch: 42, train_batch_id: 1250, avg_cost: 3.877716541290283
grad_norm: 2.069998705648815, clipped: 1.0
epoch: 42, train_batch_id: 1300, avg_cost: 3.8523168563842773
grad_norm: 1.661816476165623, clipped: 1.0
epoch: 42, train_batch_id: 1350, avg_cost: 3.8919568061828613
grad_norm: 1.7666676085953927, clipped: 1.0
epoch: 42, train_batch_id: 1400, avg_cost: 3.8762710094451904
grad_norm: 1.9540654580503192, clipped: 1.0
epoch: 42, train_batch_id: 1450, avg_cost: 3.8890483379364014
grad_norm: 1.553734180890306, clipped: 1.0
epoch: 42, train_batch_id: 1500, avg_cost: 3.885050058364868
grad_norm: 1.8406895278379356, clipped: 1.0
epoch: 42, train_batch_id: 1550, avg_cost: 3.8637399673461914
grad_norm: 1.4159768406511843, clipped: 1.0
epoch: 42, train_batch_id: 1600, avg_cost: 3.904428720474243
grad_norm: 1.4054425416062999, clipped: 1.0
epoch: 42, train_batch_id: 1650, avg_cost: 3.873633623123169
grad_norm: 1.768956390919767, clipped: 1.0
epoch: 42, train_batch_id: 1700, avg_cost: 3.8700809478759766
grad_norm: 1.782386570215123, clipped: 1.0
epoch: 42, train_batch_id: 1750, avg_cost: 3.8767361640930176
grad_norm: 2.5845449491113217, clipped: 1.0
epoch: 42, train_batch_id: 1800, avg_cost: 3.886941909790039
grad_norm: 1.8696003230381815, clipped: 1.0
epoch: 42, train_batch_id: 1850, avg_cost: 3.8710854053497314
grad_norm: 1.4237471201702647, clipped: 1.0
epoch: 42, train_batch_id: 1900, avg_cost: 3.887722969055176
grad_norm: 1.8870721823083498, clipped: 1.0
epoch: 42, train_batch_id: 1950, avg_cost: 3.8916678428649902
grad_norm: 1.552277094575906, clipped: 1.0
epoch: 42, train_batch_id: 2000, avg_cost: 3.8982045650482178
grad_norm: 1.5274559133854662, clipped: 1.0
epoch: 42, train_batch_id: 2050, avg_cost: 3.9073963165283203
grad_norm: 2.270194991027295, clipped: 1.0
epoch: 42, train_batch_id: 2100, avg_cost: 3.887756586074829
grad_norm: 9.025542875756592, clipped: 1.0
epoch: 42, train_batch_id: 2150, avg_cost: 3.8874032497406006
grad_norm: 2.5943227455173776, clipped: 1.0
epoch: 42, train_batch_id: 2200, avg_cost: 3.920844793319702
grad_norm: 1.2273253676107527, clipped: 1.0
epoch: 42, train_batch_id: 2250, avg_cost: 3.8954992294311523
grad_norm: 2.9626059604524424, clipped: 1.0
epoch: 42, train_batch_id: 2300, avg_cost: 3.8635034561157227
grad_norm: 1.5833944899760937, clipped: 1.0
epoch: 42, train_batch_id: 2350, avg_cost: 3.8758842945098877
grad_norm: 1.528569674224015, clipped: 1.0
epoch: 42, train_batch_id: 2400, avg_cost: 3.886887550354004
grad_norm: 1.4557585334092724, clipped: 1.0
epoch: 42, train_batch_id: 2450, avg_cost: 3.8603978157043457
grad_norm: 1.7330877221702226, clipped: 1.0
Finished epoch 42, took 00:09:21 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.275012969970703 +- 0.003989282995462418
Evaluating candidate model on evaluation dataset
Epoch 42 candidate mean 4.2665486335754395, baseline epoch 39 mean 4.126363277435303, difference 0.14018535614013672
Start train epoch 43, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 43, train_batch_id: 0, avg_cost: 3.9092555046081543
grad_norm: 1.9196299696225838, clipped: 1.0
epoch: 43, train_batch_id: 50, avg_cost: 3.8831608295440674
grad_norm: 1.7769803155576644, clipped: 1.0
epoch: 43, train_batch_id: 100, avg_cost: 3.8815925121307373
grad_norm: 1.8445985607539797, clipped: 1.0
epoch: 43, train_batch_id: 150, avg_cost: 3.884644031524658
grad_norm: 2.4337678745178386, clipped: 1.0
epoch: 43, train_batch_id: 200, avg_cost: 3.8961193561553955
grad_norm: 1.5299133641687, clipped: 1.0
epoch: 43, train_batch_id: 250, avg_cost: 3.872347593307495
grad_norm: 2.5446336521716657, clipped: 1.0
epoch: 43, train_batch_id: 300, avg_cost: 3.876624584197998
grad_norm: 1.8368993011134869, clipped: 1.0
epoch: 43, train_batch_id: 350, avg_cost: 3.8768110275268555
grad_norm: 2.148410267592762, clipped: 1.0
epoch: 43, train_batch_id: 400, avg_cost: 3.887321949005127
grad_norm: 1.5844385517464352, clipped: 1.0
epoch: 43, train_batch_id: 450, avg_cost: 3.88199520111084
grad_norm: 1.69985235394076, clipped: 1.0
epoch: 43, train_batch_id: 500, avg_cost: 3.877500057220459
grad_norm: 2.281319751113853, clipped: 1.0
epoch: 43, train_batch_id: 550, avg_cost: 3.8799822330474854
grad_norm: 3.3236767203085726, clipped: 1.0
epoch: 43, train_batch_id: 600, avg_cost: 3.8723905086517334
grad_norm: 6.163654156118344, clipped: 1.0
epoch: 43, train_batch_id: 650, avg_cost: 3.8917312622070312
grad_norm: 1.713101336619674, clipped: 1.0
epoch: 43, train_batch_id: 700, avg_cost: 3.8597683906555176
grad_norm: 1.9473394072683958, clipped: 1.0
epoch: 43, train_batch_id: 750, avg_cost: 3.8730404376983643
grad_norm: 1.7098336527656874, clipped: 1.0
epoch: 43, train_batch_id: 800, avg_cost: 3.905250072479248
grad_norm: 1.9924600304004312, clipped: 1.0
epoch: 43, train_batch_id: 850, avg_cost: 3.860710382461548
grad_norm: 2.53055975281937, clipped: 1.0
epoch: 43, train_batch_id: 900, avg_cost: 3.8907222747802734
grad_norm: 1.8850520308736791, clipped: 1.0
epoch: 43, train_batch_id: 950, avg_cost: 3.8734779357910156
grad_norm: 1.532987823553725, clipped: 1.0
epoch: 43, train_batch_id: 1000, avg_cost: 3.8643856048583984
grad_norm: 1.585136967549909, clipped: 1.0
epoch: 43, train_batch_id: 1050, avg_cost: 3.8720755577087402
grad_norm: 2.2183258622681308, clipped: 1.0
epoch: 43, train_batch_id: 1100, avg_cost: 3.9060609340667725
grad_norm: 2.0662240059559633, clipped: 1.0
epoch: 43, train_batch_id: 1150, avg_cost: 3.897017240524292
grad_norm: 1.6877400430985745, clipped: 1.0
epoch: 43, train_batch_id: 1200, avg_cost: 3.8916754722595215
grad_norm: 2.3829034652183663, clipped: 1.0
epoch: 43, train_batch_id: 1250, avg_cost: 3.8555796146392822
grad_norm: 1.6989944152678147, clipped: 1.0
epoch: 43, train_batch_id: 1300, avg_cost: 3.889681339263916
grad_norm: 1.859520485645877, clipped: 1.0
epoch: 43, train_batch_id: 1350, avg_cost: 3.881925106048584
grad_norm: 1.5896586570380942, clipped: 1.0
epoch: 43, train_batch_id: 1400, avg_cost: 3.880972385406494
grad_norm: 1.7586055668370795, clipped: 1.0
epoch: 43, train_batch_id: 1450, avg_cost: 3.873854160308838
grad_norm: 1.443109461353929, clipped: 1.0
epoch: 43, train_batch_id: 1500, avg_cost: 3.890976667404175
grad_norm: 2.3704344238943964, clipped: 1.0
epoch: 43, train_batch_id: 1550, avg_cost: 3.903264045715332
grad_norm: 2.056875862147464, clipped: 1.0
epoch: 43, train_batch_id: 1600, avg_cost: 3.881032705307007
grad_norm: 1.5013672932938278, clipped: 1.0
epoch: 43, train_batch_id: 1650, avg_cost: 3.8753862380981445
grad_norm: 2.3497739273244282, clipped: 1.0
epoch: 43, train_batch_id: 1700, avg_cost: 3.880669116973877
grad_norm: 2.0742197164234044, clipped: 1.0
epoch: 43, train_batch_id: 1750, avg_cost: 3.8927230834960938
grad_norm: 1.3472369546769918, clipped: 1.0
epoch: 43, train_batch_id: 1800, avg_cost: 3.894536256790161
grad_norm: 2.4985705781654453, clipped: 1.0
epoch: 43, train_batch_id: 1850, avg_cost: 3.8820395469665527
grad_norm: 1.5815191313921684, clipped: 1.0
epoch: 43, train_batch_id: 1900, avg_cost: 3.879033088684082
grad_norm: 1.7477396381614878, clipped: 1.0
epoch: 43, train_batch_id: 1950, avg_cost: 3.9008285999298096
grad_norm: 1.9956692385313397, clipped: 1.0
epoch: 43, train_batch_id: 2000, avg_cost: 3.8757052421569824
grad_norm: 1.6635511575044406, clipped: 1.0
epoch: 43, train_batch_id: 2050, avg_cost: 3.8656506538391113
grad_norm: 1.838485661150258, clipped: 1.0
epoch: 43, train_batch_id: 2100, avg_cost: 3.8929429054260254
grad_norm: 1.5379379443189016, clipped: 1.0
epoch: 43, train_batch_id: 2150, avg_cost: 3.8692338466644287
grad_norm: 2.8953868255270234, clipped: 1.0
epoch: 43, train_batch_id: 2200, avg_cost: 3.8651952743530273
grad_norm: 2.4965143211440983, clipped: 1.0
epoch: 43, train_batch_id: 2250, avg_cost: 3.883451223373413
grad_norm: 1.9361398202852105, clipped: 1.0
epoch: 43, train_batch_id: 2300, avg_cost: 3.8943190574645996
grad_norm: 1.7050546705186098, clipped: 1.0
epoch: 43, train_batch_id: 2350, avg_cost: 3.8666043281555176
grad_norm: 2.324699106748076, clipped: 1.0
epoch: 43, train_batch_id: 2400, avg_cost: 3.8721113204956055
grad_norm: 1.6227208215450741, clipped: 1.0
epoch: 43, train_batch_id: 2450, avg_cost: 3.9002487659454346
grad_norm: 2.5838763903775557, clipped: 1.0
Finished epoch 43, took 00:09:24 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.254159927368164 +- 0.003919553942978382
Evaluating candidate model on evaluation dataset
Epoch 43 candidate mean 4.246851921081543, baseline epoch 39 mean 4.126363277435303, difference 0.12048864364624023
Start train epoch 44, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 44, train_batch_id: 0, avg_cost: 3.8883109092712402
grad_norm: 1.4382918434978966, clipped: 1.0
epoch: 44, train_batch_id: 50, avg_cost: 3.8528106212615967
grad_norm: 1.7501557484105932, clipped: 1.0
epoch: 44, train_batch_id: 100, avg_cost: 3.90067720413208
grad_norm: 4.19151089515915, clipped: 1.0
epoch: 44, train_batch_id: 150, avg_cost: 3.894113540649414
grad_norm: 1.976859074287206, clipped: 1.0
epoch: 44, train_batch_id: 200, avg_cost: 3.8776564598083496
grad_norm: 2.1494108822304643, clipped: 1.0
epoch: 44, train_batch_id: 250, avg_cost: 3.8793063163757324
grad_norm: 2.006659903784101, clipped: 1.0
epoch: 44, train_batch_id: 300, avg_cost: 3.883594036102295
grad_norm: 1.5392043335083654, clipped: 1.0
epoch: 44, train_batch_id: 350, avg_cost: 3.8906476497650146
grad_norm: 2.2884167532987365, clipped: 1.0
epoch: 44, train_batch_id: 400, avg_cost: 3.865593910217285
grad_norm: 1.747155333983624, clipped: 1.0
epoch: 44, train_batch_id: 450, avg_cost: 3.8967294692993164
grad_norm: 2.5403718414594096, clipped: 1.0
epoch: 44, train_batch_id: 500, avg_cost: 3.8835020065307617
grad_norm: 1.7294486119674033, clipped: 1.0
epoch: 44, train_batch_id: 550, avg_cost: 3.895242929458618
grad_norm: 1.6903904521676876, clipped: 1.0
epoch: 44, train_batch_id: 600, avg_cost: 3.8790407180786133
grad_norm: 1.7720866517779956, clipped: 1.0
epoch: 44, train_batch_id: 650, avg_cost: 3.8754894733428955
grad_norm: 2.8382953498869896, clipped: 1.0
epoch: 44, train_batch_id: 700, avg_cost: 3.9063565731048584
grad_norm: 1.3321169659219876, clipped: 1.0
epoch: 44, train_batch_id: 750, avg_cost: 3.9134280681610107
grad_norm: 1.9192130886411856, clipped: 1.0
epoch: 44, train_batch_id: 800, avg_cost: 3.887584686279297
grad_norm: 1.730087481515615, clipped: 1.0
epoch: 44, train_batch_id: 850, avg_cost: 3.906177520751953
grad_norm: 3.884308298112283, clipped: 1.0
epoch: 44, train_batch_id: 900, avg_cost: 3.8988037109375
grad_norm: 1.9200693640492006, clipped: 1.0
epoch: 44, train_batch_id: 950, avg_cost: 3.8599987030029297
grad_norm: 1.763230062391724, clipped: 1.0
epoch: 44, train_batch_id: 1000, avg_cost: 3.891995906829834
grad_norm: 2.304536141544416, clipped: 1.0
epoch: 44, train_batch_id: 1050, avg_cost: 3.8804268836975098
grad_norm: 1.6712728886959505, clipped: 1.0
epoch: 44, train_batch_id: 1100, avg_cost: 3.852501392364502
grad_norm: 2.69146767857758, clipped: 1.0
epoch: 44, train_batch_id: 1150, avg_cost: 3.869022846221924
grad_norm: 1.339221913299064, clipped: 1.0
epoch: 44, train_batch_id: 1200, avg_cost: 3.8793797492980957
grad_norm: 1.5858505346055765, clipped: 1.0
epoch: 44, train_batch_id: 1250, avg_cost: 3.8734898567199707
grad_norm: 1.6250330674776137, clipped: 1.0
epoch: 44, train_batch_id: 1300, avg_cost: 3.8621535301208496
grad_norm: 1.767390214332497, clipped: 1.0
epoch: 44, train_batch_id: 1350, avg_cost: 3.8825631141662598
grad_norm: 1.5909824667841226, clipped: 1.0
epoch: 44, train_batch_id: 1400, avg_cost: 3.9048001766204834
grad_norm: 1.467591479125644, clipped: 1.0
epoch: 44, train_batch_id: 1450, avg_cost: 3.8815271854400635
grad_norm: 1.6718383597139421, clipped: 1.0
epoch: 44, train_batch_id: 1500, avg_cost: 3.8868165016174316
grad_norm: 1.7025114618821446, clipped: 1.0
epoch: 44, train_batch_id: 1550, avg_cost: 3.884434700012207
grad_norm: 1.4153508902042506, clipped: 1.0
epoch: 44, train_batch_id: 1600, avg_cost: 3.8959312438964844
grad_norm: 2.3959348351573677, clipped: 1.0
epoch: 44, train_batch_id: 1650, avg_cost: 3.8826799392700195
grad_norm: 1.5267929757514387, clipped: 1.0
epoch: 44, train_batch_id: 1700, avg_cost: 3.920844078063965
grad_norm: 1.1431777299781203, clipped: 1.0
epoch: 44, train_batch_id: 1750, avg_cost: 3.8961548805236816
grad_norm: 1.3512845370849256, clipped: 1.0
epoch: 44, train_batch_id: 1800, avg_cost: 3.9021568298339844
grad_norm: 2.4124427663582044, clipped: 1.0
epoch: 44, train_batch_id: 1850, avg_cost: 3.870009422302246
grad_norm: 1.6739806722077752, clipped: 1.0
epoch: 44, train_batch_id: 1900, avg_cost: 3.90954327583313
grad_norm: 1.734165516265887, clipped: 1.0
epoch: 44, train_batch_id: 1950, avg_cost: 3.8617424964904785
grad_norm: 1.8566954655670447, clipped: 1.0
epoch: 44, train_batch_id: 2000, avg_cost: 3.8838753700256348
grad_norm: 2.1023419271174744, clipped: 1.0
epoch: 44, train_batch_id: 2050, avg_cost: 3.8764028549194336
grad_norm: 2.091205788295422, clipped: 1.0
epoch: 44, train_batch_id: 2100, avg_cost: 3.891017436981201
grad_norm: 1.816124290799601, clipped: 1.0
epoch: 44, train_batch_id: 2150, avg_cost: 3.8554253578186035
grad_norm: 2.1242847232701783, clipped: 1.0
epoch: 44, train_batch_id: 2200, avg_cost: 3.8815181255340576
grad_norm: 2.1725397364425523, clipped: 1.0
epoch: 44, train_batch_id: 2250, avg_cost: 3.8793833255767822
grad_norm: 1.876523692619437, clipped: 1.0
epoch: 44, train_batch_id: 2300, avg_cost: 3.8954648971557617
grad_norm: 1.9535898699471823, clipped: 1.0
epoch: 44, train_batch_id: 2350, avg_cost: 3.876201629638672
grad_norm: 2.102010100770357, clipped: 1.0
epoch: 44, train_batch_id: 2400, avg_cost: 3.8878302574157715
grad_norm: 1.7789426228031655, clipped: 1.0
epoch: 44, train_batch_id: 2450, avg_cost: 3.880265235900879
grad_norm: 3.23472074663405, clipped: 1.0
Finished epoch 44, took 00:09:24 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.290308952331543 +- 0.004087967332452536
Evaluating candidate model on evaluation dataset
Epoch 44 candidate mean 4.280389785766602, baseline epoch 39 mean 4.126363277435303, difference 0.15402650833129883
Start train epoch 45, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 45, train_batch_id: 0, avg_cost: 3.8846397399902344
grad_norm: 1.7947380421293686, clipped: 1.0
epoch: 45, train_batch_id: 50, avg_cost: 3.896059513092041
grad_norm: 1.4783101800378669, clipped: 1.0
epoch: 45, train_batch_id: 100, avg_cost: 3.8810806274414062
grad_norm: 1.651375528224116, clipped: 1.0
epoch: 45, train_batch_id: 150, avg_cost: 3.892709493637085
grad_norm: 4.797209906446368, clipped: 1.0
epoch: 45, train_batch_id: 200, avg_cost: 3.8728599548339844
grad_norm: 1.399773444812466, clipped: 1.0
epoch: 45, train_batch_id: 250, avg_cost: 3.907606840133667
grad_norm: 1.843974243264107, clipped: 1.0
epoch: 45, train_batch_id: 300, avg_cost: 3.9063072204589844
grad_norm: 3.1525016164065156, clipped: 1.0
epoch: 45, train_batch_id: 350, avg_cost: 3.8806891441345215
grad_norm: 2.1041403928194233, clipped: 1.0
epoch: 45, train_batch_id: 400, avg_cost: 3.855314016342163
grad_norm: 1.2562702519075741, clipped: 1.0
epoch: 45, train_batch_id: 450, avg_cost: 3.874645233154297
grad_norm: 1.542414226647451, clipped: 1.0
epoch: 45, train_batch_id: 500, avg_cost: 3.8838186264038086
grad_norm: 1.6952725913123727, clipped: 1.0
epoch: 45, train_batch_id: 550, avg_cost: 3.895866870880127
grad_norm: 1.66591874100267, clipped: 1.0
epoch: 45, train_batch_id: 600, avg_cost: 3.8798117637634277
grad_norm: 2.2298581574638314, clipped: 1.0
epoch: 45, train_batch_id: 650, avg_cost: 3.8871357440948486
grad_norm: 1.6736699468299716, clipped: 1.0
epoch: 45, train_batch_id: 700, avg_cost: 3.8878347873687744
grad_norm: 1.3975123340601314, clipped: 1.0
epoch: 45, train_batch_id: 750, avg_cost: 3.8698770999908447
grad_norm: 1.5855600218685997, clipped: 1.0
epoch: 45, train_batch_id: 800, avg_cost: 3.8596601486206055
grad_norm: 2.5501849300243142, clipped: 1.0
epoch: 45, train_batch_id: 850, avg_cost: 3.899482011795044
grad_norm: 1.5673630861507823, clipped: 1.0
epoch: 45, train_batch_id: 900, avg_cost: 3.9118423461914062
grad_norm: 2.1065904754307683, clipped: 1.0
epoch: 45, train_batch_id: 950, avg_cost: 3.8725414276123047
grad_norm: 2.2812401097368853, clipped: 1.0
epoch: 45, train_batch_id: 1000, avg_cost: 3.8956809043884277
grad_norm: 2.578441180835583, clipped: 1.0
epoch: 45, train_batch_id: 1050, avg_cost: 3.8708324432373047
grad_norm: 2.054643423063989, clipped: 1.0
epoch: 45, train_batch_id: 1100, avg_cost: 3.891960620880127
grad_norm: 1.400381141807037, clipped: 1.0
epoch: 45, train_batch_id: 1150, avg_cost: 3.899170398712158
grad_norm: 2.256769367414573, clipped: 1.0
epoch: 45, train_batch_id: 1200, avg_cost: 3.8891983032226562
grad_norm: 2.24218956745406, clipped: 1.0
epoch: 45, train_batch_id: 1250, avg_cost: 3.8836565017700195
grad_norm: 1.6179856717633176, clipped: 1.0
epoch: 45, train_batch_id: 1300, avg_cost: 3.867910146713257
grad_norm: 1.8974337495959304, clipped: 1.0
epoch: 45, train_batch_id: 1350, avg_cost: 3.9093024730682373
grad_norm: 1.3333363461960974, clipped: 1.0
epoch: 45, train_batch_id: 1400, avg_cost: 3.885615825653076
grad_norm: 2.3302855332056547, clipped: 1.0
epoch: 45, train_batch_id: 1450, avg_cost: 3.868785858154297
grad_norm: 1.6656641914566408, clipped: 1.0
epoch: 45, train_batch_id: 1500, avg_cost: 3.902306079864502
grad_norm: 1.8477214747219688, clipped: 1.0
epoch: 45, train_batch_id: 1550, avg_cost: 3.88596248626709
grad_norm: 2.2555117596739764, clipped: 1.0
epoch: 45, train_batch_id: 1600, avg_cost: 3.901653289794922
grad_norm: 1.6359612747605683, clipped: 1.0
epoch: 45, train_batch_id: 1650, avg_cost: 3.8750667572021484
grad_norm: 1.8004064540281337, clipped: 1.0
epoch: 45, train_batch_id: 1700, avg_cost: 3.895695209503174
grad_norm: 2.195178596234254, clipped: 1.0
epoch: 45, train_batch_id: 1750, avg_cost: 3.8728933334350586
grad_norm: 1.696600458188102, clipped: 1.0
epoch: 45, train_batch_id: 1800, avg_cost: 3.901205539703369
grad_norm: 2.335713393695824, clipped: 1.0
epoch: 45, train_batch_id: 1850, avg_cost: 3.8822474479675293
grad_norm: 1.8297456046201694, clipped: 1.0
epoch: 45, train_batch_id: 1900, avg_cost: 3.898099660873413
grad_norm: 1.6727214452207142, clipped: 1.0
epoch: 45, train_batch_id: 1950, avg_cost: 3.8688840866088867
grad_norm: 1.4018655973635026, clipped: 1.0
epoch: 45, train_batch_id: 2000, avg_cost: 3.8859376907348633
grad_norm: 2.0584086641599857, clipped: 1.0
epoch: 45, train_batch_id: 2050, avg_cost: 3.898956298828125
grad_norm: 1.9301304282410237, clipped: 1.0
epoch: 45, train_batch_id: 2100, avg_cost: 3.874332904815674
grad_norm: 1.8643582486772712, clipped: 1.0
epoch: 45, train_batch_id: 2150, avg_cost: 3.875746965408325
grad_norm: 2.042597877125042, clipped: 1.0
epoch: 45, train_batch_id: 2200, avg_cost: 3.8912363052368164
grad_norm: 1.5812621083938185, clipped: 1.0
epoch: 45, train_batch_id: 2250, avg_cost: 3.888739585876465
grad_norm: 1.3524528058217773, clipped: 1.0
epoch: 45, train_batch_id: 2300, avg_cost: 3.8758974075317383
grad_norm: 2.0077045186191547, clipped: 1.0
epoch: 45, train_batch_id: 2350, avg_cost: 3.8554468154907227
grad_norm: 2.338271269667603, clipped: 1.0
epoch: 45, train_batch_id: 2400, avg_cost: 3.86014723777771
grad_norm: 1.7459594604404607, clipped: 1.0
epoch: 45, train_batch_id: 2450, avg_cost: 3.8913798332214355
grad_norm: 1.332802344117118, clipped: 1.0
Finished epoch 45, took 00:09:24 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.198978424072266 +- 0.003929928410798311
Evaluating candidate model on evaluation dataset
Epoch 45 candidate mean 4.186267375946045, baseline epoch 39 mean 4.126363277435303, difference 0.05990409851074219
Start train epoch 46, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 46, train_batch_id: 0, avg_cost: 3.889960765838623
grad_norm: 1.8458254425892047, clipped: 1.0
epoch: 46, train_batch_id: 50, avg_cost: 3.8670706748962402
grad_norm: 1.8492172224427994, clipped: 1.0
epoch: 46, train_batch_id: 100, avg_cost: 3.87803316116333
grad_norm: 2.212021693819699, clipped: 1.0
epoch: 46, train_batch_id: 150, avg_cost: 3.8855254650115967
grad_norm: 2.2046707938143255, clipped: 1.0
epoch: 46, train_batch_id: 200, avg_cost: 3.891747236251831
grad_norm: 2.0866294828641117, clipped: 1.0
epoch: 46, train_batch_id: 250, avg_cost: 3.868586540222168
grad_norm: 2.5839359749795583, clipped: 1.0
epoch: 46, train_batch_id: 300, avg_cost: 3.900068998336792
grad_norm: 1.7291515947720342, clipped: 1.0
epoch: 46, train_batch_id: 350, avg_cost: 3.882429599761963
grad_norm: 1.61767628847235, clipped: 1.0
epoch: 46, train_batch_id: 400, avg_cost: 3.8943896293640137
grad_norm: 1.7920475864042629, clipped: 1.0
epoch: 46, train_batch_id: 450, avg_cost: 3.881321907043457
grad_norm: 1.5457274638623697, clipped: 1.0
epoch: 46, train_batch_id: 500, avg_cost: 3.8880631923675537
grad_norm: 2.3920318269343563, clipped: 1.0
epoch: 46, train_batch_id: 550, avg_cost: 3.8803935050964355
grad_norm: 2.1921845015959645, clipped: 1.0
epoch: 46, train_batch_id: 600, avg_cost: 3.855938196182251
grad_norm: 1.1322512201851238, clipped: 1.0
epoch: 46, train_batch_id: 650, avg_cost: 3.884812116622925
grad_norm: 1.3661875566332937, clipped: 1.0
epoch: 46, train_batch_id: 700, avg_cost: 3.912137985229492
grad_norm: 2.381746478904214, clipped: 1.0
epoch: 46, train_batch_id: 750, avg_cost: 3.8938486576080322
grad_norm: 1.781035824034015, clipped: 1.0
epoch: 46, train_batch_id: 800, avg_cost: 3.8752691745758057
grad_norm: 1.6564731953037346, clipped: 1.0
epoch: 46, train_batch_id: 850, avg_cost: 3.8657960891723633
grad_norm: 1.772962235314405, clipped: 1.0
epoch: 46, train_batch_id: 900, avg_cost: 3.861001491546631
grad_norm: 2.2658185154565187, clipped: 1.0
epoch: 46, train_batch_id: 950, avg_cost: 3.8526551723480225
grad_norm: 1.4017911863824708, clipped: 1.0
epoch: 46, train_batch_id: 1000, avg_cost: 3.8801801204681396
grad_norm: 1.4735497177813128, clipped: 1.0
epoch: 46, train_batch_id: 1050, avg_cost: 3.8894424438476562
grad_norm: 1.752749030685906, clipped: 1.0
epoch: 46, train_batch_id: 1100, avg_cost: 3.8754642009735107
grad_norm: 2.2887063322247587, clipped: 1.0
epoch: 46, train_batch_id: 1150, avg_cost: 3.890073776245117
grad_norm: 1.4638766141637978, clipped: 1.0
epoch: 46, train_batch_id: 1200, avg_cost: 3.8757948875427246
grad_norm: 1.4145415584125913, clipped: 1.0
epoch: 46, train_batch_id: 1250, avg_cost: 3.8781986236572266
grad_norm: 1.5812985470145435, clipped: 1.0
epoch: 46, train_batch_id: 1300, avg_cost: 3.8985960483551025
grad_norm: 1.7612106290026859, clipped: 1.0
epoch: 46, train_batch_id: 1350, avg_cost: 3.8806586265563965
grad_norm: 1.7980254662544228, clipped: 1.0
epoch: 46, train_batch_id: 1400, avg_cost: 3.8865854740142822
grad_norm: 1.8269936513246345, clipped: 1.0
epoch: 46, train_batch_id: 1450, avg_cost: 3.867199420928955
grad_norm: 1.4929085329857703, clipped: 1.0
epoch: 46, train_batch_id: 1500, avg_cost: 3.8991310596466064
grad_norm: 1.650398017278161, clipped: 1.0
epoch: 46, train_batch_id: 1550, avg_cost: 3.8787293434143066
grad_norm: 1.3452308179507153, clipped: 1.0
epoch: 46, train_batch_id: 1600, avg_cost: 3.8872108459472656
grad_norm: 1.4631590647805555, clipped: 1.0
epoch: 46, train_batch_id: 1650, avg_cost: 3.875702381134033
grad_norm: 2.107238607374996, clipped: 1.0
epoch: 46, train_batch_id: 1700, avg_cost: 3.8835556507110596
grad_norm: 1.3148879376801081, clipped: 1.0
epoch: 46, train_batch_id: 1750, avg_cost: 3.8805654048919678
grad_norm: 1.1645197264695166, clipped: 1.0
epoch: 46, train_batch_id: 1800, avg_cost: 3.891063690185547
grad_norm: 3.174126786216297, clipped: 1.0
epoch: 46, train_batch_id: 1850, avg_cost: 3.88655948638916
grad_norm: 1.6708813682579517, clipped: 1.0
epoch: 46, train_batch_id: 1900, avg_cost: 3.905764102935791
grad_norm: 2.5467730936109034, clipped: 1.0
epoch: 46, train_batch_id: 1950, avg_cost: 3.8636412620544434
grad_norm: 2.093594129185645, clipped: 1.0
epoch: 46, train_batch_id: 2000, avg_cost: 3.8702969551086426
grad_norm: 1.3632070289462344, clipped: 1.0
epoch: 46, train_batch_id: 2050, avg_cost: 3.891475200653076
grad_norm: 1.6269322949943292, clipped: 1.0
epoch: 46, train_batch_id: 2100, avg_cost: 3.9046409130096436
grad_norm: 1.5283162794493523, clipped: 1.0
epoch: 46, train_batch_id: 2150, avg_cost: 3.8942625522613525
grad_norm: 1.5908747295913752, clipped: 1.0
epoch: 46, train_batch_id: 2200, avg_cost: 3.8928279876708984
grad_norm: 1.4402488469087238, clipped: 1.0
epoch: 46, train_batch_id: 2250, avg_cost: 3.888917922973633
grad_norm: 2.3443008945441783, clipped: 1.0
epoch: 46, train_batch_id: 2300, avg_cost: 3.8861331939697266
grad_norm: 1.9103687321809406, clipped: 1.0
epoch: 46, train_batch_id: 2350, avg_cost: 3.902438163757324
grad_norm: 1.631814031485298, clipped: 1.0
epoch: 46, train_batch_id: 2400, avg_cost: 3.873486280441284
grad_norm: 2.258951925737805, clipped: 1.0
epoch: 46, train_batch_id: 2450, avg_cost: 3.878728151321411
grad_norm: 1.3777091191598119, clipped: 1.0
Finished epoch 46, took 00:09:26 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.259467124938965 +- 0.003911515232175589
Evaluating candidate model on evaluation dataset
Epoch 46 candidate mean 4.251166343688965, baseline epoch 39 mean 4.126363277435303, difference 0.12480306625366211
Start train epoch 47, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


epoch: 47, train_batch_id: 0, avg_cost: 3.880988836288452
grad_norm: 1.79023404317837, clipped: 1.0
epoch: 47, train_batch_id: 50, avg_cost: 3.874387502670288
grad_norm: 1.6329801326394804, clipped: 1.0
epoch: 47, train_batch_id: 100, avg_cost: 3.905148983001709
grad_norm: 1.5789451375327517, clipped: 1.0
epoch: 47, train_batch_id: 150, avg_cost: 3.8776259422302246
grad_norm: 2.0368971045127338, clipped: 1.0
epoch: 47, train_batch_id: 200, avg_cost: 3.8888731002807617
grad_norm: 1.7455748579662607, clipped: 1.0
epoch: 47, train_batch_id: 250, avg_cost: 3.883970260620117
grad_norm: 2.1673293397792337, clipped: 1.0
epoch: 47, train_batch_id: 300, avg_cost: 3.88301682472229
grad_norm: 2.0457376435807793, clipped: 1.0
epoch: 47, train_batch_id: 350, avg_cost: 3.8921663761138916
grad_norm: 5.895604573416215, clipped: 1.0
epoch: 47, train_batch_id: 400, avg_cost: 3.8920116424560547
grad_norm: 2.3112165309432067, clipped: 1.0
epoch: 47, train_batch_id: 450, avg_cost: 3.890111207962036
grad_norm: 1.6864171110424528, clipped: 1.0
epoch: 47, train_batch_id: 500, avg_cost: 3.8935227394104004
grad_norm: 1.6186334415673072, clipped: 1.0
epoch: 47, train_batch_id: 550, avg_cost: 3.8830771446228027
grad_norm: 1.8972970511560956, clipped: 1.0
epoch: 47, train_batch_id: 600, avg_cost: 3.882066249847412
grad_norm: 1.1649820419896109, clipped: 1.0
epoch: 47, train_batch_id: 650, avg_cost: 3.884395122528076
grad_norm: 1.9225747989364248, clipped: 1.0
epoch: 47, train_batch_id: 700, avg_cost: 3.890974998474121
grad_norm: 1.4136778031365882, clipped: 1.0
epoch: 47, train_batch_id: 750, avg_cost: 3.863835334777832
grad_norm: 1.930322137939465, clipped: 1.0
epoch: 47, train_batch_id: 800, avg_cost: 3.8606863021850586
grad_norm: 2.6352193846817396, clipped: 1.0
epoch: 47, train_batch_id: 850, avg_cost: 3.8766098022460938
grad_norm: 1.801543774140218, clipped: 1.0
epoch: 47, train_batch_id: 900, avg_cost: 3.875013828277588
grad_norm: 1.5632391872859503, clipped: 1.0
epoch: 47, train_batch_id: 950, avg_cost: 3.8851852416992188
grad_norm: 1.7795656417724053, clipped: 1.0
epoch: 47, train_batch_id: 1000, avg_cost: 3.885133743286133
grad_norm: 1.6136004386033846, clipped: 1.0
epoch: 47, train_batch_id: 1050, avg_cost: 3.8520138263702393
grad_norm: 1.6563400068625265, clipped: 1.0
epoch: 47, train_batch_id: 1100, avg_cost: 3.890566349029541
grad_norm: 4.365836841269959, clipped: 1.0
epoch: 47, train_batch_id: 1150, avg_cost: 3.878025770187378
grad_norm: 1.4433653569124767, clipped: 1.0
epoch: 47, train_batch_id: 1200, avg_cost: 3.8876540660858154
grad_norm: 1.737259524197076, clipped: 1.0
epoch: 47, train_batch_id: 1250, avg_cost: 3.901963710784912
grad_norm: 2.2463202779396823, clipped: 1.0
epoch: 47, train_batch_id: 1300, avg_cost: 3.8866443634033203
grad_norm: 2.61637162302186, clipped: 1.0
epoch: 47, train_batch_id: 1350, avg_cost: 3.909317970275879
grad_norm: 1.9015511152958284, clipped: 1.0
epoch: 47, train_batch_id: 1400, avg_cost: 3.8914380073547363
grad_norm: 1.6480460055997574, clipped: 1.0
epoch: 47, train_batch_id: 1450, avg_cost: 3.865396022796631
grad_norm: 2.1006371345105284, clipped: 1.0
epoch: 47, train_batch_id: 1500, avg_cost: 3.89599609375
grad_norm: 2.4390988513471945, clipped: 1.0
epoch: 47, train_batch_id: 1550, avg_cost: 3.8966622352600098
grad_norm: 1.6627146319944748, clipped: 1.0
epoch: 47, train_batch_id: 1600, avg_cost: 3.891680955886841
grad_norm: 2.7881088440456896, clipped: 1.0
epoch: 47, train_batch_id: 1650, avg_cost: 3.8798365592956543
grad_norm: 3.4558080276568792, clipped: 1.0
epoch: 47, train_batch_id: 1700, avg_cost: 3.867009162902832
grad_norm: 5.75012490505213, clipped: 1.0
epoch: 47, train_batch_id: 1750, avg_cost: 3.8566172122955322
grad_norm: 1.996451205697976, clipped: 1.0
epoch: 47, train_batch_id: 1800, avg_cost: 3.8986825942993164
grad_norm: 1.8688152255234167, clipped: 1.0
epoch: 47, train_batch_id: 1850, avg_cost: 3.898252248764038
grad_norm: 1.438406219509048, clipped: 1.0
epoch: 47, train_batch_id: 1900, avg_cost: 3.905427932739258
grad_norm: 1.4861495225459582, clipped: 1.0
epoch: 47, train_batch_id: 1950, avg_cost: 3.884296417236328
grad_norm: 1.7044760325589086, clipped: 1.0
epoch: 47, train_batch_id: 2000, avg_cost: 3.8754658699035645
grad_norm: 1.6918090901678349, clipped: 1.0
epoch: 47, train_batch_id: 2050, avg_cost: 3.8729257583618164
grad_norm: 2.1083203691940553, clipped: 1.0
epoch: 47, train_batch_id: 2100, avg_cost: 3.899135112762451
grad_norm: 2.3008611946502606, clipped: 1.0
epoch: 47, train_batch_id: 2150, avg_cost: 3.890746593475342
grad_norm: 1.5257510468904656, clipped: 1.0
epoch: 47, train_batch_id: 2200, avg_cost: 3.8878602981567383
grad_norm: 2.053674367062309, clipped: 1.0
epoch: 47, train_batch_id: 2250, avg_cost: 3.8991940021514893
grad_norm: 2.2325562711066556, clipped: 1.0
epoch: 47, train_batch_id: 2300, avg_cost: 3.8749871253967285
grad_norm: 1.7446268310794315, clipped: 1.0
epoch: 47, train_batch_id: 2350, avg_cost: 3.852564573287964
grad_norm: 1.333696288256848, clipped: 1.0
epoch: 47, train_batch_id: 2400, avg_cost: 3.8669369220733643
grad_norm: 1.4641817755638629, clipped: 1.0
epoch: 47, train_batch_id: 2450, avg_cost: 3.8795790672302246
grad_norm: 2.813711868820776, clipped: 1.0
Finished epoch 47, took 00:09:24 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.197304725646973 +- 0.003892376320436597
Evaluating candidate model on evaluation dataset
Epoch 47 candidate mean 4.189267158508301, baseline epoch 39 mean 4.126363277435303, difference 0.06290388107299805
Start train epoch 48, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 48, train_batch_id: 0, avg_cost: 3.8862571716308594
grad_norm: 1.4916834891615969, clipped: 1.0
epoch: 48, train_batch_id: 50, avg_cost: 3.8917183876037598
grad_norm: 1.656198896140126, clipped: 1.0
epoch: 48, train_batch_id: 100, avg_cost: 3.904985189437866
grad_norm: 1.525533392080096, clipped: 1.0
epoch: 48, train_batch_id: 150, avg_cost: 3.8588457107543945
grad_norm: 2.3569739256890196, clipped: 1.0
epoch: 48, train_batch_id: 200, avg_cost: 3.8690249919891357
grad_norm: 1.7066463454997451, clipped: 1.0
epoch: 48, train_batch_id: 250, avg_cost: 3.875761032104492
grad_norm: 1.638066505024548, clipped: 1.0
epoch: 48, train_batch_id: 300, avg_cost: 3.8934366703033447
grad_norm: 1.7212219220581155, clipped: 1.0
epoch: 48, train_batch_id: 350, avg_cost: 3.879019260406494
grad_norm: 2.4407076031499133, clipped: 1.0
epoch: 48, train_batch_id: 400, avg_cost: 3.8814172744750977
grad_norm: 1.7197675011570028, clipped: 1.0
epoch: 48, train_batch_id: 450, avg_cost: 3.8943119049072266
grad_norm: 2.533958405728726, clipped: 1.0
epoch: 48, train_batch_id: 500, avg_cost: 3.8899083137512207
grad_norm: 1.620227071509814, clipped: 1.0
epoch: 48, train_batch_id: 550, avg_cost: 3.8690176010131836
grad_norm: 2.1313731035715144, clipped: 1.0
epoch: 48, train_batch_id: 600, avg_cost: 3.8580124378204346
grad_norm: 2.5449664796648586, clipped: 1.0
epoch: 48, train_batch_id: 650, avg_cost: 3.8632898330688477
grad_norm: 1.670510109484658, clipped: 1.0
epoch: 48, train_batch_id: 700, avg_cost: 3.859678268432617
grad_norm: 1.6839923426643633, clipped: 1.0
epoch: 48, train_batch_id: 750, avg_cost: 3.877685070037842
grad_norm: 4.600030029542497, clipped: 1.0
epoch: 48, train_batch_id: 800, avg_cost: 3.8830204010009766
grad_norm: 1.4325809209717677, clipped: 1.0
epoch: 48, train_batch_id: 850, avg_cost: 3.892454147338867
grad_norm: 1.9268643285314704, clipped: 1.0
epoch: 48, train_batch_id: 900, avg_cost: 3.8724565505981445
grad_norm: 2.4354240608369606, clipped: 1.0
epoch: 48, train_batch_id: 950, avg_cost: 3.89454984664917
grad_norm: 2.0505542165337363, clipped: 1.0
epoch: 48, train_batch_id: 1000, avg_cost: 3.8756160736083984
grad_norm: 1.4102257551916288, clipped: 1.0
epoch: 48, train_batch_id: 1050, avg_cost: 3.888352394104004
grad_norm: 1.908629172204224, clipped: 1.0
epoch: 48, train_batch_id: 1100, avg_cost: 3.913388729095459
grad_norm: 1.8065000918477578, clipped: 1.0
epoch: 48, train_batch_id: 1150, avg_cost: 3.8947410583496094
grad_norm: 2.487960147456314, clipped: 1.0
epoch: 48, train_batch_id: 1200, avg_cost: 3.8792479038238525
grad_norm: 1.574900954254484, clipped: 1.0
epoch: 48, train_batch_id: 1250, avg_cost: 3.869401454925537
grad_norm: 1.6969544987818963, clipped: 1.0
epoch: 48, train_batch_id: 1300, avg_cost: 3.889803886413574
grad_norm: 1.7140767392224026, clipped: 1.0
epoch: 48, train_batch_id: 1350, avg_cost: 3.888962984085083
grad_norm: 2.0831370411145156, clipped: 1.0
epoch: 48, train_batch_id: 1400, avg_cost: 3.861438751220703
grad_norm: 2.186484436192087, clipped: 1.0
epoch: 48, train_batch_id: 1450, avg_cost: 3.876865863800049
grad_norm: 1.4537971038887139, clipped: 1.0
epoch: 48, train_batch_id: 1500, avg_cost: 3.8890106678009033
grad_norm: 2.1218696660142156, clipped: 1.0
epoch: 48, train_batch_id: 1550, avg_cost: 3.8813300132751465
grad_norm: 2.2098575872559536, clipped: 1.0
epoch: 48, train_batch_id: 1600, avg_cost: 3.9014086723327637
grad_norm: 2.0028306785893326, clipped: 1.0
epoch: 48, train_batch_id: 1650, avg_cost: 3.8621020317077637
grad_norm: 1.6022797933218262, clipped: 1.0
epoch: 48, train_batch_id: 1700, avg_cost: 3.89674711227417
grad_norm: 1.3412626973794346, clipped: 1.0
epoch: 48, train_batch_id: 1750, avg_cost: 3.8824350833892822
grad_norm: 1.979116310733418, clipped: 1.0
epoch: 48, train_batch_id: 1800, avg_cost: 3.9034316539764404
grad_norm: 1.6504490106106413, clipped: 1.0
epoch: 48, train_batch_id: 1850, avg_cost: 3.880734920501709
grad_norm: 1.9029033974932985, clipped: 1.0
epoch: 48, train_batch_id: 1900, avg_cost: 3.910057306289673
grad_norm: 1.267889871770769, clipped: 1.0
epoch: 48, train_batch_id: 1950, avg_cost: 3.886213779449463
grad_norm: 1.780118579600067, clipped: 1.0
epoch: 48, train_batch_id: 2000, avg_cost: 3.907599925994873
grad_norm: 1.791166380854038, clipped: 1.0
epoch: 48, train_batch_id: 2050, avg_cost: 3.8806028366088867
grad_norm: 1.9980230938199004, clipped: 1.0
epoch: 48, train_batch_id: 2100, avg_cost: 3.8797507286071777
grad_norm: 1.492041953157733, clipped: 1.0
epoch: 48, train_batch_id: 2150, avg_cost: 3.8787059783935547
grad_norm: 2.168221657348364, clipped: 1.0
epoch: 48, train_batch_id: 2200, avg_cost: 3.8662476539611816
grad_norm: 2.5454259314469483, clipped: 1.0
epoch: 48, train_batch_id: 2250, avg_cost: 3.8643674850463867
grad_norm: 1.6770712523554725, clipped: 1.0
epoch: 48, train_batch_id: 2300, avg_cost: 3.9250946044921875
grad_norm: 3.3571660173736135, clipped: 1.0
epoch: 48, train_batch_id: 2350, avg_cost: 3.8701817989349365
grad_norm: 2.2727000539061724, clipped: 1.0
epoch: 48, train_batch_id: 2400, avg_cost: 3.929032564163208
grad_norm: 2.171279366871085, clipped: 1.0
epoch: 48, train_batch_id: 2450, avg_cost: 3.85945987701416
grad_norm: 2.5220022703628753, clipped: 1.0
Finished epoch 48, took 00:09:24 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.14683198928833 +- 0.0037440494634211063
Evaluating candidate model on evaluation dataset
Epoch 48 candidate mean 4.136871814727783, baseline epoch 39 mean 4.126363277435303, difference 0.010508537292480469
Start train epoch 49, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


epoch: 49, train_batch_id: 0, avg_cost: 3.8726816177368164
grad_norm: 1.929102539573344, clipped: 1.0
epoch: 49, train_batch_id: 50, avg_cost: 3.865903854370117
grad_norm: 1.651842975242588, clipped: 1.0
epoch: 49, train_batch_id: 100, avg_cost: 3.895569324493408
grad_norm: 1.877482578568442, clipped: 1.0
epoch: 49, train_batch_id: 150, avg_cost: 3.8921265602111816
grad_norm: 1.7626565303006163, clipped: 1.0
epoch: 49, train_batch_id: 200, avg_cost: 3.8776512145996094
grad_norm: 1.29986467720894, clipped: 1.0
epoch: 49, train_batch_id: 250, avg_cost: 3.8775482177734375
grad_norm: 1.2652950666379734, clipped: 1.0
epoch: 49, train_batch_id: 300, avg_cost: 3.8567252159118652
grad_norm: 1.4800759514208806, clipped: 1.0
epoch: 49, train_batch_id: 350, avg_cost: 3.877725601196289
grad_norm: 1.5720136768360684, clipped: 1.0
epoch: 49, train_batch_id: 400, avg_cost: 3.893233299255371
grad_norm: 2.045131825537589, clipped: 1.0
epoch: 49, train_batch_id: 450, avg_cost: 3.8739285469055176
grad_norm: 1.8783817072084914, clipped: 1.0
epoch: 49, train_batch_id: 500, avg_cost: 3.878312826156616
grad_norm: 1.586825458028116, clipped: 1.0
epoch: 49, train_batch_id: 550, avg_cost: 3.8987302780151367
grad_norm: 1.8013381257576504, clipped: 1.0
epoch: 49, train_batch_id: 600, avg_cost: 3.8742942810058594
grad_norm: 1.9208364764500772, clipped: 1.0
epoch: 49, train_batch_id: 650, avg_cost: 3.860682964324951
grad_norm: 3.4898419412635397, clipped: 1.0
epoch: 49, train_batch_id: 700, avg_cost: 3.88173770904541
grad_norm: 1.7270015164131474, clipped: 1.0
epoch: 49, train_batch_id: 750, avg_cost: 3.9019570350646973
grad_norm: 2.0982464269352454, clipped: 1.0
epoch: 49, train_batch_id: 800, avg_cost: 3.8972933292388916
grad_norm: 3.512119659415305, clipped: 1.0
epoch: 49, train_batch_id: 850, avg_cost: 3.9027562141418457
grad_norm: 1.4744343208807367, clipped: 1.0
epoch: 49, train_batch_id: 900, avg_cost: 3.8732659816741943
grad_norm: 2.096703529727797, clipped: 1.0
epoch: 49, train_batch_id: 950, avg_cost: 3.8898658752441406
grad_norm: 2.310664191527098, clipped: 1.0
epoch: 49, train_batch_id: 1000, avg_cost: 3.888183116912842
grad_norm: 3.4693520294478826, clipped: 1.0
epoch: 49, train_batch_id: 1050, avg_cost: 3.895965337753296
grad_norm: 1.9271752643506415, clipped: 1.0
epoch: 49, train_batch_id: 1100, avg_cost: 3.8755791187286377
grad_norm: 1.5584967654870245, clipped: 1.0
epoch: 49, train_batch_id: 1150, avg_cost: 3.887275218963623
grad_norm: 2.2198206100928157, clipped: 1.0
epoch: 49, train_batch_id: 1200, avg_cost: 3.8778669834136963
grad_norm: 3.385426283172792, clipped: 1.0
epoch: 49, train_batch_id: 1250, avg_cost: 3.891751527786255
grad_norm: 1.487031291648828, clipped: 1.0
epoch: 49, train_batch_id: 1300, avg_cost: 3.8859238624572754
grad_norm: 1.722244914519331, clipped: 1.0
epoch: 49, train_batch_id: 1350, avg_cost: 3.874302625656128
grad_norm: 1.858516621526038, clipped: 1.0
epoch: 49, train_batch_id: 1400, avg_cost: 3.8847522735595703
grad_norm: 2.2008315391736977, clipped: 1.0
epoch: 49, train_batch_id: 1450, avg_cost: 3.8626604080200195
grad_norm: 1.790687503516956, clipped: 1.0
epoch: 49, train_batch_id: 1500, avg_cost: 3.8841445446014404
grad_norm: 2.3026593743810513, clipped: 1.0
epoch: 49, train_batch_id: 1550, avg_cost: 3.8785037994384766
grad_norm: 2.002944998294963, clipped: 1.0
epoch: 49, train_batch_id: 1600, avg_cost: 3.8690099716186523
grad_norm: 6.915309637345159, clipped: 1.0
epoch: 49, train_batch_id: 1650, avg_cost: 3.8404712677001953
grad_norm: 1.5941350522892734, clipped: 1.0
epoch: 49, train_batch_id: 1700, avg_cost: 3.8828125
grad_norm: 1.779702362126753, clipped: 1.0
epoch: 49, train_batch_id: 1750, avg_cost: 3.8804521560668945
grad_norm: 2.6921574110114843, clipped: 1.0
epoch: 49, train_batch_id: 1800, avg_cost: 3.8922362327575684
grad_norm: 2.087962111943875, clipped: 1.0
epoch: 49, train_batch_id: 1850, avg_cost: 3.8907132148742676
grad_norm: 2.3254155389661184, clipped: 1.0
epoch: 49, train_batch_id: 1900, avg_cost: 3.8851757049560547
grad_norm: 1.870519359069473, clipped: 1.0
epoch: 49, train_batch_id: 1950, avg_cost: 3.8635783195495605
grad_norm: 1.91970325521709, clipped: 1.0
epoch: 49, train_batch_id: 2000, avg_cost: 3.866795301437378
grad_norm: 1.800512061493537, clipped: 1.0
epoch: 49, train_batch_id: 2050, avg_cost: 3.8694193363189697
grad_norm: 2.319383739972605, clipped: 1.0
epoch: 49, train_batch_id: 2100, avg_cost: 3.885603427886963
grad_norm: 1.503581667488106, clipped: 1.0
epoch: 49, train_batch_id: 2150, avg_cost: 3.8931961059570312
grad_norm: 1.5899914890728695, clipped: 1.0
epoch: 49, train_batch_id: 2200, avg_cost: 3.8901772499084473
grad_norm: 1.7487130536922566, clipped: 1.0
epoch: 49, train_batch_id: 2250, avg_cost: 3.8720335960388184
grad_norm: 1.8116102343697322, clipped: 1.0
epoch: 49, train_batch_id: 2300, avg_cost: 3.883357048034668
grad_norm: 2.5883740817885412, clipped: 1.0
epoch: 49, train_batch_id: 2350, avg_cost: 3.8861591815948486
grad_norm: 1.7691515679291396, clipped: 1.0
epoch: 49, train_batch_id: 2400, avg_cost: 3.8802778720855713
grad_norm: 1.27840643414906, clipped: 1.0
epoch: 49, train_batch_id: 2450, avg_cost: 3.915250301361084
grad_norm: 2.3444554269955926, clipped: 1.0
Finished epoch 49, took 00:09:25 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.207470417022705 +- 0.0039487360045313835
Evaluating candidate model on evaluation dataset
Epoch 49 candidate mean 4.19534158706665, baseline epoch 39 mean 4.126363277435303, difference 0.06897830963134766
Start train epoch 50, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 50, train_batch_id: 0, avg_cost: 3.8640589714050293
grad_norm: 2.391867034119571, clipped: 1.0
epoch: 50, train_batch_id: 50, avg_cost: 3.9018218517303467
grad_norm: 2.077311389868645, clipped: 1.0
epoch: 50, train_batch_id: 100, avg_cost: 3.9023804664611816
grad_norm: 1.6503661899165265, clipped: 1.0
epoch: 50, train_batch_id: 150, avg_cost: 3.862447500228882
grad_norm: 1.7784924913898688, clipped: 1.0
epoch: 50, train_batch_id: 200, avg_cost: 3.8658945560455322
grad_norm: 1.4478362969558989, clipped: 1.0
epoch: 50, train_batch_id: 250, avg_cost: 3.8935487270355225
grad_norm: 1.6398554607867282, clipped: 1.0
epoch: 50, train_batch_id: 300, avg_cost: 3.863358497619629
grad_norm: 2.3102343225886885, clipped: 1.0
epoch: 50, train_batch_id: 350, avg_cost: 3.8844003677368164
grad_norm: 2.1393435883309357, clipped: 1.0
epoch: 50, train_batch_id: 400, avg_cost: 3.893847942352295
grad_norm: 2.3299651914462105, clipped: 1.0
epoch: 50, train_batch_id: 450, avg_cost: 3.9052982330322266
grad_norm: 2.8544376835338103, clipped: 1.0
epoch: 50, train_batch_id: 500, avg_cost: 3.886460304260254
grad_norm: 1.7952715385413154, clipped: 1.0
epoch: 50, train_batch_id: 550, avg_cost: 3.8823652267456055
grad_norm: 1.8621823792201624, clipped: 1.0
epoch: 50, train_batch_id: 600, avg_cost: 3.8862409591674805
grad_norm: 1.7593525255811324, clipped: 1.0
epoch: 50, train_batch_id: 650, avg_cost: 3.8995299339294434
grad_norm: 1.0383942073760437, clipped: 1.0
epoch: 50, train_batch_id: 700, avg_cost: 3.886183261871338
grad_norm: 2.141627617450384, clipped: 1.0
epoch: 50, train_batch_id: 750, avg_cost: 3.8638596534729004
grad_norm: 1.5678726579527653, clipped: 1.0
epoch: 50, train_batch_id: 800, avg_cost: 3.866971731185913
grad_norm: 1.7010957217991998, clipped: 1.0
epoch: 50, train_batch_id: 850, avg_cost: 3.915753126144409
grad_norm: 1.838633487813869, clipped: 1.0
epoch: 50, train_batch_id: 900, avg_cost: 3.860258102416992
grad_norm: 2.0980940010954647, clipped: 1.0
epoch: 50, train_batch_id: 950, avg_cost: 3.879088878631592
grad_norm: 1.5605173482939763, clipped: 1.0
epoch: 50, train_batch_id: 1000, avg_cost: 3.8783791065216064
grad_norm: 1.4578692392173667, clipped: 1.0
epoch: 50, train_batch_id: 1050, avg_cost: 3.8936519622802734
grad_norm: 1.9971393441781173, clipped: 1.0
epoch: 50, train_batch_id: 1100, avg_cost: 3.8624539375305176
grad_norm: 1.649470456145825, clipped: 1.0
epoch: 50, train_batch_id: 1150, avg_cost: 3.872833490371704
grad_norm: 2.04158727998355, clipped: 1.0
epoch: 50, train_batch_id: 1200, avg_cost: 3.908867835998535
grad_norm: 2.4928728826251993, clipped: 1.0
epoch: 50, train_batch_id: 1250, avg_cost: 3.8928165435791016
grad_norm: 2.660295974747955, clipped: 1.0
epoch: 50, train_batch_id: 1300, avg_cost: 3.895127058029175
grad_norm: 1.474566434020275, clipped: 1.0
epoch: 50, train_batch_id: 1350, avg_cost: 3.88815975189209
grad_norm: 2.0796919742985938, clipped: 1.0
epoch: 50, train_batch_id: 1400, avg_cost: 3.9045519828796387
grad_norm: 1.4017198511593165, clipped: 1.0
epoch: 50, train_batch_id: 1450, avg_cost: 3.874980926513672
grad_norm: 2.570707877143505, clipped: 1.0
epoch: 50, train_batch_id: 1500, avg_cost: 3.886198043823242
grad_norm: 2.3033656333949506, clipped: 1.0
epoch: 50, train_batch_id: 1550, avg_cost: 3.8844408988952637
grad_norm: 1.8211844493343543, clipped: 1.0
epoch: 50, train_batch_id: 1600, avg_cost: 3.899667263031006
grad_norm: 1.4003286414032348, clipped: 1.0
epoch: 50, train_batch_id: 1650, avg_cost: 3.892456531524658
grad_norm: 1.6012663736661774, clipped: 1.0
epoch: 50, train_batch_id: 1700, avg_cost: 3.880676746368408
grad_norm: 1.4596593579243367, clipped: 1.0
epoch: 50, train_batch_id: 1750, avg_cost: 3.8691680431365967
grad_norm: 1.8761576146957846, clipped: 1.0
epoch: 50, train_batch_id: 1800, avg_cost: 3.881678581237793
grad_norm: 1.4571433085799088, clipped: 1.0
epoch: 50, train_batch_id: 1850, avg_cost: 3.9243478775024414
grad_norm: 1.6590513972325622, clipped: 1.0
epoch: 50, train_batch_id: 1900, avg_cost: 3.8829803466796875
grad_norm: 1.8247064252182326, clipped: 1.0
epoch: 50, train_batch_id: 1950, avg_cost: 3.856283187866211
grad_norm: 1.7469100271598677, clipped: 1.0
epoch: 50, train_batch_id: 2000, avg_cost: 3.8879032135009766
grad_norm: 2.149609875736216, clipped: 1.0
epoch: 50, train_batch_id: 2050, avg_cost: 3.9050328731536865
grad_norm: 2.0398640231919334, clipped: 1.0
epoch: 50, train_batch_id: 2100, avg_cost: 3.880911111831665
grad_norm: 1.7274164383236337, clipped: 1.0
epoch: 50, train_batch_id: 2150, avg_cost: 3.874417781829834
grad_norm: 1.1633450178402869, clipped: 1.0
epoch: 50, train_batch_id: 2200, avg_cost: 3.901902675628662
grad_norm: 1.5414053997460635, clipped: 1.0
epoch: 50, train_batch_id: 2250, avg_cost: 3.8851308822631836
grad_norm: 1.2929356755380839, clipped: 1.0
epoch: 50, train_batch_id: 2300, avg_cost: 3.9007668495178223
grad_norm: 1.622645491022103, clipped: 1.0
epoch: 50, train_batch_id: 2350, avg_cost: 3.868518590927124
grad_norm: 2.3847284011541467, clipped: 1.0
epoch: 50, train_batch_id: 2400, avg_cost: 3.8739335536956787
grad_norm: 1.8557606537625506, clipped: 1.0
epoch: 50, train_batch_id: 2450, avg_cost: 3.8960838317871094
grad_norm: 1.8660426511954884, clipped: 1.0
Finished epoch 50, took 00:09:26 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.259119033813477 +- 0.00399438152089715
Evaluating candidate model on evaluation dataset
Epoch 50 candidate mean 4.251716613769531, baseline epoch 39 mean 4.126363277435303, difference 0.12535333633422852
Start train epoch 51, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


epoch: 51, train_batch_id: 0, avg_cost: 3.886122465133667
grad_norm: 1.6356035423118014, clipped: 1.0
epoch: 51, train_batch_id: 50, avg_cost: 3.8884687423706055
grad_norm: 1.475721515867807, clipped: 1.0
epoch: 51, train_batch_id: 100, avg_cost: 3.8636181354522705
grad_norm: 1.5364352416475362, clipped: 1.0
epoch: 51, train_batch_id: 150, avg_cost: 3.8755791187286377
grad_norm: 2.2664550137837587, clipped: 1.0
epoch: 51, train_batch_id: 200, avg_cost: 3.9085893630981445
grad_norm: 1.9396713698914525, clipped: 1.0
epoch: 51, train_batch_id: 250, avg_cost: 3.8935890197753906
grad_norm: 2.505543502458609, clipped: 1.0
epoch: 51, train_batch_id: 300, avg_cost: 3.8771579265594482
grad_norm: 2.54519879800359, clipped: 1.0
epoch: 51, train_batch_id: 350, avg_cost: 3.8962671756744385
grad_norm: 1.5508379874459373, clipped: 1.0
epoch: 51, train_batch_id: 400, avg_cost: 3.8722422122955322
grad_norm: 1.4708321670518039, clipped: 1.0
epoch: 51, train_batch_id: 450, avg_cost: 3.8403282165527344
grad_norm: 1.5479184490206255, clipped: 1.0
epoch: 51, train_batch_id: 500, avg_cost: 3.8886213302612305
grad_norm: 1.7468737862229338, clipped: 1.0
epoch: 51, train_batch_id: 550, avg_cost: 3.903964042663574
grad_norm: 1.386974496299258, clipped: 1.0
epoch: 51, train_batch_id: 600, avg_cost: 3.83413028717041
grad_norm: 2.1667548511515733, clipped: 1.0
epoch: 51, train_batch_id: 650, avg_cost: 3.896766185760498
grad_norm: 2.089480259026081, clipped: 1.0
epoch: 51, train_batch_id: 700, avg_cost: 3.8761038780212402
grad_norm: 1.5040217154916404, clipped: 1.0
epoch: 51, train_batch_id: 750, avg_cost: 3.8884477615356445
grad_norm: 2.0949143371903927, clipped: 1.0
epoch: 51, train_batch_id: 800, avg_cost: 3.864943504333496
grad_norm: 1.643873644186239, clipped: 1.0
epoch: 51, train_batch_id: 850, avg_cost: 3.8844974040985107
grad_norm: 2.1587696325009404, clipped: 1.0
epoch: 51, train_batch_id: 900, avg_cost: 3.869337320327759
grad_norm: 3.781485945893258, clipped: 1.0
epoch: 51, train_batch_id: 950, avg_cost: 3.8894920349121094
grad_norm: 2.593042178719456, clipped: 1.0
epoch: 51, train_batch_id: 1000, avg_cost: 3.8872008323669434
grad_norm: 1.4007062674176634, clipped: 1.0
epoch: 51, train_batch_id: 1050, avg_cost: 3.849792242050171
grad_norm: 1.748820736182441, clipped: 1.0
epoch: 51, train_batch_id: 1100, avg_cost: 3.870502471923828
grad_norm: 1.6460500546699175, clipped: 1.0
epoch: 51, train_batch_id: 1150, avg_cost: 3.8849735260009766
grad_norm: 2.1325164963002186, clipped: 1.0
epoch: 51, train_batch_id: 1200, avg_cost: 3.8840677738189697
grad_norm: 2.0289860055339375, clipped: 1.0
epoch: 51, train_batch_id: 1250, avg_cost: 3.8714754581451416
grad_norm: 1.943873527463882, clipped: 1.0
epoch: 51, train_batch_id: 1300, avg_cost: 3.8797717094421387
grad_norm: 1.6742718422719656, clipped: 1.0
epoch: 51, train_batch_id: 1350, avg_cost: 3.8476386070251465
grad_norm: 1.6841352501027866, clipped: 1.0
epoch: 51, train_batch_id: 1400, avg_cost: 3.898946523666382
grad_norm: 1.852858284954758, clipped: 1.0
epoch: 51, train_batch_id: 1450, avg_cost: 3.863863945007324
grad_norm: 2.32560507928083, clipped: 1.0
epoch: 51, train_batch_id: 1500, avg_cost: 3.880230665206909
grad_norm: 2.191629171639617, clipped: 1.0
epoch: 51, train_batch_id: 1550, avg_cost: 3.906787395477295
grad_norm: 2.135226856690929, clipped: 1.0
epoch: 51, train_batch_id: 1600, avg_cost: 3.8622372150421143
grad_norm: 5.558840199378442, clipped: 1.0
epoch: 51, train_batch_id: 1650, avg_cost: 3.896188259124756
grad_norm: 1.7121959447727515, clipped: 1.0
epoch: 51, train_batch_id: 1700, avg_cost: 3.8907783031463623
grad_norm: 1.7751611535972132, clipped: 1.0
epoch: 51, train_batch_id: 1750, avg_cost: 3.8934037685394287
grad_norm: 2.3266693836096826, clipped: 1.0
epoch: 51, train_batch_id: 1800, avg_cost: 3.8725688457489014
grad_norm: 1.8047178936147725, clipped: 1.0
epoch: 51, train_batch_id: 1850, avg_cost: 3.8706321716308594
grad_norm: 1.4594566939796039, clipped: 1.0
epoch: 51, train_batch_id: 1900, avg_cost: 3.8724522590637207
grad_norm: 1.5188761056950588, clipped: 1.0
epoch: 51, train_batch_id: 1950, avg_cost: 3.8742761611938477
grad_norm: 1.1417122386753848, clipped: 1.0
epoch: 51, train_batch_id: 2000, avg_cost: 3.9029226303100586
grad_norm: 2.019270710692719, clipped: 1.0
epoch: 51, train_batch_id: 2050, avg_cost: 3.8629989624023438
grad_norm: 1.821416734487777, clipped: 1.0
epoch: 51, train_batch_id: 2100, avg_cost: 3.8866443634033203
grad_norm: 1.7825756577731844, clipped: 1.0
epoch: 51, train_batch_id: 2150, avg_cost: 3.886836290359497
grad_norm: 1.915715268117866, clipped: 1.0
epoch: 51, train_batch_id: 2200, avg_cost: 3.895083427429199
grad_norm: 2.9574999553589665, clipped: 1.0
epoch: 51, train_batch_id: 2250, avg_cost: 3.869936943054199
grad_norm: 1.1459666729718065, clipped: 1.0
epoch: 51, train_batch_id: 2300, avg_cost: 3.8981716632843018
grad_norm: 3.3549029520662326, clipped: 1.0
epoch: 51, train_batch_id: 2350, avg_cost: 3.906405448913574
grad_norm: 2.2040212809253985, clipped: 1.0
epoch: 51, train_batch_id: 2400, avg_cost: 3.88529896736145
grad_norm: 2.1946435698531577, clipped: 1.0
epoch: 51, train_batch_id: 2450, avg_cost: 3.8597207069396973
grad_norm: 1.5105192731566877, clipped: 1.0
Finished epoch 51, took 00:09:22 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.195443153381348 +- 0.0038736506830900908
Evaluating candidate model on evaluation dataset
Epoch 51 candidate mean 4.18771505355835, baseline epoch 39 mean 4.126363277435303, difference 0.061351776123046875
Start train epoch 52, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 52, train_batch_id: 0, avg_cost: 3.8757526874542236
grad_norm: 2.4724822292843607, clipped: 1.0
epoch: 52, train_batch_id: 50, avg_cost: 3.8828635215759277
grad_norm: 1.7788675827975489, clipped: 1.0
epoch: 52, train_batch_id: 100, avg_cost: 3.896257162094116
grad_norm: 2.196782045298359, clipped: 1.0
epoch: 52, train_batch_id: 150, avg_cost: 3.868724822998047
grad_norm: 1.7783623521483107, clipped: 1.0
epoch: 52, train_batch_id: 200, avg_cost: 3.856212854385376
grad_norm: 1.9583488054593219, clipped: 1.0
epoch: 52, train_batch_id: 250, avg_cost: 3.8866684436798096
grad_norm: 2.347634529022757, clipped: 1.0
epoch: 52, train_batch_id: 300, avg_cost: 3.8682332038879395
grad_norm: 1.7638031141087822, clipped: 1.0
epoch: 52, train_batch_id: 350, avg_cost: 3.889369487762451
grad_norm: 1.3491851385720943, clipped: 1.0
epoch: 52, train_batch_id: 400, avg_cost: 3.879307270050049
grad_norm: 2.223350937620474, clipped: 1.0
epoch: 52, train_batch_id: 450, avg_cost: 3.883070945739746
grad_norm: 1.6356915523596933, clipped: 1.0
epoch: 52, train_batch_id: 500, avg_cost: 3.890214204788208
grad_norm: 1.866197983805375, clipped: 1.0
epoch: 52, train_batch_id: 550, avg_cost: 3.8843443393707275
grad_norm: 1.856012551437382, clipped: 1.0
epoch: 52, train_batch_id: 600, avg_cost: 3.868372678756714
grad_norm: 1.9578885282304612, clipped: 1.0
epoch: 52, train_batch_id: 650, avg_cost: 3.8802781105041504
grad_norm: 2.1864083321528263, clipped: 1.0
epoch: 52, train_batch_id: 700, avg_cost: 3.870788097381592
grad_norm: 2.0612070438096826, clipped: 1.0
epoch: 52, train_batch_id: 750, avg_cost: 3.893925666809082
grad_norm: 1.5095677261792797, clipped: 1.0
epoch: 52, train_batch_id: 800, avg_cost: 3.869987964630127
grad_norm: 1.9133291410366848, clipped: 1.0
epoch: 52, train_batch_id: 850, avg_cost: 3.8842151165008545
grad_norm: 1.680389021897217, clipped: 1.0
epoch: 52, train_batch_id: 900, avg_cost: 3.8730716705322266
grad_norm: 2.4179253218037675, clipped: 1.0
epoch: 52, train_batch_id: 950, avg_cost: 3.8902878761291504
grad_norm: 1.7692880566269134, clipped: 1.0
epoch: 52, train_batch_id: 1000, avg_cost: 3.8734874725341797
grad_norm: 2.1352606034083923, clipped: 1.0
epoch: 52, train_batch_id: 1050, avg_cost: 3.8943839073181152
grad_norm: 2.33776938227112, clipped: 1.0
epoch: 52, train_batch_id: 1100, avg_cost: 3.887693166732788
grad_norm: 1.2480661769431738, clipped: 1.0
epoch: 52, train_batch_id: 1150, avg_cost: 3.8584225177764893
grad_norm: 1.4681724271029848, clipped: 1.0
epoch: 52, train_batch_id: 1200, avg_cost: 3.9002015590667725
grad_norm: 2.41426020122795, clipped: 1.0
epoch: 52, train_batch_id: 1250, avg_cost: 3.8765110969543457
grad_norm: 1.8734278921514995, clipped: 1.0
epoch: 52, train_batch_id: 1300, avg_cost: 3.8747127056121826
grad_norm: 2.6328602979677243, clipped: 1.0
epoch: 52, train_batch_id: 1350, avg_cost: 3.8755812644958496
grad_norm: 1.726135986598129, clipped: 1.0
epoch: 52, train_batch_id: 1400, avg_cost: 3.893313407897949
grad_norm: 2.2480776380345566, clipped: 1.0
epoch: 52, train_batch_id: 1450, avg_cost: 3.895244836807251
grad_norm: 1.9760516194107298, clipped: 1.0
epoch: 52, train_batch_id: 1500, avg_cost: 3.8755431175231934
grad_norm: 1.3809344845088216, clipped: 1.0
epoch: 52, train_batch_id: 1550, avg_cost: 3.9001502990722656
grad_norm: 1.7895912139488808, clipped: 1.0
epoch: 52, train_batch_id: 1600, avg_cost: 3.886598587036133
grad_norm: 1.6586591823833712, clipped: 1.0
epoch: 52, train_batch_id: 1650, avg_cost: 3.881701946258545
grad_norm: 2.047194739655658, clipped: 1.0
epoch: 52, train_batch_id: 1700, avg_cost: 3.8435983657836914
grad_norm: 1.846440616276821, clipped: 1.0
epoch: 52, train_batch_id: 1750, avg_cost: 3.8986573219299316
grad_norm: 1.9266209449930793, clipped: 1.0
epoch: 52, train_batch_id: 1800, avg_cost: 3.884239673614502
grad_norm: 2.5721951120575968, clipped: 1.0
epoch: 52, train_batch_id: 1850, avg_cost: 3.882063865661621
grad_norm: 1.6559312911451793, clipped: 1.0
epoch: 52, train_batch_id: 1900, avg_cost: 3.8999414443969727
grad_norm: 1.9678657923934344, clipped: 1.0
epoch: 52, train_batch_id: 1950, avg_cost: 3.8971922397613525
grad_norm: 1.4825218480809397, clipped: 1.0
epoch: 52, train_batch_id: 2000, avg_cost: 3.868795394897461
grad_norm: 2.8892219349273955, clipped: 1.0
epoch: 52, train_batch_id: 2050, avg_cost: 3.871157169342041
grad_norm: 17.131877836444794, clipped: 1.0
epoch: 52, train_batch_id: 2100, avg_cost: 3.9115638732910156
grad_norm: 1.93507087055646, clipped: 1.0
epoch: 52, train_batch_id: 2150, avg_cost: 3.884455680847168
grad_norm: 2.0911324880102415, clipped: 1.0
epoch: 52, train_batch_id: 2200, avg_cost: 3.8589513301849365
grad_norm: 3.442580225680575, clipped: 1.0
epoch: 52, train_batch_id: 2250, avg_cost: 3.8859353065490723
grad_norm: 1.4370838992100328, clipped: 1.0
epoch: 52, train_batch_id: 2300, avg_cost: 3.886009454727173
grad_norm: 1.5763522624912525, clipped: 1.0
epoch: 52, train_batch_id: 2350, avg_cost: 3.9063024520874023
grad_norm: 1.872133457175371, clipped: 1.0
epoch: 52, train_batch_id: 2400, avg_cost: 3.869368314743042
grad_norm: 2.3273644683628802, clipped: 1.0
epoch: 52, train_batch_id: 2450, avg_cost: 3.8890509605407715
grad_norm: 2.5691852886918554, clipped: 1.0
Finished epoch 52, took 00:09:18 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.279130935668945 +- 0.00408942112699151
Evaluating candidate model on evaluation dataset
Epoch 52 candidate mean 4.266491889953613, baseline epoch 39 mean 4.126363277435303, difference 0.14012861251831055
Start train epoch 53, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 53, train_batch_id: 0, avg_cost: 3.864654064178467
grad_norm: 1.4444967580104338, clipped: 1.0
epoch: 53, train_batch_id: 50, avg_cost: 3.8677115440368652
grad_norm: 2.5215290603542146, clipped: 1.0
epoch: 53, train_batch_id: 100, avg_cost: 3.870420455932617
grad_norm: 2.004228947550871, clipped: 1.0
epoch: 53, train_batch_id: 150, avg_cost: 3.8822121620178223
grad_norm: 6.124391495763345, clipped: 1.0
epoch: 53, train_batch_id: 200, avg_cost: 3.8772549629211426
grad_norm: 1.4083753084787294, clipped: 1.0
epoch: 53, train_batch_id: 250, avg_cost: 3.878847122192383
grad_norm: 1.9568998257948922, clipped: 1.0
epoch: 53, train_batch_id: 300, avg_cost: 3.9276392459869385
grad_norm: 1.791030989449824, clipped: 1.0
epoch: 53, train_batch_id: 350, avg_cost: 3.855740547180176
grad_norm: 1.665107409848977, clipped: 1.0
epoch: 53, train_batch_id: 400, avg_cost: 3.897706985473633
grad_norm: 2.1186130669936776, clipped: 1.0
epoch: 53, train_batch_id: 450, avg_cost: 3.8947701454162598
grad_norm: 3.400948015051507, clipped: 1.0
epoch: 53, train_batch_id: 500, avg_cost: 3.8792636394500732
grad_norm: 1.7850327807768378, clipped: 1.0
epoch: 53, train_batch_id: 550, avg_cost: 3.8700079917907715
grad_norm: 1.8347601420914077, clipped: 1.0
epoch: 53, train_batch_id: 600, avg_cost: 3.8843698501586914
grad_norm: 1.9312519975090323, clipped: 1.0
epoch: 53, train_batch_id: 650, avg_cost: 3.8836071491241455
grad_norm: 1.7636032756182607, clipped: 1.0
epoch: 53, train_batch_id: 700, avg_cost: 3.8814947605133057
grad_norm: 1.2360042840599845, clipped: 1.0
epoch: 53, train_batch_id: 750, avg_cost: 3.892857313156128
grad_norm: 2.7273722141381067, clipped: 1.0
epoch: 53, train_batch_id: 800, avg_cost: 3.8833794593811035
grad_norm: 2.162961660299418, clipped: 1.0
epoch: 53, train_batch_id: 850, avg_cost: 3.8759732246398926
grad_norm: 2.090382221473134, clipped: 1.0
epoch: 53, train_batch_id: 900, avg_cost: 3.8636631965637207
grad_norm: 1.8189735878973425, clipped: 1.0
epoch: 53, train_batch_id: 950, avg_cost: 3.8980298042297363
grad_norm: 2.626230415348632, clipped: 1.0
epoch: 53, train_batch_id: 1000, avg_cost: 3.8520760536193848
grad_norm: 2.0179470873075127, clipped: 1.0
epoch: 53, train_batch_id: 1050, avg_cost: 3.901209592819214
grad_norm: 1.725086524465248, clipped: 1.0
epoch: 53, train_batch_id: 1100, avg_cost: 3.881443977355957
grad_norm: 2.1700168952463836, clipped: 1.0
epoch: 53, train_batch_id: 1150, avg_cost: 3.8788516521453857
grad_norm: 2.9849034654018247, clipped: 1.0
epoch: 53, train_batch_id: 1200, avg_cost: 3.8729143142700195
grad_norm: 1.8723474888201046, clipped: 1.0
epoch: 53, train_batch_id: 1250, avg_cost: 3.8706817626953125
grad_norm: 1.4135776894775447, clipped: 1.0
epoch: 53, train_batch_id: 1300, avg_cost: 3.876645565032959
grad_norm: 2.08309900254228, clipped: 1.0
epoch: 53, train_batch_id: 1350, avg_cost: 3.8940305709838867
grad_norm: 2.0287351202845345, clipped: 1.0
epoch: 53, train_batch_id: 1400, avg_cost: 3.8579564094543457
grad_norm: 1.7114690894167144, clipped: 1.0
epoch: 53, train_batch_id: 1450, avg_cost: 3.8800957202911377
grad_norm: 2.1813680849547734, clipped: 1.0
epoch: 53, train_batch_id: 1500, avg_cost: 3.9067046642303467
grad_norm: 1.7933419138747266, clipped: 1.0
epoch: 53, train_batch_id: 1550, avg_cost: 3.8722457885742188
grad_norm: 1.9003353671936758, clipped: 1.0
epoch: 53, train_batch_id: 1600, avg_cost: 3.890545129776001
grad_norm: 3.0716488339493115, clipped: 1.0
epoch: 53, train_batch_id: 1650, avg_cost: 3.901930332183838
grad_norm: 1.1803049577640163, clipped: 1.0
epoch: 53, train_batch_id: 1700, avg_cost: 3.8967182636260986
grad_norm: 1.535244527295629, clipped: 1.0
epoch: 53, train_batch_id: 1750, avg_cost: 3.8928613662719727
grad_norm: 2.0545388919760263, clipped: 1.0
epoch: 53, train_batch_id: 1800, avg_cost: 3.9015355110168457
grad_norm: 2.0524407801644835, clipped: 1.0
epoch: 53, train_batch_id: 1850, avg_cost: 3.9121780395507812
grad_norm: 1.551447964647813, clipped: 1.0
epoch: 53, train_batch_id: 1900, avg_cost: 3.8815107345581055
grad_norm: 3.0236090338450112, clipped: 1.0
epoch: 53, train_batch_id: 1950, avg_cost: 3.8886375427246094
grad_norm: 3.5795925526805767, clipped: 1.0
epoch: 53, train_batch_id: 2000, avg_cost: 3.882413387298584
grad_norm: 2.271225722825751, clipped: 1.0
epoch: 53, train_batch_id: 2050, avg_cost: 3.8622400760650635
grad_norm: 2.4588502207183267, clipped: 1.0
epoch: 53, train_batch_id: 2100, avg_cost: 3.8678884506225586
grad_norm: 1.3611418694287725, clipped: 1.0
epoch: 53, train_batch_id: 2150, avg_cost: 3.8875961303710938
grad_norm: 2.664449712322566, clipped: 1.0
epoch: 53, train_batch_id: 2200, avg_cost: 3.907787799835205
grad_norm: 3.543077323945059, clipped: 1.0
epoch: 53, train_batch_id: 2250, avg_cost: 3.881441116333008
grad_norm: 1.9530127158469033, clipped: 1.0
epoch: 53, train_batch_id: 2300, avg_cost: 3.8924317359924316
grad_norm: 1.8469740571298545, clipped: 1.0
epoch: 53, train_batch_id: 2350, avg_cost: 3.8858847618103027
grad_norm: 5.6579737096084655, clipped: 1.0
epoch: 53, train_batch_id: 2400, avg_cost: 3.905705451965332
grad_norm: 1.545283428110461, clipped: 1.0
epoch: 53, train_batch_id: 2450, avg_cost: 3.8627524375915527
grad_norm: 1.909842398410259, clipped: 1.0
Finished epoch 53, took 00:09:17 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.209552764892578 +- 0.0038187699392437935
Evaluating candidate model on evaluation dataset
Epoch 53 candidate mean 4.200540065765381, baseline epoch 39 mean 4.126363277435303, difference 0.07417678833007812
Start train epoch 54, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


epoch: 54, train_batch_id: 0, avg_cost: 3.8728461265563965
grad_norm: 2.0884046839625503, clipped: 1.0
epoch: 54, train_batch_id: 50, avg_cost: 3.8646633625030518
grad_norm: 1.4469503948536329, clipped: 1.0
epoch: 54, train_batch_id: 100, avg_cost: 3.871432065963745
grad_norm: 3.5584720916959545, clipped: 1.0
epoch: 54, train_batch_id: 150, avg_cost: 3.8891191482543945
grad_norm: 2.1566662614293426, clipped: 1.0
epoch: 54, train_batch_id: 200, avg_cost: 3.8805861473083496
grad_norm: 1.6453054676549734, clipped: 1.0
epoch: 54, train_batch_id: 250, avg_cost: 3.8967459201812744
grad_norm: 2.273323004090568, clipped: 1.0
epoch: 54, train_batch_id: 300, avg_cost: 3.8976199626922607
grad_norm: 1.3125106977386911, clipped: 1.0
epoch: 54, train_batch_id: 350, avg_cost: 3.893874406814575
grad_norm: 1.3688374687423455, clipped: 1.0
epoch: 54, train_batch_id: 400, avg_cost: 3.8760409355163574
grad_norm: 2.580148629606447, clipped: 1.0
epoch: 54, train_batch_id: 450, avg_cost: 3.8690505027770996
grad_norm: 1.9896506576642117, clipped: 1.0
epoch: 54, train_batch_id: 500, avg_cost: 3.8900747299194336
grad_norm: 1.6876653411089133, clipped: 1.0
epoch: 54, train_batch_id: 550, avg_cost: 3.891058921813965
grad_norm: 1.9045702084494596, clipped: 1.0
epoch: 54, train_batch_id: 600, avg_cost: 3.892568349838257
grad_norm: 3.259091409230382, clipped: 1.0
epoch: 54, train_batch_id: 650, avg_cost: 3.8796229362487793
grad_norm: 1.5807043642841612, clipped: 1.0
epoch: 54, train_batch_id: 700, avg_cost: 3.8802719116210938
grad_norm: 1.5269376579264458, clipped: 1.0
epoch: 54, train_batch_id: 750, avg_cost: 3.8792638778686523
grad_norm: 2.8550194936646878, clipped: 1.0
epoch: 54, train_batch_id: 800, avg_cost: 3.896129608154297
grad_norm: 1.4788656354817784, clipped: 1.0
epoch: 54, train_batch_id: 850, avg_cost: 3.8957362174987793
grad_norm: 1.4084873183614839, clipped: 1.0
epoch: 54, train_batch_id: 900, avg_cost: 3.8688488006591797
grad_norm: 2.0325572602315454, clipped: 1.0
epoch: 54, train_batch_id: 950, avg_cost: 3.8844571113586426
grad_norm: 1.5757500410005814, clipped: 1.0
epoch: 54, train_batch_id: 1000, avg_cost: 3.8808133602142334
grad_norm: 2.192153497415331, clipped: 1.0
epoch: 54, train_batch_id: 1050, avg_cost: 3.878822088241577
grad_norm: 1.4404790159485663, clipped: 1.0
epoch: 54, train_batch_id: 1100, avg_cost: 3.857027053833008
grad_norm: 1.3632687208101082, clipped: 1.0
epoch: 54, train_batch_id: 1150, avg_cost: 3.880767345428467
grad_norm: 2.25042775486203, clipped: 1.0
epoch: 54, train_batch_id: 1200, avg_cost: 3.875955820083618
grad_norm: 2.152918574444319, clipped: 1.0
epoch: 54, train_batch_id: 1250, avg_cost: 3.8613972663879395
grad_norm: 3.0065133439551435, clipped: 1.0
epoch: 54, train_batch_id: 1300, avg_cost: 3.8691024780273438
grad_norm: 1.3459798676607249, clipped: 1.0
epoch: 54, train_batch_id: 1350, avg_cost: 3.874910354614258
grad_norm: 1.3086295880362593, clipped: 1.0
epoch: 54, train_batch_id: 1400, avg_cost: 3.882931709289551
grad_norm: 2.3328769156808824, clipped: 1.0
epoch: 54, train_batch_id: 1450, avg_cost: 3.8994059562683105
grad_norm: 1.546283100361092, clipped: 1.0
epoch: 54, train_batch_id: 1500, avg_cost: 3.879112482070923
grad_norm: 2.500552740723844, clipped: 1.0
epoch: 54, train_batch_id: 1550, avg_cost: 3.8760221004486084
grad_norm: 1.4120357949322606, clipped: 1.0
epoch: 54, train_batch_id: 1600, avg_cost: 3.870244026184082
grad_norm: 2.2243685694151494, clipped: 1.0
epoch: 54, train_batch_id: 1650, avg_cost: 3.857475757598877
grad_norm: 1.9428425230226976, clipped: 1.0
epoch: 54, train_batch_id: 1700, avg_cost: 3.8574769496917725
grad_norm: 1.9614066460154262, clipped: 1.0
epoch: 54, train_batch_id: 1750, avg_cost: 3.903611183166504
grad_norm: 1.4855838165643214, clipped: 1.0
epoch: 54, train_batch_id: 1800, avg_cost: 3.921701669692993
grad_norm: 1.4159949732999921, clipped: 1.0
epoch: 54, train_batch_id: 1850, avg_cost: 3.854992389678955
grad_norm: 1.3371008072131914, clipped: 1.0
epoch: 54, train_batch_id: 1900, avg_cost: 3.845566749572754
grad_norm: 1.8553067419972609, clipped: 1.0
epoch: 54, train_batch_id: 1950, avg_cost: 3.8796889781951904
grad_norm: 1.8827747259798548, clipped: 1.0
epoch: 54, train_batch_id: 2000, avg_cost: 3.8788325786590576
grad_norm: 1.4148408533036416, clipped: 1.0
epoch: 54, train_batch_id: 2050, avg_cost: 3.8711698055267334
grad_norm: 1.505641325039458, clipped: 1.0
epoch: 54, train_batch_id: 2100, avg_cost: 3.8818140029907227
grad_norm: 1.2590153743139723, clipped: 1.0
epoch: 54, train_batch_id: 2150, avg_cost: 3.879972457885742
grad_norm: 1.4053840432391276, clipped: 1.0
epoch: 54, train_batch_id: 2200, avg_cost: 3.8797614574432373
grad_norm: 1.4231018900160777, clipped: 1.0
epoch: 54, train_batch_id: 2250, avg_cost: 3.8828907012939453
grad_norm: 1.8633360845393971, clipped: 1.0
epoch: 54, train_batch_id: 2300, avg_cost: 3.8965063095092773
grad_norm: 1.3101824653480254, clipped: 1.0
epoch: 54, train_batch_id: 2350, avg_cost: 3.8623709678649902
grad_norm: 1.1876172255990736, clipped: 1.0
epoch: 54, train_batch_id: 2400, avg_cost: 3.90126895904541
grad_norm: 2.0029049881312093, clipped: 1.0
epoch: 54, train_batch_id: 2450, avg_cost: 3.8725266456604004
grad_norm: 1.644955023324333, clipped: 1.0
Finished epoch 54, took 00:09:16 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.239059925079346 +- 0.0039888652972877026
Evaluating candidate model on evaluation dataset
Epoch 54 candidate mean 4.229194641113281, baseline epoch 39 mean 4.126363277435303, difference 0.10283136367797852
Start train epoch 55, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 55, train_batch_id: 0, avg_cost: 3.9031896591186523
grad_norm: 2.26729025359128, clipped: 1.0
epoch: 55, train_batch_id: 50, avg_cost: 3.8727574348449707
grad_norm: 1.5416895802970811, clipped: 1.0
epoch: 55, train_batch_id: 100, avg_cost: 3.8896520137786865
grad_norm: 1.723754525104225, clipped: 1.0
epoch: 55, train_batch_id: 150, avg_cost: 3.8644113540649414
grad_norm: 1.4234979197550794, clipped: 1.0
epoch: 55, train_batch_id: 200, avg_cost: 3.8702735900878906
grad_norm: 2.166625592101879, clipped: 1.0
epoch: 55, train_batch_id: 250, avg_cost: 3.90714693069458
grad_norm: 2.1036699051112424, clipped: 1.0
epoch: 55, train_batch_id: 300, avg_cost: 3.8831310272216797
grad_norm: 1.8799380192470705, clipped: 1.0
epoch: 55, train_batch_id: 350, avg_cost: 3.9049220085144043
grad_norm: 1.2110455589815936, clipped: 1.0
epoch: 55, train_batch_id: 400, avg_cost: 3.90334415435791
grad_norm: 2.272872581608633, clipped: 1.0
epoch: 55, train_batch_id: 450, avg_cost: 3.8746323585510254
grad_norm: 2.0845330274976304, clipped: 1.0
epoch: 55, train_batch_id: 500, avg_cost: 3.8701210021972656
grad_norm: 2.2548397596747303, clipped: 1.0
epoch: 55, train_batch_id: 550, avg_cost: 3.8531999588012695
grad_norm: 2.9325113223581636, clipped: 1.0
epoch: 55, train_batch_id: 600, avg_cost: 3.902437686920166
grad_norm: 1.698398459989035, clipped: 1.0
epoch: 55, train_batch_id: 650, avg_cost: 3.884075164794922
grad_norm: 1.6032242937564682, clipped: 1.0
epoch: 55, train_batch_id: 700, avg_cost: 3.883975028991699
grad_norm: 1.7549364935561014, clipped: 1.0
epoch: 55, train_batch_id: 750, avg_cost: 3.8866615295410156
grad_norm: 1.3616654080501644, clipped: 1.0
epoch: 55, train_batch_id: 800, avg_cost: 3.920166015625
grad_norm: 2.6433899794351823, clipped: 1.0
epoch: 55, train_batch_id: 850, avg_cost: 3.8891139030456543
grad_norm: 1.7256050644618417, clipped: 1.0
epoch: 55, train_batch_id: 900, avg_cost: 3.912109136581421
grad_norm: 1.4121191042382715, clipped: 1.0
epoch: 55, train_batch_id: 950, avg_cost: 3.8768465518951416
grad_norm: 2.012809008928383, clipped: 1.0
epoch: 55, train_batch_id: 1000, avg_cost: 3.8780407905578613
grad_norm: 1.8838991055953795, clipped: 1.0
epoch: 55, train_batch_id: 1050, avg_cost: 3.8657360076904297
grad_norm: 1.9394328768739693, clipped: 1.0
epoch: 55, train_batch_id: 1100, avg_cost: 3.897449254989624
grad_norm: 1.9314460988440376, clipped: 1.0
epoch: 55, train_batch_id: 1150, avg_cost: 3.8782477378845215
grad_norm: 2.372095428568761, clipped: 1.0
epoch: 55, train_batch_id: 1200, avg_cost: 3.8867573738098145
grad_norm: 3.039284880019788, clipped: 1.0
epoch: 55, train_batch_id: 1250, avg_cost: 3.9096455574035645
grad_norm: 1.7116782525105803, clipped: 1.0
epoch: 55, train_batch_id: 1300, avg_cost: 3.8880600929260254
grad_norm: 2.8553552169913203, clipped: 1.0
epoch: 55, train_batch_id: 1350, avg_cost: 3.870884418487549
grad_norm: 1.7468037069252202, clipped: 1.0
epoch: 55, train_batch_id: 1400, avg_cost: 3.882528781890869
grad_norm: 2.2197145343267786, clipped: 1.0
epoch: 55, train_batch_id: 1450, avg_cost: 3.90106201171875
grad_norm: 1.7151983772365655, clipped: 1.0
epoch: 55, train_batch_id: 1500, avg_cost: 3.8653197288513184
grad_norm: 2.845747025397792, clipped: 1.0
epoch: 55, train_batch_id: 1550, avg_cost: 3.875886917114258
grad_norm: 3.0404628360279773, clipped: 1.0
epoch: 55, train_batch_id: 1600, avg_cost: 3.8869576454162598
grad_norm: 1.396588070281307, clipped: 1.0
epoch: 55, train_batch_id: 1650, avg_cost: 3.8860301971435547
grad_norm: 1.638054477795875, clipped: 1.0
epoch: 55, train_batch_id: 1700, avg_cost: 3.8992760181427
grad_norm: 1.3132098214108434, clipped: 1.0
epoch: 55, train_batch_id: 1750, avg_cost: 3.8564722537994385
grad_norm: 2.128208693170703, clipped: 1.0
epoch: 55, train_batch_id: 1800, avg_cost: 3.9138598442077637
grad_norm: 1.656935044724377, clipped: 1.0
epoch: 55, train_batch_id: 1850, avg_cost: 3.8635358810424805
grad_norm: 1.4637221983449735, clipped: 1.0
epoch: 55, train_batch_id: 1900, avg_cost: 3.87906551361084
grad_norm: 1.3965207582871695, clipped: 1.0
epoch: 55, train_batch_id: 1950, avg_cost: 3.885807752609253
grad_norm: 1.6894891416264872, clipped: 1.0
epoch: 55, train_batch_id: 2000, avg_cost: 3.8831605911254883
grad_norm: 2.4025091229019826, clipped: 1.0
epoch: 55, train_batch_id: 2050, avg_cost: 3.894089460372925
grad_norm: 2.1590949971084714, clipped: 1.0
epoch: 55, train_batch_id: 2100, avg_cost: 3.905256986618042
grad_norm: 2.731010127702045, clipped: 1.0
epoch: 55, train_batch_id: 2150, avg_cost: 3.902068614959717
grad_norm: 2.1520532276582047, clipped: 1.0
epoch: 55, train_batch_id: 2200, avg_cost: 3.8906071186065674
grad_norm: 1.533167785066488, clipped: 1.0
epoch: 55, train_batch_id: 2250, avg_cost: 3.8819024562835693
grad_norm: 2.577463002578447, clipped: 1.0
epoch: 55, train_batch_id: 2300, avg_cost: 3.887097120285034
grad_norm: 1.111260713535863, clipped: 1.0
epoch: 55, train_batch_id: 2350, avg_cost: 3.8703341484069824
grad_norm: 2.2767082025926815, clipped: 1.0
epoch: 55, train_batch_id: 2400, avg_cost: 3.890340805053711
grad_norm: 1.5767197456053759, clipped: 1.0
epoch: 55, train_batch_id: 2450, avg_cost: 3.87042236328125
grad_norm: 1.4485150724252194, clipped: 1.0
Finished epoch 55, took 00:09:25 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.374619007110596 +- 0.0042619286105036736
Evaluating candidate model on evaluation dataset
Epoch 55 candidate mean 4.3689656257629395, baseline epoch 39 mean 4.126363277435303, difference 0.24260234832763672
Start train epoch 56, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


epoch: 56, train_batch_id: 0, avg_cost: 3.88201642036438
grad_norm: 1.571650056158095, clipped: 1.0
epoch: 56, train_batch_id: 50, avg_cost: 3.895770788192749
grad_norm: 1.5674288589748313, clipped: 1.0
epoch: 56, train_batch_id: 100, avg_cost: 3.9050164222717285
grad_norm: 1.5078655392414033, clipped: 1.0
epoch: 56, train_batch_id: 150, avg_cost: 3.8946027755737305
grad_norm: 2.3641820406678797, clipped: 1.0
epoch: 56, train_batch_id: 200, avg_cost: 3.896533489227295
grad_norm: 1.3479172818304292, clipped: 1.0
epoch: 56, train_batch_id: 250, avg_cost: 3.8632874488830566
grad_norm: 1.3153467970662014, clipped: 1.0
epoch: 56, train_batch_id: 300, avg_cost: 3.8837413787841797
grad_norm: 1.6387797459827835, clipped: 1.0
epoch: 56, train_batch_id: 350, avg_cost: 3.8868248462677
grad_norm: 1.354465756248374, clipped: 1.0
epoch: 56, train_batch_id: 400, avg_cost: 3.865340232849121
grad_norm: 1.46222460016542, clipped: 1.0
epoch: 56, train_batch_id: 450, avg_cost: 3.891143560409546
grad_norm: 2.100778699414198, clipped: 1.0
epoch: 56, train_batch_id: 500, avg_cost: 3.875248432159424
grad_norm: 1.5804527497326581, clipped: 1.0
epoch: 56, train_batch_id: 550, avg_cost: 3.900648593902588
grad_norm: 1.2827518396562536, clipped: 1.0
epoch: 56, train_batch_id: 600, avg_cost: 3.871422052383423
grad_norm: 2.347918380775076, clipped: 1.0
epoch: 56, train_batch_id: 650, avg_cost: 3.8525550365448
grad_norm: 1.8514541644304765, clipped: 1.0
epoch: 56, train_batch_id: 700, avg_cost: 3.857546091079712
grad_norm: 3.2306689236754362, clipped: 1.0
epoch: 56, train_batch_id: 750, avg_cost: 3.8738038539886475
grad_norm: 1.7957369968576926, clipped: 1.0
epoch: 56, train_batch_id: 800, avg_cost: 3.8860039710998535
grad_norm: 1.3564364440505836, clipped: 1.0
epoch: 56, train_batch_id: 850, avg_cost: 3.87320876121521
grad_norm: 2.002048534629655, clipped: 1.0
epoch: 56, train_batch_id: 900, avg_cost: 3.895130157470703
grad_norm: 1.3762457155929002, clipped: 1.0
epoch: 56, train_batch_id: 950, avg_cost: 3.891834259033203
grad_norm: 1.6070912724031141, clipped: 1.0
epoch: 56, train_batch_id: 1000, avg_cost: 3.8944101333618164
grad_norm: 2.1233050077165307, clipped: 1.0
epoch: 56, train_batch_id: 1050, avg_cost: 3.8996195793151855
grad_norm: 1.842685477194537, clipped: 1.0
epoch: 56, train_batch_id: 1100, avg_cost: 3.8868565559387207
grad_norm: 2.434118912311286, clipped: 1.0
epoch: 56, train_batch_id: 1150, avg_cost: 3.857339382171631
grad_norm: 1.4848666334564555, clipped: 1.0
epoch: 56, train_batch_id: 1200, avg_cost: 3.890260696411133
grad_norm: 1.547876640341705, clipped: 1.0
epoch: 56, train_batch_id: 1250, avg_cost: 3.865036964416504
grad_norm: 1.8145137610423616, clipped: 1.0
epoch: 56, train_batch_id: 1300, avg_cost: 3.882747173309326
grad_norm: 1.5125755628007524, clipped: 1.0
epoch: 56, train_batch_id: 1350, avg_cost: 3.866528034210205
grad_norm: 1.694359127294794, clipped: 1.0
epoch: 56, train_batch_id: 1400, avg_cost: 3.891000509262085
grad_norm: 2.2191147562839566, clipped: 1.0
epoch: 56, train_batch_id: 1450, avg_cost: 3.859802722930908
grad_norm: 1.4931656309763857, clipped: 1.0
epoch: 56, train_batch_id: 1500, avg_cost: 3.8877663612365723
grad_norm: 2.5872902350175986, clipped: 1.0
epoch: 56, train_batch_id: 1550, avg_cost: 3.857414960861206
grad_norm: 1.5394575178799055, clipped: 1.0
epoch: 56, train_batch_id: 1600, avg_cost: 3.865715503692627
grad_norm: 2.359417363331404, clipped: 1.0
epoch: 56, train_batch_id: 1650, avg_cost: 3.873493194580078
grad_norm: 3.306622615489897, clipped: 1.0
epoch: 56, train_batch_id: 1700, avg_cost: 3.9180500507354736
grad_norm: 1.2221673953931858, clipped: 1.0
epoch: 56, train_batch_id: 1750, avg_cost: 3.8821024894714355
grad_norm: 1.8051404626703214, clipped: 1.0
epoch: 56, train_batch_id: 1800, avg_cost: 3.887573003768921
grad_norm: 1.463079975361511, clipped: 1.0
epoch: 56, train_batch_id: 1850, avg_cost: 3.877924919128418
grad_norm: 2.196155906661091, clipped: 1.0
epoch: 56, train_batch_id: 1900, avg_cost: 3.877793788909912
grad_norm: 2.0417308775264167, clipped: 1.0
epoch: 56, train_batch_id: 1950, avg_cost: 3.8978917598724365
grad_norm: 3.4993360680341175, clipped: 1.0
epoch: 56, train_batch_id: 2000, avg_cost: 3.8844034671783447
grad_norm: 1.5665289154095003, clipped: 1.0
epoch: 56, train_batch_id: 2050, avg_cost: 3.896740198135376
grad_norm: 1.7123169287426003, clipped: 1.0
epoch: 56, train_batch_id: 2100, avg_cost: 3.8763818740844727
grad_norm: 1.6157805897314907, clipped: 1.0
epoch: 56, train_batch_id: 2150, avg_cost: 3.8740410804748535
grad_norm: 2.1732425516678866, clipped: 1.0
epoch: 56, train_batch_id: 2200, avg_cost: 3.889817476272583
grad_norm: 1.567780986226893, clipped: 1.0
epoch: 56, train_batch_id: 2250, avg_cost: 3.865482807159424
grad_norm: 1.2975514015234004, clipped: 1.0
epoch: 56, train_batch_id: 2300, avg_cost: 3.87418794631958
grad_norm: 3.4104900204267707, clipped: 1.0
epoch: 56, train_batch_id: 2350, avg_cost: 3.884666919708252
grad_norm: 1.7920196791271108, clipped: 1.0
epoch: 56, train_batch_id: 2400, avg_cost: 3.8925604820251465
grad_norm: 1.9408205477008684, clipped: 1.0
epoch: 56, train_batch_id: 2450, avg_cost: 3.8988595008850098
grad_norm: 1.7941136317137703, clipped: 1.0
Finished epoch 56, took 00:09:26 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.394756317138672 +- 0.004309529438614845
Evaluating candidate model on evaluation dataset
Epoch 56 candidate mean 4.385205268859863, baseline epoch 39 mean 4.126363277435303, difference 0.25884199142456055
Start train epoch 57, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 57, train_batch_id: 0, avg_cost: 3.8763105869293213
grad_norm: 1.6584146397944777, clipped: 1.0
epoch: 57, train_batch_id: 50, avg_cost: 3.8892741203308105
grad_norm: 1.5626336672167467, clipped: 1.0
epoch: 57, train_batch_id: 100, avg_cost: 3.8942041397094727
grad_norm: 1.7333783156031048, clipped: 1.0
epoch: 57, train_batch_id: 150, avg_cost: 3.8621315956115723
grad_norm: 2.3226494681743084, clipped: 1.0
epoch: 57, train_batch_id: 200, avg_cost: 3.877281904220581
grad_norm: 2.7614177026307987, clipped: 1.0
epoch: 57, train_batch_id: 250, avg_cost: 3.8708810806274414
grad_norm: 1.8188053375589983, clipped: 1.0
epoch: 57, train_batch_id: 300, avg_cost: 3.8960764408111572
grad_norm: 2.0411515557253503, clipped: 1.0
epoch: 57, train_batch_id: 350, avg_cost: 3.8688604831695557
grad_norm: 1.8297213109407868, clipped: 1.0
epoch: 57, train_batch_id: 400, avg_cost: 3.8951292037963867
grad_norm: 2.054985587974156, clipped: 1.0
epoch: 57, train_batch_id: 450, avg_cost: 3.897627353668213
grad_norm: 1.2962041758246392, clipped: 1.0
epoch: 57, train_batch_id: 500, avg_cost: 3.874685764312744
grad_norm: 1.9217824124005682, clipped: 1.0
epoch: 57, train_batch_id: 550, avg_cost: 3.8799571990966797
grad_norm: 3.6060404915419633, clipped: 1.0
epoch: 57, train_batch_id: 600, avg_cost: 3.8908557891845703
grad_norm: 5.590284466458485, clipped: 1.0
epoch: 57, train_batch_id: 650, avg_cost: 3.8648171424865723
grad_norm: 2.406032666776187, clipped: 1.0
epoch: 57, train_batch_id: 700, avg_cost: 3.8803892135620117
grad_norm: 2.7753535027390726, clipped: 1.0
epoch: 57, train_batch_id: 750, avg_cost: 3.9067530632019043
grad_norm: 1.9053049635994574, clipped: 1.0
epoch: 57, train_batch_id: 800, avg_cost: 3.8954710960388184
grad_norm: 2.1162705017886667, clipped: 1.0
epoch: 57, train_batch_id: 850, avg_cost: 3.8892078399658203
grad_norm: 1.8901030049862793, clipped: 1.0
epoch: 57, train_batch_id: 900, avg_cost: 3.88460373878479
grad_norm: 1.765743500381792, clipped: 1.0
epoch: 57, train_batch_id: 950, avg_cost: 3.8957571983337402
grad_norm: 3.0784896736050706, clipped: 1.0
epoch: 57, train_batch_id: 1000, avg_cost: 3.9007487297058105
grad_norm: 2.71864255128691, clipped: 1.0
epoch: 57, train_batch_id: 1050, avg_cost: 3.872317314147949
grad_norm: 2.267851696956437, clipped: 1.0
epoch: 57, train_batch_id: 1100, avg_cost: 3.9015116691589355
grad_norm: 1.9078544125443448, clipped: 1.0
epoch: 57, train_batch_id: 1150, avg_cost: 3.8647069931030273
grad_norm: 2.259265988328449, clipped: 1.0
epoch: 57, train_batch_id: 1200, avg_cost: 3.8721485137939453
grad_norm: 2.2479692738067603, clipped: 1.0
epoch: 57, train_batch_id: 1250, avg_cost: 3.8888516426086426
grad_norm: 1.8658452154404963, clipped: 1.0
epoch: 57, train_batch_id: 1300, avg_cost: 3.8840346336364746
grad_norm: 3.736053835337462, clipped: 1.0
epoch: 57, train_batch_id: 1350, avg_cost: 3.8897078037261963
grad_norm: 1.4077718462562352, clipped: 1.0
epoch: 57, train_batch_id: 1400, avg_cost: 3.8846025466918945
grad_norm: 4.118080969728031, clipped: 1.0
epoch: 57, train_batch_id: 1450, avg_cost: 3.8795485496520996
grad_norm: 1.5927240609417377, clipped: 1.0
epoch: 57, train_batch_id: 1500, avg_cost: 3.8585596084594727
grad_norm: 2.674438317596201, clipped: 1.0
epoch: 57, train_batch_id: 1550, avg_cost: 3.8659329414367676
grad_norm: 2.471836430764633, clipped: 1.0
epoch: 57, train_batch_id: 1600, avg_cost: 3.89243745803833
grad_norm: 1.6676898045086879, clipped: 1.0
epoch: 57, train_batch_id: 1650, avg_cost: 3.885362148284912
grad_norm: 1.7600821143204397, clipped: 1.0
epoch: 57, train_batch_id: 1700, avg_cost: 3.8625924587249756
grad_norm: 1.7481646207263541, clipped: 1.0
epoch: 57, train_batch_id: 1750, avg_cost: 3.895914077758789
grad_norm: 2.9493239206366204, clipped: 1.0
epoch: 57, train_batch_id: 1800, avg_cost: 3.880404472351074
grad_norm: 1.3028202558957467, clipped: 1.0
epoch: 57, train_batch_id: 1850, avg_cost: 3.881065845489502
grad_norm: 1.5627139142282371, clipped: 1.0
epoch: 57, train_batch_id: 1900, avg_cost: 3.870026111602783
grad_norm: 2.3490300202068957, clipped: 1.0
epoch: 57, train_batch_id: 1950, avg_cost: 3.8701584339141846
grad_norm: 1.6914116729019129, clipped: 1.0
epoch: 57, train_batch_id: 2000, avg_cost: 3.8847155570983887
grad_norm: 2.188021690908918, clipped: 1.0
epoch: 57, train_batch_id: 2050, avg_cost: 3.8871307373046875
grad_norm: 1.8912214992189553, clipped: 1.0
epoch: 57, train_batch_id: 2100, avg_cost: 3.867981433868408
grad_norm: 1.427643672479407, clipped: 1.0
epoch: 57, train_batch_id: 2150, avg_cost: 3.871002197265625
grad_norm: 1.765078197694091, clipped: 1.0
epoch: 57, train_batch_id: 2200, avg_cost: 3.8982009887695312
grad_norm: 1.3723417479056719, clipped: 1.0
epoch: 57, train_batch_id: 2250, avg_cost: 3.884706735610962
grad_norm: 3.6295899491532166, clipped: 1.0
epoch: 57, train_batch_id: 2300, avg_cost: 3.889822006225586
grad_norm: 2.47237795767241, clipped: 1.0
epoch: 57, train_batch_id: 2350, avg_cost: 3.8618154525756836
grad_norm: 1.3828305144875925, clipped: 1.0
epoch: 57, train_batch_id: 2400, avg_cost: 3.8824338912963867
grad_norm: 2.8635164354462885, clipped: 1.0
epoch: 57, train_batch_id: 2450, avg_cost: 3.877620220184326
grad_norm: 1.249208576197975, clipped: 1.0
Finished epoch 57, took 00:09:19 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.289520263671875 +- 0.004004473332315683
Evaluating candidate model on evaluation dataset
Epoch 57 candidate mean 4.2794880867004395, baseline epoch 39 mean 4.126363277435303, difference 0.15312480926513672
Start train epoch 58, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 58, train_batch_id: 0, avg_cost: 3.8902392387390137
grad_norm: 1.782197147571391, clipped: 1.0
epoch: 58, train_batch_id: 50, avg_cost: 3.856807231903076
grad_norm: 1.9629908842087227, clipped: 1.0
epoch: 58, train_batch_id: 100, avg_cost: 3.8539879322052
grad_norm: 1.309575112946138, clipped: 1.0
epoch: 58, train_batch_id: 150, avg_cost: 3.885671377182007
grad_norm: 1.5135572820914724, clipped: 1.0
epoch: 58, train_batch_id: 200, avg_cost: 3.8789191246032715
grad_norm: 3.8502199283837673, clipped: 1.0
epoch: 58, train_batch_id: 250, avg_cost: 3.8835694789886475
grad_norm: 1.686633583079928, clipped: 1.0
epoch: 58, train_batch_id: 300, avg_cost: 3.856043815612793
grad_norm: 1.5856763338462005, clipped: 1.0
epoch: 58, train_batch_id: 350, avg_cost: 3.8776450157165527
grad_norm: 1.7514565912723474, clipped: 1.0
epoch: 58, train_batch_id: 400, avg_cost: 3.8628392219543457
grad_norm: 1.7530773696961885, clipped: 1.0
epoch: 58, train_batch_id: 450, avg_cost: 3.8704957962036133
grad_norm: 2.9237436989006405, clipped: 1.0
epoch: 58, train_batch_id: 500, avg_cost: 3.896571636199951
grad_norm: 1.388987534894249, clipped: 1.0
epoch: 58, train_batch_id: 550, avg_cost: 3.872797966003418
grad_norm: 1.8603149181527876, clipped: 1.0
epoch: 58, train_batch_id: 600, avg_cost: 3.8568854331970215
grad_norm: 3.434606478997793, clipped: 1.0
epoch: 58, train_batch_id: 650, avg_cost: 3.858245372772217
grad_norm: 1.9273343842374493, clipped: 1.0
epoch: 58, train_batch_id: 700, avg_cost: 3.8879919052124023
grad_norm: 2.4191025137560582, clipped: 1.0
epoch: 58, train_batch_id: 750, avg_cost: 3.8745269775390625
grad_norm: 1.4620640444034367, clipped: 1.0
epoch: 58, train_batch_id: 800, avg_cost: 3.8871772289276123
grad_norm: 2.932223606318303, clipped: 1.0
epoch: 58, train_batch_id: 850, avg_cost: 3.8913168907165527
grad_norm: 5.064616853363187, clipped: 1.0
epoch: 58, train_batch_id: 900, avg_cost: 3.8828775882720947
grad_norm: 2.296732385306659, clipped: 1.0
epoch: 58, train_batch_id: 950, avg_cost: 3.8751018047332764
grad_norm: 2.5351406108560934, clipped: 1.0
epoch: 58, train_batch_id: 1000, avg_cost: 3.9005279541015625
grad_norm: 3.0161244666218496, clipped: 1.0
epoch: 58, train_batch_id: 1050, avg_cost: 3.8615989685058594
grad_norm: 1.8681663815689948, clipped: 1.0
epoch: 58, train_batch_id: 1100, avg_cost: 3.8797311782836914
grad_norm: 2.0166621069785124, clipped: 1.0
epoch: 58, train_batch_id: 1150, avg_cost: 3.8714780807495117
grad_norm: 3.4644579094589587, clipped: 1.0
epoch: 58, train_batch_id: 1200, avg_cost: 3.8771748542785645
grad_norm: 2.092742028742538, clipped: 1.0
epoch: 58, train_batch_id: 1250, avg_cost: 3.8677616119384766
grad_norm: 1.8166856696268268, clipped: 1.0
epoch: 58, train_batch_id: 1300, avg_cost: 3.8723158836364746
grad_norm: 20.520433088951712, clipped: 1.0
epoch: 58, train_batch_id: 1350, avg_cost: 3.8721537590026855
grad_norm: 1.289084918791087, clipped: 1.0
epoch: 58, train_batch_id: 1400, avg_cost: 3.868751287460327
grad_norm: 2.2750749351088255, clipped: 1.0
epoch: 58, train_batch_id: 1450, avg_cost: 3.8765971660614014
grad_norm: 1.8228641112193604, clipped: 1.0
epoch: 58, train_batch_id: 1500, avg_cost: 3.8761658668518066
grad_norm: 1.585623257274669, clipped: 1.0
epoch: 58, train_batch_id: 1550, avg_cost: 3.8726930618286133
grad_norm: 2.251740556146334, clipped: 1.0
epoch: 58, train_batch_id: 1600, avg_cost: 3.8617308139801025
grad_norm: 1.94553835320799, clipped: 1.0
epoch: 58, train_batch_id: 1650, avg_cost: 3.876343250274658
grad_norm: 2.1250509320850126, clipped: 1.0
epoch: 58, train_batch_id: 1700, avg_cost: 3.886446475982666
grad_norm: 1.9788441889257455, clipped: 1.0
epoch: 58, train_batch_id: 1750, avg_cost: 3.878654956817627
grad_norm: 1.0845319275076024, clipped: 1.0
epoch: 58, train_batch_id: 1800, avg_cost: 3.8927860260009766
grad_norm: 1.5381709115271243, clipped: 1.0
epoch: 58, train_batch_id: 1850, avg_cost: 3.880837917327881
grad_norm: 1.482452991396664, clipped: 1.0
epoch: 58, train_batch_id: 1900, avg_cost: 3.865262031555176
grad_norm: 1.9910547368078388, clipped: 1.0
epoch: 58, train_batch_id: 1950, avg_cost: 3.869523763656616
grad_norm: 1.4384874214211862, clipped: 1.0
epoch: 58, train_batch_id: 2000, avg_cost: 3.8929431438446045
grad_norm: 2.364622048885414, clipped: 1.0
epoch: 58, train_batch_id: 2050, avg_cost: 3.8888797760009766
grad_norm: 2.1236149750192364, clipped: 1.0
epoch: 58, train_batch_id: 2100, avg_cost: 3.8925046920776367
grad_norm: 1.8345344642723749, clipped: 1.0
epoch: 58, train_batch_id: 2150, avg_cost: 3.9003751277923584
grad_norm: 1.7340868214432195, clipped: 1.0
epoch: 58, train_batch_id: 2200, avg_cost: 3.8715405464172363
grad_norm: 1.7586849256888648, clipped: 1.0
epoch: 58, train_batch_id: 2250, avg_cost: 3.8804192543029785
grad_norm: 1.8118778294077083, clipped: 1.0
epoch: 58, train_batch_id: 2300, avg_cost: 3.86405086517334
grad_norm: 1.6568834731980258, clipped: 1.0
epoch: 58, train_batch_id: 2350, avg_cost: 3.898163318634033
grad_norm: 1.4507535187580292, clipped: 1.0
epoch: 58, train_batch_id: 2400, avg_cost: 3.887885093688965
grad_norm: 1.7692117740000135, clipped: 1.0
epoch: 58, train_batch_id: 2450, avg_cost: 3.8817567825317383
grad_norm: 2.888210012812881, clipped: 1.0
Finished epoch 58, took 00:09:43 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.353397846221924 +- 0.004224583972245455
Evaluating candidate model on evaluation dataset
Epoch 58 candidate mean 4.345440864562988, baseline epoch 39 mean 4.126363277435303, difference 0.21907758712768555
Start train epoch 59, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 59, train_batch_id: 0, avg_cost: 3.8828377723693848
grad_norm: 5.73743683275317, clipped: 1.0
epoch: 59, train_batch_id: 50, avg_cost: 3.8633432388305664
grad_norm: 2.2690241293639075, clipped: 1.0
epoch: 59, train_batch_id: 100, avg_cost: 3.8894917964935303
grad_norm: 2.272886736212965, clipped: 1.0
epoch: 59, train_batch_id: 150, avg_cost: 3.9041852951049805
grad_norm: 2.0413177732395886, clipped: 1.0
epoch: 59, train_batch_id: 200, avg_cost: 3.880925178527832
grad_norm: 1.9204532367191485, clipped: 1.0
epoch: 59, train_batch_id: 250, avg_cost: 3.8772950172424316
grad_norm: 0.9610455939225814, clipped: 0.9610455939225814
epoch: 59, train_batch_id: 300, avg_cost: 3.884577751159668
grad_norm: 1.3732011970884261, clipped: 1.0
epoch: 59, train_batch_id: 350, avg_cost: 3.8681278228759766
grad_norm: 1.627260151667571, clipped: 1.0
epoch: 59, train_batch_id: 400, avg_cost: 3.8617520332336426
grad_norm: 1.3084254706923104, clipped: 1.0
epoch: 59, train_batch_id: 450, avg_cost: 3.887723207473755
grad_norm: 1.9652128505380597, clipped: 1.0
epoch: 59, train_batch_id: 500, avg_cost: 3.88525652885437
grad_norm: 1.826068793197511, clipped: 1.0
epoch: 59, train_batch_id: 550, avg_cost: 3.875882625579834
grad_norm: 1.6498598452692754, clipped: 1.0
epoch: 59, train_batch_id: 600, avg_cost: 3.85725474357605
grad_norm: 2.5470833615909183, clipped: 1.0
epoch: 59, train_batch_id: 650, avg_cost: 3.8783435821533203
grad_norm: 1.8798114557438705, clipped: 1.0
epoch: 59, train_batch_id: 700, avg_cost: 3.880178928375244
grad_norm: 2.921536085381343, clipped: 1.0
epoch: 59, train_batch_id: 750, avg_cost: 3.8734893798828125
grad_norm: 1.4885505874767428, clipped: 1.0
epoch: 59, train_batch_id: 800, avg_cost: 3.868347644805908
grad_norm: 2.709583713742093, clipped: 1.0
epoch: 59, train_batch_id: 850, avg_cost: 3.8988969326019287
grad_norm: 5.368029361193142, clipped: 1.0
epoch: 59, train_batch_id: 900, avg_cost: 3.9115428924560547
grad_norm: 1.4369619844463424, clipped: 1.0
epoch: 59, train_batch_id: 950, avg_cost: 3.9044442176818848
grad_norm: 2.3777877496157473, clipped: 1.0
epoch: 59, train_batch_id: 1000, avg_cost: 3.9003639221191406
grad_norm: 3.1857707725203572, clipped: 1.0
epoch: 59, train_batch_id: 1050, avg_cost: 3.875438690185547
grad_norm: 2.058450497265957, clipped: 1.0
epoch: 59, train_batch_id: 1100, avg_cost: 3.8916215896606445
grad_norm: 1.3897127552391952, clipped: 1.0
epoch: 59, train_batch_id: 1150, avg_cost: 3.8842384815216064
grad_norm: 1.799810157439868, clipped: 1.0
epoch: 59, train_batch_id: 1200, avg_cost: 3.8751111030578613
grad_norm: 7.128039491291882, clipped: 1.0
epoch: 59, train_batch_id: 1250, avg_cost: 3.868558883666992
grad_norm: 1.554395754576379, clipped: 1.0
epoch: 59, train_batch_id: 1300, avg_cost: 3.866764545440674
grad_norm: 4.018238045695798, clipped: 1.0
epoch: 59, train_batch_id: 1350, avg_cost: 3.877917528152466
grad_norm: 1.8503886092535597, clipped: 1.0
epoch: 59, train_batch_id: 1400, avg_cost: 3.886888265609741
grad_norm: 3.722427284830653, clipped: 1.0
epoch: 59, train_batch_id: 1450, avg_cost: 3.847381353378296
grad_norm: 2.4014598014454944, clipped: 1.0
epoch: 59, train_batch_id: 1500, avg_cost: 3.8766825199127197
grad_norm: 2.845052530247599, clipped: 1.0
epoch: 59, train_batch_id: 1550, avg_cost: 3.892455577850342
grad_norm: 1.2736471494832604, clipped: 1.0
epoch: 59, train_batch_id: 1600, avg_cost: 3.8819739818573
grad_norm: 2.2042274900511862, clipped: 1.0
epoch: 59, train_batch_id: 1650, avg_cost: 3.8889410495758057
grad_norm: 1.8691662410237744, clipped: 1.0
epoch: 59, train_batch_id: 1700, avg_cost: 3.874441146850586
grad_norm: 2.401915098748834, clipped: 1.0
epoch: 59, train_batch_id: 1750, avg_cost: 3.886199474334717
grad_norm: 1.5220151416525565, clipped: 1.0
epoch: 59, train_batch_id: 1800, avg_cost: 3.866976261138916
grad_norm: 3.2363658735514367, clipped: 1.0
epoch: 59, train_batch_id: 1850, avg_cost: 3.888195037841797
grad_norm: 2.0929051298707924, clipped: 1.0
epoch: 59, train_batch_id: 1900, avg_cost: 3.8867027759552
grad_norm: 2.006140009465553, clipped: 1.0
epoch: 59, train_batch_id: 1950, avg_cost: 3.8860836029052734
grad_norm: 1.3584926113120663, clipped: 1.0
epoch: 59, train_batch_id: 2000, avg_cost: 3.907571315765381
grad_norm: 1.7124116288521287, clipped: 1.0
epoch: 59, train_batch_id: 2050, avg_cost: 3.875180721282959
grad_norm: 1.9071607719113977, clipped: 1.0
epoch: 59, train_batch_id: 2100, avg_cost: 3.8882713317871094
grad_norm: 1.8492823248203738, clipped: 1.0
epoch: 59, train_batch_id: 2150, avg_cost: 3.8851571083068848
grad_norm: 1.2863308378387546, clipped: 1.0
epoch: 59, train_batch_id: 2200, avg_cost: 3.8678042888641357
grad_norm: 2.4040484290305932, clipped: 1.0
epoch: 59, train_batch_id: 2250, avg_cost: 3.88157320022583
grad_norm: 2.4069257131830897, clipped: 1.0
epoch: 59, train_batch_id: 2300, avg_cost: 3.8820669651031494
grad_norm: 2.2863981752599702, clipped: 1.0
epoch: 59, train_batch_id: 2350, avg_cost: 3.8410696983337402
grad_norm: 1.5232768315175393, clipped: 1.0
epoch: 59, train_batch_id: 2400, avg_cost: 3.8896613121032715
grad_norm: 2.4485577111965804, clipped: 1.0
epoch: 59, train_batch_id: 2450, avg_cost: 3.8759710788726807
grad_norm: 1.7284417990848362, clipped: 1.0
Finished epoch 59, took 00:09:28 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.438611030578613 +- 0.004386118147522211
Evaluating candidate model on evaluation dataset
Epoch 59 candidate mean 4.426316261291504, baseline epoch 39 mean 4.126363277435303, difference 0.29995298385620117
Start train epoch 60, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 60, train_batch_id: 0, avg_cost: 3.9038262367248535
grad_norm: 1.5577684208877596, clipped: 1.0
epoch: 60, train_batch_id: 50, avg_cost: 3.885462760925293
grad_norm: 1.96380141000619, clipped: 1.0
epoch: 60, train_batch_id: 100, avg_cost: 3.8567090034484863
grad_norm: 2.0287980528708247, clipped: 1.0
epoch: 60, train_batch_id: 150, avg_cost: 3.8611865043640137
grad_norm: 2.092775616926589, clipped: 1.0
epoch: 60, train_batch_id: 200, avg_cost: 3.8684849739074707
grad_norm: 2.2413367150855845, clipped: 1.0
epoch: 60, train_batch_id: 250, avg_cost: 3.89176082611084
grad_norm: 1.454003863506996, clipped: 1.0
epoch: 60, train_batch_id: 300, avg_cost: 3.8719372749328613
grad_norm: 1.7839052247376317, clipped: 1.0
epoch: 60, train_batch_id: 350, avg_cost: 3.885840654373169
grad_norm: 1.6394012247711247, clipped: 1.0
epoch: 60, train_batch_id: 400, avg_cost: 3.892362594604492
grad_norm: 1.5654145114154498, clipped: 1.0
epoch: 60, train_batch_id: 450, avg_cost: 3.878161907196045
grad_norm: 1.9796659517814277, clipped: 1.0
epoch: 60, train_batch_id: 500, avg_cost: 3.875227212905884
grad_norm: 1.89155528629753, clipped: 1.0
epoch: 60, train_batch_id: 550, avg_cost: 3.8907904624938965
grad_norm: 2.3506169878462972, clipped: 1.0
epoch: 60, train_batch_id: 600, avg_cost: 3.8740439414978027
grad_norm: 1.9588419875773804, clipped: 1.0
epoch: 60, train_batch_id: 650, avg_cost: 3.857545852661133
grad_norm: 1.7201914580157809, clipped: 1.0
epoch: 60, train_batch_id: 700, avg_cost: 3.8806633949279785
grad_norm: 4.394782535349103, clipped: 1.0
epoch: 60, train_batch_id: 750, avg_cost: 3.8828330039978027
grad_norm: 1.7366456610710461, clipped: 1.0
epoch: 60, train_batch_id: 800, avg_cost: 3.8768858909606934
grad_norm: 1.7609212130076806, clipped: 1.0
epoch: 60, train_batch_id: 850, avg_cost: 3.8499436378479004
grad_norm: 2.540167078437268, clipped: 1.0
epoch: 60, train_batch_id: 900, avg_cost: 3.8999428749084473
grad_norm: 1.267015004950493, clipped: 1.0
epoch: 60, train_batch_id: 950, avg_cost: 3.8785717487335205
grad_norm: 1.373558612427387, clipped: 1.0
epoch: 60, train_batch_id: 1000, avg_cost: 3.871908664703369
grad_norm: 2.292095320543072, clipped: 1.0
epoch: 60, train_batch_id: 1050, avg_cost: 3.892584800720215
grad_norm: 1.582408271104156, clipped: 1.0
epoch: 60, train_batch_id: 1100, avg_cost: 3.8569352626800537
grad_norm: 3.2219738514550973, clipped: 1.0
epoch: 60, train_batch_id: 1150, avg_cost: 3.861626386642456
grad_norm: 1.6460608401517447, clipped: 1.0
epoch: 60, train_batch_id: 1200, avg_cost: 3.908205986022949
grad_norm: 1.688175220495523, clipped: 1.0
epoch: 60, train_batch_id: 1250, avg_cost: 3.9001662731170654
grad_norm: 3.320226731278473, clipped: 1.0
epoch: 60, train_batch_id: 1300, avg_cost: 3.887058734893799
grad_norm: 2.4070124990236494, clipped: 1.0
epoch: 60, train_batch_id: 1350, avg_cost: 3.8901469707489014
grad_norm: 2.087202982026508, clipped: 1.0
epoch: 60, train_batch_id: 1400, avg_cost: 3.8598904609680176
grad_norm: 1.6515243331470364, clipped: 1.0
epoch: 60, train_batch_id: 1450, avg_cost: 3.903947353363037
grad_norm: 1.7084782917136996, clipped: 1.0
epoch: 60, train_batch_id: 1500, avg_cost: 3.8886303901672363
grad_norm: 4.425330685252228, clipped: 1.0
epoch: 60, train_batch_id: 1550, avg_cost: 3.9081876277923584
grad_norm: 2.0991432534804946, clipped: 1.0
epoch: 60, train_batch_id: 1600, avg_cost: 3.90584397315979
grad_norm: 2.9521717843438897, clipped: 1.0
epoch: 60, train_batch_id: 1650, avg_cost: 3.8534164428710938
grad_norm: 2.253999012827406, clipped: 1.0
epoch: 60, train_batch_id: 1700, avg_cost: 3.86611270904541
grad_norm: 2.929610116675778, clipped: 1.0
epoch: 60, train_batch_id: 1750, avg_cost: 3.8634750843048096
grad_norm: 1.771806572954457, clipped: 1.0
epoch: 60, train_batch_id: 1800, avg_cost: 3.888047933578491
grad_norm: 1.6202302375172395, clipped: 1.0
epoch: 60, train_batch_id: 1850, avg_cost: 3.8833279609680176
grad_norm: 2.182337523215914, clipped: 1.0
epoch: 60, train_batch_id: 1900, avg_cost: 3.8813042640686035
grad_norm: 1.3738027213344315, clipped: 1.0
epoch: 60, train_batch_id: 1950, avg_cost: 3.888399362564087
grad_norm: 4.609481708204597, clipped: 1.0
epoch: 60, train_batch_id: 2000, avg_cost: 3.874889850616455
grad_norm: 2.490777720215232, clipped: 1.0
epoch: 60, train_batch_id: 2050, avg_cost: 3.8714451789855957
grad_norm: 2.0029190265222905, clipped: 1.0
epoch: 60, train_batch_id: 2100, avg_cost: 3.864964008331299
grad_norm: 2.8298053039773046, clipped: 1.0
epoch: 60, train_batch_id: 2150, avg_cost: 3.8900036811828613
grad_norm: 2.353928820961548, clipped: 1.0
epoch: 60, train_batch_id: 2200, avg_cost: 3.893798828125
grad_norm: 1.9953648643394322, clipped: 1.0
epoch: 60, train_batch_id: 2250, avg_cost: 3.877061367034912
grad_norm: 2.4497043377918506, clipped: 1.0
epoch: 60, train_batch_id: 2300, avg_cost: 3.8755321502685547
grad_norm: 1.3403263803406904, clipped: 1.0
epoch: 60, train_batch_id: 2350, avg_cost: 3.864328384399414
grad_norm: 2.5123496317883003, clipped: 1.0
epoch: 60, train_batch_id: 2400, avg_cost: 3.856462240219116
grad_norm: 1.261399462697287, clipped: 1.0
epoch: 60, train_batch_id: 2450, avg_cost: 3.8758230209350586
grad_norm: 2.9186791696717327, clipped: 1.0
Finished epoch 60, took 00:09:27 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.4215569496154785 +- 0.004297305829823017
Evaluating candidate model on evaluation dataset
Epoch 60 candidate mean 4.412421703338623, baseline epoch 39 mean 4.126363277435303, difference 0.2860584259033203
Start train epoch 61, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 61, train_batch_id: 0, avg_cost: 3.892585277557373
grad_norm: 1.9669408914202882, clipped: 1.0
epoch: 61, train_batch_id: 50, avg_cost: 3.8932790756225586
grad_norm: 3.05640459386341, clipped: 1.0
epoch: 61, train_batch_id: 100, avg_cost: 3.8979156017303467
grad_norm: 1.8940445791477685, clipped: 1.0
epoch: 61, train_batch_id: 150, avg_cost: 3.8662452697753906
grad_norm: 3.058268647632779, clipped: 1.0
epoch: 61, train_batch_id: 200, avg_cost: 3.899181365966797
grad_norm: 2.8758144303309603, clipped: 1.0
epoch: 61, train_batch_id: 250, avg_cost: 3.8659729957580566
grad_norm: 2.077136059711483, clipped: 1.0
epoch: 61, train_batch_id: 300, avg_cost: 3.864804267883301
grad_norm: 1.5847498492961225, clipped: 1.0
epoch: 61, train_batch_id: 350, avg_cost: 3.886910915374756
grad_norm: 1.856391165583228, clipped: 1.0
epoch: 61, train_batch_id: 400, avg_cost: 3.8897180557250977
grad_norm: 1.5536149362417493, clipped: 1.0
epoch: 61, train_batch_id: 450, avg_cost: 3.8975424766540527
grad_norm: 1.8825505955052138, clipped: 1.0
epoch: 61, train_batch_id: 500, avg_cost: 3.8812856674194336
grad_norm: 2.033149286526633, clipped: 1.0
epoch: 61, train_batch_id: 550, avg_cost: 3.873084545135498
grad_norm: 5.695136483728422, clipped: 1.0
epoch: 61, train_batch_id: 600, avg_cost: 3.9007859230041504
grad_norm: 2.599169660202693, clipped: 1.0
epoch: 61, train_batch_id: 650, avg_cost: 3.882081985473633
grad_norm: 2.102729500964665, clipped: 1.0
epoch: 61, train_batch_id: 700, avg_cost: 3.8743534088134766
grad_norm: 1.613354007169626, clipped: 1.0
epoch: 61, train_batch_id: 750, avg_cost: 3.8737833499908447
grad_norm: 1.4479546344885434, clipped: 1.0
epoch: 61, train_batch_id: 800, avg_cost: 3.8729381561279297
grad_norm: 4.468959710271519, clipped: 1.0
epoch: 61, train_batch_id: 850, avg_cost: 3.878730297088623
grad_norm: 1.4095769129409355, clipped: 1.0
epoch: 61, train_batch_id: 900, avg_cost: 3.8781991004943848
grad_norm: 1.809331408108648, clipped: 1.0
epoch: 61, train_batch_id: 950, avg_cost: 3.8916893005371094
grad_norm: 2.226077435680829, clipped: 1.0
epoch: 61, train_batch_id: 1000, avg_cost: 3.870178699493408
grad_norm: 1.7712079227539186, clipped: 1.0
epoch: 61, train_batch_id: 1050, avg_cost: 3.87406063079834
grad_norm: 2.312758090186328, clipped: 1.0
epoch: 61, train_batch_id: 1100, avg_cost: 3.8785600662231445
grad_norm: 2.2991224973785243, clipped: 1.0
epoch: 61, train_batch_id: 1150, avg_cost: 3.875359058380127
grad_norm: 2.2785732196918382, clipped: 1.0
epoch: 61, train_batch_id: 1200, avg_cost: 3.843576431274414
grad_norm: 2.3767917543281176, clipped: 1.0
epoch: 61, train_batch_id: 1250, avg_cost: 3.8565468788146973
grad_norm: 1.402503090296003, clipped: 1.0
epoch: 61, train_batch_id: 1300, avg_cost: 3.9200010299682617
grad_norm: 5.229241301274787, clipped: 1.0
epoch: 61, train_batch_id: 1350, avg_cost: 3.9171810150146484
grad_norm: 2.301593517109681, clipped: 1.0
epoch: 61, train_batch_id: 1400, avg_cost: 3.8901214599609375
grad_norm: 3.2110499831694685, clipped: 1.0
epoch: 61, train_batch_id: 1450, avg_cost: 3.877598524093628
grad_norm: 2.3773605098935153, clipped: 1.0
epoch: 61, train_batch_id: 1500, avg_cost: 3.9029788970947266
grad_norm: 2.793172900227404, clipped: 1.0
epoch: 61, train_batch_id: 1550, avg_cost: 3.8778395652770996
grad_norm: 4.056976862794268, clipped: 1.0
epoch: 61, train_batch_id: 1600, avg_cost: 3.8725996017456055
grad_norm: 2.4384402876874507, clipped: 1.0
epoch: 61, train_batch_id: 1650, avg_cost: 3.8654322624206543
grad_norm: 1.7762196329834716, clipped: 1.0
epoch: 61, train_batch_id: 1700, avg_cost: 3.8886537551879883
grad_norm: 2.0155188453706847, clipped: 1.0
epoch: 61, train_batch_id: 1750, avg_cost: 3.8915653228759766
grad_norm: 2.0972746758695733, clipped: 1.0
epoch: 61, train_batch_id: 1800, avg_cost: 3.8807785511016846
grad_norm: 2.758432911070983, clipped: 1.0
epoch: 61, train_batch_id: 1850, avg_cost: 3.897433280944824
grad_norm: 3.8989421904393633, clipped: 1.0
epoch: 61, train_batch_id: 1900, avg_cost: 3.8786704540252686
grad_norm: 5.763357677961702, clipped: 1.0
epoch: 61, train_batch_id: 1950, avg_cost: 3.881958484649658
grad_norm: 2.977898799500247, clipped: 1.0
epoch: 61, train_batch_id: 2000, avg_cost: 3.879178047180176
grad_norm: 2.334747334181254, clipped: 1.0
epoch: 61, train_batch_id: 2050, avg_cost: 3.9006402492523193
grad_norm: 2.2961524691686317, clipped: 1.0
epoch: 61, train_batch_id: 2100, avg_cost: 3.8928067684173584
grad_norm: 3.022158426888084, clipped: 1.0
epoch: 61, train_batch_id: 2150, avg_cost: 3.884857177734375
grad_norm: 5.243750356860896, clipped: 1.0
epoch: 61, train_batch_id: 2200, avg_cost: 3.8823609352111816
grad_norm: 8.248609968085638, clipped: 1.0
epoch: 61, train_batch_id: 2250, avg_cost: 3.879040002822876
grad_norm: 3.472706728841228, clipped: 1.0
epoch: 61, train_batch_id: 2300, avg_cost: 3.8778188228607178
grad_norm: 7.011837002012414, clipped: 1.0
epoch: 61, train_batch_id: 2350, avg_cost: 3.885568380355835
grad_norm: 2.3123302120730087, clipped: 1.0
epoch: 61, train_batch_id: 2400, avg_cost: 3.8848514556884766
grad_norm: 1.817974735810809, clipped: 1.0
epoch: 61, train_batch_id: 2450, avg_cost: 3.8834943771362305
grad_norm: 1.9766804906829287, clipped: 1.0
Finished epoch 61, took 00:09:25 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.436503887176514 +- 0.004280779976397753
Evaluating candidate model on evaluation dataset
Epoch 61 candidate mean 4.4250078201293945, baseline epoch 39 mean 4.126363277435303, difference 0.2986445426940918
Start train epoch 62, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 62, train_batch_id: 0, avg_cost: 3.8790230751037598
grad_norm: 2.236670600408071, clipped: 1.0
epoch: 62, train_batch_id: 50, avg_cost: 3.8938655853271484
grad_norm: 1.9426038753007304, clipped: 1.0
epoch: 62, train_batch_id: 100, avg_cost: 3.910538911819458
grad_norm: 2.0875975559489595, clipped: 1.0
epoch: 62, train_batch_id: 150, avg_cost: 3.8955068588256836
grad_norm: 1.6151237292137963, clipped: 1.0
epoch: 62, train_batch_id: 200, avg_cost: 3.8773398399353027
grad_norm: 1.5318266318187064, clipped: 1.0
epoch: 62, train_batch_id: 250, avg_cost: 3.9009952545166016
grad_norm: 2.1790942173280703, clipped: 1.0
epoch: 62, train_batch_id: 300, avg_cost: 3.9140706062316895
grad_norm: 1.5137029042714483, clipped: 1.0
epoch: 62, train_batch_id: 350, avg_cost: 3.866511106491089
grad_norm: 1.5410147260868616, clipped: 1.0
epoch: 62, train_batch_id: 400, avg_cost: 3.8978095054626465
grad_norm: 4.766629596384587, clipped: 1.0
epoch: 62, train_batch_id: 450, avg_cost: 3.8863372802734375
grad_norm: 2.6679625637936146, clipped: 1.0
epoch: 62, train_batch_id: 500, avg_cost: 3.891761541366577
grad_norm: 2.3615033842639077, clipped: 1.0
epoch: 62, train_batch_id: 550, avg_cost: 3.8852434158325195
grad_norm: 3.2769756083684496, clipped: 1.0
epoch: 62, train_batch_id: 600, avg_cost: 3.895249366760254
grad_norm: 2.811201149068102, clipped: 1.0
epoch: 62, train_batch_id: 650, avg_cost: 3.8826112747192383
grad_norm: 1.4853143976940917, clipped: 1.0
epoch: 62, train_batch_id: 700, avg_cost: 3.882359504699707
grad_norm: 1.4982031221759053, clipped: 1.0
epoch: 62, train_batch_id: 750, avg_cost: 3.8716039657592773
grad_norm: 1.6089454509881038, clipped: 1.0
epoch: 62, train_batch_id: 800, avg_cost: 3.871142864227295
grad_norm: 1.6220651903360237, clipped: 1.0
epoch: 62, train_batch_id: 850, avg_cost: 3.882312297821045
grad_norm: 1.4139109563664891, clipped: 1.0
epoch: 62, train_batch_id: 900, avg_cost: 3.883716583251953
grad_norm: 2.1370836252870604, clipped: 1.0
epoch: 62, train_batch_id: 950, avg_cost: 3.882274627685547
grad_norm: 1.3130140780374344, clipped: 1.0
epoch: 62, train_batch_id: 1000, avg_cost: 3.857539415359497
grad_norm: 2.0288787775244725, clipped: 1.0
epoch: 62, train_batch_id: 1050, avg_cost: 3.8598451614379883
grad_norm: 1.8592864335466843, clipped: 1.0
epoch: 62, train_batch_id: 1100, avg_cost: 3.891634464263916
grad_norm: 2.088001997666537, clipped: 1.0
epoch: 62, train_batch_id: 1150, avg_cost: 3.8848283290863037
grad_norm: 1.7969761880440367, clipped: 1.0
epoch: 62, train_batch_id: 1200, avg_cost: 3.8527634143829346
grad_norm: 2.1715245197679427, clipped: 1.0
epoch: 62, train_batch_id: 1250, avg_cost: 3.870244026184082
grad_norm: 1.4430431493243272, clipped: 1.0
epoch: 62, train_batch_id: 1300, avg_cost: 3.8778581619262695
grad_norm: 1.4108854404679916, clipped: 1.0
epoch: 62, train_batch_id: 1350, avg_cost: 3.8626232147216797
grad_norm: 2.431551665533406, clipped: 1.0
epoch: 62, train_batch_id: 1400, avg_cost: 3.8651065826416016
grad_norm: 1.5946569842036655, clipped: 1.0
epoch: 62, train_batch_id: 1450, avg_cost: 3.882868766784668
grad_norm: 1.9982721080880659, clipped: 1.0
epoch: 62, train_batch_id: 1500, avg_cost: 3.8781604766845703
grad_norm: 1.3648416450320604, clipped: 1.0
epoch: 62, train_batch_id: 1550, avg_cost: 3.8961548805236816
grad_norm: 2.2623319500732917, clipped: 1.0
epoch: 62, train_batch_id: 1600, avg_cost: 3.876204490661621
grad_norm: 3.4534353903592434, clipped: 1.0
epoch: 62, train_batch_id: 1650, avg_cost: 3.8573789596557617
grad_norm: 1.504671036498188, clipped: 1.0
epoch: 62, train_batch_id: 1700, avg_cost: 3.864804744720459
grad_norm: 2.6141408513311966, clipped: 1.0
epoch: 62, train_batch_id: 1750, avg_cost: 3.8846421241760254
grad_norm: 2.351181968308092, clipped: 1.0
epoch: 62, train_batch_id: 1800, avg_cost: 3.8912830352783203
grad_norm: 1.5612818007029128, clipped: 1.0
epoch: 62, train_batch_id: 1850, avg_cost: 3.888275623321533
grad_norm: 1.883369831254605, clipped: 1.0
epoch: 62, train_batch_id: 1900, avg_cost: 3.8902437686920166
grad_norm: 2.2266629893539895, clipped: 1.0
epoch: 62, train_batch_id: 1950, avg_cost: 3.8781790733337402
grad_norm: 1.6929838545758615, clipped: 1.0
epoch: 62, train_batch_id: 2000, avg_cost: 3.8957276344299316
grad_norm: 1.8565306045944372, clipped: 1.0
epoch: 62, train_batch_id: 2050, avg_cost: 3.861469030380249
grad_norm: 1.5096178129966784, clipped: 1.0
epoch: 62, train_batch_id: 2100, avg_cost: 3.8750269412994385
grad_norm: 3.034105513367138, clipped: 1.0
epoch: 62, train_batch_id: 2150, avg_cost: 3.874497652053833
grad_norm: 1.4098697751765237, clipped: 1.0
epoch: 62, train_batch_id: 2200, avg_cost: 3.882856845855713
grad_norm: 4.729253364161587, clipped: 1.0
epoch: 62, train_batch_id: 2250, avg_cost: 3.890679121017456
grad_norm: 1.5964323102536127, clipped: 1.0
epoch: 62, train_batch_id: 2300, avg_cost: 3.876347064971924
grad_norm: 1.4172740949694806, clipped: 1.0
epoch: 62, train_batch_id: 2350, avg_cost: 3.889960527420044
grad_norm: 4.219049751192903, clipped: 1.0
epoch: 62, train_batch_id: 2400, avg_cost: 3.89078950881958
grad_norm: 1.3421714865278724, clipped: 1.0
epoch: 62, train_batch_id: 2450, avg_cost: 3.8815855979919434
grad_norm: 1.6368077799837097, clipped: 1.0
Finished epoch 62, took 00:09:27 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.386446952819824 +- 0.004225264769047499
Evaluating candidate model on evaluation dataset
Epoch 62 candidate mean 4.3826985359191895, baseline epoch 39 mean 4.126363277435303, difference 0.2563352584838867
Start train epoch 63, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 63, train_batch_id: 0, avg_cost: 3.880141496658325
grad_norm: 1.8480012182923966, clipped: 1.0
epoch: 63, train_batch_id: 50, avg_cost: 3.8827319145202637
grad_norm: 2.062638634958627, clipped: 1.0
epoch: 63, train_batch_id: 100, avg_cost: 3.8615524768829346
grad_norm: 1.4333173340460912, clipped: 1.0
epoch: 63, train_batch_id: 150, avg_cost: 3.8947157859802246
grad_norm: 1.7801709290976973, clipped: 1.0
epoch: 63, train_batch_id: 200, avg_cost: 3.8859784603118896
grad_norm: 3.5583208522526157, clipped: 1.0
epoch: 63, train_batch_id: 250, avg_cost: 3.879337787628174
grad_norm: 2.2987639340585693, clipped: 1.0
epoch: 63, train_batch_id: 300, avg_cost: 3.8864896297454834
grad_norm: 1.9384829001965078, clipped: 1.0
epoch: 63, train_batch_id: 350, avg_cost: 3.8927690982818604
grad_norm: 2.0047410285993164, clipped: 1.0
epoch: 63, train_batch_id: 400, avg_cost: 3.903836250305176
grad_norm: 1.5132246219944425, clipped: 1.0
epoch: 63, train_batch_id: 450, avg_cost: 3.8802852630615234
grad_norm: 1.6675506281050752, clipped: 1.0
epoch: 63, train_batch_id: 500, avg_cost: 3.881502151489258
grad_norm: 2.3417925212952713, clipped: 1.0
epoch: 63, train_batch_id: 550, avg_cost: 3.884106159210205
grad_norm: 1.612959295143065, clipped: 1.0
epoch: 63, train_batch_id: 600, avg_cost: 3.891129493713379
grad_norm: 1.8206462263503134, clipped: 1.0
epoch: 63, train_batch_id: 650, avg_cost: 3.8850326538085938
grad_norm: 1.5914454613621603, clipped: 1.0
epoch: 63, train_batch_id: 700, avg_cost: 3.884470224380493
grad_norm: 2.138256004436663, clipped: 1.0
epoch: 63, train_batch_id: 750, avg_cost: 3.872791290283203
grad_norm: 1.6214729734301638, clipped: 1.0
epoch: 63, train_batch_id: 800, avg_cost: 3.8924429416656494
grad_norm: 2.4192065701582073, clipped: 1.0
epoch: 63, train_batch_id: 850, avg_cost: 3.9001193046569824
grad_norm: 3.279681543130279, clipped: 1.0
epoch: 63, train_batch_id: 900, avg_cost: 3.8724827766418457
grad_norm: 1.8879822949569587, clipped: 1.0
epoch: 63, train_batch_id: 950, avg_cost: 3.873197078704834
grad_norm: 1.9140094581068194, clipped: 1.0
epoch: 63, train_batch_id: 1000, avg_cost: 3.8806939125061035
grad_norm: 2.472253584360214, clipped: 1.0
epoch: 63, train_batch_id: 1050, avg_cost: 3.874817132949829
grad_norm: 1.7869689467612309, clipped: 1.0
epoch: 63, train_batch_id: 1100, avg_cost: 3.8700079917907715
grad_norm: 2.9427229872090876, clipped: 1.0
epoch: 63, train_batch_id: 1150, avg_cost: 3.8804893493652344
grad_norm: 2.1024765490592254, clipped: 1.0
epoch: 63, train_batch_id: 1200, avg_cost: 3.8777143955230713
grad_norm: 1.751121063855519, clipped: 1.0
epoch: 63, train_batch_id: 1250, avg_cost: 3.8833816051483154
grad_norm: 2.9265591022286785, clipped: 1.0
epoch: 63, train_batch_id: 1300, avg_cost: 3.8641815185546875
grad_norm: 1.7782579725992929, clipped: 1.0
epoch: 63, train_batch_id: 1350, avg_cost: 3.89096999168396
grad_norm: 2.386988337247353, clipped: 1.0
epoch: 63, train_batch_id: 1400, avg_cost: 3.8800811767578125
grad_norm: 1.327454645248193, clipped: 1.0
epoch: 63, train_batch_id: 1450, avg_cost: 3.882944345474243
grad_norm: 1.8141295253385508, clipped: 1.0
epoch: 63, train_batch_id: 1500, avg_cost: 3.863109588623047
grad_norm: 9.525247681837042, clipped: 1.0
epoch: 63, train_batch_id: 1550, avg_cost: 3.8679277896881104
grad_norm: 1.6859136525993648, clipped: 1.0
epoch: 63, train_batch_id: 1600, avg_cost: 3.8918089866638184
grad_norm: 1.865726424160981, clipped: 1.0
epoch: 63, train_batch_id: 1650, avg_cost: 3.8375861644744873
grad_norm: 2.0142552900677733, clipped: 1.0
epoch: 63, train_batch_id: 1700, avg_cost: 3.8888354301452637
grad_norm: 3.9457933611007254, clipped: 1.0
epoch: 63, train_batch_id: 1750, avg_cost: 3.8460500240325928
grad_norm: 6.0222333049532395, clipped: 1.0
epoch: 63, train_batch_id: 1800, avg_cost: 3.8912062644958496
grad_norm: 1.5498267303297744, clipped: 1.0
epoch: 63, train_batch_id: 1850, avg_cost: 3.8636245727539062
grad_norm: 1.6353233733238424, clipped: 1.0
epoch: 63, train_batch_id: 1900, avg_cost: 3.8723669052124023
grad_norm: 1.8644722125687043, clipped: 1.0
epoch: 63, train_batch_id: 1950, avg_cost: 3.8460896015167236
grad_norm: 2.8426194103115567, clipped: 1.0
epoch: 63, train_batch_id: 2000, avg_cost: 3.8813817501068115
grad_norm: 1.190230929627268, clipped: 1.0
epoch: 63, train_batch_id: 2050, avg_cost: 3.906857967376709
grad_norm: 1.9339006635405835, clipped: 1.0
epoch: 63, train_batch_id: 2100, avg_cost: 3.881478786468506
grad_norm: 2.201936335339832, clipped: 1.0
epoch: 63, train_batch_id: 2150, avg_cost: 3.910815477371216
grad_norm: 1.992022940063479, clipped: 1.0
epoch: 63, train_batch_id: 2200, avg_cost: 3.8746261596679688
grad_norm: 1.5680421365494943, clipped: 1.0
epoch: 63, train_batch_id: 2250, avg_cost: 3.8534464836120605
grad_norm: 3.1990814949346804, clipped: 1.0
epoch: 63, train_batch_id: 2300, avg_cost: 3.894960880279541
grad_norm: 1.93098374841422, clipped: 1.0
epoch: 63, train_batch_id: 2350, avg_cost: 3.872637987136841
grad_norm: 1.8236946862791048, clipped: 1.0
epoch: 63, train_batch_id: 2400, avg_cost: 3.8728256225585938
grad_norm: 1.585547170073353, clipped: 1.0
epoch: 63, train_batch_id: 2450, avg_cost: 3.884936809539795
grad_norm: 2.1815519202745755, clipped: 1.0
Finished epoch 63, took 00:09:25 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.380320072174072 +- 0.0042591942474246025
Evaluating candidate model on evaluation dataset
Epoch 63 candidate mean 4.369425296783447, baseline epoch 39 mean 4.126363277435303, difference 0.24306201934814453
Start train epoch 64, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 64, train_batch_id: 0, avg_cost: 3.862362861633301
grad_norm: 1.5329979565215928, clipped: 1.0
epoch: 64, train_batch_id: 50, avg_cost: 3.8765392303466797
grad_norm: 1.6855431630893052, clipped: 1.0
epoch: 64, train_batch_id: 100, avg_cost: 3.887982130050659
grad_norm: 1.8836939058400817, clipped: 1.0
epoch: 64, train_batch_id: 150, avg_cost: 3.882615566253662
grad_norm: 1.9311459372037296, clipped: 1.0
epoch: 64, train_batch_id: 200, avg_cost: 3.875969171524048
grad_norm: 1.75084399608105, clipped: 1.0
epoch: 64, train_batch_id: 250, avg_cost: 3.88812255859375
grad_norm: 2.450657571392576, clipped: 1.0
epoch: 64, train_batch_id: 300, avg_cost: 3.883209228515625
grad_norm: 3.504798278719352, clipped: 1.0
epoch: 64, train_batch_id: 350, avg_cost: 3.888065814971924
grad_norm: 1.4827021311409452, clipped: 1.0
epoch: 64, train_batch_id: 400, avg_cost: 3.8943190574645996
grad_norm: 1.791479469577576, clipped: 1.0
epoch: 64, train_batch_id: 450, avg_cost: 3.8823933601379395
grad_norm: 1.7247612568365798, clipped: 1.0
epoch: 64, train_batch_id: 500, avg_cost: 3.880784511566162
grad_norm: 1.9521016483239981, clipped: 1.0
epoch: 64, train_batch_id: 550, avg_cost: 3.88735294342041
grad_norm: 1.5859181414899592, clipped: 1.0
epoch: 64, train_batch_id: 600, avg_cost: 3.8934059143066406
grad_norm: 2.0980730381971306, clipped: 1.0
epoch: 64, train_batch_id: 650, avg_cost: 3.9159955978393555
grad_norm: 1.7910016715661536, clipped: 1.0
epoch: 64, train_batch_id: 700, avg_cost: 3.8816471099853516
grad_norm: 1.3370230956456681, clipped: 1.0
epoch: 64, train_batch_id: 750, avg_cost: 3.876124858856201
grad_norm: 1.5563029712745182, clipped: 1.0
epoch: 64, train_batch_id: 800, avg_cost: 3.8692946434020996
grad_norm: 1.827278554989332, clipped: 1.0
epoch: 64, train_batch_id: 850, avg_cost: 3.9048895835876465
grad_norm: 2.2508241602856205, clipped: 1.0
epoch: 64, train_batch_id: 900, avg_cost: 3.890265703201294
grad_norm: 1.4106353135314904, clipped: 1.0
epoch: 64, train_batch_id: 950, avg_cost: 3.8732075691223145
grad_norm: 1.3467854257991965, clipped: 1.0
epoch: 64, train_batch_id: 1000, avg_cost: 3.8758981227874756
grad_norm: 2.112430504094024, clipped: 1.0
epoch: 64, train_batch_id: 1050, avg_cost: 3.904827117919922
grad_norm: 1.6828792855581187, clipped: 1.0
epoch: 64, train_batch_id: 1100, avg_cost: 3.882516384124756
grad_norm: 1.6285904123190127, clipped: 1.0
epoch: 64, train_batch_id: 1150, avg_cost: 3.8829030990600586
grad_norm: 4.766286997704985, clipped: 1.0
epoch: 64, train_batch_id: 1200, avg_cost: 3.9087343215942383
grad_norm: 3.199353008697562, clipped: 1.0
epoch: 64, train_batch_id: 1250, avg_cost: 3.886784553527832
grad_norm: 2.581875712571585, clipped: 1.0
epoch: 64, train_batch_id: 1300, avg_cost: 3.872657060623169
grad_norm: 3.2169803629971385, clipped: 1.0
epoch: 64, train_batch_id: 1350, avg_cost: 3.8687949180603027
grad_norm: 1.9962179267833233, clipped: 1.0
epoch: 64, train_batch_id: 1400, avg_cost: 3.8787033557891846
grad_norm: 2.2559789750270904, clipped: 1.0
epoch: 64, train_batch_id: 1450, avg_cost: 3.8924522399902344
grad_norm: 1.7118040059009254, clipped: 1.0
epoch: 64, train_batch_id: 1500, avg_cost: 3.8816518783569336
grad_norm: 1.6057345860410062, clipped: 1.0
epoch: 64, train_batch_id: 1550, avg_cost: 3.866957902908325
grad_norm: 2.655072760309421, clipped: 1.0
epoch: 64, train_batch_id: 1600, avg_cost: 3.8596479892730713
grad_norm: 2.697099819975991, clipped: 1.0
epoch: 64, train_batch_id: 1650, avg_cost: 3.8771371841430664
grad_norm: 1.7662235405967108, clipped: 1.0
epoch: 64, train_batch_id: 1700, avg_cost: 3.8720030784606934
grad_norm: 1.435800960056977, clipped: 1.0
epoch: 64, train_batch_id: 1750, avg_cost: 3.8678359985351562
grad_norm: 1.9774653587716724, clipped: 1.0
epoch: 64, train_batch_id: 1800, avg_cost: 3.8745322227478027
grad_norm: 1.9943778507848002, clipped: 1.0
epoch: 64, train_batch_id: 1850, avg_cost: 3.8883354663848877
grad_norm: 2.159683001329653, clipped: 1.0
epoch: 64, train_batch_id: 1900, avg_cost: 3.865051746368408
grad_norm: 1.7449057435603663, clipped: 1.0
epoch: 64, train_batch_id: 1950, avg_cost: 3.8699169158935547
grad_norm: 3.08705082673608, clipped: 1.0
epoch: 64, train_batch_id: 2000, avg_cost: 3.8915185928344727
grad_norm: 2.8209186659795713, clipped: 1.0
epoch: 64, train_batch_id: 2050, avg_cost: 3.8608875274658203
grad_norm: 1.4958452499283457, clipped: 1.0
epoch: 64, train_batch_id: 2100, avg_cost: 3.862826347351074
grad_norm: 1.8692746039060781, clipped: 1.0
epoch: 64, train_batch_id: 2150, avg_cost: 3.8624603748321533
grad_norm: 2.6687038689667593, clipped: 1.0
epoch: 64, train_batch_id: 2200, avg_cost: 3.867523670196533
grad_norm: 2.2770137538349626, clipped: 1.0
epoch: 64, train_batch_id: 2250, avg_cost: 3.878718137741089
grad_norm: 2.305280444096933, clipped: 1.0
epoch: 64, train_batch_id: 2300, avg_cost: 3.890348434448242
grad_norm: 2.0019436598268996, clipped: 1.0
epoch: 64, train_batch_id: 2350, avg_cost: 3.8758654594421387
grad_norm: 2.9448809895871015, clipped: 1.0
epoch: 64, train_batch_id: 2400, avg_cost: 3.873135566711426
grad_norm: 1.6737075243015687, clipped: 1.0
epoch: 64, train_batch_id: 2450, avg_cost: 3.8623762130737305
grad_norm: 1.6206161305681215, clipped: 1.0
Finished epoch 64, took 00:09:25 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.249274730682373 +- 0.00397367961704731
Evaluating candidate model on evaluation dataset
Epoch 64 candidate mean 4.240312576293945, baseline epoch 39 mean 4.126363277435303, difference 0.11394929885864258
Start train epoch 65, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 65, train_batch_id: 0, avg_cost: 3.9024360179901123
grad_norm: 2.3754780184829927, clipped: 1.0
epoch: 65, train_batch_id: 50, avg_cost: 3.894902467727661
grad_norm: 3.7352721342103123, clipped: 1.0
epoch: 65, train_batch_id: 100, avg_cost: 3.8961830139160156
grad_norm: 2.1896771432273456, clipped: 1.0
epoch: 65, train_batch_id: 150, avg_cost: 3.894073486328125
grad_norm: 2.0150752592593806, clipped: 1.0
epoch: 65, train_batch_id: 200, avg_cost: 3.8644309043884277
grad_norm: 2.3330082182350935, clipped: 1.0
epoch: 65, train_batch_id: 250, avg_cost: 3.891974449157715
grad_norm: 1.5372475889712651, clipped: 1.0
epoch: 65, train_batch_id: 300, avg_cost: 3.8931987285614014
grad_norm: 1.6427324413398037, clipped: 1.0
epoch: 65, train_batch_id: 350, avg_cost: 3.9005517959594727
grad_norm: 1.6318396998836826, clipped: 1.0
epoch: 65, train_batch_id: 400, avg_cost: 3.9067296981811523
grad_norm: 1.7758843655646024, clipped: 1.0
epoch: 65, train_batch_id: 450, avg_cost: 3.900294303894043
grad_norm: 1.4681335171471308, clipped: 1.0
epoch: 65, train_batch_id: 500, avg_cost: 3.8724615573883057
grad_norm: 1.715061317959669, clipped: 1.0
epoch: 65, train_batch_id: 550, avg_cost: 3.8777875900268555
grad_norm: 1.8658468830557287, clipped: 1.0
epoch: 65, train_batch_id: 600, avg_cost: 3.9013657569885254
grad_norm: 1.9506021258810495, clipped: 1.0
epoch: 65, train_batch_id: 650, avg_cost: 3.8903064727783203
grad_norm: 1.9849634495652118, clipped: 1.0
epoch: 65, train_batch_id: 700, avg_cost: 3.882305145263672
grad_norm: 1.8581921638076322, clipped: 1.0
epoch: 65, train_batch_id: 750, avg_cost: 3.864086151123047
grad_norm: 1.7547167037352154, clipped: 1.0
epoch: 65, train_batch_id: 800, avg_cost: 3.858698844909668
grad_norm: 1.8654805625587, clipped: 1.0
epoch: 65, train_batch_id: 850, avg_cost: 3.89158034324646
grad_norm: 1.8623568301802904, clipped: 1.0
epoch: 65, train_batch_id: 900, avg_cost: 3.866633415222168
grad_norm: 1.4426974765396172, clipped: 1.0
epoch: 65, train_batch_id: 950, avg_cost: 3.8832483291625977
grad_norm: 1.818365892663955, clipped: 1.0
epoch: 65, train_batch_id: 1000, avg_cost: 3.848198175430298
grad_norm: 3.0250219939540055, clipped: 1.0
epoch: 65, train_batch_id: 1050, avg_cost: 3.880673408508301
grad_norm: 3.701705492469461, clipped: 1.0
epoch: 65, train_batch_id: 1100, avg_cost: 3.8924245834350586
grad_norm: 2.1179918806643356, clipped: 1.0
epoch: 65, train_batch_id: 1150, avg_cost: 3.8891916275024414
grad_norm: 1.8420466718691035, clipped: 1.0
epoch: 65, train_batch_id: 1200, avg_cost: 3.866806983947754
grad_norm: 1.4131177104396355, clipped: 1.0
epoch: 65, train_batch_id: 1250, avg_cost: 3.852085590362549
grad_norm: 1.990683331222058, clipped: 1.0
epoch: 65, train_batch_id: 1300, avg_cost: 3.893176555633545
grad_norm: 1.7141845471624644, clipped: 1.0
epoch: 65, train_batch_id: 1350, avg_cost: 3.891822099685669
grad_norm: 3.1623543408138888, clipped: 1.0
epoch: 65, train_batch_id: 1400, avg_cost: 3.886563777923584
grad_norm: 1.928959584776289, clipped: 1.0
epoch: 65, train_batch_id: 1450, avg_cost: 3.8923356533050537
grad_norm: 2.436534435157445, clipped: 1.0
epoch: 65, train_batch_id: 1500, avg_cost: 3.8815736770629883
grad_norm: 1.942694496280831, clipped: 1.0
epoch: 65, train_batch_id: 1550, avg_cost: 3.8910250663757324
grad_norm: 2.4169363273673192, clipped: 1.0
epoch: 65, train_batch_id: 1600, avg_cost: 3.864593267440796
grad_norm: 1.6645416306503122, clipped: 1.0
epoch: 65, train_batch_id: 1650, avg_cost: 3.8676915168762207
grad_norm: 1.7819231902626893, clipped: 1.0
epoch: 65, train_batch_id: 1700, avg_cost: 3.8839375972747803
grad_norm: 2.624613423432504, clipped: 1.0
epoch: 65, train_batch_id: 1750, avg_cost: 3.8703808784484863
grad_norm: 3.01593930811835, clipped: 1.0
epoch: 65, train_batch_id: 1800, avg_cost: 3.889695167541504
grad_norm: 4.993609992544743, clipped: 1.0
epoch: 65, train_batch_id: 1850, avg_cost: 3.8812460899353027
grad_norm: 1.9309895831904762, clipped: 1.0
epoch: 65, train_batch_id: 1900, avg_cost: 3.8568317890167236
grad_norm: 4.730760185399401, clipped: 1.0
epoch: 65, train_batch_id: 1950, avg_cost: 3.8948752880096436
grad_norm: 1.809725482281285, clipped: 1.0
epoch: 65, train_batch_id: 2000, avg_cost: 3.8751184940338135
grad_norm: 1.6264451761927183, clipped: 1.0
epoch: 65, train_batch_id: 2050, avg_cost: 3.8601346015930176
grad_norm: 2.221541408451323, clipped: 1.0
epoch: 65, train_batch_id: 2100, avg_cost: 3.8900246620178223
grad_norm: 2.063451735452612, clipped: 1.0
epoch: 65, train_batch_id: 2150, avg_cost: 3.885019063949585
grad_norm: 1.6239057008286648, clipped: 1.0
epoch: 65, train_batch_id: 2200, avg_cost: 3.8853635787963867
grad_norm: 1.926174559998393, clipped: 1.0
epoch: 65, train_batch_id: 2250, avg_cost: 3.8857362270355225
grad_norm: 2.0855807312493475, clipped: 1.0
epoch: 65, train_batch_id: 2300, avg_cost: 3.8879687786102295
grad_norm: 2.1442643191756576, clipped: 1.0
epoch: 65, train_batch_id: 2350, avg_cost: 3.8520758152008057
grad_norm: 1.6878036580058935, clipped: 1.0
epoch: 65, train_batch_id: 2400, avg_cost: 3.8902487754821777
grad_norm: 1.4863044623855735, clipped: 1.0
epoch: 65, train_batch_id: 2450, avg_cost: 3.880032777786255
grad_norm: 1.8616306178319053, clipped: 1.0
Finished epoch 65, took 00:09:29 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.190705299377441 +- 0.0037490027025341988
Evaluating candidate model on evaluation dataset
Epoch 65 candidate mean 4.1803460121154785, baseline epoch 39 mean 4.126363277435303, difference 0.05398273468017578
Start train epoch 66, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 66, train_batch_id: 0, avg_cost: 3.8948633670806885
grad_norm: 1.3221914747057364, clipped: 1.0
epoch: 66, train_batch_id: 50, avg_cost: 3.8747925758361816
grad_norm: 2.763749847460698, clipped: 1.0
epoch: 66, train_batch_id: 100, avg_cost: 3.8832788467407227
grad_norm: 1.6467572190687083, clipped: 1.0
epoch: 66, train_batch_id: 150, avg_cost: 3.887479543685913
grad_norm: 1.882760865177771, clipped: 1.0
epoch: 66, train_batch_id: 200, avg_cost: 3.877509593963623
grad_norm: 2.5875083786287, clipped: 1.0
epoch: 66, train_batch_id: 250, avg_cost: 3.902191400527954
grad_norm: 1.7464755831641479, clipped: 1.0
epoch: 66, train_batch_id: 300, avg_cost: 3.85677433013916
grad_norm: 2.118991109842994, clipped: 1.0
epoch: 66, train_batch_id: 350, avg_cost: 3.870070457458496
grad_norm: 2.4449269461838656, clipped: 1.0
epoch: 66, train_batch_id: 400, avg_cost: 3.891732692718506
grad_norm: 8.196757697367023, clipped: 1.0
epoch: 66, train_batch_id: 450, avg_cost: 3.901571273803711
grad_norm: 1.6317634383151576, clipped: 1.0
epoch: 66, train_batch_id: 500, avg_cost: 3.8712282180786133
grad_norm: 1.3796331583607992, clipped: 1.0
epoch: 66, train_batch_id: 550, avg_cost: 3.871155261993408
grad_norm: 1.90971886065133, clipped: 1.0
epoch: 66, train_batch_id: 600, avg_cost: 3.884458541870117
grad_norm: 2.106605565749991, clipped: 1.0
epoch: 66, train_batch_id: 650, avg_cost: 3.8949623107910156
grad_norm: 2.881290944680132, clipped: 1.0
epoch: 66, train_batch_id: 700, avg_cost: 3.8836865425109863
grad_norm: 1.5886678042526108, clipped: 1.0
epoch: 66, train_batch_id: 750, avg_cost: 3.873370409011841
grad_norm: 1.7795266949511206, clipped: 1.0
epoch: 66, train_batch_id: 800, avg_cost: 3.867955207824707
grad_norm: 5.429650955873732, clipped: 1.0
epoch: 66, train_batch_id: 850, avg_cost: 3.869333505630493
grad_norm: 2.665667416616159, clipped: 1.0
epoch: 66, train_batch_id: 900, avg_cost: 3.868420124053955
grad_norm: 2.1076147209960987, clipped: 1.0
epoch: 66, train_batch_id: 950, avg_cost: 3.867386817932129
grad_norm: 1.3082018501107333, clipped: 1.0
epoch: 66, train_batch_id: 1000, avg_cost: 3.8664584159851074
grad_norm: 2.6065644973115516, clipped: 1.0
epoch: 66, train_batch_id: 1050, avg_cost: 3.8929474353790283
grad_norm: 3.207981358177448, clipped: 1.0
epoch: 66, train_batch_id: 1100, avg_cost: 3.8688621520996094
grad_norm: 2.6166227916426466, clipped: 1.0
epoch: 66, train_batch_id: 1150, avg_cost: 3.845977306365967
grad_norm: 1.4214098095318484, clipped: 1.0
epoch: 66, train_batch_id: 1200, avg_cost: 3.8730311393737793
grad_norm: 3.03725361622938, clipped: 1.0
epoch: 66, train_batch_id: 1250, avg_cost: 3.880310535430908
grad_norm: 2.8385674125808764, clipped: 1.0
epoch: 66, train_batch_id: 1300, avg_cost: 3.8967833518981934
grad_norm: 3.3476734997247912, clipped: 1.0
epoch: 66, train_batch_id: 1350, avg_cost: 3.8835487365722656
grad_norm: 5.2131230188483, clipped: 1.0
epoch: 66, train_batch_id: 1400, avg_cost: 3.8844151496887207
grad_norm: 2.71499199088244, clipped: 1.0
epoch: 66, train_batch_id: 1450, avg_cost: 3.896958351135254
grad_norm: 1.4835122990559093, clipped: 1.0
epoch: 66, train_batch_id: 1500, avg_cost: 3.8765196800231934
grad_norm: 2.207070715234807, clipped: 1.0
epoch: 66, train_batch_id: 1550, avg_cost: 3.885227680206299
grad_norm: 2.327086502538203, clipped: 1.0
epoch: 66, train_batch_id: 1600, avg_cost: 3.869288921356201
grad_norm: 2.2880290553835647, clipped: 1.0
epoch: 66, train_batch_id: 1650, avg_cost: 3.861811637878418
grad_norm: 1.8550145424363629, clipped: 1.0
epoch: 66, train_batch_id: 1700, avg_cost: 3.860342025756836
grad_norm: 1.5007716784976228, clipped: 1.0
epoch: 66, train_batch_id: 1750, avg_cost: 3.9045307636260986
grad_norm: 1.869753333727882, clipped: 1.0
epoch: 66, train_batch_id: 1800, avg_cost: 3.8630623817443848
grad_norm: 1.4140927936956342, clipped: 1.0
epoch: 66, train_batch_id: 1850, avg_cost: 3.891486167907715
grad_norm: 1.422684865932593, clipped: 1.0
epoch: 66, train_batch_id: 1900, avg_cost: 3.864957571029663
grad_norm: 2.2016330922537084, clipped: 1.0
epoch: 66, train_batch_id: 1950, avg_cost: 3.8645436763763428
grad_norm: 1.587859062764821, clipped: 1.0
epoch: 66, train_batch_id: 2000, avg_cost: 3.849414825439453
grad_norm: 3.106923942965135, clipped: 1.0
epoch: 66, train_batch_id: 2050, avg_cost: 3.8738276958465576
grad_norm: 1.507079856764065, clipped: 1.0
epoch: 66, train_batch_id: 2100, avg_cost: 3.8526692390441895
grad_norm: 1.3945871163649501, clipped: 1.0
epoch: 66, train_batch_id: 2150, avg_cost: 3.874908447265625
grad_norm: 1.764509788825385, clipped: 1.0
epoch: 66, train_batch_id: 2200, avg_cost: 3.8836498260498047
grad_norm: 1.9792318789568881, clipped: 1.0
epoch: 66, train_batch_id: 2250, avg_cost: 3.884155511856079
grad_norm: 2.2446581858933157, clipped: 1.0
epoch: 66, train_batch_id: 2300, avg_cost: 3.8725013732910156
grad_norm: 1.4032012443187498, clipped: 1.0
epoch: 66, train_batch_id: 2350, avg_cost: 3.8803048133850098
grad_norm: 2.3176421790361674, clipped: 1.0
epoch: 66, train_batch_id: 2400, avg_cost: 3.875887155532837
grad_norm: 2.1019321938801356, clipped: 1.0
epoch: 66, train_batch_id: 2450, avg_cost: 3.8687901496887207
grad_norm: 1.599263387393036, clipped: 1.0
Finished epoch 66, took 00:09:23 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.3117356300354 +- 0.004024973604828119
Evaluating candidate model on evaluation dataset
Epoch 66 candidate mean 4.302318572998047, baseline epoch 39 mean 4.126363277435303, difference 0.17595529556274414
Start train epoch 67, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 67, train_batch_id: 0, avg_cost: 3.8587310314178467
grad_norm: 1.797475141084062, clipped: 1.0
epoch: 67, train_batch_id: 50, avg_cost: 3.8903257846832275
grad_norm: 2.6208003716886066, clipped: 1.0
epoch: 67, train_batch_id: 100, avg_cost: 3.8809654712677
grad_norm: 3.092338162086415, clipped: 1.0
epoch: 67, train_batch_id: 150, avg_cost: 3.8659164905548096
grad_norm: 2.8360768620963968, clipped: 1.0
epoch: 67, train_batch_id: 200, avg_cost: 3.8569610118865967
grad_norm: 2.0811966708319307, clipped: 1.0
epoch: 67, train_batch_id: 250, avg_cost: 3.8769278526306152
grad_norm: 1.5808695576800749, clipped: 1.0
epoch: 67, train_batch_id: 300, avg_cost: 3.9183149337768555
grad_norm: 1.5815346037233973, clipped: 1.0
epoch: 67, train_batch_id: 350, avg_cost: 3.891590118408203
grad_norm: 2.353979815195989, clipped: 1.0
epoch: 67, train_batch_id: 400, avg_cost: 3.8733696937561035
grad_norm: 1.3727508558722663, clipped: 1.0
epoch: 67, train_batch_id: 450, avg_cost: 3.8916072845458984
grad_norm: 4.529145135288232, clipped: 1.0
epoch: 67, train_batch_id: 500, avg_cost: 3.8423867225646973
grad_norm: 1.8580028607772687, clipped: 1.0
epoch: 67, train_batch_id: 550, avg_cost: 3.881260871887207
grad_norm: 1.926951540069645, clipped: 1.0
epoch: 67, train_batch_id: 600, avg_cost: 3.8881006240844727
grad_norm: 1.6107499114720858, clipped: 1.0
epoch: 67, train_batch_id: 650, avg_cost: 3.868481159210205
grad_norm: 1.7393571188343828, clipped: 1.0
epoch: 67, train_batch_id: 700, avg_cost: 3.8937175273895264
grad_norm: 2.2394431557213736, clipped: 1.0
epoch: 67, train_batch_id: 750, avg_cost: 3.8938121795654297
grad_norm: 1.8592965608943506, clipped: 1.0
epoch: 67, train_batch_id: 800, avg_cost: 3.8754804134368896
grad_norm: 3.6574733519306974, clipped: 1.0
epoch: 67, train_batch_id: 850, avg_cost: 3.8812012672424316
grad_norm: 5.452358932263558, clipped: 1.0
epoch: 67, train_batch_id: 900, avg_cost: 3.8700833320617676
grad_norm: 4.05761453397577, clipped: 1.0
epoch: 67, train_batch_id: 950, avg_cost: 3.873767852783203
grad_norm: 1.8421831271663203, clipped: 1.0
epoch: 67, train_batch_id: 1000, avg_cost: 3.874802589416504
grad_norm: 1.753880439776695, clipped: 1.0
epoch: 67, train_batch_id: 1050, avg_cost: 3.8808960914611816
grad_norm: 1.7225071155711147, clipped: 1.0
epoch: 67, train_batch_id: 1100, avg_cost: 3.849261522293091
grad_norm: 3.141046739410368, clipped: 1.0
epoch: 67, train_batch_id: 1150, avg_cost: 3.897914409637451
grad_norm: 1.625572585112373, clipped: 1.0
epoch: 67, train_batch_id: 1200, avg_cost: 3.8615379333496094
grad_norm: 2.2302053424541493, clipped: 1.0
epoch: 67, train_batch_id: 1250, avg_cost: 3.8597588539123535
grad_norm: 1.4739246550948624, clipped: 1.0
epoch: 67, train_batch_id: 1300, avg_cost: 3.8720293045043945
grad_norm: 1.9370828474438773, clipped: 1.0
epoch: 67, train_batch_id: 1350, avg_cost: 3.8765130043029785
grad_norm: 2.942693613368586, clipped: 1.0
epoch: 67, train_batch_id: 1400, avg_cost: 3.8655240535736084
grad_norm: 2.6664965548485897, clipped: 1.0
epoch: 67, train_batch_id: 1450, avg_cost: 3.882075309753418
grad_norm: 2.1027993303368704, clipped: 1.0
epoch: 67, train_batch_id: 1500, avg_cost: 3.872316360473633
grad_norm: 1.916786174510651, clipped: 1.0
epoch: 67, train_batch_id: 1550, avg_cost: 3.874305009841919
grad_norm: 3.530182252163812, clipped: 1.0
epoch: 67, train_batch_id: 1600, avg_cost: 3.8918981552124023
grad_norm: 2.3260278533109164, clipped: 1.0
epoch: 67, train_batch_id: 1650, avg_cost: 3.9084014892578125
grad_norm: 1.4980560948729091, clipped: 1.0
epoch: 67, train_batch_id: 1700, avg_cost: 3.875077962875366
grad_norm: 1.912006248746888, clipped: 1.0
epoch: 67, train_batch_id: 1750, avg_cost: 3.8615946769714355
grad_norm: 4.014018487409264, clipped: 1.0
epoch: 67, train_batch_id: 1800, avg_cost: 3.8979289531707764
grad_norm: 2.310907792904132, clipped: 1.0
epoch: 67, train_batch_id: 1850, avg_cost: 3.8590638637542725
grad_norm: 1.954765111442812, clipped: 1.0
epoch: 67, train_batch_id: 1900, avg_cost: 3.8900914192199707
grad_norm: 2.075004077699323, clipped: 1.0
epoch: 67, train_batch_id: 1950, avg_cost: 3.8813390731811523
grad_norm: 1.755609625503875, clipped: 1.0
epoch: 67, train_batch_id: 2000, avg_cost: 3.8763535022735596
grad_norm: 1.5289491450033104, clipped: 1.0
epoch: 67, train_batch_id: 2050, avg_cost: 3.880427598953247
grad_norm: 2.2162292034700855, clipped: 1.0
epoch: 67, train_batch_id: 2100, avg_cost: 3.9003829956054688
grad_norm: 1.955395708930313, clipped: 1.0
epoch: 67, train_batch_id: 2150, avg_cost: 3.878221035003662
grad_norm: 1.6698964729486105, clipped: 1.0
epoch: 67, train_batch_id: 2200, avg_cost: 3.8664278984069824
grad_norm: 2.543411020279423, clipped: 1.0
epoch: 67, train_batch_id: 2250, avg_cost: 3.8651866912841797
grad_norm: 1.6791341177398158, clipped: 1.0
epoch: 67, train_batch_id: 2300, avg_cost: 3.865847587585449
grad_norm: 1.4350770665162926, clipped: 1.0
epoch: 67, train_batch_id: 2350, avg_cost: 3.880749225616455
grad_norm: 1.6734536138151392, clipped: 1.0
epoch: 67, train_batch_id: 2400, avg_cost: 3.894465684890747
grad_norm: 1.9843052593838053, clipped: 1.0
epoch: 67, train_batch_id: 2450, avg_cost: 3.8841500282287598
grad_norm: 2.1992210488337767, clipped: 1.0
Finished epoch 67, took 00:09:21 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.354093551635742 +- 0.004498632624745369
Evaluating candidate model on evaluation dataset
Epoch 67 candidate mean 4.347085952758789, baseline epoch 39 mean 4.126363277435303, difference 0.22072267532348633
Start train epoch 68, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


epoch: 68, train_batch_id: 0, avg_cost: 3.8820576667785645
grad_norm: 2.401373700769732, clipped: 1.0
epoch: 68, train_batch_id: 50, avg_cost: 3.86248517036438
grad_norm: 1.8184074653435376, clipped: 1.0
epoch: 68, train_batch_id: 100, avg_cost: 3.8937551975250244
grad_norm: 1.5250192152175668, clipped: 1.0
epoch: 68, train_batch_id: 150, avg_cost: 3.887293815612793
grad_norm: 2.133368326240251, clipped: 1.0
epoch: 68, train_batch_id: 200, avg_cost: 3.8658828735351562
grad_norm: 1.7040845994381968, clipped: 1.0
epoch: 68, train_batch_id: 250, avg_cost: 3.876267671585083
grad_norm: 2.5924574043950535, clipped: 1.0
epoch: 68, train_batch_id: 300, avg_cost: 3.8674564361572266
grad_norm: 3.953568982257588, clipped: 1.0
epoch: 68, train_batch_id: 350, avg_cost: 3.884903907775879
grad_norm: 2.1691501630777226, clipped: 1.0
epoch: 68, train_batch_id: 400, avg_cost: 3.8707094192504883
grad_norm: 1.2504516023294838, clipped: 1.0
epoch: 68, train_batch_id: 450, avg_cost: 3.8718631267547607
grad_norm: 1.6166529372484661, clipped: 1.0
epoch: 68, train_batch_id: 500, avg_cost: 3.8551363945007324
grad_norm: 1.6385291276788578, clipped: 1.0
epoch: 68, train_batch_id: 550, avg_cost: 3.8550291061401367
grad_norm: 2.281599971344829, clipped: 1.0
epoch: 68, train_batch_id: 600, avg_cost: 3.883991241455078
grad_norm: 1.5293072214584162, clipped: 1.0
epoch: 68, train_batch_id: 650, avg_cost: 3.8624744415283203
grad_norm: 2.683894726060339, clipped: 1.0
epoch: 68, train_batch_id: 700, avg_cost: 3.862212657928467
grad_norm: 2.3988909669885503, clipped: 1.0
epoch: 68, train_batch_id: 750, avg_cost: 3.8740296363830566
grad_norm: 1.765127065666606, clipped: 1.0
epoch: 68, train_batch_id: 800, avg_cost: 3.874311685562134
grad_norm: 2.0729322392814784, clipped: 1.0
epoch: 68, train_batch_id: 850, avg_cost: 3.8834586143493652
grad_norm: 1.6744281155666894, clipped: 1.0
epoch: 68, train_batch_id: 900, avg_cost: 3.889679431915283
grad_norm: 2.151153887648205, clipped: 1.0
epoch: 68, train_batch_id: 950, avg_cost: 3.869635820388794
grad_norm: 2.1018952828072957, clipped: 1.0
epoch: 68, train_batch_id: 1000, avg_cost: 3.8709800243377686
grad_norm: 2.1675284845253575, clipped: 1.0
epoch: 68, train_batch_id: 1050, avg_cost: 3.8695783615112305
grad_norm: 1.3214840016027434, clipped: 1.0
epoch: 68, train_batch_id: 1100, avg_cost: 3.8902268409729004
grad_norm: 1.7691421834195693, clipped: 1.0
epoch: 68, train_batch_id: 1150, avg_cost: 3.904331684112549
grad_norm: 2.2270261095850006, clipped: 1.0
epoch: 68, train_batch_id: 1200, avg_cost: 3.8805928230285645
grad_norm: 1.6731118724969476, clipped: 1.0
epoch: 68, train_batch_id: 1250, avg_cost: 3.8721156120300293
grad_norm: 2.001604490312432, clipped: 1.0
epoch: 68, train_batch_id: 1300, avg_cost: 3.894380569458008
grad_norm: 2.075624761400576, clipped: 1.0
epoch: 68, train_batch_id: 1350, avg_cost: 3.8872263431549072
grad_norm: 1.8011041734512734, clipped: 1.0
epoch: 68, train_batch_id: 1400, avg_cost: 3.874833345413208
grad_norm: 5.223692936522956, clipped: 1.0
epoch: 68, train_batch_id: 1450, avg_cost: 3.873305320739746
grad_norm: 2.817434561895044, clipped: 1.0
epoch: 68, train_batch_id: 1500, avg_cost: 3.8880538940429688
grad_norm: 1.4038079006652195, clipped: 1.0
epoch: 68, train_batch_id: 1550, avg_cost: 3.887718677520752
grad_norm: 1.8285156425081075, clipped: 1.0
epoch: 68, train_batch_id: 1600, avg_cost: 3.8986096382141113
grad_norm: 1.8201809402405946, clipped: 1.0
epoch: 68, train_batch_id: 1650, avg_cost: 3.8843822479248047
grad_norm: 1.6749474680557923, clipped: 1.0
epoch: 68, train_batch_id: 1700, avg_cost: 3.8488194942474365
grad_norm: 2.1197533715084886, clipped: 1.0
epoch: 68, train_batch_id: 1750, avg_cost: 3.9177796840667725
grad_norm: 1.8667704917869365, clipped: 1.0
epoch: 68, train_batch_id: 1800, avg_cost: 3.860408306121826
grad_norm: 1.4359748045936795, clipped: 1.0
epoch: 68, train_batch_id: 1850, avg_cost: 3.882266044616699
grad_norm: 1.8602208164782574, clipped: 1.0
epoch: 68, train_batch_id: 1900, avg_cost: 3.902324676513672
grad_norm: 4.239776923279551, clipped: 1.0
epoch: 68, train_batch_id: 1950, avg_cost: 3.8918282985687256
grad_norm: 3.833875703939221, clipped: 1.0
epoch: 68, train_batch_id: 2000, avg_cost: 3.874443531036377
grad_norm: 1.993552095949486, clipped: 1.0
epoch: 68, train_batch_id: 2050, avg_cost: 3.868873119354248
grad_norm: 1.560573071600946, clipped: 1.0
epoch: 68, train_batch_id: 2100, avg_cost: 3.8796863555908203
grad_norm: 1.5666314466270368, clipped: 1.0
epoch: 68, train_batch_id: 2150, avg_cost: 3.883113384246826
grad_norm: 1.9458406390810712, clipped: 1.0
epoch: 68, train_batch_id: 2200, avg_cost: 3.8829216957092285
grad_norm: 2.230644505359442, clipped: 1.0
epoch: 68, train_batch_id: 2250, avg_cost: 3.874962568283081
grad_norm: 1.4660582673260298, clipped: 1.0
epoch: 68, train_batch_id: 2300, avg_cost: 3.859121322631836
grad_norm: 1.5594512543929875, clipped: 1.0
epoch: 68, train_batch_id: 2350, avg_cost: 3.868227005004883
grad_norm: 1.585176825730677, clipped: 1.0
epoch: 68, train_batch_id: 2400, avg_cost: 3.8833560943603516
grad_norm: 1.6101906153548273, clipped: 1.0
epoch: 68, train_batch_id: 2450, avg_cost: 3.8872058391571045
grad_norm: 1.7525806977000107, clipped: 1.0
Finished epoch 68, took 00:09:18 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.400096416473389 +- 0.004213410895317793
Evaluating candidate model on evaluation dataset
Epoch 68 candidate mean 4.390443325042725, baseline epoch 39 mean 4.126363277435303, difference 0.2640800476074219
Start train epoch 69, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 69, train_batch_id: 0, avg_cost: 3.8742008209228516
grad_norm: 2.0463963440608635, clipped: 1.0
epoch: 69, train_batch_id: 50, avg_cost: 3.8968961238861084
grad_norm: 1.8308364792204592, clipped: 1.0
epoch: 69, train_batch_id: 100, avg_cost: 3.89582896232605
grad_norm: 1.5359735593829018, clipped: 1.0
epoch: 69, train_batch_id: 150, avg_cost: 3.8899669647216797
grad_norm: 2.132903927865367, clipped: 1.0
epoch: 69, train_batch_id: 200, avg_cost: 3.8950705528259277
grad_norm: 1.629561874213687, clipped: 1.0
epoch: 69, train_batch_id: 250, avg_cost: 3.8757176399230957
grad_norm: 2.234291971129725, clipped: 1.0
epoch: 69, train_batch_id: 300, avg_cost: 3.8638713359832764
grad_norm: 1.5376127810468536, clipped: 1.0
epoch: 69, train_batch_id: 350, avg_cost: 3.875816583633423
grad_norm: 1.6935710978144523, clipped: 1.0
epoch: 69, train_batch_id: 400, avg_cost: 3.885270118713379
grad_norm: 2.2296737621701204, clipped: 1.0
epoch: 69, train_batch_id: 450, avg_cost: 3.863521099090576
grad_norm: 2.0630290945550325, clipped: 1.0
epoch: 69, train_batch_id: 500, avg_cost: 3.901181221008301
grad_norm: 1.6117145797332557, clipped: 1.0
epoch: 69, train_batch_id: 550, avg_cost: 3.8785815238952637
grad_norm: 1.2340642619558433, clipped: 1.0
epoch: 69, train_batch_id: 600, avg_cost: 3.8524622917175293
grad_norm: 1.5051834223218004, clipped: 1.0
epoch: 69, train_batch_id: 650, avg_cost: 3.87618350982666
grad_norm: 2.090937268027149, clipped: 1.0
epoch: 69, train_batch_id: 700, avg_cost: 3.8656930923461914
grad_norm: 2.4344298726301052, clipped: 1.0
epoch: 69, train_batch_id: 750, avg_cost: 3.870464563369751
grad_norm: 3.1595799788436425, clipped: 1.0
epoch: 69, train_batch_id: 800, avg_cost: 3.8759095668792725
grad_norm: 1.4784844095887884, clipped: 1.0
epoch: 69, train_batch_id: 850, avg_cost: 3.9074172973632812
grad_norm: 1.7933325415199914, clipped: 1.0
epoch: 69, train_batch_id: 900, avg_cost: 3.8568248748779297
grad_norm: 1.4207588990159894, clipped: 1.0
epoch: 69, train_batch_id: 950, avg_cost: 3.877312183380127
grad_norm: 1.9549102675657377, clipped: 1.0
epoch: 69, train_batch_id: 1000, avg_cost: 3.8698620796203613
grad_norm: 2.6920031796803228, clipped: 1.0
epoch: 69, train_batch_id: 1050, avg_cost: 3.898256301879883
grad_norm: 2.0076995711640544, clipped: 1.0
epoch: 69, train_batch_id: 1100, avg_cost: 3.8508071899414062
grad_norm: 1.2902799378539502, clipped: 1.0
epoch: 69, train_batch_id: 1150, avg_cost: 3.8590707778930664
grad_norm: 1.685810916984356, clipped: 1.0
epoch: 69, train_batch_id: 1200, avg_cost: 3.8934502601623535
grad_norm: 1.7313905460564802, clipped: 1.0
epoch: 69, train_batch_id: 1250, avg_cost: 3.86527156829834
grad_norm: 1.8646821488485927, clipped: 1.0
epoch: 69, train_batch_id: 1300, avg_cost: 3.8782591819763184
grad_norm: 3.6892064147532766, clipped: 1.0
epoch: 69, train_batch_id: 1350, avg_cost: 3.899935722351074
grad_norm: 2.3830376884977573, clipped: 1.0
epoch: 69, train_batch_id: 1400, avg_cost: 3.867194890975952
grad_norm: 5.069797842281659, clipped: 1.0
epoch: 69, train_batch_id: 1450, avg_cost: 3.885134220123291
grad_norm: 1.5036160559861198, clipped: 1.0
epoch: 69, train_batch_id: 1500, avg_cost: 3.8872435092926025
grad_norm: 1.339144963745222, clipped: 1.0
epoch: 69, train_batch_id: 1550, avg_cost: 3.8805041313171387
grad_norm: 2.154583555404963, clipped: 1.0
epoch: 69, train_batch_id: 1600, avg_cost: 3.8787550926208496
grad_norm: 1.7404408772405435, clipped: 1.0
epoch: 69, train_batch_id: 1650, avg_cost: 3.8861234188079834
grad_norm: 1.4268820669820048, clipped: 1.0
epoch: 69, train_batch_id: 1700, avg_cost: 3.890186309814453
grad_norm: 1.8761142712786927, clipped: 1.0
epoch: 69, train_batch_id: 1750, avg_cost: 3.9082765579223633
grad_norm: 2.567257381104213, clipped: 1.0
epoch: 69, train_batch_id: 1800, avg_cost: 3.84928297996521
grad_norm: 1.7590258493734674, clipped: 1.0
epoch: 69, train_batch_id: 1850, avg_cost: 3.85624623298645
grad_norm: 1.587347113045252, clipped: 1.0
epoch: 69, train_batch_id: 1900, avg_cost: 3.874824285507202
grad_norm: 2.0966666112251433, clipped: 1.0
epoch: 69, train_batch_id: 1950, avg_cost: 3.8871827125549316
grad_norm: 1.6606856031079162, clipped: 1.0
epoch: 69, train_batch_id: 2000, avg_cost: 3.8864593505859375
grad_norm: 2.228762305374528, clipped: 1.0
epoch: 69, train_batch_id: 2050, avg_cost: 3.875990152359009
grad_norm: 1.8583247182492457, clipped: 1.0
epoch: 69, train_batch_id: 2100, avg_cost: 3.885773181915283
grad_norm: 2.569001353271661, clipped: 1.0
epoch: 69, train_batch_id: 2150, avg_cost: 3.8290457725524902
grad_norm: 1.9415795483250593, clipped: 1.0
epoch: 69, train_batch_id: 2200, avg_cost: 3.8932433128356934
grad_norm: 2.641592689230918, clipped: 1.0
epoch: 69, train_batch_id: 2250, avg_cost: 3.862312078475952
grad_norm: 2.3428277371258366, clipped: 1.0
epoch: 69, train_batch_id: 2300, avg_cost: 3.892709732055664
grad_norm: 2.305230058624737, clipped: 1.0
epoch: 69, train_batch_id: 2350, avg_cost: 3.8608455657958984
grad_norm: 3.0703471931376947, clipped: 1.0
epoch: 69, train_batch_id: 2400, avg_cost: 3.8665661811828613
grad_norm: 2.481703856534118, clipped: 1.0
epoch: 69, train_batch_id: 2450, avg_cost: 3.8763208389282227
grad_norm: 1.7931025776978695, clipped: 1.0
Finished epoch 69, took 00:09:23 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.349027156829834 +- 0.004194287583231926
Evaluating candidate model on evaluation dataset
Epoch 69 candidate mean 4.3367438316345215, baseline epoch 39 mean 4.126363277435303, difference 0.21038055419921875
Start train epoch 70, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 70, train_batch_id: 0, avg_cost: 3.8733983039855957
grad_norm: 5.8632339320732205, clipped: 1.0
epoch: 70, train_batch_id: 50, avg_cost: 3.878220319747925
grad_norm: 2.209984204342778, clipped: 1.0
epoch: 70, train_batch_id: 100, avg_cost: 3.8744938373565674
grad_norm: 1.4293368141190073, clipped: 1.0
epoch: 70, train_batch_id: 150, avg_cost: 3.9002304077148438
grad_norm: 2.089404872785546, clipped: 1.0
epoch: 70, train_batch_id: 200, avg_cost: 3.87833833694458
grad_norm: 1.8763266969092496, clipped: 1.0
epoch: 70, train_batch_id: 250, avg_cost: 3.895909309387207
grad_norm: 1.8204181976937486, clipped: 1.0
epoch: 70, train_batch_id: 300, avg_cost: 3.8779163360595703
grad_norm: 1.637165288065546, clipped: 1.0
epoch: 70, train_batch_id: 350, avg_cost: 3.8845596313476562
grad_norm: 1.6279833539115296, clipped: 1.0
epoch: 70, train_batch_id: 400, avg_cost: 3.8953213691711426
grad_norm: 11.386201772897673, clipped: 1.0
epoch: 70, train_batch_id: 450, avg_cost: 3.8832051753997803
grad_norm: 1.5203277581329917, clipped: 1.0
epoch: 70, train_batch_id: 500, avg_cost: 3.885817766189575
grad_norm: 1.7258973453386426, clipped: 1.0
epoch: 70, train_batch_id: 550, avg_cost: 3.887746810913086
grad_norm: 1.7413681623472148, clipped: 1.0
epoch: 70, train_batch_id: 600, avg_cost: 3.8617184162139893
grad_norm: 2.773209666176494, clipped: 1.0
epoch: 70, train_batch_id: 650, avg_cost: 3.882880210876465
grad_norm: 1.5880485636928063, clipped: 1.0
epoch: 70, train_batch_id: 700, avg_cost: 3.8714311122894287
grad_norm: 3.241472294108271, clipped: 1.0
epoch: 70, train_batch_id: 750, avg_cost: 3.8743016719818115
grad_norm: 1.6276844475129366, clipped: 1.0
epoch: 70, train_batch_id: 800, avg_cost: 3.8717777729034424
grad_norm: 1.4005533914901926, clipped: 1.0
epoch: 70, train_batch_id: 850, avg_cost: 3.8750529289245605
grad_norm: 1.9034647974250736, clipped: 1.0
epoch: 70, train_batch_id: 900, avg_cost: 3.8738789558410645
grad_norm: 2.1549381012920685, clipped: 1.0
epoch: 70, train_batch_id: 950, avg_cost: 3.8619394302368164
grad_norm: 2.0417458910835404, clipped: 1.0
epoch: 70, train_batch_id: 1000, avg_cost: 3.877060890197754
grad_norm: 2.0211951887742243, clipped: 1.0
epoch: 70, train_batch_id: 1050, avg_cost: 3.8973963260650635
grad_norm: 1.5710779100491676, clipped: 1.0
epoch: 70, train_batch_id: 1100, avg_cost: 3.8725898265838623
grad_norm: 6.000000332122115, clipped: 1.0
epoch: 70, train_batch_id: 1150, avg_cost: 3.856083393096924
grad_norm: 4.3810594361593, clipped: 1.0
epoch: 70, train_batch_id: 1200, avg_cost: 3.865926742553711
grad_norm: 1.8074706280327868, clipped: 1.0
epoch: 70, train_batch_id: 1250, avg_cost: 3.8835530281066895
grad_norm: 2.6117020103038056, clipped: 1.0
epoch: 70, train_batch_id: 1300, avg_cost: 3.863168716430664
grad_norm: 1.1945583160832847, clipped: 1.0
epoch: 70, train_batch_id: 1350, avg_cost: 3.8877205848693848
grad_norm: 1.9083640380079687, clipped: 1.0
epoch: 70, train_batch_id: 1400, avg_cost: 3.8777332305908203
grad_norm: 1.7923068692414306, clipped: 1.0
epoch: 70, train_batch_id: 1450, avg_cost: 3.8945767879486084
grad_norm: 6.834439771906346, clipped: 1.0
epoch: 70, train_batch_id: 1500, avg_cost: 3.8656516075134277
grad_norm: 1.780842166786646, clipped: 1.0
epoch: 70, train_batch_id: 1550, avg_cost: 3.848989963531494
grad_norm: 1.4018958987470023, clipped: 1.0
epoch: 70, train_batch_id: 1600, avg_cost: 3.859454393386841
grad_norm: 8.729667157797108, clipped: 1.0
epoch: 70, train_batch_id: 1650, avg_cost: 3.8869311809539795
grad_norm: 2.2577036036482707, clipped: 1.0
epoch: 70, train_batch_id: 1700, avg_cost: 3.8817708492279053
grad_norm: 2.1160286791121123, clipped: 1.0
epoch: 70, train_batch_id: 1750, avg_cost: 3.8677170276641846
grad_norm: 2.450841016033289, clipped: 1.0
epoch: 70, train_batch_id: 1800, avg_cost: 3.8802051544189453
grad_norm: 2.656777012021194, clipped: 1.0
epoch: 70, train_batch_id: 1850, avg_cost: 3.8722290992736816
grad_norm: 2.402872940140321, clipped: 1.0
epoch: 70, train_batch_id: 1900, avg_cost: 3.890395164489746
grad_norm: 1.7068580425628528, clipped: 1.0
epoch: 70, train_batch_id: 1950, avg_cost: 3.898496150970459
grad_norm: 3.619485025868625, clipped: 1.0
epoch: 70, train_batch_id: 2000, avg_cost: 3.8640170097351074
grad_norm: 1.5084764302395017, clipped: 1.0
epoch: 70, train_batch_id: 2050, avg_cost: 3.8703417778015137
grad_norm: 2.4074077510309366, clipped: 1.0
epoch: 70, train_batch_id: 2100, avg_cost: 3.8735876083374023
grad_norm: 1.374837628636427, clipped: 1.0
epoch: 70, train_batch_id: 2150, avg_cost: 3.9078359603881836
grad_norm: 1.2738902590630465, clipped: 1.0
epoch: 70, train_batch_id: 2200, avg_cost: 3.883753776550293
grad_norm: 3.1083251362206075, clipped: 1.0
epoch: 70, train_batch_id: 2250, avg_cost: 3.8670201301574707
grad_norm: 1.5402220392726158, clipped: 1.0
epoch: 70, train_batch_id: 2300, avg_cost: 3.8651838302612305
grad_norm: 1.4315158543896396, clipped: 1.0
epoch: 70, train_batch_id: 2350, avg_cost: 3.8665716648101807
grad_norm: 1.4960983607836182, clipped: 1.0
epoch: 70, train_batch_id: 2400, avg_cost: 3.8712661266326904
grad_norm: 2.3506963310866973, clipped: 1.0
epoch: 70, train_batch_id: 2450, avg_cost: 3.867974042892456
grad_norm: 2.0716845996187576, clipped: 1.0
Finished epoch 70, took 00:09:19 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.338143825531006 +- 0.004034141078591347
Evaluating candidate model on evaluation dataset
Epoch 70 candidate mean 4.330287456512451, baseline epoch 39 mean 4.126363277435303, difference 0.20392417907714844
Start train epoch 71, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 71, train_batch_id: 0, avg_cost: 3.8906140327453613
grad_norm: 1.8026780892455616, clipped: 1.0
epoch: 71, train_batch_id: 50, avg_cost: 3.878641128540039
grad_norm: 1.588506532568217, clipped: 1.0
epoch: 71, train_batch_id: 100, avg_cost: 3.879504680633545
grad_norm: 1.6228226091902955, clipped: 1.0
epoch: 71, train_batch_id: 150, avg_cost: 3.8757662773132324
grad_norm: 1.7371204633104413, clipped: 1.0
epoch: 71, train_batch_id: 200, avg_cost: 3.8659474849700928
grad_norm: 2.3399115996796773, clipped: 1.0
epoch: 71, train_batch_id: 250, avg_cost: 3.8561606407165527
grad_norm: 1.7965010145193838, clipped: 1.0
epoch: 71, train_batch_id: 300, avg_cost: 3.870650291442871
grad_norm: 2.1619219050141902, clipped: 1.0
epoch: 71, train_batch_id: 350, avg_cost: 3.8581080436706543
grad_norm: 1.4683806628277527, clipped: 1.0
epoch: 71, train_batch_id: 400, avg_cost: 3.883983612060547
grad_norm: 1.766818954105839, clipped: 1.0
epoch: 71, train_batch_id: 450, avg_cost: 3.8898983001708984
grad_norm: 1.6069766591603523, clipped: 1.0
epoch: 71, train_batch_id: 500, avg_cost: 3.869112253189087
grad_norm: 2.585376559983786, clipped: 1.0
epoch: 71, train_batch_id: 550, avg_cost: 3.857853889465332
grad_norm: 1.633510266617729, clipped: 1.0
epoch: 71, train_batch_id: 600, avg_cost: 3.8680148124694824
grad_norm: 1.7951242014754314, clipped: 1.0
epoch: 71, train_batch_id: 650, avg_cost: 3.905291795730591
grad_norm: 1.77455280310521, clipped: 1.0
epoch: 71, train_batch_id: 700, avg_cost: 3.863384246826172
grad_norm: 2.638521755350062, clipped: 1.0
epoch: 71, train_batch_id: 750, avg_cost: 3.899479866027832
grad_norm: 1.5328295191482504, clipped: 1.0
epoch: 71, train_batch_id: 800, avg_cost: 3.883969783782959
grad_norm: 1.894625889712513, clipped: 1.0
epoch: 71, train_batch_id: 850, avg_cost: 3.873326301574707
grad_norm: 2.020876574147436, clipped: 1.0
epoch: 71, train_batch_id: 900, avg_cost: 3.8722939491271973
grad_norm: 1.5343618654833149, clipped: 1.0
epoch: 71, train_batch_id: 950, avg_cost: 3.8875696659088135
grad_norm: 1.7702894010768435, clipped: 1.0
epoch: 71, train_batch_id: 1000, avg_cost: 3.862867832183838
grad_norm: 1.5876162290659541, clipped: 1.0
epoch: 71, train_batch_id: 1050, avg_cost: 3.8561508655548096
grad_norm: 1.2713311145419945, clipped: 1.0
epoch: 71, train_batch_id: 1100, avg_cost: 3.8514699935913086
grad_norm: 2.2381995399330727, clipped: 1.0
epoch: 71, train_batch_id: 1150, avg_cost: 3.878818988800049
grad_norm: 1.6336915358154513, clipped: 1.0
epoch: 71, train_batch_id: 1200, avg_cost: 3.8563787937164307
grad_norm: 1.470062837272139, clipped: 1.0
epoch: 71, train_batch_id: 1250, avg_cost: 3.8918943405151367
grad_norm: 1.5613036257942152, clipped: 1.0
epoch: 71, train_batch_id: 1300, avg_cost: 3.870182514190674
grad_norm: 1.59003887775919, clipped: 1.0
epoch: 71, train_batch_id: 1350, avg_cost: 3.871582508087158
grad_norm: 3.5558000519270383, clipped: 1.0
epoch: 71, train_batch_id: 1400, avg_cost: 3.861480474472046
grad_norm: 1.958748899462752, clipped: 1.0
epoch: 71, train_batch_id: 1450, avg_cost: 3.8783962726593018
grad_norm: 5.388996379503787, clipped: 1.0
epoch: 71, train_batch_id: 1500, avg_cost: 3.8742940425872803
grad_norm: 2.6881364348174563, clipped: 1.0
epoch: 71, train_batch_id: 1550, avg_cost: 3.876176357269287
grad_norm: 2.5103425289814654, clipped: 1.0
epoch: 71, train_batch_id: 1600, avg_cost: 3.8825812339782715
grad_norm: 1.5902476894819548, clipped: 1.0
epoch: 71, train_batch_id: 1650, avg_cost: 3.8840229511260986
grad_norm: 3.0124064603376404, clipped: 1.0
epoch: 71, train_batch_id: 1700, avg_cost: 3.854095458984375
grad_norm: 3.1207991718866843, clipped: 1.0
epoch: 71, train_batch_id: 1750, avg_cost: 3.871089458465576
grad_norm: 1.3218573523265547, clipped: 1.0
epoch: 71, train_batch_id: 1800, avg_cost: 3.862060070037842
grad_norm: 2.8003152451752418, clipped: 1.0
epoch: 71, train_batch_id: 1850, avg_cost: 3.8904495239257812
grad_norm: 2.6471753397512967, clipped: 1.0
epoch: 71, train_batch_id: 1900, avg_cost: 3.8668088912963867
grad_norm: 1.7537390609466763, clipped: 1.0
epoch: 71, train_batch_id: 1950, avg_cost: 3.8726744651794434
grad_norm: 1.9163411601869016, clipped: 1.0
epoch: 71, train_batch_id: 2000, avg_cost: 3.8563599586486816
grad_norm: 2.0689578667084247, clipped: 1.0
epoch: 71, train_batch_id: 2050, avg_cost: 3.883593797683716
grad_norm: 2.120080255544848, clipped: 1.0
epoch: 71, train_batch_id: 2100, avg_cost: 3.8661580085754395
grad_norm: 3.031147749964659, clipped: 1.0
epoch: 71, train_batch_id: 2150, avg_cost: 3.8657350540161133
grad_norm: 4.0544741543686245, clipped: 1.0
epoch: 71, train_batch_id: 2200, avg_cost: 3.9036011695861816
grad_norm: 2.075265888951467, clipped: 1.0
epoch: 71, train_batch_id: 2250, avg_cost: 3.879030466079712
grad_norm: 1.481486010033181, clipped: 1.0
epoch: 71, train_batch_id: 2300, avg_cost: 3.8800415992736816
grad_norm: 2.8412570156463293, clipped: 1.0
epoch: 71, train_batch_id: 2350, avg_cost: 3.8989334106445312
grad_norm: 2.1112151555919105, clipped: 1.0
epoch: 71, train_batch_id: 2400, avg_cost: 3.8581323623657227
grad_norm: 2.0877689939655912, clipped: 1.0
epoch: 71, train_batch_id: 2450, avg_cost: 3.883333683013916
grad_norm: 1.8838912812524846, clipped: 1.0
Finished epoch 71, took 00:09:25 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.247403144836426 +- 0.0038865339010953903
Evaluating candidate model on evaluation dataset
Epoch 71 candidate mean 4.237115383148193, baseline epoch 39 mean 4.126363277435303, difference 0.11075210571289062
Start train epoch 72, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


epoch: 72, train_batch_id: 0, avg_cost: 3.8828353881835938
grad_norm: 1.234549312954814, clipped: 1.0
epoch: 72, train_batch_id: 50, avg_cost: 3.8960704803466797
grad_norm: 1.820157955890738, clipped: 1.0
epoch: 72, train_batch_id: 100, avg_cost: 3.8833348751068115
grad_norm: 1.1348287665575332, clipped: 1.0
epoch: 72, train_batch_id: 150, avg_cost: 3.885580539703369
grad_norm: 1.5776926091773178, clipped: 1.0
epoch: 72, train_batch_id: 200, avg_cost: 3.8770413398742676
grad_norm: 1.4478358498689357, clipped: 1.0
epoch: 72, train_batch_id: 250, avg_cost: 3.8808178901672363
grad_norm: 1.7514127781131288, clipped: 1.0
epoch: 72, train_batch_id: 300, avg_cost: 3.888847827911377
grad_norm: 1.4060489401339227, clipped: 1.0
epoch: 72, train_batch_id: 350, avg_cost: 3.892035961151123
grad_norm: 1.6169881129346722, clipped: 1.0
epoch: 72, train_batch_id: 400, avg_cost: 3.8843812942504883
grad_norm: 5.544327272264482, clipped: 1.0
epoch: 72, train_batch_id: 450, avg_cost: 3.860273838043213
grad_norm: 1.4408698231442663, clipped: 1.0
epoch: 72, train_batch_id: 500, avg_cost: 3.852059841156006
grad_norm: 1.8873122156891886, clipped: 1.0
epoch: 72, train_batch_id: 550, avg_cost: 3.850482702255249
grad_norm: 1.7992705306235246, clipped: 1.0
epoch: 72, train_batch_id: 600, avg_cost: 3.8445019721984863
grad_norm: 1.6855042883869262, clipped: 1.0
epoch: 72, train_batch_id: 650, avg_cost: 3.870743751525879
grad_norm: 2.301972478488497, clipped: 1.0
epoch: 72, train_batch_id: 700, avg_cost: 3.8591933250427246
grad_norm: 1.5015127555674135, clipped: 1.0
epoch: 72, train_batch_id: 750, avg_cost: 3.854585647583008
grad_norm: 1.8131264215482383, clipped: 1.0
epoch: 72, train_batch_id: 800, avg_cost: 3.864020347595215
grad_norm: 5.058057141890008, clipped: 1.0
epoch: 72, train_batch_id: 850, avg_cost: 3.8626089096069336
grad_norm: 1.6249747268280255, clipped: 1.0
epoch: 72, train_batch_id: 900, avg_cost: 3.8655765056610107
grad_norm: 1.5838161019013706, clipped: 1.0
epoch: 72, train_batch_id: 950, avg_cost: 3.8851804733276367
grad_norm: 1.5789291941168766, clipped: 1.0
epoch: 72, train_batch_id: 1000, avg_cost: 3.8912625312805176
grad_norm: 6.401791691484735, clipped: 1.0
epoch: 72, train_batch_id: 1050, avg_cost: 3.8936238288879395
grad_norm: 1.3466330855979451, clipped: 1.0
epoch: 72, train_batch_id: 1100, avg_cost: 3.8810460567474365
grad_norm: 2.8759182167242296, clipped: 1.0
epoch: 72, train_batch_id: 1150, avg_cost: 3.88623309135437
grad_norm: 1.4714834348762345, clipped: 1.0
epoch: 72, train_batch_id: 1200, avg_cost: 3.8890392780303955
grad_norm: 2.053707157982733, clipped: 1.0
epoch: 72, train_batch_id: 1250, avg_cost: 3.8939971923828125
grad_norm: 1.2697201309856503, clipped: 1.0
epoch: 72, train_batch_id: 1300, avg_cost: 3.8980698585510254
grad_norm: 4.214747497452985, clipped: 1.0
epoch: 72, train_batch_id: 1350, avg_cost: 3.8857293128967285
grad_norm: 1.6953294140980109, clipped: 1.0
epoch: 72, train_batch_id: 1400, avg_cost: 3.884479522705078
grad_norm: 2.3061706133970343, clipped: 1.0
epoch: 72, train_batch_id: 1450, avg_cost: 3.8284287452697754
grad_norm: 2.395086239560773, clipped: 1.0
epoch: 72, train_batch_id: 1500, avg_cost: 3.890056610107422
grad_norm: 6.698267092921111, clipped: 1.0
epoch: 72, train_batch_id: 1550, avg_cost: 3.8737430572509766
grad_norm: 9.710061782740881, clipped: 1.0
epoch: 72, train_batch_id: 1600, avg_cost: 3.862802505493164
grad_norm: 1.7520407058983687, clipped: 1.0
epoch: 72, train_batch_id: 1650, avg_cost: 3.8777170181274414
grad_norm: 1.3774118890896, clipped: 1.0
epoch: 72, train_batch_id: 1700, avg_cost: 3.853480577468872
grad_norm: 2.205964630591168, clipped: 1.0
epoch: 72, train_batch_id: 1750, avg_cost: 3.864809274673462
grad_norm: 1.613640799086431, clipped: 1.0
epoch: 72, train_batch_id: 1800, avg_cost: 3.8615524768829346
grad_norm: 1.5575729881577576, clipped: 1.0
epoch: 72, train_batch_id: 1850, avg_cost: 3.8640503883361816
grad_norm: 1.7333958091442256, clipped: 1.0
epoch: 72, train_batch_id: 1900, avg_cost: 3.859315872192383
grad_norm: 1.9233227411665534, clipped: 1.0
epoch: 72, train_batch_id: 1950, avg_cost: 3.8639984130859375
grad_norm: 1.3458100879328596, clipped: 1.0
epoch: 72, train_batch_id: 2000, avg_cost: 3.870706081390381
grad_norm: 2.055555095595338, clipped: 1.0
epoch: 72, train_batch_id: 2050, avg_cost: 3.8889687061309814
grad_norm: 3.4249906962606453, clipped: 1.0
epoch: 72, train_batch_id: 2100, avg_cost: 3.872667074203491
grad_norm: 1.9071026525009773, clipped: 1.0
epoch: 72, train_batch_id: 2150, avg_cost: 3.8818581104278564
grad_norm: 1.7358343182253078, clipped: 1.0
epoch: 72, train_batch_id: 2200, avg_cost: 3.851712703704834
grad_norm: 2.170457886576201, clipped: 1.0
epoch: 72, train_batch_id: 2250, avg_cost: 3.8755736351013184
grad_norm: 4.808433727005509, clipped: 1.0
epoch: 72, train_batch_id: 2300, avg_cost: 3.8627591133117676
grad_norm: 1.836452843237996, clipped: 1.0
epoch: 72, train_batch_id: 2350, avg_cost: 3.869692802429199
grad_norm: 3.1652904297987594, clipped: 1.0
epoch: 72, train_batch_id: 2400, avg_cost: 3.854001045227051
grad_norm: 1.9532945301426996, clipped: 1.0
epoch: 72, train_batch_id: 2450, avg_cost: 3.8750905990600586
grad_norm: 1.8783388225617421, clipped: 1.0
Finished epoch 72, took 00:09:30 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.424256801605225 +- 0.004345057997852564
Evaluating candidate model on evaluation dataset
Epoch 72 candidate mean 4.416995525360107, baseline epoch 39 mean 4.126363277435303, difference 0.2906322479248047
Start train epoch 73, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 73, train_batch_id: 0, avg_cost: 3.8784356117248535
grad_norm: 1.6951135846388987, clipped: 1.0
epoch: 73, train_batch_id: 50, avg_cost: 3.9000298976898193
grad_norm: 1.3667092569470265, clipped: 1.0
epoch: 73, train_batch_id: 100, avg_cost: 3.880378484725952
grad_norm: 3.6914042455105243, clipped: 1.0
epoch: 73, train_batch_id: 150, avg_cost: 3.8721747398376465
grad_norm: 1.677753249323827, clipped: 1.0
epoch: 73, train_batch_id: 200, avg_cost: 3.88737416267395
grad_norm: 1.7979490204977224, clipped: 1.0
epoch: 73, train_batch_id: 250, avg_cost: 3.8848330974578857
grad_norm: 1.7769060870519828, clipped: 1.0
epoch: 73, train_batch_id: 300, avg_cost: 3.8720974922180176
grad_norm: 1.7685340272565213, clipped: 1.0
epoch: 73, train_batch_id: 350, avg_cost: 3.868924617767334
grad_norm: 2.3898627496171603, clipped: 1.0
epoch: 73, train_batch_id: 400, avg_cost: 3.874871253967285
grad_norm: 2.5460145183444727, clipped: 1.0
epoch: 73, train_batch_id: 450, avg_cost: 3.856815814971924
grad_norm: 1.616454015238965, clipped: 1.0
epoch: 73, train_batch_id: 500, avg_cost: 3.8761205673217773
grad_norm: 1.5126040873166153, clipped: 1.0
epoch: 73, train_batch_id: 550, avg_cost: 3.8989357948303223
grad_norm: 1.569135990863506, clipped: 1.0
epoch: 73, train_batch_id: 600, avg_cost: 3.8878607749938965
grad_norm: 2.4939159513648215, clipped: 1.0
epoch: 73, train_batch_id: 650, avg_cost: 3.8527441024780273
grad_norm: 1.2482534519391968, clipped: 1.0
epoch: 73, train_batch_id: 700, avg_cost: 3.8784143924713135
grad_norm: 1.5757202964196335, clipped: 1.0
epoch: 73, train_batch_id: 750, avg_cost: 3.879405975341797
grad_norm: 2.243000602341866, clipped: 1.0
epoch: 73, train_batch_id: 800, avg_cost: 3.858671188354492
grad_norm: 2.0260876940062302, clipped: 1.0
epoch: 73, train_batch_id: 850, avg_cost: 3.85318922996521
grad_norm: 2.278391667827616, clipped: 1.0
epoch: 73, train_batch_id: 900, avg_cost: 3.8623127937316895
grad_norm: 1.2556121184900433, clipped: 1.0
epoch: 73, train_batch_id: 950, avg_cost: 3.8897409439086914
grad_norm: 1.5622394833988809, clipped: 1.0
epoch: 73, train_batch_id: 1000, avg_cost: 3.870323896408081
grad_norm: 3.1734732992062153, clipped: 1.0
epoch: 73, train_batch_id: 1050, avg_cost: 3.885849714279175
grad_norm: 1.6767427669407742, clipped: 1.0
epoch: 73, train_batch_id: 1100, avg_cost: 3.881223440170288
grad_norm: 2.010741259113462, clipped: 1.0
epoch: 73, train_batch_id: 1150, avg_cost: 3.8980870246887207
grad_norm: 2.0194135747064585, clipped: 1.0
epoch: 73, train_batch_id: 1200, avg_cost: 3.859546661376953
grad_norm: 2.495059529624122, clipped: 1.0
epoch: 73, train_batch_id: 1250, avg_cost: 3.871152400970459
grad_norm: 1.766300235905596, clipped: 1.0
epoch: 73, train_batch_id: 1300, avg_cost: 3.8795104026794434
grad_norm: 2.2768894794169547, clipped: 1.0
epoch: 73, train_batch_id: 1350, avg_cost: 3.8752498626708984
grad_norm: 1.2440763129045462, clipped: 1.0
epoch: 73, train_batch_id: 1400, avg_cost: 3.861964225769043
grad_norm: 2.283348141178805, clipped: 1.0
epoch: 73, train_batch_id: 1450, avg_cost: 3.880864143371582
grad_norm: 1.8922287664446984, clipped: 1.0
epoch: 73, train_batch_id: 1500, avg_cost: 3.918154239654541
grad_norm: 1.5605195241322325, clipped: 1.0
epoch: 73, train_batch_id: 1550, avg_cost: 3.889037609100342
grad_norm: 7.369499185768209, clipped: 1.0
epoch: 73, train_batch_id: 1600, avg_cost: 3.888256549835205
grad_norm: 3.2087465134978106, clipped: 1.0
epoch: 73, train_batch_id: 1650, avg_cost: 3.8569178581237793
grad_norm: 2.1324598687305363, clipped: 1.0
epoch: 73, train_batch_id: 1700, avg_cost: 3.8435568809509277
grad_norm: 2.284534851632603, clipped: 1.0
epoch: 73, train_batch_id: 1750, avg_cost: 3.8798842430114746
grad_norm: 3.5418827216036544, clipped: 1.0
epoch: 73, train_batch_id: 1800, avg_cost: 3.8646788597106934
grad_norm: 2.050178014587351, clipped: 1.0
epoch: 73, train_batch_id: 1850, avg_cost: 3.872380256652832
grad_norm: 2.697362995972201, clipped: 1.0
epoch: 73, train_batch_id: 1900, avg_cost: 3.8511838912963867
grad_norm: 1.5409895724493814, clipped: 1.0
epoch: 73, train_batch_id: 1950, avg_cost: 3.8947620391845703
grad_norm: 1.9832659136417452, clipped: 1.0
epoch: 73, train_batch_id: 2000, avg_cost: 3.8639073371887207
grad_norm: 3.923526541327309, clipped: 1.0
epoch: 73, train_batch_id: 2050, avg_cost: 3.8823952674865723
grad_norm: 1.6453066815333404, clipped: 1.0
epoch: 73, train_batch_id: 2100, avg_cost: 3.8624684810638428
grad_norm: 1.164258665446351, clipped: 1.0
epoch: 73, train_batch_id: 2150, avg_cost: 3.886343240737915
grad_norm: 2.150996123416444, clipped: 1.0
epoch: 73, train_batch_id: 2200, avg_cost: 3.867709159851074
grad_norm: 1.3653100409647865, clipped: 1.0
epoch: 73, train_batch_id: 2250, avg_cost: 3.8751649856567383
grad_norm: 1.9024479819788034, clipped: 1.0
epoch: 73, train_batch_id: 2300, avg_cost: 3.906398296356201
grad_norm: 2.07183037963675, clipped: 1.0
epoch: 73, train_batch_id: 2350, avg_cost: 3.8873558044433594
grad_norm: 1.6579640713883206, clipped: 1.0
epoch: 73, train_batch_id: 2400, avg_cost: 3.8572559356689453
grad_norm: 1.5421109964183064, clipped: 1.0
epoch: 73, train_batch_id: 2450, avg_cost: 3.8949475288391113
grad_norm: 1.8976470818056401, clipped: 1.0
Finished epoch 73, took 00:09:24 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.313828468322754 +- 0.004080301616340876
Evaluating candidate model on evaluation dataset
Epoch 73 candidate mean 4.301486492156982, baseline epoch 39 mean 4.126363277435303, difference 0.1751232147216797
Start train epoch 74, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 74, train_batch_id: 0, avg_cost: 3.8639979362487793
grad_norm: 1.4492530816322629, clipped: 1.0
epoch: 74, train_batch_id: 50, avg_cost: 3.8669323921203613
grad_norm: 1.5521478927940418, clipped: 1.0
epoch: 74, train_batch_id: 100, avg_cost: 3.886526107788086
grad_norm: 2.5120134745344944, clipped: 1.0
epoch: 74, train_batch_id: 150, avg_cost: 3.865295886993408
grad_norm: 1.4344634115974457, clipped: 1.0
epoch: 74, train_batch_id: 200, avg_cost: 3.8960132598876953
grad_norm: 1.5906885588176058, clipped: 1.0
epoch: 74, train_batch_id: 250, avg_cost: 3.8619384765625
grad_norm: 2.549770239411606, clipped: 1.0
epoch: 74, train_batch_id: 300, avg_cost: 3.8588898181915283
grad_norm: 2.1358435712193207, clipped: 1.0
epoch: 74, train_batch_id: 350, avg_cost: 3.846101999282837
grad_norm: 1.9365502585268377, clipped: 1.0
epoch: 74, train_batch_id: 400, avg_cost: 3.871763229370117
grad_norm: 1.5341280631483964, clipped: 1.0
epoch: 74, train_batch_id: 450, avg_cost: 3.862356662750244
grad_norm: 1.4362797361033068, clipped: 1.0
epoch: 74, train_batch_id: 500, avg_cost: 3.8550329208374023
grad_norm: 1.9290952364618172, clipped: 1.0
epoch: 74, train_batch_id: 550, avg_cost: 3.8828377723693848
grad_norm: 1.6180423407699145, clipped: 1.0
epoch: 74, train_batch_id: 600, avg_cost: 3.8756463527679443
grad_norm: 1.7344092798209187, clipped: 1.0
epoch: 74, train_batch_id: 650, avg_cost: 3.88256573677063
grad_norm: 2.0955942214150842, clipped: 1.0
epoch: 74, train_batch_id: 700, avg_cost: 3.86234712600708
grad_norm: 1.3654584136138415, clipped: 1.0
epoch: 74, train_batch_id: 750, avg_cost: 3.9044227600097656
grad_norm: 2.13015645267645, clipped: 1.0
epoch: 74, train_batch_id: 800, avg_cost: 3.8875880241394043
grad_norm: 1.7428996079548922, clipped: 1.0
epoch: 74, train_batch_id: 850, avg_cost: 3.891833782196045
grad_norm: 2.003917402303425, clipped: 1.0
epoch: 74, train_batch_id: 900, avg_cost: 3.8860151767730713
grad_norm: 2.690045096854359, clipped: 1.0
epoch: 74, train_batch_id: 950, avg_cost: 3.8463239669799805
grad_norm: 1.457895649531022, clipped: 1.0
epoch: 74, train_batch_id: 1000, avg_cost: 3.8498802185058594
grad_norm: 2.4769148492786734, clipped: 1.0
epoch: 74, train_batch_id: 1050, avg_cost: 3.8737850189208984
grad_norm: 3.0906105615604256, clipped: 1.0
epoch: 74, train_batch_id: 1100, avg_cost: 3.845313549041748
grad_norm: 7.039416288120803, clipped: 1.0
epoch: 74, train_batch_id: 1150, avg_cost: 3.895840883255005
grad_norm: 4.566607029177405, clipped: 1.0
epoch: 74, train_batch_id: 1200, avg_cost: 3.9012508392333984
grad_norm: 3.379887970709629, clipped: 1.0
epoch: 74, train_batch_id: 1250, avg_cost: 3.877971649169922
grad_norm: 1.5562290952850912, clipped: 1.0
epoch: 74, train_batch_id: 1300, avg_cost: 3.8591957092285156
grad_norm: 1.268131901327003, clipped: 1.0
epoch: 74, train_batch_id: 1350, avg_cost: 3.8488306999206543
grad_norm: 1.7200920852190957, clipped: 1.0
epoch: 74, train_batch_id: 1400, avg_cost: 3.869676113128662
grad_norm: 2.508050067903628, clipped: 1.0
epoch: 74, train_batch_id: 1450, avg_cost: 3.903318405151367
grad_norm: 1.2864833032204408, clipped: 1.0
epoch: 74, train_batch_id: 1500, avg_cost: 3.886887311935425
grad_norm: 1.6461930038888433, clipped: 1.0
epoch: 74, train_batch_id: 1550, avg_cost: 3.8736307621002197
grad_norm: 2.289755452774101, clipped: 1.0
epoch: 74, train_batch_id: 1600, avg_cost: 3.850539207458496
grad_norm: 2.166618676383058, clipped: 1.0
epoch: 74, train_batch_id: 1650, avg_cost: 3.869550943374634
grad_norm: 3.0008956343613296, clipped: 1.0
epoch: 74, train_batch_id: 1700, avg_cost: 3.8789381980895996
grad_norm: 1.5464281357020062, clipped: 1.0
epoch: 74, train_batch_id: 1750, avg_cost: 3.8743488788604736
grad_norm: 1.2321427170831885, clipped: 1.0
epoch: 74, train_batch_id: 1800, avg_cost: 3.853867530822754
grad_norm: 1.3372462718760445, clipped: 1.0
epoch: 74, train_batch_id: 1850, avg_cost: 3.8656225204467773
grad_norm: 1.8228420368960985, clipped: 1.0
epoch: 74, train_batch_id: 1900, avg_cost: 3.868546962738037
grad_norm: 1.9160252600795387, clipped: 1.0
epoch: 74, train_batch_id: 1950, avg_cost: 3.8665919303894043
grad_norm: 2.0474424740376276, clipped: 1.0
epoch: 74, train_batch_id: 2000, avg_cost: 3.8894739151000977
grad_norm: 2.7627854641907597, clipped: 1.0
epoch: 74, train_batch_id: 2050, avg_cost: 3.892157554626465
grad_norm: 1.754870347863855, clipped: 1.0
epoch: 74, train_batch_id: 2100, avg_cost: 3.869659900665283
grad_norm: 1.7272612717213986, clipped: 1.0
epoch: 74, train_batch_id: 2150, avg_cost: 3.8676605224609375
grad_norm: 2.4033763905861383, clipped: 1.0
epoch: 74, train_batch_id: 2200, avg_cost: 3.870868444442749
grad_norm: 2.4157782305271684, clipped: 1.0
epoch: 74, train_batch_id: 2250, avg_cost: 3.9078543186187744
grad_norm: 2.155620580768553, clipped: 1.0
epoch: 74, train_batch_id: 2300, avg_cost: 3.8845725059509277
grad_norm: 1.5892412179435245, clipped: 1.0
epoch: 74, train_batch_id: 2350, avg_cost: 3.8768606185913086
grad_norm: 4.95642930548795, clipped: 1.0
epoch: 74, train_batch_id: 2400, avg_cost: 3.868723154067993
grad_norm: 2.5103139674134463, clipped: 1.0
epoch: 74, train_batch_id: 2450, avg_cost: 3.88578462600708
grad_norm: 1.7876430536820163, clipped: 1.0
Finished epoch 74, took 00:09:40 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.252474784851074 +- 0.003986358642578125
Evaluating candidate model on evaluation dataset
Epoch 74 candidate mean 4.240423202514648, baseline epoch 39 mean 4.126363277435303, difference 0.1140599250793457
Start train epoch 75, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 75, train_batch_id: 0, avg_cost: 3.8617749214172363
grad_norm: 1.2732652245656106, clipped: 1.0
epoch: 75, train_batch_id: 50, avg_cost: 3.873769760131836
grad_norm: 2.8507704354873944, clipped: 1.0
epoch: 75, train_batch_id: 100, avg_cost: 3.9063735008239746
grad_norm: 2.3743552202446825, clipped: 1.0
epoch: 75, train_batch_id: 150, avg_cost: 3.890315055847168
grad_norm: 1.6143810102253695, clipped: 1.0
epoch: 75, train_batch_id: 200, avg_cost: 3.876518726348877
grad_norm: 2.966679599194782, clipped: 1.0
epoch: 75, train_batch_id: 250, avg_cost: 3.860558032989502
grad_norm: 1.4701531487461539, clipped: 1.0
epoch: 75, train_batch_id: 300, avg_cost: 3.8507914543151855
grad_norm: 1.4874216912867388, clipped: 1.0
epoch: 75, train_batch_id: 350, avg_cost: 3.876882553100586
grad_norm: 3.332809699053647, clipped: 1.0
epoch: 75, train_batch_id: 400, avg_cost: 3.883370876312256
grad_norm: 1.6444939625095396, clipped: 1.0
epoch: 75, train_batch_id: 450, avg_cost: 3.8817949295043945
grad_norm: 1.7997440583104407, clipped: 1.0
epoch: 75, train_batch_id: 500, avg_cost: 3.8655998706817627
grad_norm: 4.215677954015263, clipped: 1.0
epoch: 75, train_batch_id: 550, avg_cost: 3.863956928253174
grad_norm: 2.5541345957206, clipped: 1.0
epoch: 75, train_batch_id: 600, avg_cost: 3.860534906387329
grad_norm: 2.1890626050983926, clipped: 1.0
epoch: 75, train_batch_id: 650, avg_cost: 3.8660247325897217
grad_norm: 1.622623612328621, clipped: 1.0
epoch: 75, train_batch_id: 700, avg_cost: 3.850505828857422
grad_norm: 1.7125145719306223, clipped: 1.0
epoch: 75, train_batch_id: 750, avg_cost: 3.8719332218170166
grad_norm: 1.3871985664696136, clipped: 1.0
epoch: 75, train_batch_id: 800, avg_cost: 3.9233756065368652
grad_norm: 2.0723683133402364, clipped: 1.0
epoch: 75, train_batch_id: 850, avg_cost: 3.869304656982422
grad_norm: 1.404576363625754, clipped: 1.0
epoch: 75, train_batch_id: 900, avg_cost: 3.8974368572235107
grad_norm: 1.5008077121477434, clipped: 1.0
epoch: 75, train_batch_id: 950, avg_cost: 3.868485450744629
grad_norm: 1.4483016523471963, clipped: 1.0
epoch: 75, train_batch_id: 1000, avg_cost: 3.8602638244628906
grad_norm: 2.0103460754281373, clipped: 1.0
epoch: 75, train_batch_id: 1050, avg_cost: 3.889702796936035
grad_norm: 2.904545133932841, clipped: 1.0
epoch: 75, train_batch_id: 1100, avg_cost: 3.8737549781799316
grad_norm: 1.8605268929254595, clipped: 1.0
epoch: 75, train_batch_id: 1150, avg_cost: 3.868699550628662
grad_norm: 2.057369748230504, clipped: 1.0
epoch: 75, train_batch_id: 1200, avg_cost: 3.872016191482544
grad_norm: 2.172280790223977, clipped: 1.0
epoch: 75, train_batch_id: 1250, avg_cost: 3.8881783485412598
grad_norm: 2.170285951707227, clipped: 1.0
epoch: 75, train_batch_id: 1300, avg_cost: 3.8722548484802246
grad_norm: 1.3687935378588039, clipped: 1.0
epoch: 75, train_batch_id: 1350, avg_cost: 3.8634018898010254
grad_norm: 1.281518829813063, clipped: 1.0
epoch: 75, train_batch_id: 1400, avg_cost: 3.862405776977539
grad_norm: 3.2904440063427587, clipped: 1.0
epoch: 75, train_batch_id: 1450, avg_cost: 3.883267641067505
grad_norm: 4.097607967190527, clipped: 1.0
epoch: 75, train_batch_id: 1500, avg_cost: 3.8830108642578125
grad_norm: 2.002831149257199, clipped: 1.0
epoch: 75, train_batch_id: 1550, avg_cost: 3.8813791275024414
grad_norm: 1.7160053835152118, clipped: 1.0
epoch: 75, train_batch_id: 1600, avg_cost: 3.894545793533325
grad_norm: 1.5994199449365845, clipped: 1.0
epoch: 75, train_batch_id: 1650, avg_cost: 3.861260414123535
grad_norm: 1.7959231769874688, clipped: 1.0
epoch: 75, train_batch_id: 1700, avg_cost: 3.8580946922302246
grad_norm: 1.7606444555220941, clipped: 1.0
epoch: 75, train_batch_id: 1750, avg_cost: 3.8779869079589844
grad_norm: 2.2483456450960744, clipped: 1.0
epoch: 75, train_batch_id: 1800, avg_cost: 3.8650782108306885
grad_norm: 5.124544192315337, clipped: 1.0
epoch: 75, train_batch_id: 1850, avg_cost: 3.8601207733154297
grad_norm: 1.9664569900465965, clipped: 1.0
epoch: 75, train_batch_id: 1900, avg_cost: 3.875885009765625
grad_norm: 1.0899763347063858, clipped: 1.0
epoch: 75, train_batch_id: 1950, avg_cost: 3.864739418029785
grad_norm: 1.4143755271539937, clipped: 1.0
epoch: 75, train_batch_id: 2000, avg_cost: 3.8885786533355713
grad_norm: 3.0217008670449723, clipped: 1.0
epoch: 75, train_batch_id: 2050, avg_cost: 3.8638510704040527
grad_norm: 2.3268411453131295, clipped: 1.0
epoch: 75, train_batch_id: 2100, avg_cost: 3.876976728439331
grad_norm: 1.8403164356763895, clipped: 1.0
epoch: 75, train_batch_id: 2150, avg_cost: 3.894723892211914
grad_norm: 1.8728232893615608, clipped: 1.0
epoch: 75, train_batch_id: 2200, avg_cost: 3.8760671615600586
grad_norm: 2.32588792073786, clipped: 1.0
epoch: 75, train_batch_id: 2250, avg_cost: 3.9185409545898438
grad_norm: 1.2744206232071096, clipped: 1.0
epoch: 75, train_batch_id: 2300, avg_cost: 3.872474193572998
grad_norm: 2.351968900439291, clipped: 1.0
epoch: 75, train_batch_id: 2350, avg_cost: 3.8839874267578125
grad_norm: 2.1692809907231907, clipped: 1.0
epoch: 75, train_batch_id: 2400, avg_cost: 3.86696195602417
grad_norm: 1.718761462560928, clipped: 1.0
epoch: 75, train_batch_id: 2450, avg_cost: 3.865628719329834
grad_norm: 1.9529127117336071, clipped: 1.0
Finished epoch 75, took 00:09:23 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.317719459533691 +- 0.00407255906611681
Evaluating candidate model on evaluation dataset
Epoch 75 candidate mean 4.308208465576172, baseline epoch 39 mean 4.126363277435303, difference 0.18184518814086914
Start train epoch 76, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


epoch: 76, train_batch_id: 0, avg_cost: 3.846660852432251
grad_norm: 2.0314742654660485, clipped: 1.0
epoch: 76, train_batch_id: 50, avg_cost: 3.8705880641937256
grad_norm: 2.596469356410674, clipped: 1.0
epoch: 76, train_batch_id: 100, avg_cost: 3.878337860107422
grad_norm: 3.1980181806346213, clipped: 1.0
epoch: 76, train_batch_id: 150, avg_cost: 3.8789219856262207
grad_norm: 1.7628803350983913, clipped: 1.0
epoch: 76, train_batch_id: 200, avg_cost: 3.859011173248291
grad_norm: 4.995825161148684, clipped: 1.0
epoch: 76, train_batch_id: 250, avg_cost: 3.8662068843841553
grad_norm: 1.2991520847336342, clipped: 1.0
epoch: 76, train_batch_id: 300, avg_cost: 3.8783140182495117
grad_norm: 1.5061986672266112, clipped: 1.0
epoch: 76, train_batch_id: 350, avg_cost: 3.910951614379883
grad_norm: 1.6696884346019312, clipped: 1.0
epoch: 76, train_batch_id: 400, avg_cost: 3.8662939071655273
grad_norm: 1.920970761561253, clipped: 1.0
epoch: 76, train_batch_id: 450, avg_cost: 3.878592014312744
grad_norm: 1.24092435038962, clipped: 1.0
epoch: 76, train_batch_id: 500, avg_cost: 3.90224289894104
grad_norm: 2.513465835707638, clipped: 1.0
epoch: 76, train_batch_id: 550, avg_cost: 3.870241165161133
grad_norm: 1.5763082965032191, clipped: 1.0
epoch: 76, train_batch_id: 600, avg_cost: 3.855250358581543
grad_norm: 1.6558661888477777, clipped: 1.0
epoch: 76, train_batch_id: 650, avg_cost: 3.880019426345825
grad_norm: 2.313458486194312, clipped: 1.0
epoch: 76, train_batch_id: 700, avg_cost: 3.893354892730713
grad_norm: 1.6895476843602155, clipped: 1.0
epoch: 76, train_batch_id: 750, avg_cost: 3.870514392852783
grad_norm: 1.5350037087735173, clipped: 1.0
epoch: 76, train_batch_id: 800, avg_cost: 3.8787951469421387
grad_norm: 1.4927271313534562, clipped: 1.0
epoch: 76, train_batch_id: 850, avg_cost: 3.8710925579071045
grad_norm: 1.6369670786778279, clipped: 1.0
epoch: 76, train_batch_id: 900, avg_cost: 3.889275074005127
grad_norm: 1.826580755615703, clipped: 1.0
epoch: 76, train_batch_id: 950, avg_cost: 3.8597006797790527
grad_norm: 1.735175182843409, clipped: 1.0
epoch: 76, train_batch_id: 1000, avg_cost: 3.8705809116363525
grad_norm: 1.7496475365239894, clipped: 1.0
epoch: 76, train_batch_id: 1050, avg_cost: 3.8709545135498047
grad_norm: 2.456047964322009, clipped: 1.0
epoch: 76, train_batch_id: 1100, avg_cost: 3.8557329177856445
grad_norm: 1.3195995266226404, clipped: 1.0
epoch: 76, train_batch_id: 1150, avg_cost: 3.866225242614746
grad_norm: 1.0504661484749818, clipped: 1.0
epoch: 76, train_batch_id: 1200, avg_cost: 3.8696212768554688
grad_norm: 1.9396728883446384, clipped: 1.0
epoch: 76, train_batch_id: 1250, avg_cost: 3.891730308532715
grad_norm: 2.644849842425766, clipped: 1.0
epoch: 76, train_batch_id: 1300, avg_cost: 3.8887100219726562
grad_norm: 2.186697566163578, clipped: 1.0
epoch: 76, train_batch_id: 1350, avg_cost: 3.910122871398926
grad_norm: 9.125216565425584, clipped: 1.0
epoch: 76, train_batch_id: 1400, avg_cost: 3.8842992782592773
grad_norm: 2.0922433454400506, clipped: 1.0
epoch: 76, train_batch_id: 1450, avg_cost: 3.8657636642456055
grad_norm: 1.6328987362164624, clipped: 1.0
epoch: 76, train_batch_id: 1500, avg_cost: 3.889759063720703
grad_norm: 5.5983990586521974, clipped: 1.0
epoch: 76, train_batch_id: 1550, avg_cost: 3.864403247833252
grad_norm: 4.079712758278193, clipped: 1.0
epoch: 76, train_batch_id: 1600, avg_cost: 3.8570685386657715
grad_norm: 1.5366981621056088, clipped: 1.0
epoch: 76, train_batch_id: 1650, avg_cost: 3.859280586242676
grad_norm: 6.729613144118427, clipped: 1.0
epoch: 76, train_batch_id: 1700, avg_cost: 3.89994215965271
grad_norm: 1.8504876511397146, clipped: 1.0
epoch: 76, train_batch_id: 1750, avg_cost: 3.852238178253174
grad_norm: 2.7378575037122554, clipped: 1.0
epoch: 76, train_batch_id: 1800, avg_cost: 3.874677896499634
grad_norm: 1.7037479923573216, clipped: 1.0
epoch: 76, train_batch_id: 1850, avg_cost: 3.8871564865112305
grad_norm: 2.713312126020044, clipped: 1.0
epoch: 76, train_batch_id: 1900, avg_cost: 3.865774393081665
grad_norm: 2.3682858159851077, clipped: 1.0
epoch: 76, train_batch_id: 1950, avg_cost: 3.887258768081665
grad_norm: 1.547965726047462, clipped: 1.0
epoch: 76, train_batch_id: 2000, avg_cost: 3.873701572418213
grad_norm: 1.762658722591729, clipped: 1.0
epoch: 76, train_batch_id: 2050, avg_cost: 3.895474672317505
grad_norm: 1.3416867238255834, clipped: 1.0
epoch: 76, train_batch_id: 2100, avg_cost: 3.868074417114258
grad_norm: 1.9406149349582387, clipped: 1.0
epoch: 76, train_batch_id: 2150, avg_cost: 3.884357213973999
grad_norm: 1.9314801955027374, clipped: 1.0
epoch: 76, train_batch_id: 2200, avg_cost: 3.877617597579956
grad_norm: 1.6980612890204534, clipped: 1.0
epoch: 76, train_batch_id: 2250, avg_cost: 3.8887815475463867
grad_norm: 1.4184343046750658, clipped: 1.0
epoch: 76, train_batch_id: 2300, avg_cost: 3.873668670654297
grad_norm: 1.5865638512839606, clipped: 1.0
epoch: 76, train_batch_id: 2350, avg_cost: 3.8904240131378174
grad_norm: 1.4009120939855435, clipped: 1.0
epoch: 76, train_batch_id: 2400, avg_cost: 3.8809566497802734
grad_norm: 1.5806893094782968, clipped: 1.0
epoch: 76, train_batch_id: 2450, avg_cost: 3.876051902770996
grad_norm: 1.7561921913351441, clipped: 1.0
Finished epoch 76, took 00:09:26 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.322725772857666 +- 0.004191426560282707
Evaluating candidate model on evaluation dataset
Epoch 76 candidate mean 4.316291809082031, baseline epoch 39 mean 4.126363277435303, difference 0.18992853164672852
Start train epoch 77, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 77, train_batch_id: 0, avg_cost: 3.8819832801818848
grad_norm: 1.4861469942559844, clipped: 1.0
epoch: 77, train_batch_id: 50, avg_cost: 3.8728229999542236
grad_norm: 1.7535723866947264, clipped: 1.0
epoch: 77, train_batch_id: 100, avg_cost: 3.855963706970215
grad_norm: 1.7671236862231283, clipped: 1.0
epoch: 77, train_batch_id: 150, avg_cost: 3.8824849128723145
grad_norm: 1.8968784283673863, clipped: 1.0
epoch: 77, train_batch_id: 200, avg_cost: 3.859199285507202
grad_norm: 2.139528408110708, clipped: 1.0
epoch: 77, train_batch_id: 250, avg_cost: 3.8853421211242676
grad_norm: 1.8834472636646802, clipped: 1.0
epoch: 77, train_batch_id: 300, avg_cost: 3.89939546585083
grad_norm: 1.4299491409459295, clipped: 1.0
epoch: 77, train_batch_id: 350, avg_cost: 3.8558883666992188
grad_norm: 1.2637361355076757, clipped: 1.0
epoch: 77, train_batch_id: 400, avg_cost: 3.8952088356018066
grad_norm: 10.971405689994716, clipped: 1.0
epoch: 77, train_batch_id: 450, avg_cost: 3.851863384246826
grad_norm: 2.2578521335579187, clipped: 1.0
epoch: 77, train_batch_id: 500, avg_cost: 3.877394437789917
grad_norm: 1.4746551974407351, clipped: 1.0
epoch: 77, train_batch_id: 550, avg_cost: 3.871525764465332
grad_norm: 2.694368329154864, clipped: 1.0
epoch: 77, train_batch_id: 600, avg_cost: 3.86472749710083
grad_norm: 1.6393742548891879, clipped: 1.0
epoch: 77, train_batch_id: 650, avg_cost: 3.8862533569335938
grad_norm: 2.0962960147812724, clipped: 1.0
epoch: 77, train_batch_id: 700, avg_cost: 3.9006786346435547
grad_norm: 2.0413438569197213, clipped: 1.0
epoch: 77, train_batch_id: 750, avg_cost: 3.8771910667419434
grad_norm: 1.786032017519501, clipped: 1.0
epoch: 77, train_batch_id: 800, avg_cost: 3.880824565887451
grad_norm: 1.7895153569368567, clipped: 1.0
epoch: 77, train_batch_id: 850, avg_cost: 3.8638153076171875
grad_norm: 1.3888161119744387, clipped: 1.0
epoch: 77, train_batch_id: 900, avg_cost: 3.8764476776123047
grad_norm: 2.4129124682094267, clipped: 1.0
epoch: 77, train_batch_id: 950, avg_cost: 3.854795455932617
grad_norm: 1.4099387812869089, clipped: 1.0
epoch: 77, train_batch_id: 1000, avg_cost: 3.888509511947632
grad_norm: 1.3114352777937237, clipped: 1.0
epoch: 77, train_batch_id: 1050, avg_cost: 3.8556466102600098
grad_norm: 1.6961934062092123, clipped: 1.0
epoch: 77, train_batch_id: 1100, avg_cost: 3.8866872787475586
grad_norm: 1.2464316660948778, clipped: 1.0
epoch: 77, train_batch_id: 1150, avg_cost: 3.8883979320526123
grad_norm: 1.7367190498308351, clipped: 1.0
epoch: 77, train_batch_id: 1200, avg_cost: 3.8595993518829346
grad_norm: 1.5683950430195217, clipped: 1.0
epoch: 77, train_batch_id: 1250, avg_cost: 3.871746778488159
grad_norm: 1.487993683501001, clipped: 1.0
epoch: 77, train_batch_id: 1300, avg_cost: 3.8663406372070312
grad_norm: 2.6265823330118914, clipped: 1.0
epoch: 77, train_batch_id: 1350, avg_cost: 3.8860514163970947
grad_norm: 1.7247803951922798, clipped: 1.0
epoch: 77, train_batch_id: 1400, avg_cost: 3.8846042156219482
grad_norm: 1.5895394168402281, clipped: 1.0
epoch: 77, train_batch_id: 1450, avg_cost: 3.8841545581817627
grad_norm: 1.4489093336588912, clipped: 1.0
epoch: 77, train_batch_id: 1500, avg_cost: 3.8789432048797607
grad_norm: 1.9917197546989374, clipped: 1.0
epoch: 77, train_batch_id: 1550, avg_cost: 3.877791404724121
grad_norm: 4.359871762774814, clipped: 1.0
epoch: 77, train_batch_id: 1600, avg_cost: 3.8855156898498535
grad_norm: 1.4429326066508907, clipped: 1.0
epoch: 77, train_batch_id: 1650, avg_cost: 3.8544838428497314
grad_norm: 2.402449223080562, clipped: 1.0
epoch: 77, train_batch_id: 1700, avg_cost: 3.8919901847839355
grad_norm: 3.35405525792542, clipped: 1.0
epoch: 77, train_batch_id: 1750, avg_cost: 3.862070083618164
grad_norm: 1.3284954101643376, clipped: 1.0
epoch: 77, train_batch_id: 1800, avg_cost: 3.882949113845825
grad_norm: 1.5021223304712887, clipped: 1.0
epoch: 77, train_batch_id: 1850, avg_cost: 3.87568736076355
grad_norm: 1.6736658114980834, clipped: 1.0
epoch: 77, train_batch_id: 1900, avg_cost: 3.8623528480529785
grad_norm: 2.1233252101485522, clipped: 1.0
epoch: 77, train_batch_id: 1950, avg_cost: 3.8470864295959473
grad_norm: 1.4506475796836584, clipped: 1.0
epoch: 77, train_batch_id: 2000, avg_cost: 3.8757991790771484
grad_norm: 1.816464740899018, clipped: 1.0
epoch: 77, train_batch_id: 2050, avg_cost: 3.87442946434021
grad_norm: 1.9856288617539646, clipped: 1.0
epoch: 77, train_batch_id: 2100, avg_cost: 3.882399082183838
grad_norm: 1.5529396288782347, clipped: 1.0
epoch: 77, train_batch_id: 2150, avg_cost: 3.8550586700439453
grad_norm: 2.3898138166374294, clipped: 1.0
epoch: 77, train_batch_id: 2200, avg_cost: 3.886061191558838
grad_norm: 2.013944060234781, clipped: 1.0
epoch: 77, train_batch_id: 2250, avg_cost: 3.872062921524048
grad_norm: 1.4782736646572678, clipped: 1.0
epoch: 77, train_batch_id: 2300, avg_cost: 3.8858163356781006
grad_norm: 1.5914439663443736, clipped: 1.0
epoch: 77, train_batch_id: 2350, avg_cost: 3.8645105361938477
grad_norm: 1.7813545948729916, clipped: 1.0
epoch: 77, train_batch_id: 2400, avg_cost: 3.878324270248413
grad_norm: 1.5823599686893168, clipped: 1.0
epoch: 77, train_batch_id: 2450, avg_cost: 3.8853201866149902
grad_norm: 1.9267087483884429, clipped: 1.0
Finished epoch 77, took 00:09:24 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.4077019691467285 +- 0.004218852613121271
Evaluating candidate model on evaluation dataset
Epoch 77 candidate mean 4.398837089538574, baseline epoch 39 mean 4.126363277435303, difference 0.2724738121032715
Start train epoch 78, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


epoch: 78, train_batch_id: 0, avg_cost: 3.8733043670654297
grad_norm: 1.7392805931399073, clipped: 1.0
epoch: 78, train_batch_id: 50, avg_cost: 3.866431713104248
grad_norm: 1.7504847001639519, clipped: 1.0
epoch: 78, train_batch_id: 100, avg_cost: 3.8832340240478516
grad_norm: 1.670519905049011, clipped: 1.0
epoch: 78, train_batch_id: 150, avg_cost: 3.876095771789551
grad_norm: 1.8857827118156933, clipped: 1.0
epoch: 78, train_batch_id: 200, avg_cost: 3.8654415607452393
grad_norm: 1.6933581052858704, clipped: 1.0
epoch: 78, train_batch_id: 250, avg_cost: 3.87935471534729
grad_norm: 1.6617743501429156, clipped: 1.0
epoch: 78, train_batch_id: 300, avg_cost: 3.895867347717285
grad_norm: 2.1470467482392444, clipped: 1.0
epoch: 78, train_batch_id: 350, avg_cost: 3.875706195831299
grad_norm: 1.4572715951139115, clipped: 1.0
epoch: 78, train_batch_id: 400, avg_cost: 3.8808860778808594
grad_norm: 1.8847461205192504, clipped: 1.0
epoch: 78, train_batch_id: 450, avg_cost: 3.889881134033203
grad_norm: 1.497970093453489, clipped: 1.0
epoch: 78, train_batch_id: 500, avg_cost: 3.8601808547973633
grad_norm: 1.451145160554143, clipped: 1.0
epoch: 78, train_batch_id: 550, avg_cost: 3.864102840423584
grad_norm: 1.5986069089757684, clipped: 1.0
epoch: 78, train_batch_id: 600, avg_cost: 3.8450469970703125
grad_norm: 1.5867083277159029, clipped: 1.0
epoch: 78, train_batch_id: 650, avg_cost: 3.885895252227783
grad_norm: 1.6927775320987475, clipped: 1.0
epoch: 78, train_batch_id: 700, avg_cost: 3.8812127113342285
grad_norm: 1.9154197853517025, clipped: 1.0
epoch: 78, train_batch_id: 750, avg_cost: 3.8635473251342773
grad_norm: 1.4735360731021985, clipped: 1.0
epoch: 78, train_batch_id: 800, avg_cost: 3.875927686691284
grad_norm: 1.614462856127358, clipped: 1.0
epoch: 78, train_batch_id: 850, avg_cost: 3.8816921710968018
grad_norm: 1.6550900511663034, clipped: 1.0
epoch: 78, train_batch_id: 900, avg_cost: 3.861647129058838
grad_norm: 1.6644994865238838, clipped: 1.0
epoch: 78, train_batch_id: 950, avg_cost: 3.851684093475342
grad_norm: 1.8220955536630954, clipped: 1.0
epoch: 78, train_batch_id: 1000, avg_cost: 3.910137414932251
grad_norm: 1.9681377984619333, clipped: 1.0
epoch: 78, train_batch_id: 1050, avg_cost: 3.893281936645508
grad_norm: 1.7093231047043118, clipped: 1.0
epoch: 78, train_batch_id: 1100, avg_cost: 3.868350028991699
grad_norm: 3.7456263607726035, clipped: 1.0
epoch: 78, train_batch_id: 1150, avg_cost: 3.868952989578247
grad_norm: 1.4950337407573413, clipped: 1.0
epoch: 78, train_batch_id: 1200, avg_cost: 3.877138376235962
grad_norm: 1.9446919366978892, clipped: 1.0
epoch: 78, train_batch_id: 1250, avg_cost: 3.8822197914123535
grad_norm: 1.5676037348908494, clipped: 1.0
epoch: 78, train_batch_id: 1300, avg_cost: 3.8773252964019775
grad_norm: 1.3427277730543563, clipped: 1.0
epoch: 78, train_batch_id: 1350, avg_cost: 3.8930163383483887
grad_norm: 5.6286107015896265, clipped: 1.0
epoch: 78, train_batch_id: 1400, avg_cost: 3.8793962001800537
grad_norm: 1.5882636490968096, clipped: 1.0
epoch: 78, train_batch_id: 1450, avg_cost: 3.8828256130218506
grad_norm: 1.7838079232759672, clipped: 1.0
epoch: 78, train_batch_id: 1500, avg_cost: 3.895557403564453
grad_norm: 1.774532276229927, clipped: 1.0
epoch: 78, train_batch_id: 1550, avg_cost: 3.8735392093658447
grad_norm: 1.9240117107025068, clipped: 1.0
epoch: 78, train_batch_id: 1600, avg_cost: 3.8726439476013184
grad_norm: 1.2629734374526544, clipped: 1.0
epoch: 78, train_batch_id: 1650, avg_cost: 3.891362428665161
grad_norm: 1.3860278113115279, clipped: 1.0
epoch: 78, train_batch_id: 1700, avg_cost: 3.885251045227051
grad_norm: 1.6056748728581238, clipped: 1.0
epoch: 78, train_batch_id: 1750, avg_cost: 3.862941265106201
grad_norm: 1.9892080552292626, clipped: 1.0
epoch: 78, train_batch_id: 1800, avg_cost: 3.887167453765869
grad_norm: 4.1070065687838815, clipped: 1.0
epoch: 78, train_batch_id: 1850, avg_cost: 3.868006706237793
grad_norm: 1.5725173628132036, clipped: 1.0
epoch: 78, train_batch_id: 1900, avg_cost: 3.891420364379883
grad_norm: 2.0676469333665226, clipped: 1.0
epoch: 78, train_batch_id: 1950, avg_cost: 3.8956503868103027
grad_norm: 1.857993193690583, clipped: 1.0
epoch: 78, train_batch_id: 2000, avg_cost: 3.87827467918396
grad_norm: 1.8598505408616126, clipped: 1.0
epoch: 78, train_batch_id: 2050, avg_cost: 3.891242742538452
grad_norm: 1.7166172971520381, clipped: 1.0
epoch: 78, train_batch_id: 2100, avg_cost: 3.8681273460388184
grad_norm: 1.8010491003955147, clipped: 1.0
epoch: 78, train_batch_id: 2150, avg_cost: 3.846184730529785
grad_norm: 2.0283041631827583, clipped: 1.0
epoch: 78, train_batch_id: 2200, avg_cost: 3.8930702209472656
grad_norm: 1.5038515768732579, clipped: 1.0
epoch: 78, train_batch_id: 2250, avg_cost: 3.8845462799072266
grad_norm: 2.653106435029739, clipped: 1.0
epoch: 78, train_batch_id: 2300, avg_cost: 3.8691396713256836
grad_norm: 1.7784007780809796, clipped: 1.0
epoch: 78, train_batch_id: 2350, avg_cost: 3.866574764251709
grad_norm: 6.306736862652938, clipped: 1.0
epoch: 78, train_batch_id: 2400, avg_cost: 3.863060235977173
grad_norm: 15.095934221703265, clipped: 1.0
epoch: 78, train_batch_id: 2450, avg_cost: 3.8772919178009033
grad_norm: 1.3662241992277169, clipped: 1.0
Finished epoch 78, took 00:09:24 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.373571395874023 +- 0.004704505670815706
Evaluating candidate model on evaluation dataset
Epoch 78 candidate mean 4.363094329833984, baseline epoch 39 mean 4.126363277435303, difference 0.23673105239868164
Start train epoch 79, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 79, train_batch_id: 0, avg_cost: 3.868590831756592
grad_norm: 2.1932642078254756, clipped: 1.0
epoch: 79, train_batch_id: 50, avg_cost: 3.875615119934082
grad_norm: 1.5539876566767863, clipped: 1.0
epoch: 79, train_batch_id: 100, avg_cost: 3.8961336612701416
grad_norm: 1.9290304918327073, clipped: 1.0
epoch: 79, train_batch_id: 150, avg_cost: 3.873213052749634
grad_norm: 3.429475157309534, clipped: 1.0
epoch: 79, train_batch_id: 200, avg_cost: 3.871432304382324
grad_norm: 1.8080682877065035, clipped: 1.0
epoch: 79, train_batch_id: 250, avg_cost: 3.8748817443847656
grad_norm: 1.9519438443484178, clipped: 1.0
epoch: 79, train_batch_id: 300, avg_cost: 3.846761703491211
grad_norm: 1.9513209598973953, clipped: 1.0
epoch: 79, train_batch_id: 350, avg_cost: 3.8723020553588867
grad_norm: 3.710956124258422, clipped: 1.0
epoch: 79, train_batch_id: 400, avg_cost: 3.8639299869537354
grad_norm: 1.8751645188399961, clipped: 1.0
epoch: 79, train_batch_id: 450, avg_cost: 3.8666229248046875
grad_norm: 1.7170925522005454, clipped: 1.0
epoch: 79, train_batch_id: 500, avg_cost: 3.863539934158325
grad_norm: 1.9415446188043253, clipped: 1.0
epoch: 79, train_batch_id: 550, avg_cost: 3.9076356887817383
grad_norm: 1.8481037098841522, clipped: 1.0
epoch: 79, train_batch_id: 600, avg_cost: 3.8573760986328125
grad_norm: 1.3260632979393494, clipped: 1.0
epoch: 79, train_batch_id: 650, avg_cost: 3.8568532466888428
grad_norm: 1.4451242729377267, clipped: 1.0
epoch: 79, train_batch_id: 700, avg_cost: 3.8722333908081055
grad_norm: 1.8444629652376108, clipped: 1.0
epoch: 79, train_batch_id: 750, avg_cost: 3.8702986240386963
grad_norm: 2.6218934114460644, clipped: 1.0
epoch: 79, train_batch_id: 800, avg_cost: 3.867635726928711
grad_norm: 1.326023303482, clipped: 1.0
epoch: 79, train_batch_id: 850, avg_cost: 3.8759264945983887
grad_norm: 1.505314318646417, clipped: 1.0
epoch: 79, train_batch_id: 900, avg_cost: 3.871368885040283
grad_norm: 1.7771476972132951, clipped: 1.0
epoch: 79, train_batch_id: 950, avg_cost: 3.8652825355529785
grad_norm: 1.4299353815435956, clipped: 1.0
epoch: 79, train_batch_id: 1000, avg_cost: 3.8831958770751953
grad_norm: 1.5833818780944706, clipped: 1.0
epoch: 79, train_batch_id: 1050, avg_cost: 3.8600387573242188
grad_norm: 3.4266956340116086, clipped: 1.0
epoch: 79, train_batch_id: 1100, avg_cost: 3.865783214569092
grad_norm: 1.5352035104181823, clipped: 1.0
epoch: 79, train_batch_id: 1150, avg_cost: 3.877871036529541
grad_norm: 2.262333487623701, clipped: 1.0
epoch: 79, train_batch_id: 1200, avg_cost: 3.8794398307800293
grad_norm: 1.5406085579907474, clipped: 1.0
epoch: 79, train_batch_id: 1250, avg_cost: 3.866816520690918
grad_norm: 1.8130037035303652, clipped: 1.0
epoch: 79, train_batch_id: 1300, avg_cost: 3.8527183532714844
grad_norm: 1.3723474832639784, clipped: 1.0
epoch: 79, train_batch_id: 1350, avg_cost: 3.8807382583618164
grad_norm: 1.6633475181433384, clipped: 1.0
epoch: 79, train_batch_id: 1400, avg_cost: 3.853135108947754
grad_norm: 2.055229511807375, clipped: 1.0
epoch: 79, train_batch_id: 1450, avg_cost: 3.864657402038574
grad_norm: 1.7992320967080018, clipped: 1.0
epoch: 79, train_batch_id: 1500, avg_cost: 3.876789093017578
grad_norm: 1.8652605036248477, clipped: 1.0
epoch: 79, train_batch_id: 1550, avg_cost: 3.8603949546813965
grad_norm: 2.7748966890210105, clipped: 1.0
epoch: 79, train_batch_id: 1600, avg_cost: 3.8843488693237305
grad_norm: 2.805779878897578, clipped: 1.0
epoch: 79, train_batch_id: 1650, avg_cost: 3.8875844478607178
grad_norm: 1.6394307241917065, clipped: 1.0
epoch: 79, train_batch_id: 1700, avg_cost: 3.8841490745544434
grad_norm: 2.088504844897142, clipped: 1.0
epoch: 79, train_batch_id: 1750, avg_cost: 3.88116192817688
grad_norm: 2.6784370980843266, clipped: 1.0
epoch: 79, train_batch_id: 1800, avg_cost: 3.8672173023223877
grad_norm: 1.410632328645868, clipped: 1.0
epoch: 79, train_batch_id: 1850, avg_cost: 3.8707423210144043
grad_norm: 2.751808093363354, clipped: 1.0
epoch: 79, train_batch_id: 1900, avg_cost: 3.8707292079925537
grad_norm: 1.4842452959409, clipped: 1.0
epoch: 79, train_batch_id: 1950, avg_cost: 3.868870258331299
grad_norm: 3.803312264770806, clipped: 1.0
epoch: 79, train_batch_id: 2000, avg_cost: 3.886096954345703
grad_norm: 3.0160723850422344, clipped: 1.0
epoch: 79, train_batch_id: 2050, avg_cost: 3.9069838523864746
grad_norm: 2.165489744428055, clipped: 1.0
epoch: 79, train_batch_id: 2100, avg_cost: 3.8504624366760254
grad_norm: 1.946145972665346, clipped: 1.0
epoch: 79, train_batch_id: 2150, avg_cost: 3.8920669555664062
grad_norm: 2.5765308493111005, clipped: 1.0
epoch: 79, train_batch_id: 2200, avg_cost: 3.898280620574951
grad_norm: 1.660545539349987, clipped: 1.0
epoch: 79, train_batch_id: 2250, avg_cost: 3.910492420196533
grad_norm: 1.2856541941156694, clipped: 1.0
epoch: 79, train_batch_id: 2300, avg_cost: 3.858942985534668
grad_norm: 1.9636998438472328, clipped: 1.0
epoch: 79, train_batch_id: 2350, avg_cost: 3.872313976287842
grad_norm: 2.3236379858424967, clipped: 1.0
epoch: 79, train_batch_id: 2400, avg_cost: 3.8945140838623047
grad_norm: 2.298022570513895, clipped: 1.0
epoch: 79, train_batch_id: 2450, avg_cost: 3.85490083694458
grad_norm: 1.5958024026480941, clipped: 1.0
Finished epoch 79, took 00:09:22 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.363008975982666 +- 0.004218186717480421
Evaluating candidate model on evaluation dataset
Epoch 79 candidate mean 4.350876331329346, baseline epoch 39 mean 4.126363277435303, difference 0.22451305389404297
Start train epoch 80, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


171


171


epoch: 80, train_batch_id: 0, avg_cost: 3.873631477355957
grad_norm: 1.6710253466481004, clipped: 1.0
epoch: 80, train_batch_id: 50, avg_cost: 3.8633389472961426
grad_norm: 1.5671276254675808, clipped: 1.0
epoch: 80, train_batch_id: 100, avg_cost: 3.905474901199341
grad_norm: 1.6981453894812646, clipped: 1.0
epoch: 80, train_batch_id: 150, avg_cost: 3.8752284049987793
grad_norm: 1.809363934607315, clipped: 1.0
epoch: 80, train_batch_id: 200, avg_cost: 3.884875774383545
grad_norm: 1.6523377234685868, clipped: 1.0
epoch: 80, train_batch_id: 250, avg_cost: 3.8795933723449707
grad_norm: 2.70231900410182, clipped: 1.0
epoch: 80, train_batch_id: 300, avg_cost: 3.8558759689331055
grad_norm: 1.5963630716301114, clipped: 1.0
epoch: 80, train_batch_id: 350, avg_cost: 3.888699531555176
grad_norm: 1.6607857324765156, clipped: 1.0
epoch: 80, train_batch_id: 400, avg_cost: 3.8822007179260254
grad_norm: 2.047512309291741, clipped: 1.0
epoch: 80, train_batch_id: 450, avg_cost: 3.9026594161987305
grad_norm: 1.7406801212701901, clipped: 1.0
epoch: 80, train_batch_id: 500, avg_cost: 3.8689656257629395
grad_norm: 1.9067495541270634, clipped: 1.0
epoch: 80, train_batch_id: 550, avg_cost: 3.880598545074463
grad_norm: 2.665809549560377, clipped: 1.0
epoch: 80, train_batch_id: 600, avg_cost: 3.890277147293091
grad_norm: 1.6721778367507822, clipped: 1.0
epoch: 80, train_batch_id: 650, avg_cost: 3.8878915309906006
grad_norm: 1.952274054737598, clipped: 1.0
epoch: 80, train_batch_id: 700, avg_cost: 3.8697144985198975
grad_norm: 4.770646797056126, clipped: 1.0
epoch: 80, train_batch_id: 750, avg_cost: 3.8679332733154297
grad_norm: 2.3947636207943943, clipped: 1.0
epoch: 80, train_batch_id: 800, avg_cost: 3.849724531173706
grad_norm: 2.2427301256306307, clipped: 1.0
epoch: 80, train_batch_id: 850, avg_cost: 3.8868870735168457
grad_norm: 1.9413601936959803, clipped: 1.0
epoch: 80, train_batch_id: 900, avg_cost: 3.890345573425293
grad_norm: 4.325797500688904, clipped: 1.0
epoch: 80, train_batch_id: 950, avg_cost: 3.8794076442718506
grad_norm: 1.7876113595459702, clipped: 1.0
epoch: 80, train_batch_id: 1000, avg_cost: 3.8990654945373535
grad_norm: 2.41069942015437, clipped: 1.0
epoch: 80, train_batch_id: 1050, avg_cost: 3.8991262912750244
grad_norm: 2.07120894517355, clipped: 1.0
epoch: 80, train_batch_id: 1100, avg_cost: 3.883387327194214
grad_norm: 1.4460641017660127, clipped: 1.0
epoch: 80, train_batch_id: 1150, avg_cost: 3.8925535678863525
grad_norm: 4.351498929688782, clipped: 1.0
epoch: 80, train_batch_id: 1200, avg_cost: 3.889333724975586
grad_norm: 1.84781529426785, clipped: 1.0
epoch: 80, train_batch_id: 1250, avg_cost: 3.872054100036621
grad_norm: 1.6799753757650457, clipped: 1.0
epoch: 80, train_batch_id: 1300, avg_cost: 3.8751606941223145
grad_norm: 2.227694372396795, clipped: 1.0
epoch: 80, train_batch_id: 1350, avg_cost: 3.8568787574768066
grad_norm: 1.69327849442231, clipped: 1.0
epoch: 80, train_batch_id: 1400, avg_cost: 3.8508877754211426
grad_norm: 2.102313044717299, clipped: 1.0
epoch: 80, train_batch_id: 1450, avg_cost: 3.8631224632263184
grad_norm: 2.0079756499111054, clipped: 1.0
epoch: 80, train_batch_id: 1500, avg_cost: 3.880746364593506
grad_norm: 2.1890139285763666, clipped: 1.0
epoch: 80, train_batch_id: 1550, avg_cost: 3.871936798095703
grad_norm: 3.0511971457906215, clipped: 1.0
epoch: 80, train_batch_id: 1600, avg_cost: 3.874845504760742
grad_norm: 1.5024577733183684, clipped: 1.0
epoch: 80, train_batch_id: 1650, avg_cost: 3.8775382041931152
grad_norm: 7.667216172532712, clipped: 1.0
epoch: 80, train_batch_id: 1700, avg_cost: 3.903071403503418
grad_norm: 4.376925678820708, clipped: 1.0
epoch: 80, train_batch_id: 1750, avg_cost: 3.9067492485046387
grad_norm: 1.8525777234183116, clipped: 1.0
epoch: 80, train_batch_id: 1800, avg_cost: 3.867908000946045
grad_norm: 4.262969322837382, clipped: 1.0
epoch: 80, train_batch_id: 1850, avg_cost: 3.8568763732910156
grad_norm: 1.5605979355095638, clipped: 1.0
epoch: 80, train_batch_id: 1900, avg_cost: 3.8900978565216064
grad_norm: 1.7726433789581193, clipped: 1.0
epoch: 80, train_batch_id: 1950, avg_cost: 3.863168239593506
grad_norm: 2.419379009694646, clipped: 1.0
epoch: 80, train_batch_id: 2000, avg_cost: 3.8653788566589355
grad_norm: 1.9258156035923448, clipped: 1.0
epoch: 80, train_batch_id: 2050, avg_cost: 3.883894920349121
grad_norm: 3.6748127275342624, clipped: 1.0
epoch: 80, train_batch_id: 2100, avg_cost: 3.8606791496276855
grad_norm: 2.082207871199421, clipped: 1.0
epoch: 80, train_batch_id: 2150, avg_cost: 3.85623836517334
grad_norm: 2.012597394276158, clipped: 1.0
epoch: 80, train_batch_id: 2200, avg_cost: 3.850922107696533
grad_norm: 2.2197158781126722, clipped: 1.0
epoch: 80, train_batch_id: 2250, avg_cost: 3.8732781410217285
grad_norm: 1.4273752690847499, clipped: 1.0
epoch: 80, train_batch_id: 2300, avg_cost: 3.883573532104492
grad_norm: 3.720982614799862, clipped: 1.0
epoch: 80, train_batch_id: 2350, avg_cost: 3.8493871688842773
grad_norm: 1.1248053637161735, clipped: 1.0
epoch: 80, train_batch_id: 2400, avg_cost: 3.8851733207702637
grad_norm: 1.631251136178601, clipped: 1.0
epoch: 80, train_batch_id: 2450, avg_cost: 3.892463207244873
grad_norm: 2.3190983228871245, clipped: 1.0
Finished epoch 80, took 00:09:22 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.4147467613220215 +- 0.0043204412795603275
Evaluating candidate model on evaluation dataset
Epoch 80 candidate mean 4.4060258865356445, baseline epoch 39 mean 4.126363277435303, difference 0.2796626091003418
Start train epoch 81, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 81, train_batch_id: 0, avg_cost: 3.889943838119507
grad_norm: 1.9073129382511695, clipped: 1.0
epoch: 81, train_batch_id: 50, avg_cost: 3.875764846801758
grad_norm: 2.6133703343901673, clipped: 1.0
epoch: 81, train_batch_id: 100, avg_cost: 3.8875045776367188
grad_norm: 1.4634246742595338, clipped: 1.0
epoch: 81, train_batch_id: 150, avg_cost: 3.8856568336486816
grad_norm: 1.0475752985522395, clipped: 1.0
epoch: 81, train_batch_id: 200, avg_cost: 3.872591972351074
grad_norm: 1.8929269139446685, clipped: 1.0
epoch: 81, train_batch_id: 250, avg_cost: 3.8871569633483887
grad_norm: 2.5770680556493697, clipped: 1.0
epoch: 81, train_batch_id: 300, avg_cost: 3.88267183303833
grad_norm: 1.8347192682947557, clipped: 1.0
epoch: 81, train_batch_id: 350, avg_cost: 3.889389753341675
grad_norm: 1.4898738886756608, clipped: 1.0
epoch: 81, train_batch_id: 400, avg_cost: 3.8734383583068848
grad_norm: 7.691683386306411, clipped: 1.0
epoch: 81, train_batch_id: 450, avg_cost: 3.8749184608459473
grad_norm: 1.4871389932675605, clipped: 1.0
epoch: 81, train_batch_id: 500, avg_cost: 3.8866024017333984
grad_norm: 1.3289890370252706, clipped: 1.0
epoch: 81, train_batch_id: 550, avg_cost: 3.868943214416504
grad_norm: 2.1467889275816683, clipped: 1.0
epoch: 81, train_batch_id: 600, avg_cost: 3.878671169281006
grad_norm: 3.9244018246499355, clipped: 1.0
epoch: 81, train_batch_id: 650, avg_cost: 3.8706369400024414
grad_norm: 3.196733439320122, clipped: 1.0
epoch: 81, train_batch_id: 700, avg_cost: 3.861069679260254
grad_norm: 1.7481951503717699, clipped: 1.0
epoch: 81, train_batch_id: 750, avg_cost: 3.8693618774414062
grad_norm: 1.8046208142347717, clipped: 1.0
epoch: 81, train_batch_id: 800, avg_cost: 3.8413984775543213
grad_norm: 2.271751786409586, clipped: 1.0
epoch: 81, train_batch_id: 850, avg_cost: 3.8797974586486816
grad_norm: 2.240809351096403, clipped: 1.0
epoch: 81, train_batch_id: 900, avg_cost: 3.830005407333374
grad_norm: 3.907053879744997, clipped: 1.0
epoch: 81, train_batch_id: 950, avg_cost: 3.861643075942993
grad_norm: 3.548526114822655, clipped: 1.0
epoch: 81, train_batch_id: 1000, avg_cost: 3.893695592880249
grad_norm: 1.7992989540286664, clipped: 1.0
epoch: 81, train_batch_id: 1050, avg_cost: 3.89216947555542
grad_norm: 1.9788996461622663, clipped: 1.0
epoch: 81, train_batch_id: 1100, avg_cost: 3.8854622840881348
grad_norm: 1.384050712100138, clipped: 1.0
epoch: 81, train_batch_id: 1150, avg_cost: 3.876002311706543
grad_norm: 2.0847078409150392, clipped: 1.0
epoch: 81, train_batch_id: 1200, avg_cost: 3.8941080570220947
grad_norm: 2.597361788027705, clipped: 1.0
epoch: 81, train_batch_id: 1250, avg_cost: 3.8911163806915283
grad_norm: 2.357263474619758, clipped: 1.0
epoch: 81, train_batch_id: 1300, avg_cost: 3.882750988006592
grad_norm: 5.280674303985361, clipped: 1.0
epoch: 81, train_batch_id: 1350, avg_cost: 3.845233678817749
grad_norm: 3.2213818265566814, clipped: 1.0
epoch: 81, train_batch_id: 1400, avg_cost: 3.898074150085449
grad_norm: 1.7363092640235849, clipped: 1.0
epoch: 81, train_batch_id: 1450, avg_cost: 3.868166923522949
grad_norm: 1.7724360517426654, clipped: 1.0
epoch: 81, train_batch_id: 1500, avg_cost: 3.8683104515075684
grad_norm: 1.3544036850701542, clipped: 1.0
epoch: 81, train_batch_id: 1550, avg_cost: 3.890225887298584
grad_norm: 4.712991017190303, clipped: 1.0
epoch: 81, train_batch_id: 1600, avg_cost: 3.8674163818359375
grad_norm: 3.586179144779537, clipped: 1.0
epoch: 81, train_batch_id: 1650, avg_cost: 3.8837714195251465
grad_norm: 1.336821132684098, clipped: 1.0
epoch: 81, train_batch_id: 1700, avg_cost: 3.887228012084961
grad_norm: 3.499685614750824, clipped: 1.0
epoch: 81, train_batch_id: 1750, avg_cost: 3.8751730918884277
grad_norm: 1.608305079089442, clipped: 1.0
epoch: 81, train_batch_id: 1800, avg_cost: 3.870778799057007
grad_norm: 2.4966656466140855, clipped: 1.0
epoch: 81, train_batch_id: 1850, avg_cost: 3.8956236839294434
grad_norm: 3.0277894630568634, clipped: 1.0
epoch: 81, train_batch_id: 1900, avg_cost: 3.8526997566223145
grad_norm: 2.4713987929495826, clipped: 1.0
epoch: 81, train_batch_id: 1950, avg_cost: 3.8652241230010986
grad_norm: 2.072049230093536, clipped: 1.0
epoch: 81, train_batch_id: 2000, avg_cost: 3.8713409900665283
grad_norm: 1.4788399366951903, clipped: 1.0
epoch: 81, train_batch_id: 2050, avg_cost: 3.8325929641723633
grad_norm: 4.07372671888089, clipped: 1.0
epoch: 81, train_batch_id: 2100, avg_cost: 3.864126205444336
grad_norm: 2.1952004720684264, clipped: 1.0
epoch: 81, train_batch_id: 2150, avg_cost: 3.8701908588409424
grad_norm: 3.5144232053428714, clipped: 1.0
epoch: 81, train_batch_id: 2200, avg_cost: 3.875077247619629
grad_norm: 3.226375056444171, clipped: 1.0
epoch: 81, train_batch_id: 2250, avg_cost: 3.8974244594573975
grad_norm: 2.3767416982852314, clipped: 1.0
epoch: 81, train_batch_id: 2300, avg_cost: 3.8736743927001953
grad_norm: 1.4728849286014254, clipped: 1.0
epoch: 81, train_batch_id: 2350, avg_cost: 3.8706603050231934
grad_norm: 1.9924234123848348, clipped: 1.0
epoch: 81, train_batch_id: 2400, avg_cost: 3.916071891784668
grad_norm: 1.9273724604727613, clipped: 1.0
epoch: 81, train_batch_id: 2450, avg_cost: 3.8881688117980957
grad_norm: 1.3570885355760416, clipped: 1.0
Finished epoch 81, took 00:09:29 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.327481269836426 +- 0.004165926016867161
Evaluating candidate model on evaluation dataset
Epoch 81 candidate mean 4.318697452545166, baseline epoch 39 mean 4.126363277435303, difference 0.19233417510986328
Start train epoch 82, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


171


171


epoch: 82, train_batch_id: 0, avg_cost: 3.8652162551879883
grad_norm: 3.2755780224117204, clipped: 1.0
epoch: 82, train_batch_id: 50, avg_cost: 3.8837647438049316
grad_norm: 1.7080156251323786, clipped: 1.0
epoch: 82, train_batch_id: 100, avg_cost: 3.8652567863464355
grad_norm: 1.4290262898990584, clipped: 1.0
epoch: 82, train_batch_id: 150, avg_cost: 3.86796498298645
grad_norm: 2.3234722040738536, clipped: 1.0
epoch: 82, train_batch_id: 200, avg_cost: 3.88373064994812
grad_norm: 20.394149474566618, clipped: 1.0
epoch: 82, train_batch_id: 250, avg_cost: 3.9172821044921875
grad_norm: 2.1146241992918684, clipped: 1.0
epoch: 82, train_batch_id: 300, avg_cost: 3.884023904800415
grad_norm: 2.5764092326096546, clipped: 1.0
epoch: 82, train_batch_id: 350, avg_cost: 3.9098544120788574
grad_norm: 4.085983317628545, clipped: 1.0
epoch: 82, train_batch_id: 400, avg_cost: 3.887000560760498
grad_norm: 1.6852931899251384, clipped: 1.0
epoch: 82, train_batch_id: 450, avg_cost: 3.850526809692383
grad_norm: 1.9901876196717543, clipped: 1.0
epoch: 82, train_batch_id: 500, avg_cost: 3.880718231201172
grad_norm: 2.4041792735356546, clipped: 1.0
epoch: 82, train_batch_id: 550, avg_cost: 3.872769594192505
grad_norm: 1.7872356193128476, clipped: 1.0
epoch: 82, train_batch_id: 600, avg_cost: 3.875138282775879
grad_norm: 2.4944716723652602, clipped: 1.0
epoch: 82, train_batch_id: 650, avg_cost: 3.8887619972229004
grad_norm: 1.751553439824995, clipped: 1.0
epoch: 82, train_batch_id: 700, avg_cost: 3.874586582183838
grad_norm: 2.060318176572905, clipped: 1.0
epoch: 82, train_batch_id: 750, avg_cost: 3.8679611682891846
grad_norm: 1.907297158432476, clipped: 1.0
epoch: 82, train_batch_id: 800, avg_cost: 3.898678779602051
grad_norm: 4.51730069323758, clipped: 1.0
epoch: 82, train_batch_id: 850, avg_cost: 3.8799705505371094
grad_norm: 2.364348562844736, clipped: 1.0
epoch: 82, train_batch_id: 900, avg_cost: 3.866173267364502
grad_norm: 1.8337185964278915, clipped: 1.0
epoch: 82, train_batch_id: 950, avg_cost: 3.8806910514831543
grad_norm: 2.287530627747528, clipped: 1.0
epoch: 82, train_batch_id: 1000, avg_cost: 3.8727879524230957
grad_norm: 1.8817330454633159, clipped: 1.0
epoch: 82, train_batch_id: 1050, avg_cost: 3.869521141052246
grad_norm: 3.0154512692890405, clipped: 1.0
epoch: 82, train_batch_id: 1100, avg_cost: 3.889031171798706
grad_norm: 2.4725697144607923, clipped: 1.0
epoch: 82, train_batch_id: 1150, avg_cost: 3.8845419883728027
grad_norm: 1.2712412885343813, clipped: 1.0
epoch: 82, train_batch_id: 1200, avg_cost: 3.8661983013153076
grad_norm: 2.1654460921061722, clipped: 1.0
epoch: 82, train_batch_id: 1250, avg_cost: 3.906895637512207
grad_norm: 6.463175767873141, clipped: 1.0
epoch: 82, train_batch_id: 1300, avg_cost: 3.847930669784546
grad_norm: 1.5462721116637486, clipped: 1.0
epoch: 82, train_batch_id: 1350, avg_cost: 3.872507095336914
grad_norm: 1.3128030995902837, clipped: 1.0
epoch: 82, train_batch_id: 1400, avg_cost: 3.854362964630127
grad_norm: 1.6610664531065524, clipped: 1.0
epoch: 82, train_batch_id: 1450, avg_cost: 3.8769936561584473
grad_norm: 3.559829580640995, clipped: 1.0
epoch: 82, train_batch_id: 1500, avg_cost: 3.8866961002349854
grad_norm: 3.930131847216832, clipped: 1.0
epoch: 82, train_batch_id: 1550, avg_cost: 3.8851122856140137
grad_norm: 2.535295430361015, clipped: 1.0
epoch: 82, train_batch_id: 1600, avg_cost: 3.850822925567627
grad_norm: 1.5221659506059153, clipped: 1.0
epoch: 82, train_batch_id: 1650, avg_cost: 3.877211570739746
grad_norm: 3.1092182300765097, clipped: 1.0
epoch: 82, train_batch_id: 1700, avg_cost: 3.8609163761138916
grad_norm: 1.543272724523152, clipped: 1.0
epoch: 82, train_batch_id: 1750, avg_cost: 3.8687033653259277
grad_norm: 1.610988923691021, clipped: 1.0
epoch: 82, train_batch_id: 1800, avg_cost: 3.8877017498016357
grad_norm: 1.5710387293191095, clipped: 1.0
epoch: 82, train_batch_id: 1850, avg_cost: 3.890929937362671
grad_norm: 2.1512435048574483, clipped: 1.0
epoch: 82, train_batch_id: 1900, avg_cost: 3.8741631507873535
grad_norm: 1.4090595577895884, clipped: 1.0
epoch: 82, train_batch_id: 1950, avg_cost: 3.871082305908203
grad_norm: 1.5561977313599837, clipped: 1.0
epoch: 82, train_batch_id: 2000, avg_cost: 3.8921585083007812
grad_norm: 1.8713528986957095, clipped: 1.0
epoch: 82, train_batch_id: 2050, avg_cost: 3.8795084953308105
grad_norm: 1.53436892300095, clipped: 1.0
epoch: 82, train_batch_id: 2100, avg_cost: 3.882120370864868
grad_norm: 2.3362608503041473, clipped: 1.0
epoch: 82, train_batch_id: 2150, avg_cost: 3.880171775817871
grad_norm: 1.5488315191974096, clipped: 1.0
epoch: 82, train_batch_id: 2200, avg_cost: 3.8758163452148438
grad_norm: 1.8083185216368522, clipped: 1.0
epoch: 82, train_batch_id: 2250, avg_cost: 3.8619773387908936
grad_norm: 1.350265835145215, clipped: 1.0
epoch: 82, train_batch_id: 2300, avg_cost: 3.8830723762512207
grad_norm: 1.6975742904818012, clipped: 1.0
epoch: 82, train_batch_id: 2350, avg_cost: 3.8699216842651367
grad_norm: 2.4467925609428347, clipped: 1.0
epoch: 82, train_batch_id: 2400, avg_cost: 3.8618295192718506
grad_norm: 1.3672476162341516, clipped: 1.0
epoch: 82, train_batch_id: 2450, avg_cost: 3.8699958324432373
grad_norm: 1.6686508477228443, clipped: 1.0
Finished epoch 82, took 00:09:33 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.333556175231934 +- 0.004194528330117464
Evaluating candidate model on evaluation dataset
Epoch 82 candidate mean 4.322452545166016, baseline epoch 39 mean 4.126363277435303, difference 0.1960892677307129
Start train epoch 83, lr=0.0001 for run tsp20_attiter3_rollout_20200202T054546
Evaluating baseline on dataset...
342


342


