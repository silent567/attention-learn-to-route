245


{'baseline': 'rollout',
 'batch_size': 512,
 'bl_alpha': 0.05,
 'bl_warmup_epochs': 1,
 'checkpoint_encoder': False,
 'checkpoint_epochs': 1,
 'data_distribution': None,
 'embedding_dim': 128,
 'epoch_size': 1280000,
 'epoch_start': 0,
 'eval_batch_size': 1024,
 'eval_only': False,
 'exp_beta': 0.8,
 'graph_size': 20,
 'hidden_dim': 128,
 'load_path': None,
 'log_dir': 'logs',
 'log_step': 50,
 'lr_critic': 0.0001,
 'lr_decay': 1.0,
 'lr_model': 0.0001,
 'max_grad_norm': 1.0,
 'model': 'attentioniter5',
 'n_encode_layers': 3,
 'n_epochs': 100,
 'no_cuda': False,
 'no_progress_bar': False,
 'no_tensorboard': False,
 'normalization': 'batch',
 'output_dir': 'outputs',
 'problem': 'tsp',
 'resume': None,
 'run_name': 'tsp20_attiter5_rollout_20200202T054549',
 'save_dir': 'outputs/tsp_20/tsp20_attiter5_rollout_20200202T054549',
 'seed': 1234,
 'shrink_size': None,
 'tanh_clipping': 10.0,
 'use_cuda': True,
 'val_dataset': None,
 'val_size': 10000}
Evaluating baseline model on evaluation dataset
Start train epoch 0, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 0, train_batch_id: 0, avg_cost: 9.131672859191895
grad_norm: 85.3595816271947, clipped: 1.0
epoch: 0, train_batch_id: 50, avg_cost: 4.554759979248047
grad_norm: 14.08903897131448, clipped: 1.0
epoch: 0, train_batch_id: 100, avg_cost: 4.25623893737793
grad_norm: 7.313211842761875, clipped: 1.0
epoch: 0, train_batch_id: 150, avg_cost: 4.142577171325684
grad_norm: 5.7614335725991035, clipped: 1.0
epoch: 0, train_batch_id: 200, avg_cost: 4.137018203735352
grad_norm: 5.043941142491394, clipped: 1.0
epoch: 0, train_batch_id: 250, avg_cost: 4.124512672424316
grad_norm: 6.574890971906208, clipped: 1.0
epoch: 0, train_batch_id: 300, avg_cost: 4.068759441375732
grad_norm: 5.333013781889721, clipped: 1.0
epoch: 0, train_batch_id: 350, avg_cost: 4.104841232299805
grad_norm: 4.80934562646166, clipped: 1.0
epoch: 0, train_batch_id: 400, avg_cost: 4.036821365356445
grad_norm: 4.027855601011901, clipped: 1.0
epoch: 0, train_batch_id: 450, avg_cost: 4.04903507232666
grad_norm: 3.337557252677536, clipped: 1.0
epoch: 0, train_batch_id: 500, avg_cost: 4.053000450134277
grad_norm: 4.926097046094013, clipped: 1.0
epoch: 0, train_batch_id: 550, avg_cost: 4.045138835906982
grad_norm: 5.026906676165869, clipped: 1.0
epoch: 0, train_batch_id: 600, avg_cost: 4.034800052642822
grad_norm: 3.970300630062604, clipped: 1.0
epoch: 0, train_batch_id: 650, avg_cost: 4.019681930541992
grad_norm: 4.336184126461831, clipped: 1.0
epoch: 0, train_batch_id: 700, avg_cost: 4.067421913146973
grad_norm: 3.819223962215215, clipped: 1.0
epoch: 0, train_batch_id: 750, avg_cost: 4.043025970458984
grad_norm: 3.9613599076070463, clipped: 1.0
epoch: 0, train_batch_id: 800, avg_cost: 4.046502113342285
grad_norm: 4.403658021736562, clipped: 1.0
epoch: 0, train_batch_id: 850, avg_cost: 4.062329292297363
grad_norm: 4.309677226709434, clipped: 1.0
epoch: 0, train_batch_id: 900, avg_cost: 4.008212089538574
grad_norm: 4.280205084683915, clipped: 1.0
epoch: 0, train_batch_id: 950, avg_cost: 4.03690242767334
grad_norm: 4.241780973893855, clipped: 1.0
epoch: 0, train_batch_id: 1000, avg_cost: 3.992108106613159
grad_norm: 3.171633614631491, clipped: 1.0
epoch: 0, train_batch_id: 1050, avg_cost: 4.005763053894043
grad_norm: 3.5945380511339615, clipped: 1.0
epoch: 0, train_batch_id: 1100, avg_cost: 4.000662803649902
grad_norm: 3.62863263616376, clipped: 1.0
epoch: 0, train_batch_id: 1150, avg_cost: 4.01915979385376
grad_norm: 3.3736676682922826, clipped: 1.0
epoch: 0, train_batch_id: 1200, avg_cost: 3.9861624240875244
grad_norm: 4.0870160266159665, clipped: 1.0
epoch: 0, train_batch_id: 1250, avg_cost: 4.005809783935547
grad_norm: 5.706379158571476, clipped: 1.0
epoch: 0, train_batch_id: 1300, avg_cost: 3.98983097076416
grad_norm: 2.9806831134637592, clipped: 1.0
epoch: 0, train_batch_id: 1350, avg_cost: 4.033684730529785
grad_norm: 5.384180319870202, clipped: 1.0
epoch: 0, train_batch_id: 1400, avg_cost: 4.013472080230713
grad_norm: 3.4544489456773633, clipped: 1.0
epoch: 0, train_batch_id: 1450, avg_cost: 3.983354091644287
grad_norm: 3.572362963683587, clipped: 1.0
epoch: 0, train_batch_id: 1500, avg_cost: 4.014719486236572
grad_norm: 3.4435856500907565, clipped: 1.0
epoch: 0, train_batch_id: 1550, avg_cost: 3.9725394248962402
grad_norm: 3.1225904949051118, clipped: 1.0
epoch: 0, train_batch_id: 1600, avg_cost: 3.9639205932617188
grad_norm: 3.623391598813741, clipped: 1.0
epoch: 0, train_batch_id: 1650, avg_cost: 3.9813551902770996
grad_norm: 4.664181164783217, clipped: 1.0
epoch: 0, train_batch_id: 1700, avg_cost: 3.979532241821289
grad_norm: 2.992696203301385, clipped: 1.0
epoch: 0, train_batch_id: 1750, avg_cost: 3.953470230102539
grad_norm: 3.5564538282558726, clipped: 1.0
epoch: 0, train_batch_id: 1800, avg_cost: 3.9888863563537598
grad_norm: 2.613578761383629, clipped: 1.0
epoch: 0, train_batch_id: 1850, avg_cost: 3.9784393310546875
grad_norm: 3.412549574926961, clipped: 1.0
epoch: 0, train_batch_id: 1900, avg_cost: 3.976527214050293
grad_norm: 2.8112472754192863, clipped: 1.0
epoch: 0, train_batch_id: 1950, avg_cost: 4.000597953796387
grad_norm: 3.2309879878128904, clipped: 1.0
epoch: 0, train_batch_id: 2000, avg_cost: 3.9952642917633057
grad_norm: 2.8204974219241112, clipped: 1.0
epoch: 0, train_batch_id: 2050, avg_cost: 4.006136417388916
grad_norm: 4.305225995893911, clipped: 1.0
epoch: 0, train_batch_id: 2100, avg_cost: 4.002082824707031
grad_norm: 3.394050172753335, clipped: 1.0
epoch: 0, train_batch_id: 2150, avg_cost: 3.970879554748535
grad_norm: 3.3766130590013863, clipped: 1.0
epoch: 0, train_batch_id: 2200, avg_cost: 3.954101800918579
grad_norm: 3.831383447298756, clipped: 1.0
epoch: 0, train_batch_id: 2250, avg_cost: 3.9556727409362793
grad_norm: 3.0858215498447996, clipped: 1.0
epoch: 0, train_batch_id: 2300, avg_cost: 3.986494302749634
grad_norm: 3.7960159341197754, clipped: 1.0
epoch: 0, train_batch_id: 2350, avg_cost: 4.01777458190918
grad_norm: 4.085865588828957, clipped: 1.0
epoch: 0, train_batch_id: 2400, avg_cost: 4.008859634399414
grad_norm: 4.108748139933071, clipped: 1.0
epoch: 0, train_batch_id: 2450, avg_cost: 3.951869010925293
grad_norm: 3.212376393963745, clipped: 1.0
Finished epoch 0, took 00:16:06 s
Saving model and state...
Validating...
Validation overall avg_cost: 5.417165279388428 +- 0.006144751328974962
Evaluating candidate model on evaluation dataset
Epoch 0 candidate mean 5.4198384284973145, baseline epoch 0 mean 7.945488929748535, difference -2.5256505012512207
p-value: 0.0
Update baseline
Evaluating baseline model on evaluation dataset
Set warmup alpha = 1.0
Start train epoch 1, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


171


epoch: 1, train_batch_id: 0, avg_cost: 3.9758362770080566
grad_norm: 9.660799913678128, clipped: 1.0
epoch: 1, train_batch_id: 50, avg_cost: 4.024489879608154
grad_norm: 9.779906689383727, clipped: 1.0
epoch: 1, train_batch_id: 100, avg_cost: 4.022831916809082
grad_norm: 9.379218634002672, clipped: 1.0
epoch: 1, train_batch_id: 150, avg_cost: 4.033591270446777
grad_norm: 10.512718479075025, clipped: 1.0
epoch: 1, train_batch_id: 200, avg_cost: 4.041308879852295
grad_norm: 10.775114860307687, clipped: 1.0
epoch: 1, train_batch_id: 250, avg_cost: 4.108591079711914
grad_norm: 9.444244275590538, clipped: 1.0
epoch: 1, train_batch_id: 300, avg_cost: 4.028201580047607
grad_norm: 11.353442140186356, clipped: 1.0
epoch: 1, train_batch_id: 350, avg_cost: 4.014817237854004
grad_norm: 11.389079299491264, clipped: 1.0
epoch: 1, train_batch_id: 400, avg_cost: 4.034502983093262
grad_norm: 10.420108514548676, clipped: 1.0
epoch: 1, train_batch_id: 450, avg_cost: 4.072782039642334
grad_norm: 9.725471389807637, clipped: 1.0
epoch: 1, train_batch_id: 500, avg_cost: 4.048267364501953
grad_norm: 8.774920160200168, clipped: 1.0
epoch: 1, train_batch_id: 550, avg_cost: 4.048520088195801
grad_norm: 7.392767211654624, clipped: 1.0
epoch: 1, train_batch_id: 600, avg_cost: 4.061775207519531
grad_norm: 8.650468070801075, clipped: 1.0
epoch: 1, train_batch_id: 650, avg_cost: 4.052361965179443
grad_norm: 10.498941033767396, clipped: 1.0
epoch: 1, train_batch_id: 700, avg_cost: 4.05417537689209
grad_norm: 9.651919962082157, clipped: 1.0
epoch: 1, train_batch_id: 750, avg_cost: 4.041949272155762
grad_norm: 9.043136877292891, clipped: 1.0
epoch: 1, train_batch_id: 800, avg_cost: 4.034200668334961
grad_norm: 9.63422496703211, clipped: 1.0
epoch: 1, train_batch_id: 850, avg_cost: 4.068601608276367
grad_norm: 10.450199904589876, clipped: 1.0
epoch: 1, train_batch_id: 900, avg_cost: 4.056177616119385
grad_norm: 7.588019811567779, clipped: 1.0
epoch: 1, train_batch_id: 950, avg_cost: 4.071518421173096
grad_norm: 10.746882860986084, clipped: 1.0
epoch: 1, train_batch_id: 1000, avg_cost: 4.039182662963867
grad_norm: 10.745049979128204, clipped: 1.0
epoch: 1, train_batch_id: 1050, avg_cost: 4.0504350662231445
grad_norm: 9.993217063973084, clipped: 1.0
epoch: 1, train_batch_id: 1100, avg_cost: 4.0791754722595215
grad_norm: 8.948410799968048, clipped: 1.0
epoch: 1, train_batch_id: 1150, avg_cost: 4.034409046173096
grad_norm: 7.134550690268292, clipped: 1.0
epoch: 1, train_batch_id: 1200, avg_cost: 4.031648635864258
grad_norm: 7.986543443310866, clipped: 1.0
epoch: 1, train_batch_id: 1250, avg_cost: 4.044078826904297
grad_norm: 9.259294069848373, clipped: 1.0
epoch: 1, train_batch_id: 1300, avg_cost: 4.0446906089782715
grad_norm: 10.969591011542695, clipped: 1.0
epoch: 1, train_batch_id: 1350, avg_cost: 4.002524375915527
grad_norm: 9.038475652532965, clipped: 1.0
epoch: 1, train_batch_id: 1400, avg_cost: 4.027039051055908
grad_norm: 10.278875999015208, clipped: 1.0
epoch: 1, train_batch_id: 1450, avg_cost: 4.0759124755859375
grad_norm: 10.874458589263385, clipped: 1.0
epoch: 1, train_batch_id: 1500, avg_cost: 4.0413970947265625
grad_norm: 8.345136990417036, clipped: 1.0
epoch: 1, train_batch_id: 1550, avg_cost: 4.0334367752075195
grad_norm: 9.574393569133992, clipped: 1.0
epoch: 1, train_batch_id: 1600, avg_cost: 4.015618324279785
grad_norm: 8.806290348782195, clipped: 1.0
epoch: 1, train_batch_id: 1650, avg_cost: 4.055908203125
grad_norm: 9.392261849608376, clipped: 1.0
epoch: 1, train_batch_id: 1700, avg_cost: 4.066821098327637
grad_norm: 8.731471967572457, clipped: 1.0
epoch: 1, train_batch_id: 1750, avg_cost: 4.067853927612305
grad_norm: 10.116790136079755, clipped: 1.0
epoch: 1, train_batch_id: 1800, avg_cost: 4.075132369995117
grad_norm: 9.370227271988899, clipped: 1.0
epoch: 1, train_batch_id: 1850, avg_cost: 4.100920677185059
grad_norm: 7.779711779518598, clipped: 1.0
epoch: 1, train_batch_id: 1900, avg_cost: 4.066845893859863
grad_norm: 7.48928026453222, clipped: 1.0
epoch: 1, train_batch_id: 1950, avg_cost: 4.074391841888428
grad_norm: 8.557608730136671, clipped: 1.0
epoch: 1, train_batch_id: 2000, avg_cost: 4.051309108734131
grad_norm: 9.224029063241005, clipped: 1.0
epoch: 1, train_batch_id: 2050, avg_cost: 4.018266677856445
grad_norm: 9.798314016120917, clipped: 1.0
epoch: 1, train_batch_id: 2100, avg_cost: 4.050192832946777
grad_norm: 7.637321102533107, clipped: 1.0
epoch: 1, train_batch_id: 2150, avg_cost: 4.05375862121582
grad_norm: 5.583506538079862, clipped: 1.0
epoch: 1, train_batch_id: 2200, avg_cost: 4.032825946807861
grad_norm: 11.281362058958836, clipped: 1.0
epoch: 1, train_batch_id: 2250, avg_cost: 4.120281219482422
grad_norm: 9.845689622747676, clipped: 1.0
epoch: 1, train_batch_id: 2300, avg_cost: 4.090666770935059
grad_norm: 10.292725491276636, clipped: 1.0
epoch: 1, train_batch_id: 2350, avg_cost: 4.024360179901123
grad_norm: 8.540991230042104, clipped: 1.0
epoch: 1, train_batch_id: 2400, avg_cost: 4.035558700561523
grad_norm: 7.609352276992025, clipped: 1.0
epoch: 1, train_batch_id: 2450, avg_cost: 3.99263858795166
grad_norm: 10.27251894966156, clipped: 1.0
Finished epoch 1, took 00:19:48 s
Saving model and state...
Validating...
Validation overall avg_cost: 5.391242980957031 +- 0.006388012319803238
Evaluating candidate model on evaluation dataset
Epoch 1 candidate mean 5.375814437866211, baseline epoch 0 mean 5.418237686157227, difference -0.042423248291015625
p-value: 6.956266226470822e-10
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 2, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 2, train_batch_id: 0, avg_cost: 4.054537773132324
grad_norm: 6.381007354763099, clipped: 1.0
epoch: 2, train_batch_id: 50, avg_cost: 4.083617687225342
grad_norm: 9.478129452538944, clipped: 1.0
epoch: 2, train_batch_id: 100, avg_cost: 4.027223587036133
grad_norm: 7.536433781576278, clipped: 1.0
epoch: 2, train_batch_id: 150, avg_cost: 4.0760674476623535
grad_norm: 7.841643040627211, clipped: 1.0
epoch: 2, train_batch_id: 200, avg_cost: 4.009490966796875
grad_norm: 10.180146354789768, clipped: 1.0
epoch: 2, train_batch_id: 250, avg_cost: 4.087320327758789
grad_norm: 10.688784423829835, clipped: 1.0
epoch: 2, train_batch_id: 300, avg_cost: 4.055797576904297
grad_norm: 6.336717032191136, clipped: 1.0
epoch: 2, train_batch_id: 350, avg_cost: 4.131565093994141
grad_norm: 6.95226446581624, clipped: 1.0
epoch: 2, train_batch_id: 400, avg_cost: 4.038027763366699
grad_norm: 11.229542899206454, clipped: 1.0
epoch: 2, train_batch_id: 450, avg_cost: 4.030816555023193
grad_norm: 8.740541784928991, clipped: 1.0
epoch: 2, train_batch_id: 500, avg_cost: 4.078510284423828
grad_norm: 7.303041877981368, clipped: 1.0
epoch: 2, train_batch_id: 550, avg_cost: 4.004225730895996
grad_norm: 6.947846605004895, clipped: 1.0
epoch: 2, train_batch_id: 600, avg_cost: 4.018879413604736
grad_norm: 9.505172398311908, clipped: 1.0
epoch: 2, train_batch_id: 650, avg_cost: 4.03492546081543
grad_norm: 8.2844414236633, clipped: 1.0
epoch: 2, train_batch_id: 700, avg_cost: 4.0301055908203125
grad_norm: 8.523790960058257, clipped: 1.0
epoch: 2, train_batch_id: 750, avg_cost: 4.076874732971191
grad_norm: 10.650172579400222, clipped: 1.0
epoch: 2, train_batch_id: 800, avg_cost: 4.023475170135498
grad_norm: 10.21836137835039, clipped: 1.0
epoch: 2, train_batch_id: 850, avg_cost: 3.99332332611084
grad_norm: 6.400949139327517, clipped: 1.0
epoch: 2, train_batch_id: 900, avg_cost: 4.038419723510742
grad_norm: 9.582333371096578, clipped: 1.0
epoch: 2, train_batch_id: 950, avg_cost: 4.003122329711914
grad_norm: 7.38836123811864, clipped: 1.0
epoch: 2, train_batch_id: 1000, avg_cost: 3.985060453414917
grad_norm: 7.529737652323374, clipped: 1.0
epoch: 2, train_batch_id: 1050, avg_cost: 4.059377193450928
grad_norm: 8.940294881814514, clipped: 1.0
epoch: 2, train_batch_id: 1100, avg_cost: 4.0663933753967285
grad_norm: 8.760516774565813, clipped: 1.0
epoch: 2, train_batch_id: 1150, avg_cost: 4.006633758544922
grad_norm: 6.510518602032002, clipped: 1.0
epoch: 2, train_batch_id: 1200, avg_cost: 4.036011219024658
grad_norm: 7.966314190450172, clipped: 1.0
epoch: 2, train_batch_id: 1250, avg_cost: 4.020234107971191
grad_norm: 9.51978203624205, clipped: 1.0
epoch: 2, train_batch_id: 1300, avg_cost: 4.011463642120361
grad_norm: 8.531250422597154, clipped: 1.0
epoch: 2, train_batch_id: 1350, avg_cost: 4.017539024353027
grad_norm: 8.105999007726052, clipped: 1.0
epoch: 2, train_batch_id: 1400, avg_cost: 4.046072006225586
grad_norm: 8.074369959862574, clipped: 1.0
epoch: 2, train_batch_id: 1450, avg_cost: 4.047048568725586
grad_norm: 7.919174350769123, clipped: 1.0
epoch: 2, train_batch_id: 1500, avg_cost: 4.089746475219727
grad_norm: 9.017438015088869, clipped: 1.0
epoch: 2, train_batch_id: 1550, avg_cost: 4.045147895812988
grad_norm: 7.56888874259736, clipped: 1.0
epoch: 2, train_batch_id: 1600, avg_cost: 4.068397521972656
grad_norm: 7.325180072220456, clipped: 1.0
epoch: 2, train_batch_id: 1650, avg_cost: 4.033308982849121
grad_norm: 6.966863481156652, clipped: 1.0
epoch: 2, train_batch_id: 1700, avg_cost: 4.052668571472168
grad_norm: 6.037109038885796, clipped: 1.0
epoch: 2, train_batch_id: 1750, avg_cost: 4.093544960021973
grad_norm: 13.555210388763253, clipped: 1.0
epoch: 2, train_batch_id: 1800, avg_cost: 4.049743175506592
grad_norm: 9.52806387832228, clipped: 1.0
epoch: 2, train_batch_id: 1850, avg_cost: 4.008980751037598
grad_norm: 8.088975359241884, clipped: 1.0
epoch: 2, train_batch_id: 1900, avg_cost: 3.998566150665283
grad_norm: 9.187532000849759, clipped: 1.0
epoch: 2, train_batch_id: 1950, avg_cost: 4.029036521911621
grad_norm: 9.267219537845405, clipped: 1.0
epoch: 2, train_batch_id: 2000, avg_cost: 4.013697147369385
grad_norm: 8.148494532802227, clipped: 1.0
epoch: 2, train_batch_id: 2050, avg_cost: 4.044518947601318
grad_norm: 6.689085179664058, clipped: 1.0
epoch: 2, train_batch_id: 2100, avg_cost: 4.049773216247559
grad_norm: 7.544464230409265, clipped: 1.0
epoch: 2, train_batch_id: 2150, avg_cost: 4.078699588775635
grad_norm: 5.997061586833326, clipped: 1.0
epoch: 2, train_batch_id: 2200, avg_cost: 4.0376176834106445
grad_norm: 7.883762282800753, clipped: 1.0
epoch: 2, train_batch_id: 2250, avg_cost: 4.06255578994751
grad_norm: 8.330489397954265, clipped: 1.0
epoch: 2, train_batch_id: 2300, avg_cost: 4.08455753326416
grad_norm: 6.732248760516974, clipped: 1.0
epoch: 2, train_batch_id: 2350, avg_cost: 4.06786584854126
grad_norm: 9.323011324453205, clipped: 1.0
epoch: 2, train_batch_id: 2400, avg_cost: 4.028542518615723
grad_norm: 7.630149853419247, clipped: 1.0
epoch: 2, train_batch_id: 2450, avg_cost: 4.102141857147217
grad_norm: 7.023739378963077, clipped: 1.0
Finished epoch 2, took 00:19:23 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.897959232330322 +- 0.005548820365220308
Evaluating candidate model on evaluation dataset
Epoch 2 candidate mean 4.895264148712158, baseline epoch 1 mean 5.383991718292236, difference -0.4887275695800781
p-value: 0.0
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 3, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 3, train_batch_id: 0, avg_cost: 4.027677536010742
grad_norm: 5.198345986605257, clipped: 1.0
epoch: 3, train_batch_id: 50, avg_cost: 4.021500587463379
grad_norm: 4.505464293074512, clipped: 1.0
epoch: 3, train_batch_id: 100, avg_cost: 4.020760536193848
grad_norm: 6.330675083978253, clipped: 1.0
epoch: 3, train_batch_id: 150, avg_cost: 4.023892402648926
grad_norm: 4.5299301352265156, clipped: 1.0
epoch: 3, train_batch_id: 200, avg_cost: 3.997938871383667
grad_norm: 7.836154432845478, clipped: 1.0
epoch: 3, train_batch_id: 250, avg_cost: 4.0062971115112305
grad_norm: 5.645001626762558, clipped: 1.0
epoch: 3, train_batch_id: 300, avg_cost: 4.020458221435547
grad_norm: 4.734411512315478, clipped: 1.0
epoch: 3, train_batch_id: 350, avg_cost: 4.008373260498047
grad_norm: 6.638940670123045, clipped: 1.0
epoch: 3, train_batch_id: 400, avg_cost: 3.984971284866333
grad_norm: 6.882238076501672, clipped: 1.0
epoch: 3, train_batch_id: 450, avg_cost: 4.0118818283081055
grad_norm: 5.230993005759647, clipped: 1.0
epoch: 3, train_batch_id: 500, avg_cost: 3.9930081367492676
grad_norm: 5.534995236382407, clipped: 1.0
epoch: 3, train_batch_id: 550, avg_cost: 4.010472297668457
grad_norm: 6.023249106107735, clipped: 1.0
epoch: 3, train_batch_id: 600, avg_cost: 4.05461311340332
grad_norm: 6.146109057713357, clipped: 1.0
epoch: 3, train_batch_id: 650, avg_cost: 4.019155979156494
grad_norm: 5.443262664425002, clipped: 1.0
epoch: 3, train_batch_id: 700, avg_cost: 4.0019073486328125
grad_norm: 5.348026797208463, clipped: 1.0
epoch: 3, train_batch_id: 750, avg_cost: 4.035078048706055
grad_norm: 5.590064663193156, clipped: 1.0
epoch: 3, train_batch_id: 800, avg_cost: 4.014500617980957
grad_norm: 4.463749441503142, clipped: 1.0
epoch: 3, train_batch_id: 850, avg_cost: 3.969991683959961
grad_norm: 6.227141372985812, clipped: 1.0
epoch: 3, train_batch_id: 900, avg_cost: 4.017366409301758
grad_norm: 5.428037496489124, clipped: 1.0
epoch: 3, train_batch_id: 950, avg_cost: 3.9984500408172607
grad_norm: 4.526155591001755, clipped: 1.0
epoch: 3, train_batch_id: 1000, avg_cost: 4.012901306152344
grad_norm: 5.614363891920278, clipped: 1.0
epoch: 3, train_batch_id: 1050, avg_cost: 4.006613731384277
grad_norm: 5.0003695763791125, clipped: 1.0
epoch: 3, train_batch_id: 1100, avg_cost: 3.9792823791503906
grad_norm: 4.339010098333482, clipped: 1.0
epoch: 3, train_batch_id: 1150, avg_cost: 3.9925265312194824
grad_norm: 3.8647895307780193, clipped: 1.0
epoch: 3, train_batch_id: 1200, avg_cost: 4.029217720031738
grad_norm: 4.620224282865919, clipped: 1.0
epoch: 3, train_batch_id: 1250, avg_cost: 4.020707130432129
grad_norm: 4.937560789116193, clipped: 1.0
epoch: 3, train_batch_id: 1300, avg_cost: 3.9895548820495605
grad_norm: 5.111014973325041, clipped: 1.0
epoch: 3, train_batch_id: 1350, avg_cost: 3.976658344268799
grad_norm: 5.920428655387758, clipped: 1.0
epoch: 3, train_batch_id: 1400, avg_cost: 4.023777008056641
grad_norm: 6.155008956291085, clipped: 1.0
epoch: 3, train_batch_id: 1450, avg_cost: 4.018027305603027
grad_norm: 5.650886728567672, clipped: 1.0
epoch: 3, train_batch_id: 1500, avg_cost: 3.98349666595459
grad_norm: 5.923193508488857, clipped: 1.0
epoch: 3, train_batch_id: 1550, avg_cost: 4.031257629394531
grad_norm: 6.047693067525519, clipped: 1.0
epoch: 3, train_batch_id: 1600, avg_cost: 4.019928932189941
grad_norm: 7.154916009654169, clipped: 1.0
epoch: 3, train_batch_id: 1650, avg_cost: 4.035283088684082
grad_norm: 6.142482073328754, clipped: 1.0
epoch: 3, train_batch_id: 1700, avg_cost: 4.02609920501709
grad_norm: 6.383936509677702, clipped: 1.0
epoch: 3, train_batch_id: 1750, avg_cost: 4.029842853546143
grad_norm: 5.290374027346949, clipped: 1.0
epoch: 3, train_batch_id: 1800, avg_cost: 4.032440185546875
grad_norm: 4.457716148728767, clipped: 1.0
epoch: 3, train_batch_id: 1850, avg_cost: 4.013941764831543
grad_norm: 4.656715091374421, clipped: 1.0
epoch: 3, train_batch_id: 1900, avg_cost: 4.021426200866699
grad_norm: 5.218234759478565, clipped: 1.0
epoch: 3, train_batch_id: 1950, avg_cost: 3.9904212951660156
grad_norm: 4.925100268983501, clipped: 1.0
epoch: 3, train_batch_id: 2000, avg_cost: 3.972322463989258
grad_norm: 3.9596730685947645, clipped: 1.0
epoch: 3, train_batch_id: 2050, avg_cost: 4.022065162658691
grad_norm: 6.1033169138317, clipped: 1.0
epoch: 3, train_batch_id: 2100, avg_cost: 4.021119594573975
grad_norm: 4.525110774440122, clipped: 1.0
epoch: 3, train_batch_id: 2150, avg_cost: 3.967770576477051
grad_norm: 4.642636609327586, clipped: 1.0
epoch: 3, train_batch_id: 2200, avg_cost: 3.9465630054473877
grad_norm: 4.527107998293412, clipped: 1.0
epoch: 3, train_batch_id: 2250, avg_cost: 3.995999336242676
grad_norm: 6.414144005017674, clipped: 1.0
epoch: 3, train_batch_id: 2300, avg_cost: 4.010566711425781
grad_norm: 5.392409153617459, clipped: 1.0
epoch: 3, train_batch_id: 2350, avg_cost: 4.028407096862793
grad_norm: 5.543220623240743, clipped: 1.0
epoch: 3, train_batch_id: 2400, avg_cost: 3.964550733566284
grad_norm: 5.134698555923877, clipped: 1.0
epoch: 3, train_batch_id: 2450, avg_cost: 4.031669616699219
grad_norm: 5.447494674798435, clipped: 1.0
Finished epoch 3, took 00:19:26 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.7569804191589355 +- 0.005340459756553173
Evaluating candidate model on evaluation dataset
Epoch 3 candidate mean 4.746619701385498, baseline epoch 2 mean 4.900761127471924, difference -0.15414142608642578
p-value: 9.122198150747977e-182
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 4, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


171


epoch: 4, train_batch_id: 0, avg_cost: 3.9898953437805176
grad_norm: 4.287565584409583, clipped: 1.0
epoch: 4, train_batch_id: 50, avg_cost: 3.97812819480896
grad_norm: 4.337735912118823, clipped: 1.0
epoch: 4, train_batch_id: 100, avg_cost: 3.988046646118164
grad_norm: 5.05090094466346, clipped: 1.0
epoch: 4, train_batch_id: 150, avg_cost: 4.027280330657959
grad_norm: 3.841110397355049, clipped: 1.0
epoch: 4, train_batch_id: 200, avg_cost: 3.9797441959381104
grad_norm: 4.198394154695257, clipped: 1.0
epoch: 4, train_batch_id: 250, avg_cost: 3.965230703353882
grad_norm: 5.17541951387145, clipped: 1.0
epoch: 4, train_batch_id: 300, avg_cost: 4.042844772338867
grad_norm: 4.75713375823813, clipped: 1.0
epoch: 4, train_batch_id: 350, avg_cost: 3.965571641921997
grad_norm: 3.8425559078725207, clipped: 1.0
epoch: 4, train_batch_id: 400, avg_cost: 3.9961283206939697
grad_norm: 5.460502568538198, clipped: 1.0
epoch: 4, train_batch_id: 450, avg_cost: 3.965756416320801
grad_norm: 4.735394142728788, clipped: 1.0
epoch: 4, train_batch_id: 500, avg_cost: 3.956186294555664
grad_norm: 6.017820373864989, clipped: 1.0
epoch: 4, train_batch_id: 550, avg_cost: 3.9751625061035156
grad_norm: 4.778929154891756, clipped: 1.0
epoch: 4, train_batch_id: 600, avg_cost: 3.979135036468506
grad_norm: 4.076313882240129, clipped: 1.0
epoch: 4, train_batch_id: 650, avg_cost: 3.993572473526001
grad_norm: 4.4509456363796716, clipped: 1.0
epoch: 4, train_batch_id: 700, avg_cost: 3.974545478820801
grad_norm: 4.844045091714307, clipped: 1.0
epoch: 4, train_batch_id: 750, avg_cost: 3.93033504486084
grad_norm: 4.909165609504828, clipped: 1.0
epoch: 4, train_batch_id: 800, avg_cost: 3.9793648719787598
grad_norm: 3.713883718016408, clipped: 1.0
epoch: 4, train_batch_id: 850, avg_cost: 4.001880645751953
grad_norm: 3.7673252379753284, clipped: 1.0
epoch: 4, train_batch_id: 900, avg_cost: 3.976933002471924
grad_norm: 5.749365871537541, clipped: 1.0
epoch: 4, train_batch_id: 950, avg_cost: 3.9570727348327637
grad_norm: 6.242461513853257, clipped: 1.0
epoch: 4, train_batch_id: 1000, avg_cost: 3.9908218383789062
grad_norm: 4.531569508691474, clipped: 1.0
epoch: 4, train_batch_id: 1050, avg_cost: 3.9926774501800537
grad_norm: 5.890791418885352, clipped: 1.0
epoch: 4, train_batch_id: 1100, avg_cost: 3.9970006942749023
grad_norm: 6.295692778141029, clipped: 1.0
epoch: 4, train_batch_id: 1150, avg_cost: 4.01334810256958
grad_norm: 4.723749111396542, clipped: 1.0
epoch: 4, train_batch_id: 1200, avg_cost: 3.9847402572631836
grad_norm: 4.593995968387701, clipped: 1.0
epoch: 4, train_batch_id: 1250, avg_cost: 3.982419490814209
grad_norm: 3.7865063596543846, clipped: 1.0
epoch: 4, train_batch_id: 1300, avg_cost: 4.00391960144043
grad_norm: 3.770615594512123, clipped: 1.0
epoch: 4, train_batch_id: 1350, avg_cost: 3.97489333152771
grad_norm: 5.515332955692468, clipped: 1.0
epoch: 4, train_batch_id: 1400, avg_cost: 3.9819440841674805
grad_norm: 4.446657348950822, clipped: 1.0
epoch: 4, train_batch_id: 1450, avg_cost: 3.927305221557617
grad_norm: 4.4815801593311, clipped: 1.0
epoch: 4, train_batch_id: 1500, avg_cost: 3.980226516723633
grad_norm: 4.125794793414917, clipped: 1.0
epoch: 4, train_batch_id: 1550, avg_cost: 3.9769229888916016
grad_norm: 4.195363448128646, clipped: 1.0
epoch: 4, train_batch_id: 1600, avg_cost: 3.9774842262268066
grad_norm: 4.684910403807334, clipped: 1.0
epoch: 4, train_batch_id: 1650, avg_cost: 3.9654457569122314
grad_norm: 4.035755790243151, clipped: 1.0
epoch: 4, train_batch_id: 1700, avg_cost: 3.9755425453186035
grad_norm: 5.110026764253193, clipped: 1.0
epoch: 4, train_batch_id: 1750, avg_cost: 3.9574878215789795
grad_norm: 3.3296388763173, clipped: 1.0
epoch: 4, train_batch_id: 1800, avg_cost: 3.9624130725860596
grad_norm: 4.622666112989765, clipped: 1.0
epoch: 4, train_batch_id: 1850, avg_cost: 3.9427032470703125
grad_norm: 5.5334886891000306, clipped: 1.0
epoch: 4, train_batch_id: 1900, avg_cost: 3.965010166168213
grad_norm: 5.06692995456389, clipped: 1.0
epoch: 4, train_batch_id: 1950, avg_cost: 3.979956865310669
grad_norm: 5.25895047058309, clipped: 1.0
epoch: 4, train_batch_id: 2000, avg_cost: 3.99387526512146
grad_norm: 4.19306770357648, clipped: 1.0
epoch: 4, train_batch_id: 2050, avg_cost: 3.9560186862945557
grad_norm: 5.828841442835175, clipped: 1.0
epoch: 4, train_batch_id: 2100, avg_cost: 3.9529213905334473
grad_norm: 4.462774413482452, clipped: 1.0
epoch: 4, train_batch_id: 2150, avg_cost: 3.9946250915527344
grad_norm: 4.244163079885134, clipped: 1.0
epoch: 4, train_batch_id: 2200, avg_cost: 3.994778871536255
grad_norm: 4.371191385038229, clipped: 1.0
epoch: 4, train_batch_id: 2250, avg_cost: 3.977721691131592
grad_norm: 3.743456986565392, clipped: 1.0
epoch: 4, train_batch_id: 2300, avg_cost: 3.9489805698394775
grad_norm: 4.233523044118322, clipped: 1.0
epoch: 4, train_batch_id: 2350, avg_cost: 3.9689905643463135
grad_norm: 4.991545618402685, clipped: 1.0
epoch: 4, train_batch_id: 2400, avg_cost: 3.987098455429077
grad_norm: 5.834797485105969, clipped: 1.0
epoch: 4, train_batch_id: 2450, avg_cost: 3.945594310760498
grad_norm: 3.583490872908498, clipped: 1.0
Finished epoch 4, took 00:19:28 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.687291145324707 +- 0.004907195921987295
Evaluating candidate model on evaluation dataset
Epoch 4 candidate mean 4.684885025024414, baseline epoch 3 mean 4.748108386993408, difference -0.06322336196899414
p-value: 1.2034255054852268e-52
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 5, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 5, train_batch_id: 0, avg_cost: 3.971287727355957
grad_norm: 3.6751491119724515, clipped: 1.0
epoch: 5, train_batch_id: 50, avg_cost: 3.9667935371398926
grad_norm: 3.18290459524783, clipped: 1.0
epoch: 5, train_batch_id: 100, avg_cost: 3.931375503540039
grad_norm: 3.899050298738893, clipped: 1.0
epoch: 5, train_batch_id: 150, avg_cost: 3.988624095916748
grad_norm: 5.309017954061154, clipped: 1.0
epoch: 5, train_batch_id: 200, avg_cost: 3.9770326614379883
grad_norm: 3.789419426627944, clipped: 1.0
epoch: 5, train_batch_id: 250, avg_cost: 4.030489444732666
grad_norm: 4.4490127688508165, clipped: 1.0
epoch: 5, train_batch_id: 300, avg_cost: 3.976799964904785
grad_norm: 3.9259220900723912, clipped: 1.0
epoch: 5, train_batch_id: 350, avg_cost: 3.938730239868164
grad_norm: 4.271331524413338, clipped: 1.0
epoch: 5, train_batch_id: 400, avg_cost: 3.9573655128479004
grad_norm: 3.2268631480817795, clipped: 1.0
epoch: 5, train_batch_id: 450, avg_cost: 3.9498915672302246
grad_norm: 3.962449355634767, clipped: 1.0
epoch: 5, train_batch_id: 500, avg_cost: 3.9827988147735596
grad_norm: 4.163526778250315, clipped: 1.0
epoch: 5, train_batch_id: 550, avg_cost: 3.9796195030212402
grad_norm: 5.850461816898388, clipped: 1.0
epoch: 5, train_batch_id: 600, avg_cost: 3.954298496246338
grad_norm: 4.654715494588588, clipped: 1.0
epoch: 5, train_batch_id: 650, avg_cost: 3.9633193016052246
grad_norm: 4.411195244885965, clipped: 1.0
epoch: 5, train_batch_id: 700, avg_cost: 3.9475221633911133
grad_norm: 3.4981187470279833, clipped: 1.0
epoch: 5, train_batch_id: 750, avg_cost: 3.962667226791382
grad_norm: 3.220362482030021, clipped: 1.0
epoch: 5, train_batch_id: 800, avg_cost: 3.990647792816162
grad_norm: 3.3873851521626595, clipped: 1.0
epoch: 5, train_batch_id: 850, avg_cost: 3.9097793102264404
grad_norm: 3.9904278666951054, clipped: 1.0
epoch: 5, train_batch_id: 900, avg_cost: 3.937439203262329
grad_norm: 3.2416412489695405, clipped: 1.0
epoch: 5, train_batch_id: 950, avg_cost: 3.9559788703918457
grad_norm: 3.3544897838891314, clipped: 1.0
epoch: 5, train_batch_id: 1000, avg_cost: 4.004385948181152
grad_norm: 2.785098321288853, clipped: 1.0
epoch: 5, train_batch_id: 1050, avg_cost: 3.9588019847869873
grad_norm: 3.1828542614386786, clipped: 1.0
epoch: 5, train_batch_id: 1100, avg_cost: 3.9850051403045654
grad_norm: 5.134489285369373, clipped: 1.0
epoch: 5, train_batch_id: 1150, avg_cost: 3.937915325164795
grad_norm: 3.605147947768368, clipped: 1.0
epoch: 5, train_batch_id: 1200, avg_cost: 3.9591479301452637
grad_norm: 4.256690429045926, clipped: 1.0
epoch: 5, train_batch_id: 1250, avg_cost: 3.983729839324951
grad_norm: 4.2858270671042655, clipped: 1.0
epoch: 5, train_batch_id: 1300, avg_cost: 3.977203369140625
grad_norm: 4.161448290079276, clipped: 1.0
epoch: 5, train_batch_id: 1350, avg_cost: 3.9773120880126953
grad_norm: 4.02368538135141, clipped: 1.0
epoch: 5, train_batch_id: 1400, avg_cost: 3.966442584991455
grad_norm: 4.100752517798116, clipped: 1.0
epoch: 5, train_batch_id: 1450, avg_cost: 3.965177059173584
grad_norm: 6.208948575024701, clipped: 1.0
epoch: 5, train_batch_id: 1500, avg_cost: 3.9835219383239746
grad_norm: 3.7077853189416707, clipped: 1.0
epoch: 5, train_batch_id: 1550, avg_cost: 3.9682564735412598
grad_norm: 3.203968268806739, clipped: 1.0
epoch: 5, train_batch_id: 1600, avg_cost: 3.9471893310546875
grad_norm: 4.499676657588825, clipped: 1.0
epoch: 5, train_batch_id: 1650, avg_cost: 3.955536127090454
grad_norm: 3.365520095669621, clipped: 1.0
epoch: 5, train_batch_id: 1700, avg_cost: 3.9605510234832764
grad_norm: 3.6312700040310144, clipped: 1.0
epoch: 5, train_batch_id: 1750, avg_cost: 3.9503226280212402
grad_norm: 4.965577950874501, clipped: 1.0
epoch: 5, train_batch_id: 1800, avg_cost: 3.97459077835083
grad_norm: 4.272553948119644, clipped: 1.0
epoch: 5, train_batch_id: 1850, avg_cost: 3.9523019790649414
grad_norm: 3.620527872412906, clipped: 1.0
epoch: 5, train_batch_id: 1900, avg_cost: 3.9625065326690674
grad_norm: 4.854801844585057, clipped: 1.0
epoch: 5, train_batch_id: 1950, avg_cost: 3.9613571166992188
grad_norm: 4.88881951895015, clipped: 1.0
epoch: 5, train_batch_id: 2000, avg_cost: 3.941257953643799
grad_norm: 3.523854102445279, clipped: 1.0
epoch: 5, train_batch_id: 2050, avg_cost: 3.9518203735351562
grad_norm: 4.5787249009863356, clipped: 1.0
epoch: 5, train_batch_id: 2100, avg_cost: 3.972580671310425
grad_norm: 6.084462727076051, clipped: 1.0
epoch: 5, train_batch_id: 2150, avg_cost: 3.9628946781158447
grad_norm: 3.771156339912292, clipped: 1.0
epoch: 5, train_batch_id: 2200, avg_cost: 3.9645228385925293
grad_norm: 3.8345371928685172, clipped: 1.0
epoch: 5, train_batch_id: 2250, avg_cost: 3.9571895599365234
grad_norm: 5.12483711693963, clipped: 1.0
epoch: 5, train_batch_id: 2300, avg_cost: 3.933164119720459
grad_norm: 4.396484130395885, clipped: 1.0
epoch: 5, train_batch_id: 2350, avg_cost: 3.9641685485839844
grad_norm: 4.178430368022551, clipped: 1.0
epoch: 5, train_batch_id: 2400, avg_cost: 3.9704337120056152
grad_norm: 4.214364961639727, clipped: 1.0
epoch: 5, train_batch_id: 2450, avg_cost: 3.95930552482605
grad_norm: 3.667492567206865, clipped: 1.0
Finished epoch 5, took 00:19:30 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.761897087097168 +- 0.00502673489972949
Evaluating candidate model on evaluation dataset
Epoch 5 candidate mean 4.7580437660217285, baseline epoch 4 mean 4.68769645690918, difference 0.07034730911254883
Start train epoch 6, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


171


epoch: 6, train_batch_id: 0, avg_cost: 3.9391942024230957
grad_norm: 5.842519208757636, clipped: 1.0
epoch: 6, train_batch_id: 50, avg_cost: 3.937918186187744
grad_norm: 5.580168306596874, clipped: 1.0
epoch: 6, train_batch_id: 100, avg_cost: 3.996096134185791
grad_norm: 6.357992607601512, clipped: 1.0
epoch: 6, train_batch_id: 150, avg_cost: 3.975031852722168
grad_norm: 4.901436362344203, clipped: 1.0
epoch: 6, train_batch_id: 200, avg_cost: 3.9611122608184814
grad_norm: 4.524576169741887, clipped: 1.0
epoch: 6, train_batch_id: 250, avg_cost: 3.9745640754699707
grad_norm: 3.6366248350400165, clipped: 1.0
epoch: 6, train_batch_id: 300, avg_cost: 3.9605751037597656
grad_norm: 3.9470295899436048, clipped: 1.0
epoch: 6, train_batch_id: 350, avg_cost: 3.953014373779297
grad_norm: 3.0298123066988425, clipped: 1.0
epoch: 6, train_batch_id: 400, avg_cost: 3.916978120803833
grad_norm: 3.853591528262814, clipped: 1.0
epoch: 6, train_batch_id: 450, avg_cost: 3.9957635402679443
grad_norm: 3.800458043302255, clipped: 1.0
epoch: 6, train_batch_id: 500, avg_cost: 3.9619359970092773
grad_norm: 3.533412938212415, clipped: 1.0
epoch: 6, train_batch_id: 550, avg_cost: 3.9441137313842773
grad_norm: 4.026538356998735, clipped: 1.0
epoch: 6, train_batch_id: 600, avg_cost: 3.9582159519195557
grad_norm: 5.677898781893185, clipped: 1.0
epoch: 6, train_batch_id: 650, avg_cost: 3.9325289726257324
grad_norm: 4.7387220495588105, clipped: 1.0
epoch: 6, train_batch_id: 700, avg_cost: 3.9381847381591797
grad_norm: 3.655510668539132, clipped: 1.0
epoch: 6, train_batch_id: 750, avg_cost: 3.95106840133667
grad_norm: 3.7910541814717775, clipped: 1.0
epoch: 6, train_batch_id: 800, avg_cost: 3.9299867153167725
grad_norm: 4.432492652646954, clipped: 1.0
epoch: 6, train_batch_id: 850, avg_cost: 3.929314613342285
grad_norm: 3.2703312137711227, clipped: 1.0
epoch: 6, train_batch_id: 900, avg_cost: 3.9467453956604004
grad_norm: 3.8282587164862676, clipped: 1.0
epoch: 6, train_batch_id: 950, avg_cost: 3.9641149044036865
grad_norm: 3.4740946915735096, clipped: 1.0
epoch: 6, train_batch_id: 1000, avg_cost: 3.9615638256073
grad_norm: 4.017758561690906, clipped: 1.0
epoch: 6, train_batch_id: 1050, avg_cost: 3.9631190299987793
grad_norm: 3.647096753516767, clipped: 1.0
epoch: 6, train_batch_id: 1100, avg_cost: 3.95371413230896
grad_norm: 4.596660830143835, clipped: 1.0
epoch: 6, train_batch_id: 1150, avg_cost: 3.9346365928649902
grad_norm: 4.444930597017005, clipped: 1.0
epoch: 6, train_batch_id: 1200, avg_cost: 3.9788103103637695
grad_norm: 3.7889750957425505, clipped: 1.0
epoch: 6, train_batch_id: 1250, avg_cost: 3.9629530906677246
grad_norm: 4.052381619362937, clipped: 1.0
epoch: 6, train_batch_id: 1300, avg_cost: 3.957719564437866
grad_norm: 4.304550661673468, clipped: 1.0
epoch: 6, train_batch_id: 1350, avg_cost: 3.9590773582458496
grad_norm: 4.522181572176076, clipped: 1.0
epoch: 6, train_batch_id: 1400, avg_cost: 3.9419212341308594
grad_norm: 3.623807502598778, clipped: 1.0
epoch: 6, train_batch_id: 1450, avg_cost: 3.9698216915130615
grad_norm: 4.6760939310708975, clipped: 1.0
epoch: 6, train_batch_id: 1500, avg_cost: 3.956252098083496
grad_norm: 3.6640653197405024, clipped: 1.0
epoch: 6, train_batch_id: 1550, avg_cost: 3.94096040725708
grad_norm: 4.329603801589263, clipped: 1.0
epoch: 6, train_batch_id: 1600, avg_cost: 3.963446617126465
grad_norm: 3.7947422260768744, clipped: 1.0
epoch: 6, train_batch_id: 1650, avg_cost: 3.9639387130737305
grad_norm: 4.0428323284092915, clipped: 1.0
epoch: 6, train_batch_id: 1700, avg_cost: 3.9275963306427
grad_norm: 5.144176004483149, clipped: 1.0
epoch: 6, train_batch_id: 1750, avg_cost: 3.9294090270996094
grad_norm: 5.8449481598357, clipped: 1.0
epoch: 6, train_batch_id: 1800, avg_cost: 3.921809196472168
grad_norm: 4.094999911557517, clipped: 1.0
epoch: 6, train_batch_id: 1850, avg_cost: 3.978367567062378
grad_norm: 5.46181047431754, clipped: 1.0
epoch: 6, train_batch_id: 1900, avg_cost: 3.95013427734375
grad_norm: 4.8319901712885125, clipped: 1.0
epoch: 6, train_batch_id: 1950, avg_cost: 3.975170373916626
grad_norm: 4.949882236123445, clipped: 1.0
epoch: 6, train_batch_id: 2000, avg_cost: 3.941270589828491
grad_norm: 3.642458213517362, clipped: 1.0
epoch: 6, train_batch_id: 2050, avg_cost: 3.9512767791748047
grad_norm: 5.011647026228277, clipped: 1.0
epoch: 6, train_batch_id: 2100, avg_cost: 3.949862003326416
grad_norm: 5.1811926795251, clipped: 1.0
epoch: 6, train_batch_id: 2150, avg_cost: 3.9446165561676025
grad_norm: 3.6463948606031207, clipped: 1.0
epoch: 6, train_batch_id: 2200, avg_cost: 3.998635768890381
grad_norm: 4.189094484892623, clipped: 1.0
epoch: 6, train_batch_id: 2250, avg_cost: 3.937324047088623
grad_norm: 6.591017913582146, clipped: 1.0
epoch: 6, train_batch_id: 2300, avg_cost: 3.9579973220825195
grad_norm: 4.31664728700873, clipped: 1.0
epoch: 6, train_batch_id: 2350, avg_cost: 3.946354389190674
grad_norm: 4.170932707220668, clipped: 1.0
epoch: 6, train_batch_id: 2400, avg_cost: 3.929936408996582
grad_norm: 3.723105044819474, clipped: 1.0
epoch: 6, train_batch_id: 2450, avg_cost: 3.974246025085449
grad_norm: 2.9458860262775097, clipped: 1.0
Finished epoch 6, took 00:19:22 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.518932819366455 +- 0.004740373231470585
Evaluating candidate model on evaluation dataset
Epoch 6 candidate mean 4.517668724060059, baseline epoch 4 mean 4.68769645690918, difference -0.1700277328491211
p-value: 9.770013379325077e-286
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 7, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 7, train_batch_id: 0, avg_cost: 3.9446096420288086
grad_norm: 3.088476597202982, clipped: 1.0
epoch: 7, train_batch_id: 50, avg_cost: 3.9838805198669434
grad_norm: 3.6149000972780625, clipped: 1.0
epoch: 7, train_batch_id: 100, avg_cost: 3.987541675567627
grad_norm: 3.557177694153261, clipped: 1.0
epoch: 7, train_batch_id: 150, avg_cost: 3.94431734085083
grad_norm: 4.320151887638575, clipped: 1.0
epoch: 7, train_batch_id: 200, avg_cost: 3.946547031402588
grad_norm: 3.289252913024058, clipped: 1.0
epoch: 7, train_batch_id: 250, avg_cost: 3.9325833320617676
grad_norm: 2.7106333911825007, clipped: 1.0
epoch: 7, train_batch_id: 300, avg_cost: 3.98307204246521
grad_norm: 3.8706473204720515, clipped: 1.0
epoch: 7, train_batch_id: 350, avg_cost: 3.935218334197998
grad_norm: 2.8487794069211603, clipped: 1.0
epoch: 7, train_batch_id: 400, avg_cost: 3.940164804458618
grad_norm: 2.909669339161872, clipped: 1.0
epoch: 7, train_batch_id: 450, avg_cost: 3.940624475479126
grad_norm: 3.5537770444482826, clipped: 1.0
epoch: 7, train_batch_id: 500, avg_cost: 3.9624805450439453
grad_norm: 3.7369968838611864, clipped: 1.0
epoch: 7, train_batch_id: 550, avg_cost: 3.935447931289673
grad_norm: 3.6842178902140685, clipped: 1.0
epoch: 7, train_batch_id: 600, avg_cost: 3.9428234100341797
grad_norm: 3.9020067531225684, clipped: 1.0
epoch: 7, train_batch_id: 650, avg_cost: 3.949312448501587
grad_norm: 3.348205323587021, clipped: 1.0
epoch: 7, train_batch_id: 700, avg_cost: 3.993041515350342
grad_norm: 2.9455676883392634, clipped: 1.0
epoch: 7, train_batch_id: 750, avg_cost: 3.9347457885742188
grad_norm: 4.7428978391549705, clipped: 1.0
epoch: 7, train_batch_id: 800, avg_cost: 3.9323694705963135
grad_norm: 3.839644201899887, clipped: 1.0
epoch: 7, train_batch_id: 850, avg_cost: 3.9336929321289062
grad_norm: 2.471810991443281, clipped: 1.0
epoch: 7, train_batch_id: 900, avg_cost: 3.955880880355835
grad_norm: 3.375443154717046, clipped: 1.0
epoch: 7, train_batch_id: 950, avg_cost: 3.9547014236450195
grad_norm: 4.159639138463728, clipped: 1.0
epoch: 7, train_batch_id: 1000, avg_cost: 3.9330081939697266
grad_norm: 3.9599216375930584, clipped: 1.0
epoch: 7, train_batch_id: 1050, avg_cost: 3.9452672004699707
grad_norm: 2.426868867981256, clipped: 1.0
epoch: 7, train_batch_id: 1100, avg_cost: 3.934034824371338
grad_norm: 4.024495733381827, clipped: 1.0
epoch: 7, train_batch_id: 1150, avg_cost: 3.968109130859375
grad_norm: 2.3641017658904233, clipped: 1.0
epoch: 7, train_batch_id: 1200, avg_cost: 3.9453113079071045
grad_norm: 3.1356945678678296, clipped: 1.0
epoch: 7, train_batch_id: 1250, avg_cost: 3.936905860900879
grad_norm: 4.064231665212305, clipped: 1.0
epoch: 7, train_batch_id: 1300, avg_cost: 3.9313862323760986
grad_norm: 4.655066595022057, clipped: 1.0
epoch: 7, train_batch_id: 1350, avg_cost: 3.9361181259155273
grad_norm: 3.529771617839503, clipped: 1.0
epoch: 7, train_batch_id: 1400, avg_cost: 3.9381017684936523
grad_norm: 3.2985145197424677, clipped: 1.0
epoch: 7, train_batch_id: 1450, avg_cost: 3.941314220428467
grad_norm: 2.660704997398085, clipped: 1.0
epoch: 7, train_batch_id: 1500, avg_cost: 3.9623615741729736
grad_norm: 2.9602414819777607, clipped: 1.0
epoch: 7, train_batch_id: 1550, avg_cost: 3.95078706741333
grad_norm: 3.6753371085008584, clipped: 1.0
epoch: 7, train_batch_id: 1600, avg_cost: 3.92702054977417
grad_norm: 3.286141064959343, clipped: 1.0
epoch: 7, train_batch_id: 1650, avg_cost: 3.968733549118042
grad_norm: 2.9139411312435235, clipped: 1.0
epoch: 7, train_batch_id: 1700, avg_cost: 3.975864887237549
grad_norm: 2.651469543374283, clipped: 1.0
epoch: 7, train_batch_id: 1750, avg_cost: 3.964165210723877
grad_norm: 2.841514371789896, clipped: 1.0
epoch: 7, train_batch_id: 1800, avg_cost: 3.9744873046875
grad_norm: 3.5899394045850297, clipped: 1.0
epoch: 7, train_batch_id: 1850, avg_cost: 3.9298269748687744
grad_norm: 3.5381786967728246, clipped: 1.0
epoch: 7, train_batch_id: 1900, avg_cost: 3.9441771507263184
grad_norm: 3.3649437637190336, clipped: 1.0
epoch: 7, train_batch_id: 1950, avg_cost: 3.9956905841827393
grad_norm: 3.086760933160826, clipped: 1.0
epoch: 7, train_batch_id: 2000, avg_cost: 3.9716286659240723
grad_norm: 3.105546327832801, clipped: 1.0
epoch: 7, train_batch_id: 2050, avg_cost: 3.9518752098083496
grad_norm: 3.3121049432554974, clipped: 1.0
epoch: 7, train_batch_id: 2100, avg_cost: 3.9649150371551514
grad_norm: 2.7140852478993476, clipped: 1.0
epoch: 7, train_batch_id: 2150, avg_cost: 3.941071033477783
grad_norm: 4.278400071296934, clipped: 1.0
epoch: 7, train_batch_id: 2200, avg_cost: 3.938410758972168
grad_norm: 3.1086138896039355, clipped: 1.0
epoch: 7, train_batch_id: 2250, avg_cost: 3.972550392150879
grad_norm: 3.285227923054887, clipped: 1.0
epoch: 7, train_batch_id: 2300, avg_cost: 3.9195117950439453
grad_norm: 2.482570696834479, clipped: 1.0
epoch: 7, train_batch_id: 2350, avg_cost: 3.9418392181396484
grad_norm: 3.933460958409822, clipped: 1.0
epoch: 7, train_batch_id: 2400, avg_cost: 3.9611072540283203
grad_norm: 3.694735492342881, clipped: 1.0
epoch: 7, train_batch_id: 2450, avg_cost: 3.9553093910217285
grad_norm: 3.2964821062282494, clipped: 1.0
Finished epoch 7, took 00:19:24 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.486362457275391 +- 0.004255125764757395
Evaluating candidate model on evaluation dataset
Epoch 7 candidate mean 4.485571384429932, baseline epoch 6 mean 4.5153656005859375, difference -0.02979421615600586
p-value: 3.662044179383559e-13
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 8, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


171


epoch: 8, train_batch_id: 0, avg_cost: 3.9409914016723633
grad_norm: 3.0636257785301333, clipped: 1.0
epoch: 8, train_batch_id: 50, avg_cost: 3.9293477535247803
grad_norm: 3.2405317035716443, clipped: 1.0
epoch: 8, train_batch_id: 100, avg_cost: 3.970076084136963
grad_norm: 3.113576244825475, clipped: 1.0
epoch: 8, train_batch_id: 150, avg_cost: 3.9583449363708496
grad_norm: 3.3110440091074116, clipped: 1.0
epoch: 8, train_batch_id: 200, avg_cost: 3.9509618282318115
grad_norm: 2.6586840984358187, clipped: 1.0
epoch: 8, train_batch_id: 250, avg_cost: 3.944833278656006
grad_norm: 3.1606184119597422, clipped: 1.0
epoch: 8, train_batch_id: 300, avg_cost: 3.9356143474578857
grad_norm: 3.611162129548108, clipped: 1.0
epoch: 8, train_batch_id: 350, avg_cost: 3.9572787284851074
grad_norm: 3.0897470368293427, clipped: 1.0
epoch: 8, train_batch_id: 400, avg_cost: 3.9314093589782715
grad_norm: 3.9324886456947308, clipped: 1.0
epoch: 8, train_batch_id: 450, avg_cost: 3.9536099433898926
grad_norm: 2.7124290105455757, clipped: 1.0
epoch: 8, train_batch_id: 500, avg_cost: 3.9429244995117188
grad_norm: 3.096379878991674, clipped: 1.0
epoch: 8, train_batch_id: 550, avg_cost: 3.935359477996826
grad_norm: 2.976873259168945, clipped: 1.0
epoch: 8, train_batch_id: 600, avg_cost: 3.9542531967163086
grad_norm: 3.5301796572976687, clipped: 1.0
epoch: 8, train_batch_id: 650, avg_cost: 3.940624475479126
grad_norm: 3.7169033941065286, clipped: 1.0
epoch: 8, train_batch_id: 700, avg_cost: 3.9048404693603516
grad_norm: 3.153239078905944, clipped: 1.0
epoch: 8, train_batch_id: 750, avg_cost: 3.914621591567993
grad_norm: 3.5552715506154957, clipped: 1.0
epoch: 8, train_batch_id: 800, avg_cost: 3.9458205699920654
grad_norm: 3.591650572388405, clipped: 1.0
epoch: 8, train_batch_id: 850, avg_cost: 3.918808698654175
grad_norm: 3.1732311459352527, clipped: 1.0
epoch: 8, train_batch_id: 900, avg_cost: 3.9409594535827637
grad_norm: 3.1493115718321154, clipped: 1.0
epoch: 8, train_batch_id: 950, avg_cost: 3.9551644325256348
grad_norm: 3.409394731784364, clipped: 1.0
epoch: 8, train_batch_id: 1000, avg_cost: 3.936084270477295
grad_norm: 2.6584642194229526, clipped: 1.0
epoch: 8, train_batch_id: 1050, avg_cost: 3.9532504081726074
grad_norm: 3.02778929033355, clipped: 1.0
epoch: 8, train_batch_id: 1100, avg_cost: 3.9337782859802246
grad_norm: 3.3410332877413893, clipped: 1.0
epoch: 8, train_batch_id: 1150, avg_cost: 3.927175760269165
grad_norm: 2.8077702487913503, clipped: 1.0
epoch: 8, train_batch_id: 1200, avg_cost: 3.9255168437957764
grad_norm: 3.235468245349439, clipped: 1.0
epoch: 8, train_batch_id: 1250, avg_cost: 3.893866539001465
grad_norm: 3.370620428004497, clipped: 1.0
epoch: 8, train_batch_id: 1300, avg_cost: 3.9778316020965576
grad_norm: 3.1454117809578395, clipped: 1.0
epoch: 8, train_batch_id: 1350, avg_cost: 3.9256463050842285
grad_norm: 2.9022865418718653, clipped: 1.0
epoch: 8, train_batch_id: 1400, avg_cost: 3.9403154850006104
grad_norm: 2.2600652136743373, clipped: 1.0
epoch: 8, train_batch_id: 1450, avg_cost: 3.915576934814453
grad_norm: 2.0619857827151074, clipped: 1.0
epoch: 8, train_batch_id: 1500, avg_cost: 3.930710792541504
grad_norm: 2.9397054785922894, clipped: 1.0
epoch: 8, train_batch_id: 1550, avg_cost: 3.955258369445801
grad_norm: 3.2475582125577147, clipped: 1.0
epoch: 8, train_batch_id: 1600, avg_cost: 3.9326324462890625
grad_norm: 3.6669734994800467, clipped: 1.0
epoch: 8, train_batch_id: 1650, avg_cost: 3.9523539543151855
grad_norm: 2.7253134069147555, clipped: 1.0
epoch: 8, train_batch_id: 1700, avg_cost: 3.9403014183044434
grad_norm: 3.214346865790035, clipped: 1.0
epoch: 8, train_batch_id: 1750, avg_cost: 3.9575681686401367
grad_norm: 2.946844164566296, clipped: 1.0
epoch: 8, train_batch_id: 1800, avg_cost: 3.9279391765594482
grad_norm: 4.6895974021353135, clipped: 1.0
epoch: 8, train_batch_id: 1850, avg_cost: 3.9329445362091064
grad_norm: 3.4134625878645073, clipped: 1.0
epoch: 8, train_batch_id: 1900, avg_cost: 3.929701328277588
grad_norm: 2.2417503452758614, clipped: 1.0
epoch: 8, train_batch_id: 1950, avg_cost: 3.9592483043670654
grad_norm: 2.6132191546144665, clipped: 1.0
epoch: 8, train_batch_id: 2000, avg_cost: 3.9368343353271484
grad_norm: 3.2728672948180675, clipped: 1.0
epoch: 8, train_batch_id: 2050, avg_cost: 3.936631679534912
grad_norm: 3.617394015046209, clipped: 1.0
epoch: 8, train_batch_id: 2100, avg_cost: 3.947960376739502
grad_norm: 3.874464443106665, clipped: 1.0
epoch: 8, train_batch_id: 2150, avg_cost: 3.9423208236694336
grad_norm: 2.8620293665517913, clipped: 1.0
epoch: 8, train_batch_id: 2200, avg_cost: 3.9243178367614746
grad_norm: 2.5641794431463047, clipped: 1.0
epoch: 8, train_batch_id: 2250, avg_cost: 3.950798273086548
grad_norm: 2.5033977718080918, clipped: 1.0
epoch: 8, train_batch_id: 2300, avg_cost: 3.9283175468444824
grad_norm: 2.773554955063048, clipped: 1.0
epoch: 8, train_batch_id: 2350, avg_cost: 3.924085855484009
grad_norm: 2.7132256284761995, clipped: 1.0
epoch: 8, train_batch_id: 2400, avg_cost: 3.9317944049835205
grad_norm: 2.657476372181475, clipped: 1.0
epoch: 8, train_batch_id: 2450, avg_cost: 3.937720775604248
grad_norm: 2.64074681799215, clipped: 1.0
Finished epoch 8, took 00:19:27 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.613671779632568 +- 0.004998480435460806
Evaluating candidate model on evaluation dataset
Epoch 8 candidate mean 4.61004114151001, baseline epoch 7 mean 4.493778705596924, difference 0.11626243591308594
Start train epoch 9, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 9, train_batch_id: 0, avg_cost: 3.9676294326782227
grad_norm: 3.1968143421264315, clipped: 1.0
epoch: 9, train_batch_id: 50, avg_cost: 3.9258697032928467
grad_norm: 2.7563862299453783, clipped: 1.0
epoch: 9, train_batch_id: 100, avg_cost: 3.919144630432129
grad_norm: 2.6232920973878557, clipped: 1.0
epoch: 9, train_batch_id: 150, avg_cost: 3.951878309249878
grad_norm: 2.8132163526851497, clipped: 1.0
epoch: 9, train_batch_id: 200, avg_cost: 3.914165496826172
grad_norm: 2.6529300239705, clipped: 1.0
epoch: 9, train_batch_id: 250, avg_cost: 3.9470298290252686
grad_norm: 2.980068598278174, clipped: 1.0
epoch: 9, train_batch_id: 300, avg_cost: 3.947373628616333
grad_norm: 3.1883658194338675, clipped: 1.0
epoch: 9, train_batch_id: 350, avg_cost: 3.9229931831359863
grad_norm: 3.293725031729648, clipped: 1.0
epoch: 9, train_batch_id: 400, avg_cost: 3.916346549987793
grad_norm: 2.911182217070395, clipped: 1.0
epoch: 9, train_batch_id: 450, avg_cost: 3.9404609203338623
grad_norm: 3.5077318716606416, clipped: 1.0
epoch: 9, train_batch_id: 500, avg_cost: 3.949918270111084
grad_norm: 2.909426195752017, clipped: 1.0
epoch: 9, train_batch_id: 550, avg_cost: 3.952962875366211
grad_norm: 3.734095547998671, clipped: 1.0
epoch: 9, train_batch_id: 600, avg_cost: 3.9408059120178223
grad_norm: 2.81050056789252, clipped: 1.0
epoch: 9, train_batch_id: 650, avg_cost: 3.935697317123413
grad_norm: 2.7362630057315953, clipped: 1.0
epoch: 9, train_batch_id: 700, avg_cost: 3.9215400218963623
grad_norm: 3.2361615842712927, clipped: 1.0
epoch: 9, train_batch_id: 750, avg_cost: 3.9300265312194824
grad_norm: 3.46945648506778, clipped: 1.0
epoch: 9, train_batch_id: 800, avg_cost: 3.915006637573242
grad_norm: 3.159282882445386, clipped: 1.0
epoch: 9, train_batch_id: 850, avg_cost: 3.9275407791137695
grad_norm: 3.703473993189519, clipped: 1.0
epoch: 9, train_batch_id: 900, avg_cost: 3.950502634048462
grad_norm: 4.006553786508247, clipped: 1.0
epoch: 9, train_batch_id: 950, avg_cost: 3.940600872039795
grad_norm: 2.82577876670256, clipped: 1.0
epoch: 9, train_batch_id: 1000, avg_cost: 3.9159369468688965
grad_norm: 4.431496794068762, clipped: 1.0
epoch: 9, train_batch_id: 1050, avg_cost: 3.9576380252838135
grad_norm: 3.099600047333589, clipped: 1.0
epoch: 9, train_batch_id: 1100, avg_cost: 3.9678611755371094
grad_norm: 3.9874192280886995, clipped: 1.0
epoch: 9, train_batch_id: 1150, avg_cost: 3.938318967819214
grad_norm: 3.482433600306592, clipped: 1.0
epoch: 9, train_batch_id: 1200, avg_cost: 3.93878173828125
grad_norm: 3.516753982184566, clipped: 1.0
epoch: 9, train_batch_id: 1250, avg_cost: 3.92710542678833
grad_norm: 3.748240733878777, clipped: 1.0
epoch: 9, train_batch_id: 1300, avg_cost: 3.936051368713379
grad_norm: 3.003192023690174, clipped: 1.0
epoch: 9, train_batch_id: 1350, avg_cost: 3.918701648712158
grad_norm: 3.7423022037624403, clipped: 1.0
epoch: 9, train_batch_id: 1400, avg_cost: 3.9264450073242188
grad_norm: 3.264375605778209, clipped: 1.0
epoch: 9, train_batch_id: 1450, avg_cost: 3.930715560913086
grad_norm: 2.9234767697564656, clipped: 1.0
epoch: 9, train_batch_id: 1500, avg_cost: 3.920076847076416
grad_norm: 2.518114473450072, clipped: 1.0
epoch: 9, train_batch_id: 1550, avg_cost: 3.9232301712036133
grad_norm: 3.323480180271518, clipped: 1.0
epoch: 9, train_batch_id: 1600, avg_cost: 3.95709228515625
grad_norm: 2.5509461966853775, clipped: 1.0
epoch: 9, train_batch_id: 1650, avg_cost: 3.957662582397461
grad_norm: 4.024519123903024, clipped: 1.0
epoch: 9, train_batch_id: 1700, avg_cost: 3.9527852535247803
grad_norm: 2.6757147870357962, clipped: 1.0
epoch: 9, train_batch_id: 1750, avg_cost: 3.965393543243408
grad_norm: 3.013922674405082, clipped: 1.0
epoch: 9, train_batch_id: 1800, avg_cost: 3.92173433303833
grad_norm: 3.094641496221839, clipped: 1.0
epoch: 9, train_batch_id: 1850, avg_cost: 3.921283483505249
grad_norm: 2.6187287225134526, clipped: 1.0
epoch: 9, train_batch_id: 1900, avg_cost: 3.924006223678589
grad_norm: 3.7092724879084327, clipped: 1.0
epoch: 9, train_batch_id: 1950, avg_cost: 3.9213485717773438
grad_norm: 2.724325641384212, clipped: 1.0
epoch: 9, train_batch_id: 2000, avg_cost: 3.9279937744140625
grad_norm: 3.485958309992917, clipped: 1.0
epoch: 9, train_batch_id: 2050, avg_cost: 3.9457454681396484
grad_norm: 2.4834540355257557, clipped: 1.0
epoch: 9, train_batch_id: 2100, avg_cost: 3.9136805534362793
grad_norm: 2.658836715149418, clipped: 1.0
epoch: 9, train_batch_id: 2150, avg_cost: 3.923164129257202
grad_norm: 3.6151059534640186, clipped: 1.0
epoch: 9, train_batch_id: 2200, avg_cost: 3.9323275089263916
grad_norm: 3.8392719774882567, clipped: 1.0
epoch: 9, train_batch_id: 2250, avg_cost: 3.9678547382354736
grad_norm: 4.249020407449254, clipped: 1.0
epoch: 9, train_batch_id: 2300, avg_cost: 3.908301591873169
grad_norm: 3.5762195555837466, clipped: 1.0
epoch: 9, train_batch_id: 2350, avg_cost: 3.916938304901123
grad_norm: 2.6294212794496996, clipped: 1.0
epoch: 9, train_batch_id: 2400, avg_cost: 3.9356751441955566
grad_norm: 4.013502772583175, clipped: 1.0
epoch: 9, train_batch_id: 2450, avg_cost: 3.9373908042907715
grad_norm: 3.6697585546173963, clipped: 1.0
Finished epoch 9, took 00:19:19 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.39367151260376 +- 0.0042022098787128925
Evaluating candidate model on evaluation dataset
Epoch 9 candidate mean 4.401011943817139, baseline epoch 7 mean 4.493778705596924, difference -0.09276676177978516
p-value: 9.605073193873494e-209
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 10, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


171


epoch: 10, train_batch_id: 0, avg_cost: 3.926571846008301
grad_norm: 2.6541965048758653, clipped: 1.0
epoch: 10, train_batch_id: 50, avg_cost: 3.9124045372009277
grad_norm: 2.5860798351721987, clipped: 1.0
epoch: 10, train_batch_id: 100, avg_cost: 3.929234027862549
grad_norm: 2.990301617551814, clipped: 1.0
epoch: 10, train_batch_id: 150, avg_cost: 3.955136775970459
grad_norm: 3.0671737901102207, clipped: 1.0
epoch: 10, train_batch_id: 200, avg_cost: 3.929043769836426
grad_norm: 3.159495303679539, clipped: 1.0
epoch: 10, train_batch_id: 250, avg_cost: 3.9234259128570557
grad_norm: 3.89638863463318, clipped: 1.0
epoch: 10, train_batch_id: 300, avg_cost: 3.942511558532715
grad_norm: 2.1223712879321432, clipped: 1.0
epoch: 10, train_batch_id: 350, avg_cost: 3.943303108215332
grad_norm: 3.0910402027014503, clipped: 1.0
epoch: 10, train_batch_id: 400, avg_cost: 3.928792953491211
grad_norm: 2.2789988663047884, clipped: 1.0
epoch: 10, train_batch_id: 450, avg_cost: 3.917590618133545
grad_norm: 2.2602768166607796, clipped: 1.0
epoch: 10, train_batch_id: 500, avg_cost: 3.9357733726501465
grad_norm: 3.3593152732900893, clipped: 1.0
epoch: 10, train_batch_id: 550, avg_cost: 3.95141339302063
grad_norm: 2.0899465131335275, clipped: 1.0
epoch: 10, train_batch_id: 600, avg_cost: 3.8996872901916504
grad_norm: 2.543959279817905, clipped: 1.0
epoch: 10, train_batch_id: 650, avg_cost: 3.960636854171753
grad_norm: 3.443260143775015, clipped: 1.0
epoch: 10, train_batch_id: 700, avg_cost: 3.9470198154449463
grad_norm: 2.9862780316875033, clipped: 1.0
epoch: 10, train_batch_id: 750, avg_cost: 3.915628671646118
grad_norm: 2.9722608271023376, clipped: 1.0
epoch: 10, train_batch_id: 800, avg_cost: 3.9217050075531006
grad_norm: 3.5222301337609903, clipped: 1.0
epoch: 10, train_batch_id: 850, avg_cost: 3.922380208969116
grad_norm: 2.987328784111885, clipped: 1.0
epoch: 10, train_batch_id: 900, avg_cost: 3.914466381072998
grad_norm: 3.1346077990084886, clipped: 1.0
epoch: 10, train_batch_id: 950, avg_cost: 3.938497304916382
grad_norm: 2.4477409626139517, clipped: 1.0
epoch: 10, train_batch_id: 1000, avg_cost: 3.9328200817108154
grad_norm: 2.9397838472489983, clipped: 1.0
epoch: 10, train_batch_id: 1050, avg_cost: 3.9283552169799805
grad_norm: 2.312568121394288, clipped: 1.0
epoch: 10, train_batch_id: 1100, avg_cost: 3.9122800827026367
grad_norm: 3.1306980868947445, clipped: 1.0
epoch: 10, train_batch_id: 1150, avg_cost: 3.9281578063964844
grad_norm: 1.947102669571198, clipped: 1.0
epoch: 10, train_batch_id: 1200, avg_cost: 3.921278476715088
grad_norm: 2.728757937119748, clipped: 1.0
epoch: 10, train_batch_id: 1250, avg_cost: 3.948129177093506
grad_norm: 2.874053700861438, clipped: 1.0
epoch: 10, train_batch_id: 1300, avg_cost: 3.9394373893737793
grad_norm: 2.7862639703403227, clipped: 1.0
epoch: 10, train_batch_id: 1350, avg_cost: 3.9403910636901855
grad_norm: 2.4415625317482186, clipped: 1.0
epoch: 10, train_batch_id: 1400, avg_cost: 3.9264581203460693
grad_norm: 2.7202103448374158, clipped: 1.0
epoch: 10, train_batch_id: 1450, avg_cost: 3.9436495304107666
grad_norm: 2.877547419929014, clipped: 1.0
epoch: 10, train_batch_id: 1500, avg_cost: 3.9325432777404785
grad_norm: 3.365650334414902, clipped: 1.0
epoch: 10, train_batch_id: 1550, avg_cost: 3.9451262950897217
grad_norm: 2.4636621895685584, clipped: 1.0
epoch: 10, train_batch_id: 1600, avg_cost: 3.9309194087982178
grad_norm: 3.5970133872612386, clipped: 1.0
epoch: 10, train_batch_id: 1650, avg_cost: 3.900397300720215
grad_norm: 2.452478262622018, clipped: 1.0
epoch: 10, train_batch_id: 1700, avg_cost: 3.9123916625976562
grad_norm: 2.6759822124769985, clipped: 1.0
epoch: 10, train_batch_id: 1750, avg_cost: 3.922100067138672
grad_norm: 2.035598375482883, clipped: 1.0
epoch: 10, train_batch_id: 1800, avg_cost: 3.9073233604431152
grad_norm: 2.47000455462908, clipped: 1.0
epoch: 10, train_batch_id: 1850, avg_cost: 3.9513845443725586
grad_norm: 2.1381806274776105, clipped: 1.0
epoch: 10, train_batch_id: 1900, avg_cost: 3.9384496212005615
grad_norm: 3.034652958628847, clipped: 1.0
epoch: 10, train_batch_id: 1950, avg_cost: 3.911130905151367
grad_norm: 2.7691888735951404, clipped: 1.0
epoch: 10, train_batch_id: 2000, avg_cost: 3.899886131286621
grad_norm: 2.372773474033281, clipped: 1.0
epoch: 10, train_batch_id: 2050, avg_cost: 3.9176430702209473
grad_norm: 2.5522799049835934, clipped: 1.0
epoch: 10, train_batch_id: 2100, avg_cost: 3.9490227699279785
grad_norm: 2.5244489778699677, clipped: 1.0
epoch: 10, train_batch_id: 2150, avg_cost: 3.9226512908935547
grad_norm: 2.9403972923279493, clipped: 1.0
epoch: 10, train_batch_id: 2200, avg_cost: 3.93463397026062
grad_norm: 3.145227877228615, clipped: 1.0
epoch: 10, train_batch_id: 2250, avg_cost: 3.8860626220703125
grad_norm: 2.52434989155142, clipped: 1.0
epoch: 10, train_batch_id: 2300, avg_cost: 3.889075756072998
grad_norm: 2.567011818304274, clipped: 1.0
epoch: 10, train_batch_id: 2350, avg_cost: 3.9142990112304688
grad_norm: 3.5521747599260327, clipped: 1.0
epoch: 10, train_batch_id: 2400, avg_cost: 3.9055471420288086
grad_norm: 2.5207839857366134, clipped: 1.0
epoch: 10, train_batch_id: 2450, avg_cost: 3.9329543113708496
grad_norm: 2.63874069749291, clipped: 1.0
Finished epoch 10, took 00:19:22 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.429671287536621 +- 0.004254510160535574
Evaluating candidate model on evaluation dataset
Epoch 10 candidate mean 4.424918174743652, baseline epoch 9 mean 4.388998985290527, difference 0.035919189453125
Start train epoch 11, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 11, train_batch_id: 0, avg_cost: 3.922846794128418
grad_norm: 2.844005951374038, clipped: 1.0
epoch: 11, train_batch_id: 50, avg_cost: 3.9515719413757324
grad_norm: 3.383611647270473, clipped: 1.0
epoch: 11, train_batch_id: 100, avg_cost: 3.914299964904785
grad_norm: 2.533543200754387, clipped: 1.0
epoch: 11, train_batch_id: 150, avg_cost: 3.92934513092041
grad_norm: 2.876548252222389, clipped: 1.0
epoch: 11, train_batch_id: 200, avg_cost: 3.9331185817718506
grad_norm: 3.0123112814310407, clipped: 1.0
epoch: 11, train_batch_id: 250, avg_cost: 3.9574313163757324
grad_norm: 2.8440909409057373, clipped: 1.0
epoch: 11, train_batch_id: 300, avg_cost: 3.9486958980560303
grad_norm: 2.7873218809114375, clipped: 1.0
epoch: 11, train_batch_id: 350, avg_cost: 3.8976659774780273
grad_norm: 2.555745063806708, clipped: 1.0
epoch: 11, train_batch_id: 400, avg_cost: 3.9073729515075684
grad_norm: 2.526902506481348, clipped: 1.0
epoch: 11, train_batch_id: 450, avg_cost: 3.917457103729248
grad_norm: 2.527803479047698, clipped: 1.0
epoch: 11, train_batch_id: 500, avg_cost: 3.9205191135406494
grad_norm: 2.656006434247417, clipped: 1.0
epoch: 11, train_batch_id: 550, avg_cost: 3.9258885383605957
grad_norm: 3.10345116671871, clipped: 1.0
epoch: 11, train_batch_id: 600, avg_cost: 3.909970760345459
grad_norm: 2.201232574882587, clipped: 1.0
epoch: 11, train_batch_id: 650, avg_cost: 3.9057750701904297
grad_norm: 2.7440628108778213, clipped: 1.0
epoch: 11, train_batch_id: 700, avg_cost: 3.897371292114258
grad_norm: 2.898289256653114, clipped: 1.0
epoch: 11, train_batch_id: 750, avg_cost: 3.9383373260498047
grad_norm: 2.7852696373734283, clipped: 1.0
epoch: 11, train_batch_id: 800, avg_cost: 3.910226345062256
grad_norm: 2.9186669110259014, clipped: 1.0
epoch: 11, train_batch_id: 850, avg_cost: 3.926835536956787
grad_norm: 3.1103626355936584, clipped: 1.0
epoch: 11, train_batch_id: 900, avg_cost: 3.9335598945617676
grad_norm: 2.8961932029529476, clipped: 1.0
epoch: 11, train_batch_id: 950, avg_cost: 3.8865256309509277
grad_norm: 2.1590348974610443, clipped: 1.0
epoch: 11, train_batch_id: 1000, avg_cost: 3.9219813346862793
grad_norm: 3.001680959822231, clipped: 1.0
epoch: 11, train_batch_id: 1050, avg_cost: 3.9239344596862793
grad_norm: 2.184754802596798, clipped: 1.0
epoch: 11, train_batch_id: 1100, avg_cost: 3.9123244285583496
grad_norm: 2.3648127831966406, clipped: 1.0
epoch: 11, train_batch_id: 1150, avg_cost: 3.898597240447998
grad_norm: 2.0160685731555583, clipped: 1.0
epoch: 11, train_batch_id: 1200, avg_cost: 3.9391837120056152
grad_norm: 2.44508133406345, clipped: 1.0
epoch: 11, train_batch_id: 1250, avg_cost: 3.9100470542907715
grad_norm: 2.4322391844190565, clipped: 1.0
epoch: 11, train_batch_id: 1300, avg_cost: 3.9350743293762207
grad_norm: 2.552169758632773, clipped: 1.0
epoch: 11, train_batch_id: 1350, avg_cost: 3.8856139183044434
grad_norm: 2.51939300524487, clipped: 1.0
epoch: 11, train_batch_id: 1400, avg_cost: 3.913145065307617
grad_norm: 2.9547163671594445, clipped: 1.0
epoch: 11, train_batch_id: 1450, avg_cost: 3.9284656047821045
grad_norm: 2.9328762563598576, clipped: 1.0
epoch: 11, train_batch_id: 1500, avg_cost: 3.9305615425109863
grad_norm: 3.0349148918007605, clipped: 1.0
epoch: 11, train_batch_id: 1550, avg_cost: 3.943345546722412
grad_norm: 2.706198510023298, clipped: 1.0
epoch: 11, train_batch_id: 1600, avg_cost: 3.9592721462249756
grad_norm: 3.1866390560267583, clipped: 1.0
epoch: 11, train_batch_id: 1650, avg_cost: 3.8949766159057617
grad_norm: 3.422251096564034, clipped: 1.0
epoch: 11, train_batch_id: 1700, avg_cost: 3.9469614028930664
grad_norm: 2.2197944648746484, clipped: 1.0
epoch: 11, train_batch_id: 1750, avg_cost: 3.9099907875061035
grad_norm: 2.7481832351710658, clipped: 1.0
epoch: 11, train_batch_id: 1800, avg_cost: 3.9225809574127197
grad_norm: 2.8831389115642954, clipped: 1.0
epoch: 11, train_batch_id: 1850, avg_cost: 3.9344911575317383
grad_norm: 2.622932059963706, clipped: 1.0
epoch: 11, train_batch_id: 1900, avg_cost: 3.8950676918029785
grad_norm: 2.5120344718669294, clipped: 1.0
epoch: 11, train_batch_id: 1950, avg_cost: 3.91019868850708
grad_norm: 2.8356956703873735, clipped: 1.0
epoch: 11, train_batch_id: 2000, avg_cost: 3.88145112991333
grad_norm: 2.7104738034337403, clipped: 1.0
epoch: 11, train_batch_id: 2050, avg_cost: 3.9255847930908203
grad_norm: 2.58158354214682, clipped: 1.0
epoch: 11, train_batch_id: 2100, avg_cost: 3.9134206771850586
grad_norm: 2.9224187703723468, clipped: 1.0
epoch: 11, train_batch_id: 2150, avg_cost: 3.8927791118621826
grad_norm: 3.1560618854557623, clipped: 1.0
epoch: 11, train_batch_id: 2200, avg_cost: 3.953866958618164
grad_norm: 2.1220484174621257, clipped: 1.0
epoch: 11, train_batch_id: 2250, avg_cost: 3.9167444705963135
grad_norm: 3.0314682329077085, clipped: 1.0
epoch: 11, train_batch_id: 2300, avg_cost: 3.928750991821289
grad_norm: 2.620397189921388, clipped: 1.0
epoch: 11, train_batch_id: 2350, avg_cost: 3.932549476623535
grad_norm: 3.226700732703588, clipped: 1.0
epoch: 11, train_batch_id: 2400, avg_cost: 3.927222967147827
grad_norm: 2.540557098196282, clipped: 1.0
epoch: 11, train_batch_id: 2450, avg_cost: 3.901606321334839
grad_norm: 2.491183347728825, clipped: 1.0
Finished epoch 11, took 00:19:18 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.411917209625244 +- 0.004168942105025053
Evaluating candidate model on evaluation dataset
Epoch 11 candidate mean 4.405489921569824, baseline epoch 9 mean 4.388998985290527, difference 0.016490936279296875
Start train epoch 12, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


171


epoch: 12, train_batch_id: 0, avg_cost: 3.912048816680908
grad_norm: 2.3748483636527067, clipped: 1.0
epoch: 12, train_batch_id: 50, avg_cost: 3.934640884399414
grad_norm: 2.808846228303522, clipped: 1.0
epoch: 12, train_batch_id: 100, avg_cost: 3.927177667617798
grad_norm: 2.8593643308279786, clipped: 1.0
epoch: 12, train_batch_id: 150, avg_cost: 3.9200522899627686
grad_norm: 2.9665232838042206, clipped: 1.0
epoch: 12, train_batch_id: 200, avg_cost: 3.915743350982666
grad_norm: 2.6257131862041816, clipped: 1.0
epoch: 12, train_batch_id: 250, avg_cost: 3.913679838180542
grad_norm: 3.074181621455842, clipped: 1.0
epoch: 12, train_batch_id: 300, avg_cost: 3.939072370529175
grad_norm: 2.706052905440949, clipped: 1.0
epoch: 12, train_batch_id: 350, avg_cost: 3.9289474487304688
grad_norm: 3.051194462442923, clipped: 1.0
epoch: 12, train_batch_id: 400, avg_cost: 3.9154653549194336
grad_norm: 3.0446469313790128, clipped: 1.0
epoch: 12, train_batch_id: 450, avg_cost: 3.9194178581237793
grad_norm: 3.315813719261934, clipped: 1.0
epoch: 12, train_batch_id: 500, avg_cost: 3.9154186248779297
grad_norm: 2.641124718722443, clipped: 1.0
epoch: 12, train_batch_id: 550, avg_cost: 3.904340982437134
grad_norm: 2.428987215475903, clipped: 1.0
epoch: 12, train_batch_id: 600, avg_cost: 3.9430553913116455
grad_norm: 3.267934461588736, clipped: 1.0
epoch: 12, train_batch_id: 650, avg_cost: 3.918426036834717
grad_norm: 3.059177565298477, clipped: 1.0
epoch: 12, train_batch_id: 700, avg_cost: 3.9098358154296875
grad_norm: 2.7079628878532302, clipped: 1.0
epoch: 12, train_batch_id: 750, avg_cost: 3.917698383331299
grad_norm: 2.858877722658022, clipped: 1.0
epoch: 12, train_batch_id: 800, avg_cost: 3.91367244720459
grad_norm: 2.6664533901792145, clipped: 1.0
epoch: 12, train_batch_id: 850, avg_cost: 3.909209728240967
grad_norm: 2.580560489657737, clipped: 1.0
epoch: 12, train_batch_id: 900, avg_cost: 3.9464335441589355
grad_norm: 2.6630560820145224, clipped: 1.0
epoch: 12, train_batch_id: 950, avg_cost: 3.9468092918395996
grad_norm: 3.223582616300339, clipped: 1.0
epoch: 12, train_batch_id: 1000, avg_cost: 3.9374613761901855
grad_norm: 2.4089664533242297, clipped: 1.0
epoch: 12, train_batch_id: 1050, avg_cost: 3.935690402984619
grad_norm: 3.386292457486509, clipped: 1.0
epoch: 12, train_batch_id: 1100, avg_cost: 3.933185338973999
grad_norm: 4.142547906720591, clipped: 1.0
epoch: 12, train_batch_id: 1150, avg_cost: 3.931384563446045
grad_norm: 2.773534362883768, clipped: 1.0
epoch: 12, train_batch_id: 1200, avg_cost: 3.9441771507263184
grad_norm: 2.4110740695989317, clipped: 1.0
epoch: 12, train_batch_id: 1250, avg_cost: 3.915116310119629
grad_norm: 2.8253981383756184, clipped: 1.0
epoch: 12, train_batch_id: 1300, avg_cost: 3.950247287750244
grad_norm: 2.616205949750206, clipped: 1.0
epoch: 12, train_batch_id: 1350, avg_cost: 3.9339070320129395
grad_norm: 2.7248706476685634, clipped: 1.0
epoch: 12, train_batch_id: 1400, avg_cost: 3.9164822101593018
grad_norm: 2.734738690583758, clipped: 1.0
epoch: 12, train_batch_id: 1450, avg_cost: 3.9350264072418213
grad_norm: 2.950956235335558, clipped: 1.0
epoch: 12, train_batch_id: 1500, avg_cost: 3.906381130218506
grad_norm: 2.562788438513264, clipped: 1.0
epoch: 12, train_batch_id: 1550, avg_cost: 3.9071671962738037
grad_norm: 2.4557101020924783, clipped: 1.0
epoch: 12, train_batch_id: 1600, avg_cost: 3.943199872970581
grad_norm: 2.7723029503557237, clipped: 1.0
epoch: 12, train_batch_id: 1650, avg_cost: 3.9098002910614014
grad_norm: 2.2584063012344266, clipped: 1.0
epoch: 12, train_batch_id: 1700, avg_cost: 3.9353761672973633
grad_norm: 2.792264247097141, clipped: 1.0
epoch: 12, train_batch_id: 1750, avg_cost: 3.916815757751465
grad_norm: 2.003313936042581, clipped: 1.0
epoch: 12, train_batch_id: 1800, avg_cost: 3.933342695236206
grad_norm: 2.367858147940035, clipped: 1.0
epoch: 12, train_batch_id: 1850, avg_cost: 3.9408135414123535
grad_norm: 2.363352121673692, clipped: 1.0
epoch: 12, train_batch_id: 1900, avg_cost: 3.8971621990203857
grad_norm: 2.7666351799000384, clipped: 1.0
epoch: 12, train_batch_id: 1950, avg_cost: 3.933285713195801
grad_norm: 2.798637135461789, clipped: 1.0
epoch: 12, train_batch_id: 2000, avg_cost: 3.910524368286133
grad_norm: 2.374490079834889, clipped: 1.0
epoch: 12, train_batch_id: 2050, avg_cost: 3.9345574378967285
grad_norm: 2.8361345811064718, clipped: 1.0
epoch: 12, train_batch_id: 2100, avg_cost: 3.924133062362671
grad_norm: 2.80775316622029, clipped: 1.0
epoch: 12, train_batch_id: 2150, avg_cost: 3.913059711456299
grad_norm: 2.8189415921659333, clipped: 1.0
epoch: 12, train_batch_id: 2200, avg_cost: 3.927074432373047
grad_norm: 3.470960427814815, clipped: 1.0
epoch: 12, train_batch_id: 2250, avg_cost: 3.96378755569458
grad_norm: 2.470502936562762, clipped: 1.0
epoch: 12, train_batch_id: 2300, avg_cost: 3.886458396911621
grad_norm: 2.7392559653379998, clipped: 1.0
epoch: 12, train_batch_id: 2350, avg_cost: 3.9146180152893066
grad_norm: 3.798085823822787, clipped: 1.0
epoch: 12, train_batch_id: 2400, avg_cost: 3.934208869934082
grad_norm: 2.3864168922488913, clipped: 1.0
epoch: 12, train_batch_id: 2450, avg_cost: 3.8979251384735107
grad_norm: 2.892651867688735, clipped: 1.0
Finished epoch 12, took 00:19:22 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.331122875213623 +- 0.004127546679228544
Evaluating candidate model on evaluation dataset
Epoch 12 candidate mean 4.328389644622803, baseline epoch 9 mean 4.388998985290527, difference -0.06060934066772461
p-value: 1.4384313714519569e-125
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 13, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 13, train_batch_id: 0, avg_cost: 3.9308829307556152
grad_norm: 2.944430310039262, clipped: 1.0
epoch: 13, train_batch_id: 50, avg_cost: 3.924907922744751
grad_norm: 2.2187315117654816, clipped: 1.0
epoch: 13, train_batch_id: 100, avg_cost: 3.9135892391204834
grad_norm: 2.713357523097462, clipped: 1.0
epoch: 13, train_batch_id: 150, avg_cost: 3.89821720123291
grad_norm: 3.5225800539871175, clipped: 1.0
epoch: 13, train_batch_id: 200, avg_cost: 3.9323861598968506
grad_norm: 2.1368571266414738, clipped: 1.0
epoch: 13, train_batch_id: 250, avg_cost: 3.9532389640808105
grad_norm: 3.277830851550134, clipped: 1.0
epoch: 13, train_batch_id: 300, avg_cost: 3.946012020111084
grad_norm: 2.8032381280392396, clipped: 1.0
epoch: 13, train_batch_id: 350, avg_cost: 3.9451990127563477
grad_norm: 2.264931542684159, clipped: 1.0
epoch: 13, train_batch_id: 400, avg_cost: 3.9235143661499023
grad_norm: 2.349991931007569, clipped: 1.0
epoch: 13, train_batch_id: 450, avg_cost: 3.907233238220215
grad_norm: 2.2404669645363664, clipped: 1.0
epoch: 13, train_batch_id: 500, avg_cost: 3.9366514682769775
grad_norm: 3.11446642690021, clipped: 1.0
epoch: 13, train_batch_id: 550, avg_cost: 3.936838150024414
grad_norm: 3.9088184014299907, clipped: 1.0
epoch: 13, train_batch_id: 600, avg_cost: 3.923133373260498
grad_norm: 2.735421935055459, clipped: 1.0
epoch: 13, train_batch_id: 650, avg_cost: 3.9331555366516113
grad_norm: 2.109485391270351, clipped: 1.0
epoch: 13, train_batch_id: 700, avg_cost: 3.907902717590332
grad_norm: 2.6421545476183037, clipped: 1.0
epoch: 13, train_batch_id: 750, avg_cost: 3.8898496627807617
grad_norm: 3.306333201170558, clipped: 1.0
epoch: 13, train_batch_id: 800, avg_cost: 3.918412923812866
grad_norm: 2.2733519165007703, clipped: 1.0
epoch: 13, train_batch_id: 850, avg_cost: 3.931271553039551
grad_norm: 2.4087238006171034, clipped: 1.0
epoch: 13, train_batch_id: 900, avg_cost: 3.9437332153320312
grad_norm: 2.125281027645222, clipped: 1.0
epoch: 13, train_batch_id: 950, avg_cost: 3.91591739654541
grad_norm: 2.1026354833342693, clipped: 1.0
epoch: 13, train_batch_id: 1000, avg_cost: 3.9372875690460205
grad_norm: 2.682663362993755, clipped: 1.0
epoch: 13, train_batch_id: 1050, avg_cost: 3.934969425201416
grad_norm: 2.34219415367253, clipped: 1.0
epoch: 13, train_batch_id: 1100, avg_cost: 3.9413681030273438
grad_norm: 2.9684637458565217, clipped: 1.0
epoch: 13, train_batch_id: 1150, avg_cost: 3.909440517425537
grad_norm: 2.6565926804797084, clipped: 1.0
epoch: 13, train_batch_id: 1200, avg_cost: 3.922423839569092
grad_norm: 2.895476765122193, clipped: 1.0
epoch: 13, train_batch_id: 1250, avg_cost: 3.896073341369629
grad_norm: 2.377566654935378, clipped: 1.0
epoch: 13, train_batch_id: 1300, avg_cost: 3.922852039337158
grad_norm: 2.012226544369885, clipped: 1.0
epoch: 13, train_batch_id: 1350, avg_cost: 3.9421868324279785
grad_norm: 3.092352022503798, clipped: 1.0
epoch: 13, train_batch_id: 1400, avg_cost: 3.9224703311920166
grad_norm: 2.839791885993814, clipped: 1.0
epoch: 13, train_batch_id: 1450, avg_cost: 3.9242401123046875
grad_norm: 2.7912623743742833, clipped: 1.0
epoch: 13, train_batch_id: 1500, avg_cost: 3.933687210083008
grad_norm: 2.824217103422301, clipped: 1.0
epoch: 13, train_batch_id: 1550, avg_cost: 3.9191784858703613
grad_norm: 3.566028865210363, clipped: 1.0
epoch: 13, train_batch_id: 1600, avg_cost: 3.8768186569213867
grad_norm: 3.1850887222417406, clipped: 1.0
epoch: 13, train_batch_id: 1650, avg_cost: 3.907944679260254
grad_norm: 2.4484486524126607, clipped: 1.0
epoch: 13, train_batch_id: 1700, avg_cost: 3.9286303520202637
grad_norm: 2.2538250435525446, clipped: 1.0
epoch: 13, train_batch_id: 1750, avg_cost: 3.930467367172241
grad_norm: 2.3954093499390634, clipped: 1.0
epoch: 13, train_batch_id: 1800, avg_cost: 3.920544385910034
grad_norm: 2.6043868252043194, clipped: 1.0
epoch: 13, train_batch_id: 1850, avg_cost: 3.9221343994140625
grad_norm: 2.622459380479981, clipped: 1.0
epoch: 13, train_batch_id: 1900, avg_cost: 3.908195972442627
grad_norm: 1.8131964420497506, clipped: 1.0
epoch: 13, train_batch_id: 1950, avg_cost: 3.8681983947753906
grad_norm: 2.0315400871081994, clipped: 1.0
epoch: 13, train_batch_id: 2000, avg_cost: 3.922244071960449
grad_norm: 2.9614384385212236, clipped: 1.0
epoch: 13, train_batch_id: 2050, avg_cost: 3.9376020431518555
grad_norm: 2.4410729270389466, clipped: 1.0
epoch: 13, train_batch_id: 2100, avg_cost: 3.915701150894165
grad_norm: 2.1873439546193625, clipped: 1.0
epoch: 13, train_batch_id: 2150, avg_cost: 3.9042303562164307
grad_norm: 2.8536769443458874, clipped: 1.0
epoch: 13, train_batch_id: 2200, avg_cost: 3.9107699394226074
grad_norm: 2.6182867953594395, clipped: 1.0
epoch: 13, train_batch_id: 2250, avg_cost: 3.9163079261779785
grad_norm: 2.3284985054041774, clipped: 1.0
epoch: 13, train_batch_id: 2300, avg_cost: 3.8787174224853516
grad_norm: 2.7409563395476426, clipped: 1.0
epoch: 13, train_batch_id: 2350, avg_cost: 3.9099249839782715
grad_norm: 3.29707232436857, clipped: 1.0
epoch: 13, train_batch_id: 2400, avg_cost: 3.920698642730713
grad_norm: 3.084705668873284, clipped: 1.0
epoch: 13, train_batch_id: 2450, avg_cost: 3.946192502975464
grad_norm: 2.1806003300406323, clipped: 1.0
Finished epoch 13, took 00:19:25 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.385871410369873 +- 0.0041998932138085365
Evaluating candidate model on evaluation dataset
Epoch 13 candidate mean 4.380560874938965, baseline epoch 12 mean 4.327935218811035, difference 0.05262565612792969
Start train epoch 14, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


171


epoch: 14, train_batch_id: 0, avg_cost: 3.9198648929595947
grad_norm: 2.4788679863908674, clipped: 1.0
epoch: 14, train_batch_id: 50, avg_cost: 3.920356512069702
grad_norm: 2.127000859116549, clipped: 1.0
epoch: 14, train_batch_id: 100, avg_cost: 3.939218521118164
grad_norm: 2.459854658268921, clipped: 1.0
epoch: 14, train_batch_id: 150, avg_cost: 3.9045615196228027
grad_norm: 2.5472597147011706, clipped: 1.0
epoch: 14, train_batch_id: 200, avg_cost: 3.910937786102295
grad_norm: 2.6756850920013653, clipped: 1.0
epoch: 14, train_batch_id: 250, avg_cost: 3.886111259460449
grad_norm: 2.5183081256477617, clipped: 1.0
epoch: 14, train_batch_id: 300, avg_cost: 3.903463840484619
grad_norm: 2.48671799315145, clipped: 1.0
epoch: 14, train_batch_id: 350, avg_cost: 3.9060606956481934
grad_norm: 2.783330317310129, clipped: 1.0
epoch: 14, train_batch_id: 400, avg_cost: 3.8960373401641846
grad_norm: 2.0139505096217407, clipped: 1.0
epoch: 14, train_batch_id: 450, avg_cost: 3.893247604370117
grad_norm: 2.0443270830127434, clipped: 1.0
epoch: 14, train_batch_id: 500, avg_cost: 3.9103612899780273
grad_norm: 2.669438079092536, clipped: 1.0
epoch: 14, train_batch_id: 550, avg_cost: 3.9061756134033203
grad_norm: 3.107991245655818, clipped: 1.0
epoch: 14, train_batch_id: 600, avg_cost: 3.9051289558410645
grad_norm: 2.6579640079650027, clipped: 1.0
epoch: 14, train_batch_id: 650, avg_cost: 3.9363961219787598
grad_norm: 3.0650070294352996, clipped: 1.0
epoch: 14, train_batch_id: 700, avg_cost: 3.905548095703125
grad_norm: 2.324167064345541, clipped: 1.0
epoch: 14, train_batch_id: 750, avg_cost: 3.8741602897644043
grad_norm: 2.9832159543691943, clipped: 1.0
epoch: 14, train_batch_id: 800, avg_cost: 3.897700786590576
grad_norm: 2.3963768962680954, clipped: 1.0
epoch: 14, train_batch_id: 850, avg_cost: 3.900831699371338
grad_norm: 2.5094672387388983, clipped: 1.0
epoch: 14, train_batch_id: 900, avg_cost: 3.901920795440674
grad_norm: 2.494025456301809, clipped: 1.0
epoch: 14, train_batch_id: 950, avg_cost: 3.9307596683502197
grad_norm: 1.8123049762133325, clipped: 1.0
epoch: 14, train_batch_id: 1000, avg_cost: 3.922661542892456
grad_norm: 3.4531272074035644, clipped: 1.0
epoch: 14, train_batch_id: 1050, avg_cost: 3.9233741760253906
grad_norm: 2.255317006161063, clipped: 1.0
epoch: 14, train_batch_id: 1100, avg_cost: 3.8960301876068115
grad_norm: 2.765330176956794, clipped: 1.0
epoch: 14, train_batch_id: 1150, avg_cost: 3.915581464767456
grad_norm: 3.1211407237468825, clipped: 1.0
epoch: 14, train_batch_id: 1200, avg_cost: 3.9233787059783936
grad_norm: 2.1722969619811963, clipped: 1.0
epoch: 14, train_batch_id: 1250, avg_cost: 3.9330923557281494
grad_norm: 3.064791501735702, clipped: 1.0
epoch: 14, train_batch_id: 1300, avg_cost: 3.9143824577331543
grad_norm: 2.511867964622044, clipped: 1.0
epoch: 14, train_batch_id: 1350, avg_cost: 3.9171371459960938
grad_norm: 3.4926840238993826, clipped: 1.0
epoch: 14, train_batch_id: 1400, avg_cost: 3.929266929626465
grad_norm: 2.647236568744076, clipped: 1.0
epoch: 14, train_batch_id: 1450, avg_cost: 3.918973207473755
grad_norm: 2.3882075023521456, clipped: 1.0
epoch: 14, train_batch_id: 1500, avg_cost: 3.894988775253296
grad_norm: 1.9450016471549865, clipped: 1.0
epoch: 14, train_batch_id: 1550, avg_cost: 3.898324728012085
grad_norm: 2.5795033977614295, clipped: 1.0
epoch: 14, train_batch_id: 1600, avg_cost: 3.894102096557617
grad_norm: 2.6024773523135356, clipped: 1.0
epoch: 14, train_batch_id: 1650, avg_cost: 3.9441568851470947
grad_norm: 2.839064225524721, clipped: 1.0
epoch: 14, train_batch_id: 1700, avg_cost: 3.9078757762908936
grad_norm: 2.7669692032668616, clipped: 1.0
epoch: 14, train_batch_id: 1750, avg_cost: 3.897463321685791
grad_norm: 2.429242546437314, clipped: 1.0
epoch: 14, train_batch_id: 1800, avg_cost: 3.911222457885742
grad_norm: 2.6321199860481097, clipped: 1.0
epoch: 14, train_batch_id: 1850, avg_cost: 3.916569232940674
grad_norm: 2.5064125636497554, clipped: 1.0
epoch: 14, train_batch_id: 1900, avg_cost: 3.919678211212158
grad_norm: 2.430964000337973, clipped: 1.0
epoch: 14, train_batch_id: 1950, avg_cost: 3.921694040298462
grad_norm: 2.7093617280617135, clipped: 1.0
epoch: 14, train_batch_id: 2000, avg_cost: 3.923151969909668
grad_norm: 2.031021316017252, clipped: 1.0
epoch: 14, train_batch_id: 2050, avg_cost: 3.9287073612213135
grad_norm: 2.587714373534909, clipped: 1.0
epoch: 14, train_batch_id: 2100, avg_cost: 3.915188789367676
grad_norm: 2.9224900718751345, clipped: 1.0
epoch: 14, train_batch_id: 2150, avg_cost: 3.9076080322265625
grad_norm: 2.3219527128989257, clipped: 1.0
epoch: 14, train_batch_id: 2200, avg_cost: 3.9120876789093018
grad_norm: 2.3403133381549974, clipped: 1.0
epoch: 14, train_batch_id: 2250, avg_cost: 3.9262304306030273
grad_norm: 2.19488398242008, clipped: 1.0
epoch: 14, train_batch_id: 2300, avg_cost: 3.8865418434143066
grad_norm: 3.0856632530321435, clipped: 1.0
epoch: 14, train_batch_id: 2350, avg_cost: 3.8957901000976562
grad_norm: 3.0163073874418367, clipped: 1.0
epoch: 14, train_batch_id: 2400, avg_cost: 3.938542127609253
grad_norm: 2.4276520219514315, clipped: 1.0
epoch: 14, train_batch_id: 2450, avg_cost: 3.9107000827789307
grad_norm: 2.1764191940045854, clipped: 1.0
Finished epoch 14, took 00:19:22 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.278113842010498 +- 0.003935534041374922
Evaluating candidate model on evaluation dataset
Epoch 14 candidate mean 4.274533748626709, baseline epoch 12 mean 4.327935218811035, difference -0.05340147018432617
p-value: 8.642222319322545e-131
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 15, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


171


epoch: 15, train_batch_id: 0, avg_cost: 3.9324893951416016
grad_norm: 1.8826847345610997, clipped: 1.0
epoch: 15, train_batch_id: 50, avg_cost: 3.92411470413208
grad_norm: 2.951608378636137, clipped: 1.0
epoch: 15, train_batch_id: 100, avg_cost: 3.8912858963012695
grad_norm: 2.170816556220902, clipped: 1.0
epoch: 15, train_batch_id: 150, avg_cost: 3.914813756942749
grad_norm: 2.0677358439142837, clipped: 1.0
epoch: 15, train_batch_id: 200, avg_cost: 3.902435779571533
grad_norm: 1.81224064991795, clipped: 1.0
epoch: 15, train_batch_id: 250, avg_cost: 3.9051241874694824
grad_norm: 2.7119898423546362, clipped: 1.0
epoch: 15, train_batch_id: 300, avg_cost: 3.9063358306884766
grad_norm: 1.8774974509476898, clipped: 1.0
epoch: 15, train_batch_id: 350, avg_cost: 3.8965392112731934
grad_norm: 1.7514082782364226, clipped: 1.0
epoch: 15, train_batch_id: 400, avg_cost: 3.9145143032073975
grad_norm: 2.0603507687736693, clipped: 1.0
epoch: 15, train_batch_id: 450, avg_cost: 3.909146308898926
grad_norm: 2.3096701548108896, clipped: 1.0
epoch: 15, train_batch_id: 500, avg_cost: 3.9047799110412598
grad_norm: 1.8456293092486133, clipped: 1.0
epoch: 15, train_batch_id: 550, avg_cost: 3.957162380218506
grad_norm: 2.23850231441468, clipped: 1.0
epoch: 15, train_batch_id: 600, avg_cost: 3.910832643508911
grad_norm: 2.4154113882802974, clipped: 1.0
epoch: 15, train_batch_id: 650, avg_cost: 3.9015231132507324
grad_norm: 2.407426781784068, clipped: 1.0
epoch: 15, train_batch_id: 700, avg_cost: 3.8978042602539062
grad_norm: 1.914412511185888, clipped: 1.0
epoch: 15, train_batch_id: 750, avg_cost: 3.9360289573669434
grad_norm: 2.2569592677585177, clipped: 1.0
epoch: 15, train_batch_id: 800, avg_cost: 3.9183316230773926
grad_norm: 2.016643435943313, clipped: 1.0
epoch: 15, train_batch_id: 850, avg_cost: 3.9075534343719482
grad_norm: 1.8362904248745773, clipped: 1.0
epoch: 15, train_batch_id: 900, avg_cost: 3.9301905632019043
grad_norm: 2.657811552409602, clipped: 1.0
epoch: 15, train_batch_id: 950, avg_cost: 3.8934669494628906
grad_norm: 2.233190904144149, clipped: 1.0
epoch: 15, train_batch_id: 1000, avg_cost: 3.934927225112915
grad_norm: 1.863050176719865, clipped: 1.0
epoch: 15, train_batch_id: 1050, avg_cost: 3.9080748558044434
grad_norm: 2.396174695664581, clipped: 1.0
epoch: 15, train_batch_id: 1100, avg_cost: 3.8888320922851562
grad_norm: 2.1318667614026383, clipped: 1.0
epoch: 15, train_batch_id: 1150, avg_cost: 3.9347805976867676
grad_norm: 1.9358667713898154, clipped: 1.0
epoch: 15, train_batch_id: 1200, avg_cost: 3.920631170272827
grad_norm: 1.648141351523192, clipped: 1.0
epoch: 15, train_batch_id: 1250, avg_cost: 3.9251785278320312
grad_norm: 1.8515227061575785, clipped: 1.0
epoch: 15, train_batch_id: 1300, avg_cost: 3.9344961643218994
grad_norm: 2.5175102710853636, clipped: 1.0
epoch: 15, train_batch_id: 1350, avg_cost: 3.9150829315185547
grad_norm: 1.903031053145033, clipped: 1.0
epoch: 15, train_batch_id: 1400, avg_cost: 3.894503116607666
grad_norm: 2.434524224863074, clipped: 1.0
epoch: 15, train_batch_id: 1450, avg_cost: 3.928896903991699
grad_norm: 2.361553687325327, clipped: 1.0
epoch: 15, train_batch_id: 1500, avg_cost: 3.892314910888672
grad_norm: 2.109762669579533, clipped: 1.0
epoch: 15, train_batch_id: 1550, avg_cost: 3.91552734375
grad_norm: 3.0539104841023534, clipped: 1.0
epoch: 15, train_batch_id: 1600, avg_cost: 3.8878607749938965
grad_norm: 2.1424055625003096, clipped: 1.0
epoch: 15, train_batch_id: 1650, avg_cost: 3.9358301162719727
grad_norm: 2.940046484028251, clipped: 1.0
epoch: 15, train_batch_id: 1700, avg_cost: 3.9003896713256836
grad_norm: 2.2809119568286276, clipped: 1.0
epoch: 15, train_batch_id: 1750, avg_cost: 3.8779635429382324
grad_norm: 1.93411800772475, clipped: 1.0
epoch: 15, train_batch_id: 1800, avg_cost: 3.910073757171631
grad_norm: 3.0579314713957046, clipped: 1.0
epoch: 15, train_batch_id: 1850, avg_cost: 3.9086501598358154
grad_norm: 1.988506498568262, clipped: 1.0
epoch: 15, train_batch_id: 1900, avg_cost: 3.912222385406494
grad_norm: 2.0418347003581965, clipped: 1.0
epoch: 15, train_batch_id: 1950, avg_cost: 3.9229471683502197
grad_norm: 2.1061057871539313, clipped: 1.0
epoch: 15, train_batch_id: 2000, avg_cost: 3.926321506500244
grad_norm: 2.682745790506534, clipped: 1.0
epoch: 15, train_batch_id: 2050, avg_cost: 3.924910545349121
grad_norm: 2.1006485929748546, clipped: 1.0
epoch: 15, train_batch_id: 2100, avg_cost: 3.9071648120880127
grad_norm: 2.27606009752113, clipped: 1.0
epoch: 15, train_batch_id: 2150, avg_cost: 3.8884482383728027
grad_norm: 2.65004792293956, clipped: 1.0
epoch: 15, train_batch_id: 2200, avg_cost: 3.9086170196533203
grad_norm: 2.104238918506878, clipped: 1.0
epoch: 15, train_batch_id: 2250, avg_cost: 3.884633779525757
grad_norm: 2.7487773889714604, clipped: 1.0
epoch: 15, train_batch_id: 2300, avg_cost: 3.9014339447021484
grad_norm: 2.797323396210571, clipped: 1.0
epoch: 15, train_batch_id: 2350, avg_cost: 3.923349380493164
grad_norm: 1.6916254481284185, clipped: 1.0
epoch: 15, train_batch_id: 2400, avg_cost: 3.9076852798461914
grad_norm: 1.8294019723445447, clipped: 1.0
epoch: 15, train_batch_id: 2450, avg_cost: 3.9041600227355957
grad_norm: 2.3991290674139636, clipped: 1.0
Finished epoch 15, took 00:19:19 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.303414821624756 +- 0.00401495024561882
Evaluating candidate model on evaluation dataset
Epoch 15 candidate mean 4.304876327514648, baseline epoch 14 mean 4.278552532196045, difference 0.026323795318603516
Start train epoch 16, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 16, train_batch_id: 0, avg_cost: 3.912330150604248
grad_norm: 2.526607195814265, clipped: 1.0
epoch: 16, train_batch_id: 50, avg_cost: 3.9125070571899414
grad_norm: 2.3625430542595893, clipped: 1.0
epoch: 16, train_batch_id: 100, avg_cost: 3.9055418968200684
grad_norm: 2.8837780648192974, clipped: 1.0
epoch: 16, train_batch_id: 150, avg_cost: 3.8920297622680664
grad_norm: 1.92269838345813, clipped: 1.0
epoch: 16, train_batch_id: 200, avg_cost: 3.9108729362487793
grad_norm: 1.7489283560302316, clipped: 1.0
epoch: 16, train_batch_id: 250, avg_cost: 3.939513683319092
grad_norm: 2.104836581424265, clipped: 1.0
epoch: 16, train_batch_id: 300, avg_cost: 3.919999122619629
grad_norm: 2.01228256348122, clipped: 1.0
epoch: 16, train_batch_id: 350, avg_cost: 3.8892879486083984
grad_norm: 2.13905088051482, clipped: 1.0
epoch: 16, train_batch_id: 400, avg_cost: 3.892854928970337
grad_norm: 2.2048514391549388, clipped: 1.0
epoch: 16, train_batch_id: 450, avg_cost: 3.8975110054016113
grad_norm: 2.6294959961915607, clipped: 1.0
epoch: 16, train_batch_id: 500, avg_cost: 3.9062023162841797
grad_norm: 2.438064931872803, clipped: 1.0
epoch: 16, train_batch_id: 550, avg_cost: 3.882216691970825
grad_norm: 1.6569129291539086, clipped: 1.0
epoch: 16, train_batch_id: 600, avg_cost: 3.9138665199279785
grad_norm: 2.5864511225468956, clipped: 1.0
epoch: 16, train_batch_id: 650, avg_cost: 3.9082202911376953
grad_norm: 2.900689095717443, clipped: 1.0
epoch: 16, train_batch_id: 700, avg_cost: 3.886873483657837
grad_norm: 2.833202464827431, clipped: 1.0
epoch: 16, train_batch_id: 750, avg_cost: 3.8891406059265137
grad_norm: 2.210980271289634, clipped: 1.0
epoch: 16, train_batch_id: 800, avg_cost: 3.896387815475464
grad_norm: 2.7425153080072473, clipped: 1.0
epoch: 16, train_batch_id: 850, avg_cost: 3.9320335388183594
grad_norm: 2.3014721951872925, clipped: 1.0
epoch: 16, train_batch_id: 900, avg_cost: 3.904927968978882
grad_norm: 2.2642047478350045, clipped: 1.0
epoch: 16, train_batch_id: 950, avg_cost: 3.9122986793518066
grad_norm: 2.0169814828966133, clipped: 1.0
epoch: 16, train_batch_id: 1000, avg_cost: 3.9296839237213135
grad_norm: 2.1563091651934707, clipped: 1.0
epoch: 16, train_batch_id: 1050, avg_cost: 3.9068284034729004
grad_norm: 1.9104265938411098, clipped: 1.0
epoch: 16, train_batch_id: 1100, avg_cost: 3.904489040374756
grad_norm: 3.1455103614695923, clipped: 1.0
epoch: 16, train_batch_id: 1150, avg_cost: 3.9390010833740234
grad_norm: 1.9456936201367183, clipped: 1.0
epoch: 16, train_batch_id: 1200, avg_cost: 3.9108479022979736
grad_norm: 2.61894725700585, clipped: 1.0
epoch: 16, train_batch_id: 1250, avg_cost: 3.9237489700317383
grad_norm: 2.646042794870007, clipped: 1.0
epoch: 16, train_batch_id: 1300, avg_cost: 3.9267189502716064
grad_norm: 1.8711773895933461, clipped: 1.0
epoch: 16, train_batch_id: 1350, avg_cost: 3.9206314086914062
grad_norm: 2.2400044815236835, clipped: 1.0
epoch: 16, train_batch_id: 1400, avg_cost: 3.8772530555725098
grad_norm: 2.7035101118380056, clipped: 1.0
epoch: 16, train_batch_id: 1450, avg_cost: 3.936307191848755
grad_norm: 2.2907619784533977, clipped: 1.0
epoch: 16, train_batch_id: 1500, avg_cost: 3.914975643157959
grad_norm: 2.670064462973098, clipped: 1.0
epoch: 16, train_batch_id: 1550, avg_cost: 3.9059152603149414
grad_norm: 2.3406504835952195, clipped: 1.0
epoch: 16, train_batch_id: 1600, avg_cost: 3.906165599822998
grad_norm: 2.3877145675292497, clipped: 1.0
epoch: 16, train_batch_id: 1650, avg_cost: 3.892467498779297
grad_norm: 2.3238920263755243, clipped: 1.0
epoch: 16, train_batch_id: 1700, avg_cost: 3.890324592590332
grad_norm: 2.526043783429168, clipped: 1.0
epoch: 16, train_batch_id: 1750, avg_cost: 3.9181270599365234
grad_norm: 2.0865280812892504, clipped: 1.0
epoch: 16, train_batch_id: 1800, avg_cost: 3.9090797901153564
grad_norm: 3.0988892679711473, clipped: 1.0
epoch: 16, train_batch_id: 1850, avg_cost: 3.9023077487945557
grad_norm: 2.838937680965129, clipped: 1.0
epoch: 16, train_batch_id: 1900, avg_cost: 3.9089982509613037
grad_norm: 2.2964872851609, clipped: 1.0
epoch: 16, train_batch_id: 1950, avg_cost: 3.9218027591705322
grad_norm: 2.052910523487219, clipped: 1.0
epoch: 16, train_batch_id: 2000, avg_cost: 3.9034743309020996
grad_norm: 2.092667491181825, clipped: 1.0
epoch: 16, train_batch_id: 2050, avg_cost: 3.8852038383483887
grad_norm: 2.5854252820412786, clipped: 1.0
epoch: 16, train_batch_id: 2100, avg_cost: 3.90455961227417
grad_norm: 2.497787966480575, clipped: 1.0
epoch: 16, train_batch_id: 2150, avg_cost: 3.902377128601074
grad_norm: 2.281036987345146, clipped: 1.0
epoch: 16, train_batch_id: 2200, avg_cost: 3.88659405708313
grad_norm: 2.718643387255754, clipped: 1.0
epoch: 16, train_batch_id: 2250, avg_cost: 3.9121861457824707
grad_norm: 2.3193380150207528, clipped: 1.0
epoch: 16, train_batch_id: 2300, avg_cost: 3.9353349208831787
grad_norm: 3.293521662413667, clipped: 1.0
epoch: 16, train_batch_id: 2350, avg_cost: 3.8900227546691895
grad_norm: 2.7329715702610065, clipped: 1.0
epoch: 16, train_batch_id: 2400, avg_cost: 3.908829927444458
grad_norm: 2.1764593152227407, clipped: 1.0
epoch: 16, train_batch_id: 2450, avg_cost: 3.926628828048706
grad_norm: 2.323643302823353, clipped: 1.0
Finished epoch 16, took 00:19:22 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.215592861175537 +- 0.003924470394849777
Evaluating candidate model on evaluation dataset
Epoch 16 candidate mean 4.207854270935059, baseline epoch 14 mean 4.278552532196045, difference -0.07069826126098633
p-value: 2.322559936579494e-160
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 17, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


245


171


171


171


epoch: 17, train_batch_id: 0, avg_cost: 3.888117790222168
grad_norm: 2.2886856201941748, clipped: 1.0
epoch: 17, train_batch_id: 50, avg_cost: 3.916463851928711
grad_norm: 1.7421307640754518, clipped: 1.0
epoch: 17, train_batch_id: 100, avg_cost: 3.91318941116333
grad_norm: 2.839761563518297, clipped: 1.0
epoch: 17, train_batch_id: 150, avg_cost: 3.9135806560516357
grad_norm: 2.952606063834172, clipped: 1.0
epoch: 17, train_batch_id: 200, avg_cost: 3.894693613052368
grad_norm: 1.7615375010018433, clipped: 1.0
epoch: 17, train_batch_id: 250, avg_cost: 3.9071803092956543
grad_norm: 2.0728370125640905, clipped: 1.0
epoch: 17, train_batch_id: 300, avg_cost: 3.9054646492004395
grad_norm: 1.6937779706010527, clipped: 1.0
epoch: 17, train_batch_id: 350, avg_cost: 3.9037458896636963
grad_norm: 3.264036547535278, clipped: 1.0
epoch: 17, train_batch_id: 400, avg_cost: 3.9145772457122803
grad_norm: 2.1925128952930666, clipped: 1.0
epoch: 17, train_batch_id: 450, avg_cost: 3.8615667819976807
grad_norm: 1.9341272238813456, clipped: 1.0
epoch: 17, train_batch_id: 500, avg_cost: 3.9076461791992188
grad_norm: 2.0432535041867665, clipped: 1.0
epoch: 17, train_batch_id: 550, avg_cost: 3.921842098236084
grad_norm: 2.0889751480056904, clipped: 1.0
epoch: 17, train_batch_id: 600, avg_cost: 3.9170713424682617
grad_norm: 1.7450551734106832, clipped: 1.0
epoch: 17, train_batch_id: 650, avg_cost: 3.8910391330718994
grad_norm: 2.0544551799259962, clipped: 1.0
epoch: 17, train_batch_id: 700, avg_cost: 3.899639129638672
grad_norm: 1.9552261778626259, clipped: 1.0
epoch: 17, train_batch_id: 750, avg_cost: 3.927229166030884
grad_norm: 1.6327112421569745, clipped: 1.0
epoch: 17, train_batch_id: 800, avg_cost: 3.918274402618408
grad_norm: 2.0043326965503168, clipped: 1.0
epoch: 17, train_batch_id: 850, avg_cost: 3.91671085357666
grad_norm: 2.6078304708254274, clipped: 1.0
epoch: 17, train_batch_id: 900, avg_cost: 3.90397047996521
grad_norm: 1.7188411765790501, clipped: 1.0
epoch: 17, train_batch_id: 950, avg_cost: 3.915522336959839
grad_norm: 2.214508296397806, clipped: 1.0
epoch: 17, train_batch_id: 1000, avg_cost: 3.9093284606933594
grad_norm: 2.1525539088457677, clipped: 1.0
epoch: 17, train_batch_id: 1050, avg_cost: 3.899519443511963
grad_norm: 1.992965384783246, clipped: 1.0
epoch: 17, train_batch_id: 1100, avg_cost: 3.922558546066284
grad_norm: 2.7833371449068247, clipped: 1.0
epoch: 17, train_batch_id: 1150, avg_cost: 3.8876912593841553
grad_norm: 2.3057781199905136, clipped: 1.0
epoch: 17, train_batch_id: 1200, avg_cost: 3.8756346702575684
grad_norm: 2.577333327790072, clipped: 1.0
epoch: 17, train_batch_id: 1250, avg_cost: 3.9143948554992676
grad_norm: 4.5247981574435165, clipped: 1.0
epoch: 17, train_batch_id: 1300, avg_cost: 3.8952372074127197
grad_norm: 1.924454302304739, clipped: 1.0
epoch: 17, train_batch_id: 1350, avg_cost: 3.8970351219177246
grad_norm: 1.5464524374094328, clipped: 1.0
epoch: 17, train_batch_id: 1400, avg_cost: 3.89695143699646
grad_norm: 2.3573522398083893, clipped: 1.0
epoch: 17, train_batch_id: 1450, avg_cost: 3.938459873199463
grad_norm: 1.8698146055765723, clipped: 1.0
epoch: 17, train_batch_id: 1500, avg_cost: 3.897399663925171
grad_norm: 3.2241693029296834, clipped: 1.0
epoch: 17, train_batch_id: 1550, avg_cost: 3.9286789894104004
grad_norm: 1.9310140362821744, clipped: 1.0
epoch: 17, train_batch_id: 1600, avg_cost: 3.9003257751464844
grad_norm: 2.209829121391964, clipped: 1.0
epoch: 17, train_batch_id: 1650, avg_cost: 3.896380662918091
grad_norm: 1.7575281389937494, clipped: 1.0
epoch: 17, train_batch_id: 1700, avg_cost: 3.9112634658813477
grad_norm: 2.4486032420893347, clipped: 1.0
epoch: 17, train_batch_id: 1750, avg_cost: 3.877121686935425
grad_norm: 3.1138371605378934, clipped: 1.0
epoch: 17, train_batch_id: 1800, avg_cost: 3.9162161350250244
grad_norm: 2.1509315914314806, clipped: 1.0
epoch: 17, train_batch_id: 1850, avg_cost: 3.8986504077911377
grad_norm: 2.2274084088231483, clipped: 1.0
epoch: 17, train_batch_id: 1900, avg_cost: 3.9117865562438965
grad_norm: 1.842970467367054, clipped: 1.0
epoch: 17, train_batch_id: 1950, avg_cost: 3.9148952960968018
grad_norm: 1.9775138132230239, clipped: 1.0
epoch: 17, train_batch_id: 2000, avg_cost: 3.888180732727051
grad_norm: 1.825132075675396, clipped: 1.0
epoch: 17, train_batch_id: 2050, avg_cost: 3.8871724605560303
grad_norm: 1.9781536673384428, clipped: 1.0
epoch: 17, train_batch_id: 2100, avg_cost: 3.887406826019287
grad_norm: 2.2705434778701017, clipped: 1.0
epoch: 17, train_batch_id: 2150, avg_cost: 3.9028825759887695
grad_norm: 2.447950030012373, clipped: 1.0
epoch: 17, train_batch_id: 2200, avg_cost: 3.9092936515808105
grad_norm: 2.1275599190917256, clipped: 1.0
epoch: 17, train_batch_id: 2250, avg_cost: 3.8954429626464844
grad_norm: 1.7266040020918845, clipped: 1.0
epoch: 17, train_batch_id: 2300, avg_cost: 3.8902010917663574
grad_norm: 1.788386409811856, clipped: 1.0
epoch: 17, train_batch_id: 2350, avg_cost: 3.905357599258423
grad_norm: 2.078756022192004, clipped: 1.0
epoch: 17, train_batch_id: 2400, avg_cost: 3.894447088241577
grad_norm: 1.6139315624343464, clipped: 1.0
epoch: 17, train_batch_id: 2450, avg_cost: 3.8876399993896484
grad_norm: 2.465741492960708, clipped: 1.0
Finished epoch 17, took 00:19:27 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.139551639556885 +- 0.0036942758597433567
Evaluating candidate model on evaluation dataset
Epoch 17 candidate mean 4.141797065734863, baseline epoch 16 mean 4.217473030090332, difference -0.07567596435546875
p-value: 8.650516041488466e-237
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 18, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


171


epoch: 18, train_batch_id: 0, avg_cost: 3.878307342529297
grad_norm: 1.1449212611033528, clipped: 1.0
epoch: 18, train_batch_id: 50, avg_cost: 3.8797850608825684
grad_norm: 1.627769476609332, clipped: 1.0
epoch: 18, train_batch_id: 100, avg_cost: 3.8933608531951904
grad_norm: 1.485716905385555, clipped: 1.0
epoch: 18, train_batch_id: 150, avg_cost: 3.890251636505127
grad_norm: 1.7031283777785897, clipped: 1.0
epoch: 18, train_batch_id: 200, avg_cost: 3.8867502212524414
grad_norm: 1.5684419302233392, clipped: 1.0
epoch: 18, train_batch_id: 250, avg_cost: 3.8886799812316895
grad_norm: 1.6244771790551573, clipped: 1.0
epoch: 18, train_batch_id: 300, avg_cost: 3.911587953567505
grad_norm: 1.1946358244061202, clipped: 1.0
epoch: 18, train_batch_id: 350, avg_cost: 3.8981380462646484
grad_norm: 1.5345189814900477, clipped: 1.0
epoch: 18, train_batch_id: 400, avg_cost: 3.890392303466797
grad_norm: 1.5229509574943179, clipped: 1.0
epoch: 18, train_batch_id: 450, avg_cost: 3.8953847885131836
grad_norm: 1.4720455040183478, clipped: 1.0
epoch: 18, train_batch_id: 500, avg_cost: 3.8867177963256836
grad_norm: 1.4621539488391897, clipped: 1.0
epoch: 18, train_batch_id: 550, avg_cost: 3.869126081466675
grad_norm: 1.1262345452506117, clipped: 1.0
epoch: 18, train_batch_id: 600, avg_cost: 3.8857812881469727
grad_norm: 2.005693605525289, clipped: 1.0
epoch: 18, train_batch_id: 650, avg_cost: 3.915855884552002
grad_norm: 1.3244177849345444, clipped: 1.0
epoch: 18, train_batch_id: 700, avg_cost: 3.851806640625
grad_norm: 1.2664248614108746, clipped: 1.0
epoch: 18, train_batch_id: 750, avg_cost: 3.8922905921936035
grad_norm: 2.040192184788117, clipped: 1.0
epoch: 18, train_batch_id: 800, avg_cost: 3.903987407684326
grad_norm: 1.3771075840890816, clipped: 1.0
epoch: 18, train_batch_id: 850, avg_cost: 3.9121265411376953
grad_norm: 2.134560573456951, clipped: 1.0
epoch: 18, train_batch_id: 900, avg_cost: 3.9105730056762695
grad_norm: 1.3209414089575853, clipped: 1.0
epoch: 18, train_batch_id: 950, avg_cost: 3.8863184452056885
grad_norm: 2.0624335485803496, clipped: 1.0
epoch: 18, train_batch_id: 1000, avg_cost: 3.901580333709717
grad_norm: 1.5600955372618666, clipped: 1.0
epoch: 18, train_batch_id: 1050, avg_cost: 3.8993706703186035
grad_norm: 1.6235512396318255, clipped: 1.0
epoch: 18, train_batch_id: 1100, avg_cost: 3.8850760459899902
grad_norm: 2.4689927315241462, clipped: 1.0
epoch: 18, train_batch_id: 1150, avg_cost: 3.8766989707946777
grad_norm: 1.486452084946096, clipped: 1.0
epoch: 18, train_batch_id: 1200, avg_cost: 3.861067056655884
grad_norm: 1.6946201911728678, clipped: 1.0
epoch: 18, train_batch_id: 1250, avg_cost: 3.900256633758545
grad_norm: 1.1879823498684503, clipped: 1.0
epoch: 18, train_batch_id: 1300, avg_cost: 3.914398193359375
grad_norm: 1.7719268360300129, clipped: 1.0
epoch: 18, train_batch_id: 1350, avg_cost: 3.8908944129943848
grad_norm: 2.713886495849124, clipped: 1.0
epoch: 18, train_batch_id: 1400, avg_cost: 3.886094093322754
grad_norm: 1.4015313175028399, clipped: 1.0
epoch: 18, train_batch_id: 1450, avg_cost: 3.872145652770996
grad_norm: 1.4756166001194244, clipped: 1.0
epoch: 18, train_batch_id: 1500, avg_cost: 3.8867321014404297
grad_norm: 1.8882230827093687, clipped: 1.0
epoch: 18, train_batch_id: 1550, avg_cost: 3.887186050415039
grad_norm: 1.858293047376144, clipped: 1.0
epoch: 18, train_batch_id: 1600, avg_cost: 3.919210910797119
grad_norm: 1.660382813017852, clipped: 1.0
epoch: 18, train_batch_id: 1650, avg_cost: 3.8839213848114014
grad_norm: 1.4730366228163345, clipped: 1.0
epoch: 18, train_batch_id: 1700, avg_cost: 3.8992457389831543
grad_norm: 1.6101477762955925, clipped: 1.0
epoch: 18, train_batch_id: 1750, avg_cost: 3.8774142265319824
grad_norm: 2.091274036041538, clipped: 1.0
epoch: 18, train_batch_id: 1800, avg_cost: 3.888066291809082
grad_norm: 1.9684793781741328, clipped: 1.0
epoch: 18, train_batch_id: 1850, avg_cost: 3.9179787635803223
grad_norm: 4.189773183788509, clipped: 1.0
epoch: 18, train_batch_id: 1900, avg_cost: 3.892421245574951
grad_norm: 1.852578561662325, clipped: 1.0
epoch: 18, train_batch_id: 1950, avg_cost: 3.8839616775512695
grad_norm: 1.1748882107177816, clipped: 1.0
epoch: 18, train_batch_id: 2000, avg_cost: 3.888533592224121
grad_norm: 2.4075820607588025, clipped: 1.0
epoch: 18, train_batch_id: 2050, avg_cost: 3.9077608585357666
grad_norm: 2.3648896256766605, clipped: 1.0
epoch: 18, train_batch_id: 2100, avg_cost: 3.881707191467285
grad_norm: 6.376053201649824, clipped: 1.0
epoch: 18, train_batch_id: 2150, avg_cost: 3.8905680179595947
grad_norm: 1.68465303079198, clipped: 1.0
epoch: 18, train_batch_id: 2200, avg_cost: 3.9199399948120117
grad_norm: 1.578288857440968, clipped: 1.0
epoch: 18, train_batch_id: 2250, avg_cost: 3.904629707336426
grad_norm: 1.1942752798629621, clipped: 1.0
epoch: 18, train_batch_id: 2300, avg_cost: 3.8865764141082764
grad_norm: 2.4321963995622236, clipped: 1.0
epoch: 18, train_batch_id: 2350, avg_cost: 3.8854475021362305
grad_norm: 1.471646768297246, clipped: 1.0
epoch: 18, train_batch_id: 2400, avg_cost: 3.918217182159424
grad_norm: 1.484138390298574, clipped: 1.0
epoch: 18, train_batch_id: 2450, avg_cost: 3.891812324523926
grad_norm: 1.6350643314847269, clipped: 1.0
Finished epoch 18, took 00:19:30 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.2118611335754395 +- 0.0038859567139297724
Evaluating candidate model on evaluation dataset
Epoch 18 candidate mean 4.211710453033447, baseline epoch 17 mean 4.135786533355713, difference 0.07592391967773438
Start train epoch 19, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 19, train_batch_id: 0, avg_cost: 3.9255080223083496
grad_norm: 1.860077821510439, clipped: 1.0
epoch: 19, train_batch_id: 50, avg_cost: 3.8773341178894043
grad_norm: 1.8742716961747017, clipped: 1.0
epoch: 19, train_batch_id: 100, avg_cost: 3.888171911239624
grad_norm: 1.552019449002575, clipped: 1.0
epoch: 19, train_batch_id: 150, avg_cost: 3.903125286102295
grad_norm: 1.5798710244998835, clipped: 1.0
epoch: 19, train_batch_id: 200, avg_cost: 3.884286642074585
grad_norm: 2.067011166257317, clipped: 1.0
epoch: 19, train_batch_id: 250, avg_cost: 3.907012462615967
grad_norm: 1.7542339889218967, clipped: 1.0
epoch: 19, train_batch_id: 300, avg_cost: 3.908348321914673
grad_norm: 1.4328825466991015, clipped: 1.0
epoch: 19, train_batch_id: 350, avg_cost: 3.88801646232605
grad_norm: 1.5364813909917032, clipped: 1.0
epoch: 19, train_batch_id: 400, avg_cost: 3.871237277984619
grad_norm: 1.2542231637763472, clipped: 1.0
epoch: 19, train_batch_id: 450, avg_cost: 3.907280921936035
grad_norm: 1.5766787818167793, clipped: 1.0
epoch: 19, train_batch_id: 500, avg_cost: 3.8852620124816895
grad_norm: 1.7897802847751496, clipped: 1.0
epoch: 19, train_batch_id: 550, avg_cost: 3.908358335494995
grad_norm: 1.6399386012812438, clipped: 1.0
epoch: 19, train_batch_id: 600, avg_cost: 3.903597831726074
grad_norm: 1.8335227471578235, clipped: 1.0
epoch: 19, train_batch_id: 650, avg_cost: 3.908700466156006
grad_norm: 1.4369906681776905, clipped: 1.0
epoch: 19, train_batch_id: 700, avg_cost: 3.8946447372436523
grad_norm: 1.5334994392318642, clipped: 1.0
epoch: 19, train_batch_id: 750, avg_cost: 3.8974721431732178
grad_norm: 1.6441393876103363, clipped: 1.0
epoch: 19, train_batch_id: 800, avg_cost: 3.908784866333008
grad_norm: 1.2225640168297496, clipped: 1.0
epoch: 19, train_batch_id: 850, avg_cost: 3.9115467071533203
grad_norm: 1.3690634396752284, clipped: 1.0
epoch: 19, train_batch_id: 900, avg_cost: 3.874938488006592
grad_norm: 1.521357840884329, clipped: 1.0
epoch: 19, train_batch_id: 950, avg_cost: 3.8856983184814453
grad_norm: 1.7878196055669089, clipped: 1.0
epoch: 19, train_batch_id: 1000, avg_cost: 3.8993353843688965
grad_norm: 2.0486683931684784, clipped: 1.0
epoch: 19, train_batch_id: 1050, avg_cost: 3.893263816833496
grad_norm: 1.4282107651087086, clipped: 1.0
epoch: 19, train_batch_id: 1100, avg_cost: 3.9164986610412598
grad_norm: 2.280236406742398, clipped: 1.0
epoch: 19, train_batch_id: 1150, avg_cost: 3.9109344482421875
grad_norm: 1.2400266020626287, clipped: 1.0
epoch: 19, train_batch_id: 1200, avg_cost: 3.8672983646392822
grad_norm: 1.374622682480572, clipped: 1.0
epoch: 19, train_batch_id: 1250, avg_cost: 3.8656630516052246
grad_norm: 1.8122178529141113, clipped: 1.0
epoch: 19, train_batch_id: 1300, avg_cost: 3.8894858360290527
grad_norm: 1.5079406448893915, clipped: 1.0
epoch: 19, train_batch_id: 1350, avg_cost: 3.8886923789978027
grad_norm: 1.8468468036633436, clipped: 1.0
epoch: 19, train_batch_id: 1400, avg_cost: 3.9212794303894043
grad_norm: 1.7017689472661472, clipped: 1.0
epoch: 19, train_batch_id: 1450, avg_cost: 3.8803772926330566
grad_norm: 1.8004272346006194, clipped: 1.0
epoch: 19, train_batch_id: 1500, avg_cost: 3.8849472999572754
grad_norm: 1.4883416617199159, clipped: 1.0
epoch: 19, train_batch_id: 1550, avg_cost: 3.8945999145507812
grad_norm: 1.6977798262075368, clipped: 1.0
epoch: 19, train_batch_id: 1600, avg_cost: 3.8873069286346436
grad_norm: 1.4216928367538892, clipped: 1.0
epoch: 19, train_batch_id: 1650, avg_cost: 3.8755359649658203
grad_norm: 1.6579570402713262, clipped: 1.0
epoch: 19, train_batch_id: 1700, avg_cost: 3.902184247970581
grad_norm: 1.5123251165127167, clipped: 1.0
epoch: 19, train_batch_id: 1750, avg_cost: 3.9224672317504883
grad_norm: 1.5098314014656076, clipped: 1.0
epoch: 19, train_batch_id: 1800, avg_cost: 3.8676037788391113
grad_norm: 1.4588466677611596, clipped: 1.0
epoch: 19, train_batch_id: 1850, avg_cost: 3.8938207626342773
grad_norm: 1.7517888893058138, clipped: 1.0
epoch: 19, train_batch_id: 1900, avg_cost: 3.885869026184082
grad_norm: 1.796197969025162, clipped: 1.0
epoch: 19, train_batch_id: 1950, avg_cost: 3.883338451385498
grad_norm: 1.652178553496738, clipped: 1.0
epoch: 19, train_batch_id: 2000, avg_cost: 3.887263298034668
grad_norm: 1.4446709581062451, clipped: 1.0
epoch: 19, train_batch_id: 2050, avg_cost: 3.8769850730895996
grad_norm: 1.7058300714615662, clipped: 1.0
epoch: 19, train_batch_id: 2100, avg_cost: 3.930729866027832
grad_norm: 1.5997901590526822, clipped: 1.0
epoch: 19, train_batch_id: 2150, avg_cost: 3.8775763511657715
grad_norm: 3.0141297467394352, clipped: 1.0
epoch: 19, train_batch_id: 2200, avg_cost: 3.891533613204956
grad_norm: 1.3611020136807521, clipped: 1.0
epoch: 19, train_batch_id: 2250, avg_cost: 3.89481258392334
grad_norm: 1.558474849646665, clipped: 1.0
epoch: 19, train_batch_id: 2300, avg_cost: 3.9053452014923096
grad_norm: 1.4933738728218937, clipped: 1.0
epoch: 19, train_batch_id: 2350, avg_cost: 3.887126922607422
grad_norm: 2.0612629409998653, clipped: 1.0
epoch: 19, train_batch_id: 2400, avg_cost: 3.8819241523742676
grad_norm: 1.4710917159503836, clipped: 1.0
epoch: 19, train_batch_id: 2450, avg_cost: 3.8847384452819824
grad_norm: 1.3895881071383525, clipped: 1.0
Finished epoch 19, took 00:19:22 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.206474304199219 +- 0.003844538237899542
Evaluating candidate model on evaluation dataset
Epoch 19 candidate mean 4.20387601852417, baseline epoch 17 mean 4.135786533355713, difference 0.06808948516845703
Start train epoch 20, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 20, train_batch_id: 0, avg_cost: 3.8746140003204346
grad_norm: 2.151957131748847, clipped: 1.0
epoch: 20, train_batch_id: 50, avg_cost: 3.8757662773132324
grad_norm: 1.7525843164902792, clipped: 1.0
epoch: 20, train_batch_id: 100, avg_cost: 3.8949968814849854
grad_norm: 1.6274969904486842, clipped: 1.0
epoch: 20, train_batch_id: 150, avg_cost: 3.8924813270568848
grad_norm: 1.9024128934452507, clipped: 1.0
epoch: 20, train_batch_id: 200, avg_cost: 3.8719239234924316
grad_norm: 1.8582504762009149, clipped: 1.0
epoch: 20, train_batch_id: 250, avg_cost: 3.898649215698242
grad_norm: 1.545017410361123, clipped: 1.0
epoch: 20, train_batch_id: 300, avg_cost: 3.8893017768859863
grad_norm: 2.8492445913014994, clipped: 1.0
epoch: 20, train_batch_id: 350, avg_cost: 3.8762073516845703
grad_norm: 1.4777824447052672, clipped: 1.0
epoch: 20, train_batch_id: 400, avg_cost: 3.8786544799804688
grad_norm: 1.834008984097506, clipped: 1.0
epoch: 20, train_batch_id: 450, avg_cost: 3.8965048789978027
grad_norm: 1.9046752257494333, clipped: 1.0
epoch: 20, train_batch_id: 500, avg_cost: 3.8879544734954834
grad_norm: 1.7182993761308651, clipped: 1.0
epoch: 20, train_batch_id: 550, avg_cost: 3.8853542804718018
grad_norm: 1.5002521204815753, clipped: 1.0
epoch: 20, train_batch_id: 600, avg_cost: 3.887537956237793
grad_norm: 1.7134121654751648, clipped: 1.0
epoch: 20, train_batch_id: 650, avg_cost: 3.8973493576049805
grad_norm: 1.5503214426089018, clipped: 1.0
epoch: 20, train_batch_id: 700, avg_cost: 3.8698525428771973
grad_norm: 1.458449430038579, clipped: 1.0
epoch: 20, train_batch_id: 750, avg_cost: 3.8735804557800293
grad_norm: 1.8504717997693847, clipped: 1.0
epoch: 20, train_batch_id: 800, avg_cost: 3.894711971282959
grad_norm: 1.3219826073675685, clipped: 1.0
epoch: 20, train_batch_id: 850, avg_cost: 3.9014339447021484
grad_norm: 1.4525463602681974, clipped: 1.0
epoch: 20, train_batch_id: 900, avg_cost: 3.8853931427001953
grad_norm: 1.5303532733633338, clipped: 1.0
epoch: 20, train_batch_id: 950, avg_cost: 3.904758930206299
grad_norm: 1.4373959174179294, clipped: 1.0
epoch: 20, train_batch_id: 1000, avg_cost: 3.8765695095062256
grad_norm: 1.4498382650959407, clipped: 1.0
epoch: 20, train_batch_id: 1050, avg_cost: 3.8944249153137207
grad_norm: 2.2765619727816278, clipped: 1.0
epoch: 20, train_batch_id: 1100, avg_cost: 3.8927528858184814
grad_norm: 2.2120717846233693, clipped: 1.0
epoch: 20, train_batch_id: 1150, avg_cost: 3.8822999000549316
grad_norm: 1.3975952051697011, clipped: 1.0
epoch: 20, train_batch_id: 1200, avg_cost: 3.902533531188965
grad_norm: 1.7439986144202888, clipped: 1.0
epoch: 20, train_batch_id: 1250, avg_cost: 3.8897271156311035
grad_norm: 1.680776907291309, clipped: 1.0
epoch: 20, train_batch_id: 1300, avg_cost: 3.8845386505126953
grad_norm: 1.970643451278074, clipped: 1.0
epoch: 20, train_batch_id: 1350, avg_cost: 3.886192798614502
grad_norm: 1.4751392281969782, clipped: 1.0
epoch: 20, train_batch_id: 1400, avg_cost: 3.8869431018829346
grad_norm: 1.5059591831078194, clipped: 1.0
epoch: 20, train_batch_id: 1450, avg_cost: 3.925037145614624
grad_norm: 1.466184869504388, clipped: 1.0
epoch: 20, train_batch_id: 1500, avg_cost: 3.881997585296631
grad_norm: 2.2054788626673223, clipped: 1.0
epoch: 20, train_batch_id: 1550, avg_cost: 3.877668857574463
grad_norm: 1.677378802519882, clipped: 1.0
epoch: 20, train_batch_id: 1600, avg_cost: 3.894212245941162
grad_norm: 1.4876488550423677, clipped: 1.0
epoch: 20, train_batch_id: 1650, avg_cost: 3.8584842681884766
grad_norm: 1.3957160786060085, clipped: 1.0
epoch: 20, train_batch_id: 1700, avg_cost: 3.891058921813965
grad_norm: 1.8348010910828592, clipped: 1.0
epoch: 20, train_batch_id: 1750, avg_cost: 3.8889565467834473
grad_norm: 1.9367016311487364, clipped: 1.0
epoch: 20, train_batch_id: 1800, avg_cost: 3.894789218902588
grad_norm: 2.294972016431511, clipped: 1.0
epoch: 20, train_batch_id: 1850, avg_cost: 3.9105377197265625
grad_norm: 1.7716640926043414, clipped: 1.0
epoch: 20, train_batch_id: 1900, avg_cost: 3.8982954025268555
grad_norm: 2.476360527810856, clipped: 1.0
epoch: 20, train_batch_id: 1950, avg_cost: 3.9090752601623535
grad_norm: 1.5793185693591258, clipped: 1.0
epoch: 20, train_batch_id: 2000, avg_cost: 3.8915274143218994
grad_norm: 2.286124055641436, clipped: 1.0
epoch: 20, train_batch_id: 2050, avg_cost: 3.9203062057495117
grad_norm: 1.8675495051025972, clipped: 1.0
epoch: 20, train_batch_id: 2100, avg_cost: 3.9088971614837646
grad_norm: 1.7283233698909122, clipped: 1.0
epoch: 20, train_batch_id: 2150, avg_cost: 3.895695447921753
grad_norm: 2.0731163194078808, clipped: 1.0
epoch: 20, train_batch_id: 2200, avg_cost: 3.8729026317596436
grad_norm: 1.3526619385306424, clipped: 1.0
epoch: 20, train_batch_id: 2250, avg_cost: 3.8957600593566895
grad_norm: 1.9305418958597043, clipped: 1.0
epoch: 20, train_batch_id: 2300, avg_cost: 3.8873543739318848
grad_norm: 1.5951514719617959, clipped: 1.0
epoch: 20, train_batch_id: 2350, avg_cost: 3.893087863922119
grad_norm: 1.6039135213327447, clipped: 1.0
epoch: 20, train_batch_id: 2400, avg_cost: 3.8760311603546143
grad_norm: 1.2391743286581416, clipped: 1.0
epoch: 20, train_batch_id: 2450, avg_cost: 3.895982265472412
grad_norm: 1.4841135333206608, clipped: 1.0
Finished epoch 20, took 00:19:21 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.224306583404541 +- 0.0039351936429739
Evaluating candidate model on evaluation dataset
Epoch 20 candidate mean 4.2184247970581055, baseline epoch 17 mean 4.135786533355713, difference 0.08263826370239258
Start train epoch 21, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 21, train_batch_id: 0, avg_cost: 3.8823845386505127
grad_norm: 1.328093473539079, clipped: 1.0
epoch: 21, train_batch_id: 50, avg_cost: 3.8776144981384277
grad_norm: 1.5524735949102662, clipped: 1.0
epoch: 21, train_batch_id: 100, avg_cost: 3.8586575984954834
grad_norm: 1.8507260610694727, clipped: 1.0
epoch: 21, train_batch_id: 150, avg_cost: 3.8502659797668457
grad_norm: 1.3102389544387285, clipped: 1.0
epoch: 21, train_batch_id: 200, avg_cost: 3.8891801834106445
grad_norm: 1.4795054482687768, clipped: 1.0
epoch: 21, train_batch_id: 250, avg_cost: 3.859602928161621
grad_norm: 1.352303246917293, clipped: 1.0
epoch: 21, train_batch_id: 300, avg_cost: 3.8856449127197266
grad_norm: 1.8487062566125607, clipped: 1.0
epoch: 21, train_batch_id: 350, avg_cost: 3.913954734802246
grad_norm: 1.4054531826581291, clipped: 1.0
epoch: 21, train_batch_id: 400, avg_cost: 3.8785362243652344
grad_norm: 1.8703761722433419, clipped: 1.0
epoch: 21, train_batch_id: 450, avg_cost: 3.9151995182037354
grad_norm: 1.5704030275262209, clipped: 1.0
epoch: 21, train_batch_id: 500, avg_cost: 3.876936197280884
grad_norm: 1.983332764349523, clipped: 1.0
epoch: 21, train_batch_id: 550, avg_cost: 3.89850115776062
grad_norm: 1.6672127888209707, clipped: 1.0
epoch: 21, train_batch_id: 600, avg_cost: 3.8921093940734863
grad_norm: 1.9818257291166463, clipped: 1.0
epoch: 21, train_batch_id: 650, avg_cost: 3.868274450302124
grad_norm: 1.747838889232809, clipped: 1.0
epoch: 21, train_batch_id: 700, avg_cost: 3.8892409801483154
grad_norm: 1.2237096997763897, clipped: 1.0
epoch: 21, train_batch_id: 750, avg_cost: 3.8958868980407715
grad_norm: 1.81217101316154, clipped: 1.0
epoch: 21, train_batch_id: 800, avg_cost: 3.9068892002105713
grad_norm: 1.4285046056308437, clipped: 1.0
epoch: 21, train_batch_id: 850, avg_cost: 3.8979804515838623
grad_norm: 1.2532414986589724, clipped: 1.0
epoch: 21, train_batch_id: 900, avg_cost: 3.8845677375793457
grad_norm: 1.6236266893641835, clipped: 1.0
epoch: 21, train_batch_id: 950, avg_cost: 3.8778746128082275
grad_norm: 1.7975757786526463, clipped: 1.0
epoch: 21, train_batch_id: 1000, avg_cost: 3.903611183166504
grad_norm: 1.2587447827537879, clipped: 1.0
epoch: 21, train_batch_id: 1050, avg_cost: 3.8828227519989014
grad_norm: 1.3664338369824272, clipped: 1.0
epoch: 21, train_batch_id: 1100, avg_cost: 3.871549367904663
grad_norm: 1.4320794029627406, clipped: 1.0
epoch: 21, train_batch_id: 1150, avg_cost: 3.8872547149658203
grad_norm: 1.9131448608327726, clipped: 1.0
epoch: 21, train_batch_id: 1200, avg_cost: 3.886934280395508
grad_norm: 1.812700656944444, clipped: 1.0
epoch: 21, train_batch_id: 1250, avg_cost: 3.8771800994873047
grad_norm: 1.5690799600946423, clipped: 1.0
epoch: 21, train_batch_id: 1300, avg_cost: 3.8952622413635254
grad_norm: 2.5697744413518575, clipped: 1.0
epoch: 21, train_batch_id: 1350, avg_cost: 3.857616424560547
grad_norm: 1.5466453717703392, clipped: 1.0
epoch: 21, train_batch_id: 1400, avg_cost: 3.9170899391174316
grad_norm: 1.5721262449451645, clipped: 1.0
epoch: 21, train_batch_id: 1450, avg_cost: 3.87860369682312
grad_norm: 1.7714251229280704, clipped: 1.0
epoch: 21, train_batch_id: 1500, avg_cost: 3.8730366230010986
grad_norm: 1.5340925149557574, clipped: 1.0
epoch: 21, train_batch_id: 1550, avg_cost: 3.8944692611694336
grad_norm: 1.7662450585148035, clipped: 1.0
epoch: 21, train_batch_id: 1600, avg_cost: 3.8982326984405518
grad_norm: 1.8203809763774832, clipped: 1.0
epoch: 21, train_batch_id: 1650, avg_cost: 3.8893303871154785
grad_norm: 1.4100081258377053, clipped: 1.0
epoch: 21, train_batch_id: 1700, avg_cost: 3.9111289978027344
grad_norm: 1.3966493489866212, clipped: 1.0
epoch: 21, train_batch_id: 1750, avg_cost: 3.8666720390319824
grad_norm: 1.9458170733839575, clipped: 1.0
epoch: 21, train_batch_id: 1800, avg_cost: 3.9099318981170654
grad_norm: 1.7155663094204021, clipped: 1.0
epoch: 21, train_batch_id: 1850, avg_cost: 3.872669219970703
grad_norm: 1.8038372446106137, clipped: 1.0
epoch: 21, train_batch_id: 1900, avg_cost: 3.8898983001708984
grad_norm: 1.895020835437099, clipped: 1.0
epoch: 21, train_batch_id: 1950, avg_cost: 3.883270263671875
grad_norm: 1.76547628878761, clipped: 1.0
epoch: 21, train_batch_id: 2000, avg_cost: 3.8855819702148438
grad_norm: 1.6346002557922497, clipped: 1.0
epoch: 21, train_batch_id: 2050, avg_cost: 3.8987388610839844
grad_norm: 1.6035810948071045, clipped: 1.0
epoch: 21, train_batch_id: 2100, avg_cost: 3.8887953758239746
grad_norm: 1.767939486851867, clipped: 1.0
epoch: 21, train_batch_id: 2150, avg_cost: 3.9127960205078125
grad_norm: 1.4765482733229103, clipped: 1.0
epoch: 21, train_batch_id: 2200, avg_cost: 3.884080410003662
grad_norm: 1.6972425001293503, clipped: 1.0
epoch: 21, train_batch_id: 2250, avg_cost: 3.8545596599578857
grad_norm: 2.58456786334269, clipped: 1.0
epoch: 21, train_batch_id: 2300, avg_cost: 3.9127845764160156
grad_norm: 2.402877484561703, clipped: 1.0
epoch: 21, train_batch_id: 2350, avg_cost: 3.8976941108703613
grad_norm: 2.000790866600188, clipped: 1.0
epoch: 21, train_batch_id: 2400, avg_cost: 3.8708438873291016
grad_norm: 1.5710881733934994, clipped: 1.0
epoch: 21, train_batch_id: 2450, avg_cost: 3.8928539752960205
grad_norm: 1.4336082922861453, clipped: 1.0
Finished epoch 21, took 00:19:26 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.143799304962158 +- 0.0036493537481874228
Evaluating candidate model on evaluation dataset
Epoch 21 candidate mean 4.139575004577637, baseline epoch 17 mean 4.135786533355713, difference 0.003788471221923828
Start train epoch 22, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


171


epoch: 22, train_batch_id: 0, avg_cost: 3.908799171447754
grad_norm: 1.4268656505960382, clipped: 1.0
epoch: 22, train_batch_id: 50, avg_cost: 3.851700782775879
grad_norm: 1.5493769462998523, clipped: 1.0
epoch: 22, train_batch_id: 100, avg_cost: 3.8841328620910645
grad_norm: 1.3868709361647993, clipped: 1.0
epoch: 22, train_batch_id: 150, avg_cost: 3.8975093364715576
grad_norm: 2.0808704956493296, clipped: 1.0
epoch: 22, train_batch_id: 200, avg_cost: 3.8772549629211426
grad_norm: 1.5250458072122355, clipped: 1.0
epoch: 22, train_batch_id: 250, avg_cost: 3.914004325866699
grad_norm: 1.6185877440043321, clipped: 1.0
epoch: 22, train_batch_id: 300, avg_cost: 3.8988394737243652
grad_norm: 1.4519577691640677, clipped: 1.0
epoch: 22, train_batch_id: 350, avg_cost: 3.882345199584961
grad_norm: 1.6697292867906932, clipped: 1.0
epoch: 22, train_batch_id: 400, avg_cost: 3.8905115127563477
grad_norm: 1.934580526922505, clipped: 1.0
epoch: 22, train_batch_id: 450, avg_cost: 3.8631808757781982
grad_norm: 1.478434331183643, clipped: 1.0
epoch: 22, train_batch_id: 500, avg_cost: 3.873617649078369
grad_norm: 1.9334391165447933, clipped: 1.0
epoch: 22, train_batch_id: 550, avg_cost: 3.9155516624450684
grad_norm: 1.409039279708697, clipped: 1.0
epoch: 22, train_batch_id: 600, avg_cost: 3.8683366775512695
grad_norm: 1.6738143903954867, clipped: 1.0
epoch: 22, train_batch_id: 650, avg_cost: 3.8709425926208496
grad_norm: 2.0197860756182333, clipped: 1.0
epoch: 22, train_batch_id: 700, avg_cost: 3.869126558303833
grad_norm: 1.7391462716453279, clipped: 1.0
epoch: 22, train_batch_id: 750, avg_cost: 3.875032424926758
grad_norm: 1.557463837218925, clipped: 1.0
epoch: 22, train_batch_id: 800, avg_cost: 3.889582633972168
grad_norm: 1.8401374706359432, clipped: 1.0
epoch: 22, train_batch_id: 850, avg_cost: 3.8497512340545654
grad_norm: 1.2484028932213178, clipped: 1.0
epoch: 22, train_batch_id: 900, avg_cost: 3.8658876419067383
grad_norm: 1.4775007914383087, clipped: 1.0
epoch: 22, train_batch_id: 950, avg_cost: 3.8913211822509766
grad_norm: 1.7706476981295067, clipped: 1.0
epoch: 22, train_batch_id: 1000, avg_cost: 3.8829424381256104
grad_norm: 1.7584452089102958, clipped: 1.0
epoch: 22, train_batch_id: 1050, avg_cost: 3.871917963027954
grad_norm: 1.5220524014107941, clipped: 1.0
epoch: 22, train_batch_id: 1100, avg_cost: 3.8731813430786133
grad_norm: 1.8240273132411369, clipped: 1.0
epoch: 22, train_batch_id: 1150, avg_cost: 3.8789429664611816
grad_norm: 1.659672995298968, clipped: 1.0
epoch: 22, train_batch_id: 1200, avg_cost: 3.8699610233306885
grad_norm: 1.295800590617691, clipped: 1.0
epoch: 22, train_batch_id: 1250, avg_cost: 3.8747215270996094
grad_norm: 1.637010241533024, clipped: 1.0
epoch: 22, train_batch_id: 1300, avg_cost: 3.8853912353515625
grad_norm: 1.5461133562060994, clipped: 1.0
epoch: 22, train_batch_id: 1350, avg_cost: 3.9097654819488525
grad_norm: 1.6703332262197563, clipped: 1.0
epoch: 22, train_batch_id: 1400, avg_cost: 3.8922665119171143
grad_norm: 1.6845564945384481, clipped: 1.0
epoch: 22, train_batch_id: 1450, avg_cost: 3.9048399925231934
grad_norm: 1.7230980917159582, clipped: 1.0
epoch: 22, train_batch_id: 1500, avg_cost: 3.8668458461761475
grad_norm: 1.2725199400936065, clipped: 1.0
epoch: 22, train_batch_id: 1550, avg_cost: 3.893873453140259
grad_norm: 1.7754420116356862, clipped: 1.0
epoch: 22, train_batch_id: 1600, avg_cost: 3.894890785217285
grad_norm: 1.6121468366706153, clipped: 1.0
epoch: 22, train_batch_id: 1650, avg_cost: 3.901115655899048
grad_norm: 2.2158563347366638, clipped: 1.0
epoch: 22, train_batch_id: 1700, avg_cost: 3.8989391326904297
grad_norm: 1.6725311034746713, clipped: 1.0
epoch: 22, train_batch_id: 1750, avg_cost: 3.866311550140381
grad_norm: 1.7843297991300264, clipped: 1.0
epoch: 22, train_batch_id: 1800, avg_cost: 3.900831699371338
grad_norm: 1.7011350383540171, clipped: 1.0
epoch: 22, train_batch_id: 1850, avg_cost: 3.892940044403076
grad_norm: 1.7316771955309826, clipped: 1.0
epoch: 22, train_batch_id: 1900, avg_cost: 3.898397922515869
grad_norm: 2.030590931197562, clipped: 1.0
epoch: 22, train_batch_id: 1950, avg_cost: 3.883023500442505
grad_norm: 1.499153007752574, clipped: 1.0
epoch: 22, train_batch_id: 2000, avg_cost: 3.894721031188965
grad_norm: 1.6288265116602993, clipped: 1.0
epoch: 22, train_batch_id: 2050, avg_cost: 3.884594678878784
grad_norm: 1.8667775063341678, clipped: 1.0
epoch: 22, train_batch_id: 2100, avg_cost: 3.8824915885925293
grad_norm: 1.9426552281397809, clipped: 1.0
epoch: 22, train_batch_id: 2150, avg_cost: 3.901371717453003
grad_norm: 1.3880365921861215, clipped: 1.0
epoch: 22, train_batch_id: 2200, avg_cost: 3.859762668609619
grad_norm: 2.1222032891195948, clipped: 1.0
epoch: 22, train_batch_id: 2250, avg_cost: 3.8776559829711914
grad_norm: 1.464846237149325, clipped: 1.0
epoch: 22, train_batch_id: 2300, avg_cost: 3.888789176940918
grad_norm: 1.9809653386783006, clipped: 1.0
epoch: 22, train_batch_id: 2350, avg_cost: 3.8841867446899414
grad_norm: 1.4706979295799962, clipped: 1.0
epoch: 22, train_batch_id: 2400, avg_cost: 3.8830246925354004
grad_norm: 1.7655038350814634, clipped: 1.0
epoch: 22, train_batch_id: 2450, avg_cost: 3.897660493850708
grad_norm: 2.1837093473154727, clipped: 1.0
Finished epoch 22, took 00:19:23 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.2095255851745605 +- 0.0038348743692040443
Evaluating candidate model on evaluation dataset
Epoch 22 candidate mean 4.20590877532959, baseline epoch 17 mean 4.135786533355713, difference 0.07012224197387695
Start train epoch 23, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 23, train_batch_id: 0, avg_cost: 3.88710880279541
grad_norm: 1.5539048593761702, clipped: 1.0
epoch: 23, train_batch_id: 50, avg_cost: 3.8461806774139404
grad_norm: 1.4891450696129607, clipped: 1.0
epoch: 23, train_batch_id: 100, avg_cost: 3.878037929534912
grad_norm: 1.6791845647183357, clipped: 1.0
epoch: 23, train_batch_id: 150, avg_cost: 3.8726282119750977
grad_norm: 1.6938926983783151, clipped: 1.0
epoch: 23, train_batch_id: 200, avg_cost: 3.867962121963501
grad_norm: 1.2259435041762294, clipped: 1.0
epoch: 23, train_batch_id: 250, avg_cost: 3.8861424922943115
grad_norm: 1.7788402848690004, clipped: 1.0
epoch: 23, train_batch_id: 300, avg_cost: 3.8819942474365234
grad_norm: 1.4735716335934514, clipped: 1.0
epoch: 23, train_batch_id: 350, avg_cost: 3.910982608795166
grad_norm: 2.4081407597727065, clipped: 1.0
epoch: 23, train_batch_id: 400, avg_cost: 3.885551929473877
grad_norm: 1.7256227215925122, clipped: 1.0
epoch: 23, train_batch_id: 450, avg_cost: 3.9250617027282715
grad_norm: 1.4222865205051638, clipped: 1.0
epoch: 23, train_batch_id: 500, avg_cost: 3.8936119079589844
grad_norm: 1.6678000721845816, clipped: 1.0
epoch: 23, train_batch_id: 550, avg_cost: 3.900761604309082
grad_norm: 1.7818904705490075, clipped: 1.0
epoch: 23, train_batch_id: 600, avg_cost: 3.9145493507385254
grad_norm: 2.17474620122482, clipped: 1.0
epoch: 23, train_batch_id: 650, avg_cost: 3.8740406036376953
grad_norm: 1.4409780925927638, clipped: 1.0
epoch: 23, train_batch_id: 700, avg_cost: 3.8991141319274902
grad_norm: 1.8227013550355233, clipped: 1.0
epoch: 23, train_batch_id: 750, avg_cost: 3.877744674682617
grad_norm: 2.223255368118882, clipped: 1.0
epoch: 23, train_batch_id: 800, avg_cost: 3.899275302886963
grad_norm: 1.4573095690741342, clipped: 1.0
epoch: 23, train_batch_id: 850, avg_cost: 3.902283191680908
grad_norm: 1.9155443808351775, clipped: 1.0
epoch: 23, train_batch_id: 900, avg_cost: 3.8857526779174805
grad_norm: 2.3292967442692185, clipped: 1.0
epoch: 23, train_batch_id: 950, avg_cost: 3.8829896450042725
grad_norm: 2.032376886586197, clipped: 1.0
epoch: 23, train_batch_id: 1000, avg_cost: 3.8961071968078613
grad_norm: 1.3807249476465155, clipped: 1.0
epoch: 23, train_batch_id: 1050, avg_cost: 3.8862500190734863
grad_norm: 1.578533427062451, clipped: 1.0
epoch: 23, train_batch_id: 1100, avg_cost: 3.882932424545288
grad_norm: 1.569545192348888, clipped: 1.0
epoch: 23, train_batch_id: 1150, avg_cost: 3.893733263015747
grad_norm: 2.00676457481661, clipped: 1.0
epoch: 23, train_batch_id: 1200, avg_cost: 3.903193950653076
grad_norm: 1.7598599933203587, clipped: 1.0
epoch: 23, train_batch_id: 1250, avg_cost: 3.9012298583984375
grad_norm: 1.6867866313504079, clipped: 1.0
epoch: 23, train_batch_id: 1300, avg_cost: 3.86555814743042
grad_norm: 1.4442200576950028, clipped: 1.0
epoch: 23, train_batch_id: 1350, avg_cost: 3.8714606761932373
grad_norm: 1.8708326584544615, clipped: 1.0
epoch: 23, train_batch_id: 1400, avg_cost: 3.8913533687591553
grad_norm: 1.8462994447688035, clipped: 1.0
epoch: 23, train_batch_id: 1450, avg_cost: 3.8851358890533447
grad_norm: 1.3114311646870513, clipped: 1.0
epoch: 23, train_batch_id: 1500, avg_cost: 3.8776891231536865
grad_norm: 1.738300553748186, clipped: 1.0
epoch: 23, train_batch_id: 1550, avg_cost: 3.8875572681427
grad_norm: 1.6639113506925616, clipped: 1.0
epoch: 23, train_batch_id: 1600, avg_cost: 3.900330066680908
grad_norm: 1.7630056371184544, clipped: 1.0
epoch: 23, train_batch_id: 1650, avg_cost: 3.9026474952697754
grad_norm: 1.418927449855823, clipped: 1.0
epoch: 23, train_batch_id: 1700, avg_cost: 3.8899965286254883
grad_norm: 1.8826310713548564, clipped: 1.0
epoch: 23, train_batch_id: 1750, avg_cost: 3.890195846557617
grad_norm: 1.4859530208416851, clipped: 1.0
epoch: 23, train_batch_id: 1800, avg_cost: 3.870234251022339
grad_norm: 1.3145181884763277, clipped: 1.0
epoch: 23, train_batch_id: 1850, avg_cost: 3.8640458583831787
grad_norm: 2.0709024359613655, clipped: 1.0
epoch: 23, train_batch_id: 1900, avg_cost: 3.9128024578094482
grad_norm: 1.333403660477369, clipped: 1.0
epoch: 23, train_batch_id: 1950, avg_cost: 3.89554500579834
grad_norm: 1.516845187664341, clipped: 1.0
epoch: 23, train_batch_id: 2000, avg_cost: 3.8951737880706787
grad_norm: 2.746242415159138, clipped: 1.0
epoch: 23, train_batch_id: 2050, avg_cost: 3.9119691848754883
grad_norm: 2.2668641971960635, clipped: 1.0
epoch: 23, train_batch_id: 2100, avg_cost: 3.8652429580688477
grad_norm: 1.5375865133287228, clipped: 1.0
epoch: 23, train_batch_id: 2150, avg_cost: 3.9016528129577637
grad_norm: 1.7634247842057527, clipped: 1.0
epoch: 23, train_batch_id: 2200, avg_cost: 3.8868608474731445
grad_norm: 1.3517329014243689, clipped: 1.0
epoch: 23, train_batch_id: 2250, avg_cost: 3.872063398361206
grad_norm: 2.109089716518987, clipped: 1.0
epoch: 23, train_batch_id: 2300, avg_cost: 3.869696617126465
grad_norm: 1.8993249809157424, clipped: 1.0
epoch: 23, train_batch_id: 2350, avg_cost: 3.9019861221313477
grad_norm: 1.213737075413922, clipped: 1.0
epoch: 23, train_batch_id: 2400, avg_cost: 3.871232271194458
grad_norm: 1.8489458647006884, clipped: 1.0
epoch: 23, train_batch_id: 2450, avg_cost: 3.8856563568115234
grad_norm: 1.5120627378298808, clipped: 1.0
Finished epoch 23, took 00:19:25 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.248687744140625 +- 0.003911405336111784
Evaluating candidate model on evaluation dataset
Epoch 23 candidate mean 4.245072841644287, baseline epoch 17 mean 4.135786533355713, difference 0.10928630828857422
Start train epoch 24, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 24, train_batch_id: 0, avg_cost: 3.874081611633301
grad_norm: 2.239564228978248, clipped: 1.0
epoch: 24, train_batch_id: 50, avg_cost: 3.905980110168457
grad_norm: 1.9579579850877897, clipped: 1.0
epoch: 24, train_batch_id: 100, avg_cost: 3.876875162124634
grad_norm: 1.4223791405634483, clipped: 1.0
epoch: 24, train_batch_id: 150, avg_cost: 3.8913497924804688
grad_norm: 1.5866526801153689, clipped: 1.0
epoch: 24, train_batch_id: 200, avg_cost: 3.8951385021209717
grad_norm: 1.63867235836647, clipped: 1.0
epoch: 24, train_batch_id: 250, avg_cost: 3.902921199798584
grad_norm: 1.670834374625393, clipped: 1.0
epoch: 24, train_batch_id: 300, avg_cost: 3.868208885192871
grad_norm: 1.9222338160395969, clipped: 1.0
epoch: 24, train_batch_id: 350, avg_cost: 3.890268564224243
grad_norm: 1.8615654379496602, clipped: 1.0
epoch: 24, train_batch_id: 400, avg_cost: 3.877079486846924
grad_norm: 1.7681453062028039, clipped: 1.0
epoch: 24, train_batch_id: 450, avg_cost: 3.8952574729919434
grad_norm: 1.731755148146031, clipped: 1.0
epoch: 24, train_batch_id: 500, avg_cost: 3.884556770324707
grad_norm: 1.590690468840857, clipped: 1.0
epoch: 24, train_batch_id: 550, avg_cost: 3.915943145751953
grad_norm: 1.773627643909105, clipped: 1.0
epoch: 24, train_batch_id: 600, avg_cost: 3.8943991661071777
grad_norm: 1.7513812244742735, clipped: 1.0
epoch: 24, train_batch_id: 650, avg_cost: 3.874910831451416
grad_norm: 2.0300852364026936, clipped: 1.0
epoch: 24, train_batch_id: 700, avg_cost: 3.893939971923828
grad_norm: 1.2031416416429292, clipped: 1.0
epoch: 24, train_batch_id: 750, avg_cost: 3.880958318710327
grad_norm: 1.8164214882340397, clipped: 1.0
epoch: 24, train_batch_id: 800, avg_cost: 3.902189016342163
grad_norm: 1.754804342878771, clipped: 1.0
epoch: 24, train_batch_id: 850, avg_cost: 3.913963556289673
grad_norm: 1.7835289688756788, clipped: 1.0
epoch: 24, train_batch_id: 900, avg_cost: 3.8742659091949463
grad_norm: 1.466774418720849, clipped: 1.0
epoch: 24, train_batch_id: 950, avg_cost: 3.8779220581054688
grad_norm: 1.6349243715734212, clipped: 1.0
epoch: 24, train_batch_id: 1000, avg_cost: 3.9288296699523926
grad_norm: 1.792835034520871, clipped: 1.0
epoch: 24, train_batch_id: 1050, avg_cost: 3.8969531059265137
grad_norm: 1.605498694478827, clipped: 1.0
epoch: 24, train_batch_id: 1100, avg_cost: 3.87984037399292
grad_norm: 1.5756506760914855, clipped: 1.0
epoch: 24, train_batch_id: 1150, avg_cost: 3.8948402404785156
grad_norm: 2.2695978075371652, clipped: 1.0
epoch: 24, train_batch_id: 1200, avg_cost: 3.8726043701171875
grad_norm: 1.319894090144023, clipped: 1.0
epoch: 24, train_batch_id: 1250, avg_cost: 3.8777167797088623
grad_norm: 1.7861115246542978, clipped: 1.0
epoch: 24, train_batch_id: 1300, avg_cost: 3.890963077545166
grad_norm: 1.5657186881803167, clipped: 1.0
epoch: 24, train_batch_id: 1350, avg_cost: 3.865206718444824
grad_norm: 2.2546442398857436, clipped: 1.0
epoch: 24, train_batch_id: 1400, avg_cost: 3.870776653289795
grad_norm: 2.3124232339608954, clipped: 1.0
epoch: 24, train_batch_id: 1450, avg_cost: 3.914707660675049
grad_norm: 3.1824651257848977, clipped: 1.0
epoch: 24, train_batch_id: 1500, avg_cost: 3.868135452270508
grad_norm: 1.7439862707187985, clipped: 1.0
epoch: 24, train_batch_id: 1550, avg_cost: 3.8790159225463867
grad_norm: 2.1115947657900533, clipped: 1.0
epoch: 24, train_batch_id: 1600, avg_cost: 3.8660547733306885
grad_norm: 2.0817382706463237, clipped: 1.0
epoch: 24, train_batch_id: 1650, avg_cost: 3.898149013519287
grad_norm: 1.552168824023422, clipped: 1.0
epoch: 24, train_batch_id: 1700, avg_cost: 3.8733038902282715
grad_norm: 1.3718531380738188, clipped: 1.0
epoch: 24, train_batch_id: 1750, avg_cost: 3.878178596496582
grad_norm: 1.6005754243925234, clipped: 1.0
epoch: 24, train_batch_id: 1800, avg_cost: 3.888139247894287
grad_norm: 1.5063946763475857, clipped: 1.0
epoch: 24, train_batch_id: 1850, avg_cost: 3.9035396575927734
grad_norm: 1.4346421139328336, clipped: 1.0
epoch: 24, train_batch_id: 1900, avg_cost: 3.885582447052002
grad_norm: 2.167315984656986, clipped: 1.0
epoch: 24, train_batch_id: 1950, avg_cost: 3.88679838180542
grad_norm: 1.704897187755708, clipped: 1.0
epoch: 24, train_batch_id: 2000, avg_cost: 3.899077892303467
grad_norm: 1.61566550328677, clipped: 1.0
epoch: 24, train_batch_id: 2050, avg_cost: 3.8785042762756348
grad_norm: 1.7231150613516246, clipped: 1.0
epoch: 24, train_batch_id: 2100, avg_cost: 3.898773670196533
grad_norm: 2.472566727793208, clipped: 1.0
epoch: 24, train_batch_id: 2150, avg_cost: 3.871324062347412
grad_norm: 1.8001726186467306, clipped: 1.0
epoch: 24, train_batch_id: 2200, avg_cost: 3.8932437896728516
grad_norm: 2.0192149383118183, clipped: 1.0
epoch: 24, train_batch_id: 2250, avg_cost: 3.874778985977173
grad_norm: 1.7284300156764014, clipped: 1.0
epoch: 24, train_batch_id: 2300, avg_cost: 3.8763504028320312
grad_norm: 1.4908408868784093, clipped: 1.0
epoch: 24, train_batch_id: 2350, avg_cost: 3.888660430908203
grad_norm: 1.6477322822300238, clipped: 1.0
epoch: 24, train_batch_id: 2400, avg_cost: 3.8982396125793457
grad_norm: 1.5186688541602547, clipped: 1.0
epoch: 24, train_batch_id: 2450, avg_cost: 3.862769603729248
grad_norm: 1.9036640243398875, clipped: 1.0
Finished epoch 24, took 00:19:21 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.123025894165039 +- 0.003751989919692278
Evaluating candidate model on evaluation dataset
Epoch 24 candidate mean 4.124156475067139, baseline epoch 17 mean 4.135786533355713, difference -0.011630058288574219
p-value: 5.064719081019539e-10
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 25, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


171


epoch: 25, train_batch_id: 0, avg_cost: 3.8873722553253174
grad_norm: 1.595370988879006, clipped: 1.0
epoch: 25, train_batch_id: 50, avg_cost: 3.881906032562256
grad_norm: 1.4992667569085265, clipped: 1.0
epoch: 25, train_batch_id: 100, avg_cost: 3.8701536655426025
grad_norm: 1.4497975251604545, clipped: 1.0
epoch: 25, train_batch_id: 150, avg_cost: 3.8778910636901855
grad_norm: 1.9174522983618172, clipped: 1.0
epoch: 25, train_batch_id: 200, avg_cost: 3.8658430576324463
grad_norm: 1.8559196507568831, clipped: 1.0
epoch: 25, train_batch_id: 250, avg_cost: 3.888362407684326
grad_norm: 1.4974946381665193, clipped: 1.0
epoch: 25, train_batch_id: 300, avg_cost: 3.887631416320801
grad_norm: 1.6565585528354283, clipped: 1.0
epoch: 25, train_batch_id: 350, avg_cost: 3.8904924392700195
grad_norm: 2.3267214233569087, clipped: 1.0
epoch: 25, train_batch_id: 400, avg_cost: 3.8753294944763184
grad_norm: 1.9287166892264889, clipped: 1.0
epoch: 25, train_batch_id: 450, avg_cost: 3.8645105361938477
grad_norm: 2.8880816995795477, clipped: 1.0
epoch: 25, train_batch_id: 500, avg_cost: 3.8823328018188477
grad_norm: 1.7520116584278507, clipped: 1.0
epoch: 25, train_batch_id: 550, avg_cost: 3.8536903858184814
grad_norm: 2.4144809472945714, clipped: 1.0
epoch: 25, train_batch_id: 600, avg_cost: 3.8918840885162354
grad_norm: 1.384193934592036, clipped: 1.0
epoch: 25, train_batch_id: 650, avg_cost: 3.859921455383301
grad_norm: 1.691525667546565, clipped: 1.0
epoch: 25, train_batch_id: 700, avg_cost: 3.8771610260009766
grad_norm: 2.038805646501149, clipped: 1.0
epoch: 25, train_batch_id: 750, avg_cost: 3.910708427429199
grad_norm: 1.6071396628270247, clipped: 1.0
epoch: 25, train_batch_id: 800, avg_cost: 3.9131743907928467
grad_norm: 1.6775477878772762, clipped: 1.0
epoch: 25, train_batch_id: 850, avg_cost: 3.8729207515716553
grad_norm: 1.9087812439262175, clipped: 1.0
epoch: 25, train_batch_id: 900, avg_cost: 3.891533374786377
grad_norm: 2.1645563176885183, clipped: 1.0
epoch: 25, train_batch_id: 950, avg_cost: 3.8768551349639893
grad_norm: 2.4105513911096805, clipped: 1.0
epoch: 25, train_batch_id: 1000, avg_cost: 3.865657329559326
grad_norm: 5.135915186845478, clipped: 1.0
epoch: 25, train_batch_id: 1050, avg_cost: 3.875818967819214
grad_norm: 1.7189129018507607, clipped: 1.0
epoch: 25, train_batch_id: 1100, avg_cost: 3.905579090118408
grad_norm: 1.7257674029140997, clipped: 1.0
epoch: 25, train_batch_id: 1150, avg_cost: 3.882040500640869
grad_norm: 2.0302246910407358, clipped: 1.0
epoch: 25, train_batch_id: 1200, avg_cost: 3.865651845932007
grad_norm: 2.039992120928125, clipped: 1.0
epoch: 25, train_batch_id: 1250, avg_cost: 3.860687255859375
grad_norm: 1.836254437555396, clipped: 1.0
epoch: 25, train_batch_id: 1300, avg_cost: 3.875908374786377
grad_norm: 1.500991944036075, clipped: 1.0
epoch: 25, train_batch_id: 1350, avg_cost: 3.874821424484253
grad_norm: 2.007515360843489, clipped: 1.0
epoch: 25, train_batch_id: 1400, avg_cost: 3.9195897579193115
grad_norm: 2.3691726399328323, clipped: 1.0
epoch: 25, train_batch_id: 1450, avg_cost: 3.8712449073791504
grad_norm: 2.190137308476428, clipped: 1.0
epoch: 25, train_batch_id: 1500, avg_cost: 3.8975558280944824
grad_norm: 2.259644200405988, clipped: 1.0
epoch: 25, train_batch_id: 1550, avg_cost: 3.8669986724853516
grad_norm: 1.7710943407850228, clipped: 1.0
epoch: 25, train_batch_id: 1600, avg_cost: 3.9054512977600098
grad_norm: 1.6367456903524285, clipped: 1.0
epoch: 25, train_batch_id: 1650, avg_cost: 3.8952016830444336
grad_norm: 1.6201616437039026, clipped: 1.0
epoch: 25, train_batch_id: 1700, avg_cost: 3.8957719802856445
grad_norm: 1.6758846687217326, clipped: 1.0
epoch: 25, train_batch_id: 1750, avg_cost: 3.879173755645752
grad_norm: 1.8971200865467917, clipped: 1.0
epoch: 25, train_batch_id: 1800, avg_cost: 3.8921873569488525
grad_norm: 1.5295746799974619, clipped: 1.0
epoch: 25, train_batch_id: 1850, avg_cost: 3.904867649078369
grad_norm: 1.900712327766868, clipped: 1.0
epoch: 25, train_batch_id: 1900, avg_cost: 3.86384916305542
grad_norm: 2.431220959374555, clipped: 1.0
epoch: 25, train_batch_id: 1950, avg_cost: 3.878669261932373
grad_norm: 2.166320505697296, clipped: 1.0
epoch: 25, train_batch_id: 2000, avg_cost: 3.8783230781555176
grad_norm: 1.6639044900530524, clipped: 1.0
epoch: 25, train_batch_id: 2050, avg_cost: 3.8850603103637695
grad_norm: 1.8329976612001437, clipped: 1.0
epoch: 25, train_batch_id: 2100, avg_cost: 3.880964756011963
grad_norm: 1.3544061708847546, clipped: 1.0
epoch: 25, train_batch_id: 2150, avg_cost: 3.87278413772583
grad_norm: 1.5985799572569663, clipped: 1.0
epoch: 25, train_batch_id: 2200, avg_cost: 3.8887102603912354
grad_norm: 1.3498983173049224, clipped: 1.0
epoch: 25, train_batch_id: 2250, avg_cost: 3.8866961002349854
grad_norm: 1.8199871227918665, clipped: 1.0
epoch: 25, train_batch_id: 2300, avg_cost: 3.8757550716400146
grad_norm: 1.6962989020834687, clipped: 1.0
epoch: 25, train_batch_id: 2350, avg_cost: 3.886392593383789
grad_norm: 2.5114517479016647, clipped: 1.0
epoch: 25, train_batch_id: 2400, avg_cost: 3.893773317337036
grad_norm: 1.6624496709656806, clipped: 1.0
epoch: 25, train_batch_id: 2450, avg_cost: 3.8826236724853516
grad_norm: 1.3975285224511969, clipped: 1.0
Finished epoch 25, took 00:19:18 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.176699161529541 +- 0.0038532435428351164
Evaluating candidate model on evaluation dataset
Epoch 25 candidate mean 4.17308235168457, baseline epoch 24 mean 4.11965274810791, difference 0.053429603576660156
Start train epoch 26, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 26, train_batch_id: 0, avg_cost: 3.8656022548675537
grad_norm: 1.6279363493024679, clipped: 1.0
epoch: 26, train_batch_id: 50, avg_cost: 3.8923234939575195
grad_norm: 1.7063761861114872, clipped: 1.0
epoch: 26, train_batch_id: 100, avg_cost: 3.8802528381347656
grad_norm: 1.5390908420102287, clipped: 1.0
epoch: 26, train_batch_id: 150, avg_cost: 3.8773632049560547
grad_norm: 1.7897004620108707, clipped: 1.0
epoch: 26, train_batch_id: 200, avg_cost: 3.8703250885009766
grad_norm: 2.1379064538420045, clipped: 1.0
epoch: 26, train_batch_id: 250, avg_cost: 3.9143524169921875
grad_norm: 2.00212850066923, clipped: 1.0
epoch: 26, train_batch_id: 300, avg_cost: 3.876225471496582
grad_norm: 1.5450518322023779, clipped: 1.0
epoch: 26, train_batch_id: 350, avg_cost: 3.90852952003479
grad_norm: 2.1969141883800116, clipped: 1.0
epoch: 26, train_batch_id: 400, avg_cost: 3.8756613731384277
grad_norm: 1.5623553826920293, clipped: 1.0
epoch: 26, train_batch_id: 450, avg_cost: 3.874178886413574
grad_norm: 1.5258291369557941, clipped: 1.0
epoch: 26, train_batch_id: 500, avg_cost: 3.891812801361084
grad_norm: 2.2147249192250675, clipped: 1.0
epoch: 26, train_batch_id: 550, avg_cost: 3.878077268600464
grad_norm: 2.2273993994554457, clipped: 1.0
epoch: 26, train_batch_id: 600, avg_cost: 3.863726854324341
grad_norm: 1.8763648867945175, clipped: 1.0
epoch: 26, train_batch_id: 650, avg_cost: 3.8964478969573975
grad_norm: 1.8659218498190446, clipped: 1.0
epoch: 26, train_batch_id: 700, avg_cost: 3.8725335597991943
grad_norm: 2.1594217999609815, clipped: 1.0
epoch: 26, train_batch_id: 750, avg_cost: 3.879054546356201
grad_norm: 1.7183999038791244, clipped: 1.0
epoch: 26, train_batch_id: 800, avg_cost: 3.8795833587646484
grad_norm: 1.4087186041217403, clipped: 1.0
epoch: 26, train_batch_id: 850, avg_cost: 3.938744306564331
grad_norm: 1.3166124408842261, clipped: 1.0
epoch: 26, train_batch_id: 900, avg_cost: 3.888533592224121
grad_norm: 1.5177704171997493, clipped: 1.0
epoch: 26, train_batch_id: 950, avg_cost: 3.8837647438049316
grad_norm: 1.4056490044897283, clipped: 1.0
epoch: 26, train_batch_id: 1000, avg_cost: 3.8703994750976562
grad_norm: 1.5794633107488856, clipped: 1.0
epoch: 26, train_batch_id: 1050, avg_cost: 3.889342784881592
grad_norm: 1.9906054148537882, clipped: 1.0
epoch: 26, train_batch_id: 1100, avg_cost: 3.8730216026306152
grad_norm: 1.580506898579874, clipped: 1.0
epoch: 26, train_batch_id: 1150, avg_cost: 3.9049997329711914
grad_norm: 1.0766398871681808, clipped: 1.0
epoch: 26, train_batch_id: 1200, avg_cost: 3.8790698051452637
grad_norm: 1.9052472484560647, clipped: 1.0
epoch: 26, train_batch_id: 1250, avg_cost: 3.8918492794036865
grad_norm: 1.6811131886188098, clipped: 1.0
epoch: 26, train_batch_id: 1300, avg_cost: 3.8993234634399414
grad_norm: 2.03375257006902, clipped: 1.0
epoch: 26, train_batch_id: 1350, avg_cost: 3.867913246154785
grad_norm: 1.3370923181536531, clipped: 1.0
epoch: 26, train_batch_id: 1400, avg_cost: 3.9012598991394043
grad_norm: 1.8312676860919732, clipped: 1.0
epoch: 26, train_batch_id: 1450, avg_cost: 3.871915817260742
grad_norm: 1.7678040741015195, clipped: 1.0
epoch: 26, train_batch_id: 1500, avg_cost: 3.8916139602661133
grad_norm: 1.328889439248449, clipped: 1.0
epoch: 26, train_batch_id: 1550, avg_cost: 3.878664016723633
grad_norm: 2.0949875428800175, clipped: 1.0
epoch: 26, train_batch_id: 1600, avg_cost: 3.885671377182007
grad_norm: 1.6768256102260586, clipped: 1.0
epoch: 26, train_batch_id: 1650, avg_cost: 3.899003028869629
grad_norm: 1.658857193028308, clipped: 1.0
epoch: 26, train_batch_id: 1700, avg_cost: 3.902385711669922
grad_norm: 2.187226252992789, clipped: 1.0
epoch: 26, train_batch_id: 1750, avg_cost: 3.8970179557800293
grad_norm: 1.575827347353282, clipped: 1.0
epoch: 26, train_batch_id: 1800, avg_cost: 3.855746030807495
grad_norm: 1.9946326430384458, clipped: 1.0
epoch: 26, train_batch_id: 1850, avg_cost: 3.8839974403381348
grad_norm: 1.2951818160683213, clipped: 1.0
epoch: 26, train_batch_id: 1900, avg_cost: 3.866755962371826
grad_norm: 1.4476244142707857, clipped: 1.0
epoch: 26, train_batch_id: 1950, avg_cost: 3.894639015197754
grad_norm: 2.3927917252202877, clipped: 1.0
epoch: 26, train_batch_id: 2000, avg_cost: 3.8886141777038574
grad_norm: 1.679292024426803, clipped: 1.0
epoch: 26, train_batch_id: 2050, avg_cost: 3.859198570251465
grad_norm: 1.4481380949389207, clipped: 1.0
epoch: 26, train_batch_id: 2100, avg_cost: 3.8938651084899902
grad_norm: 1.5127590791868417, clipped: 1.0
epoch: 26, train_batch_id: 2150, avg_cost: 3.895486831665039
grad_norm: 1.368974087008529, clipped: 1.0
epoch: 26, train_batch_id: 2200, avg_cost: 3.9231319427490234
grad_norm: 1.7772153835494984, clipped: 1.0
epoch: 26, train_batch_id: 2250, avg_cost: 3.901252031326294
grad_norm: 1.4898338292510491, clipped: 1.0
epoch: 26, train_batch_id: 2300, avg_cost: 3.848296880722046
grad_norm: 1.7042143093324307, clipped: 1.0
epoch: 26, train_batch_id: 2350, avg_cost: 3.8560376167297363
grad_norm: 1.58941507455545, clipped: 1.0
epoch: 26, train_batch_id: 2400, avg_cost: 3.893399953842163
grad_norm: 2.263911146204667, clipped: 1.0
epoch: 26, train_batch_id: 2450, avg_cost: 3.908510684967041
grad_norm: 1.6425974513461357, clipped: 1.0
Finished epoch 26, took 00:19:22 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.18432092666626 +- 0.003839577781036496
Evaluating candidate model on evaluation dataset
Epoch 26 candidate mean 4.182443141937256, baseline epoch 24 mean 4.11965274810791, difference 0.0627903938293457
Start train epoch 27, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


171


epoch: 27, train_batch_id: 0, avg_cost: 3.8883461952209473
grad_norm: 1.5812540304454554, clipped: 1.0
epoch: 27, train_batch_id: 50, avg_cost: 3.8512284755706787
grad_norm: 1.9774732284855137, clipped: 1.0
epoch: 27, train_batch_id: 100, avg_cost: 3.8901185989379883
grad_norm: 1.395440111284209, clipped: 1.0
epoch: 27, train_batch_id: 150, avg_cost: 3.892867088317871
grad_norm: 2.0488952342673725, clipped: 1.0
epoch: 27, train_batch_id: 200, avg_cost: 3.897920608520508
grad_norm: 1.4816590856408713, clipped: 1.0
epoch: 27, train_batch_id: 250, avg_cost: 3.921865463256836
grad_norm: 1.6151392379316183, clipped: 1.0
epoch: 27, train_batch_id: 300, avg_cost: 3.873870372772217
grad_norm: 1.6460647837023539, clipped: 1.0
epoch: 27, train_batch_id: 350, avg_cost: 3.879513740539551
grad_norm: 1.5879887145197362, clipped: 1.0
epoch: 27, train_batch_id: 400, avg_cost: 3.8868637084960938
grad_norm: 1.7428913898793643, clipped: 1.0
epoch: 27, train_batch_id: 450, avg_cost: 3.8899049758911133
grad_norm: 1.508212436933143, clipped: 1.0
epoch: 27, train_batch_id: 500, avg_cost: 3.8899006843566895
grad_norm: 3.2259478648916815, clipped: 1.0
epoch: 27, train_batch_id: 550, avg_cost: 3.899724245071411
grad_norm: 1.553048716081474, clipped: 1.0
epoch: 27, train_batch_id: 600, avg_cost: 3.8708176612854004
grad_norm: 1.929089939420103, clipped: 1.0
epoch: 27, train_batch_id: 650, avg_cost: 3.896113157272339
grad_norm: 1.7460267331830803, clipped: 1.0
epoch: 27, train_batch_id: 700, avg_cost: 3.8928463459014893
grad_norm: 1.4770599091094063, clipped: 1.0
epoch: 27, train_batch_id: 750, avg_cost: 3.8977553844451904
grad_norm: 1.5207603708872515, clipped: 1.0
epoch: 27, train_batch_id: 800, avg_cost: 3.916696548461914
grad_norm: 1.8428089267163061, clipped: 1.0
epoch: 27, train_batch_id: 850, avg_cost: 3.8589229583740234
grad_norm: 1.9741323048410973, clipped: 1.0
epoch: 27, train_batch_id: 900, avg_cost: 3.8552169799804688
grad_norm: 2.7462246051181283, clipped: 1.0
epoch: 27, train_batch_id: 950, avg_cost: 3.9036145210266113
grad_norm: 1.5497354172927706, clipped: 1.0
epoch: 27, train_batch_id: 1000, avg_cost: 3.888489246368408
grad_norm: 1.941619044750034, clipped: 1.0
epoch: 27, train_batch_id: 1050, avg_cost: 3.8779873847961426
grad_norm: 1.6278820565112335, clipped: 1.0
epoch: 27, train_batch_id: 1100, avg_cost: 3.871441125869751
grad_norm: 1.5912513641944845, clipped: 1.0
epoch: 27, train_batch_id: 1150, avg_cost: 3.88213849067688
grad_norm: 1.5543825652692265, clipped: 1.0
epoch: 27, train_batch_id: 1200, avg_cost: 3.8691651821136475
grad_norm: 1.68974496044634, clipped: 1.0
epoch: 27, train_batch_id: 1250, avg_cost: 3.8845255374908447
grad_norm: 2.003045303195651, clipped: 1.0
epoch: 27, train_batch_id: 1300, avg_cost: 3.8780410289764404
grad_norm: 2.8964522794552896, clipped: 1.0
epoch: 27, train_batch_id: 1350, avg_cost: 3.8725786209106445
grad_norm: 1.7484387050140133, clipped: 1.0
epoch: 27, train_batch_id: 1400, avg_cost: 3.9114060401916504
grad_norm: 2.148663206278438, clipped: 1.0
epoch: 27, train_batch_id: 1450, avg_cost: 3.8479561805725098
grad_norm: 1.659661714904594, clipped: 1.0
epoch: 27, train_batch_id: 1500, avg_cost: 3.8933730125427246
grad_norm: 1.8893631652830227, clipped: 1.0
epoch: 27, train_batch_id: 1550, avg_cost: 3.886383533477783
grad_norm: 1.4515623165269829, clipped: 1.0
epoch: 27, train_batch_id: 1600, avg_cost: 3.8602824211120605
grad_norm: 2.2299661674163773, clipped: 1.0
epoch: 27, train_batch_id: 1650, avg_cost: 3.884598731994629
grad_norm: 1.9003188217762164, clipped: 1.0
epoch: 27, train_batch_id: 1700, avg_cost: 3.887579917907715
grad_norm: 2.3123529228617943, clipped: 1.0
epoch: 27, train_batch_id: 1750, avg_cost: 3.882852792739868
grad_norm: 1.6923023495844292, clipped: 1.0
epoch: 27, train_batch_id: 1800, avg_cost: 3.891965389251709
grad_norm: 1.489825698592542, clipped: 1.0
epoch: 27, train_batch_id: 1850, avg_cost: 3.874441146850586
grad_norm: 3.2411585597036208, clipped: 1.0
epoch: 27, train_batch_id: 1900, avg_cost: 3.8935675621032715
grad_norm: 1.3674552855302082, clipped: 1.0
epoch: 27, train_batch_id: 1950, avg_cost: 3.89792537689209
grad_norm: 1.345991256285607, clipped: 1.0
epoch: 27, train_batch_id: 2000, avg_cost: 3.8715903759002686
grad_norm: 2.2759148059875036, clipped: 1.0
epoch: 27, train_batch_id: 2050, avg_cost: 3.8909852504730225
grad_norm: 1.8866144835001808, clipped: 1.0
epoch: 27, train_batch_id: 2100, avg_cost: 3.8784632682800293
grad_norm: 2.072749657580191, clipped: 1.0
epoch: 27, train_batch_id: 2150, avg_cost: 3.9009695053100586
grad_norm: 1.8863346117054203, clipped: 1.0
epoch: 27, train_batch_id: 2200, avg_cost: 3.898376941680908
grad_norm: 2.2199783841686473, clipped: 1.0
epoch: 27, train_batch_id: 2250, avg_cost: 3.8786299228668213
grad_norm: 2.1739656568769252, clipped: 1.0
epoch: 27, train_batch_id: 2300, avg_cost: 3.8824901580810547
grad_norm: 1.229841947350997, clipped: 1.0
epoch: 27, train_batch_id: 2350, avg_cost: 3.8622682094573975
grad_norm: 1.5953926321969754, clipped: 1.0
epoch: 27, train_batch_id: 2400, avg_cost: 3.8683958053588867
grad_norm: 1.3149538499149203, clipped: 1.0
epoch: 27, train_batch_id: 2450, avg_cost: 3.871708393096924
grad_norm: 1.2993306931904185, clipped: 1.0
Finished epoch 27, took 00:19:25 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.09888219833374 +- 0.0036708731204271317
Evaluating candidate model on evaluation dataset
Epoch 27 candidate mean 4.096899509429932, baseline epoch 24 mean 4.11965274810791, difference -0.022753238677978516
p-value: 1.810714433059637e-28
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 28, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 28, train_batch_id: 0, avg_cost: 3.902904748916626
grad_norm: 1.3549130889509966, clipped: 1.0
epoch: 28, train_batch_id: 50, avg_cost: 3.8879754543304443
grad_norm: 1.6380978436772518, clipped: 1.0
epoch: 28, train_batch_id: 100, avg_cost: 3.8858749866485596
grad_norm: 1.425614265929366, clipped: 1.0
epoch: 28, train_batch_id: 150, avg_cost: 3.889066696166992
grad_norm: 1.651699941659414, clipped: 1.0
epoch: 28, train_batch_id: 200, avg_cost: 3.8821232318878174
grad_norm: 1.3265121954936627, clipped: 1.0
epoch: 28, train_batch_id: 250, avg_cost: 3.8632516860961914
grad_norm: 1.281099798698378, clipped: 1.0
epoch: 28, train_batch_id: 300, avg_cost: 3.8883371353149414
grad_norm: 2.0203834842236623, clipped: 1.0
epoch: 28, train_batch_id: 350, avg_cost: 3.885867118835449
grad_norm: 1.6560999431319665, clipped: 1.0
epoch: 28, train_batch_id: 400, avg_cost: 3.8689448833465576
grad_norm: 1.4990415291583428, clipped: 1.0
epoch: 28, train_batch_id: 450, avg_cost: 3.8665449619293213
grad_norm: 1.7801759318212458, clipped: 1.0
epoch: 28, train_batch_id: 500, avg_cost: 3.874739170074463
grad_norm: 2.8489778663335406, clipped: 1.0
epoch: 28, train_batch_id: 550, avg_cost: 3.849320411682129
grad_norm: 1.3572108579405533, clipped: 1.0
epoch: 28, train_batch_id: 600, avg_cost: 3.8890862464904785
grad_norm: 2.9615378633735743, clipped: 1.0
epoch: 28, train_batch_id: 650, avg_cost: 3.854804515838623
grad_norm: 2.344929526717672, clipped: 1.0
epoch: 28, train_batch_id: 700, avg_cost: 3.897545337677002
grad_norm: 1.6621118294597363, clipped: 1.0
epoch: 28, train_batch_id: 750, avg_cost: 3.867292881011963
grad_norm: 1.2074709880760868, clipped: 1.0
epoch: 28, train_batch_id: 800, avg_cost: 3.8849329948425293
grad_norm: 1.6724402943271666, clipped: 1.0
epoch: 28, train_batch_id: 850, avg_cost: 3.8954100608825684
grad_norm: 1.3512755998461583, clipped: 1.0
epoch: 28, train_batch_id: 900, avg_cost: 3.899149179458618
grad_norm: 2.0527552798229856, clipped: 1.0
epoch: 28, train_batch_id: 950, avg_cost: 3.878572940826416
grad_norm: 1.542208816894272, clipped: 1.0
epoch: 28, train_batch_id: 1000, avg_cost: 3.864234685897827
grad_norm: 1.638948569411794, clipped: 1.0
epoch: 28, train_batch_id: 1050, avg_cost: 3.8820133209228516
grad_norm: 1.5798379515826622, clipped: 1.0
epoch: 28, train_batch_id: 1100, avg_cost: 3.8787779808044434
grad_norm: 2.573747260039964, clipped: 1.0
epoch: 28, train_batch_id: 1150, avg_cost: 3.865262031555176
grad_norm: 1.6097177564848455, clipped: 1.0
epoch: 28, train_batch_id: 1200, avg_cost: 3.9094650745391846
grad_norm: 2.0330410282760787, clipped: 1.0
epoch: 28, train_batch_id: 1250, avg_cost: 3.889414072036743
grad_norm: 1.342145887107752, clipped: 1.0
epoch: 28, train_batch_id: 1300, avg_cost: 3.8699684143066406
grad_norm: 2.009582857341339, clipped: 1.0
epoch: 28, train_batch_id: 1350, avg_cost: 3.879302501678467
grad_norm: 1.9231996040392298, clipped: 1.0
epoch: 28, train_batch_id: 1400, avg_cost: 3.8988800048828125
grad_norm: 1.529889406786974, clipped: 1.0
epoch: 28, train_batch_id: 1450, avg_cost: 3.869049549102783
grad_norm: 1.4378352688777347, clipped: 1.0
epoch: 28, train_batch_id: 1500, avg_cost: 3.8843841552734375
grad_norm: 2.072784673546211, clipped: 1.0
epoch: 28, train_batch_id: 1550, avg_cost: 3.8787014484405518
grad_norm: 1.2331977052024088, clipped: 1.0
epoch: 28, train_batch_id: 1600, avg_cost: 3.873387098312378
grad_norm: 1.6392139004217166, clipped: 1.0
epoch: 28, train_batch_id: 1650, avg_cost: 3.907233715057373
grad_norm: 1.4368743088020108, clipped: 1.0
epoch: 28, train_batch_id: 1700, avg_cost: 3.9127941131591797
grad_norm: 1.2639251082774694, clipped: 1.0
epoch: 28, train_batch_id: 1750, avg_cost: 3.8764500617980957
grad_norm: 2.0841989500451725, clipped: 1.0
epoch: 28, train_batch_id: 1800, avg_cost: 3.834784746170044
grad_norm: 1.3468922054083028, clipped: 1.0
epoch: 28, train_batch_id: 1850, avg_cost: 3.907395124435425
grad_norm: 2.257502218759946, clipped: 1.0
epoch: 28, train_batch_id: 1900, avg_cost: 3.878530502319336
grad_norm: 1.460674315454595, clipped: 1.0
epoch: 28, train_batch_id: 1950, avg_cost: 3.878513813018799
grad_norm: 1.5197788518728508, clipped: 1.0
epoch: 28, train_batch_id: 2000, avg_cost: 3.878772258758545
grad_norm: 2.1594109229771106, clipped: 1.0
epoch: 28, train_batch_id: 2050, avg_cost: 3.894596815109253
grad_norm: 1.5401493049712487, clipped: 1.0
epoch: 28, train_batch_id: 2100, avg_cost: 3.8683676719665527
grad_norm: 1.5910753516108056, clipped: 1.0
epoch: 28, train_batch_id: 2150, avg_cost: 3.902550220489502
grad_norm: 1.763254611796443, clipped: 1.0
epoch: 28, train_batch_id: 2200, avg_cost: 3.8674628734588623
grad_norm: 1.5569859958159318, clipped: 1.0
epoch: 28, train_batch_id: 2250, avg_cost: 3.890523672103882
grad_norm: 1.1206390692572028, clipped: 1.0
epoch: 28, train_batch_id: 2300, avg_cost: 3.861184597015381
grad_norm: 1.4571623041414405, clipped: 1.0
epoch: 28, train_batch_id: 2350, avg_cost: 3.899472713470459
grad_norm: 1.4783048341546223, clipped: 1.0
epoch: 28, train_batch_id: 2400, avg_cost: 3.8909804821014404
grad_norm: 1.462130201197876, clipped: 1.0
epoch: 28, train_batch_id: 2450, avg_cost: 3.880059242248535
grad_norm: 2.007973669611705, clipped: 1.0
Finished epoch 28, took 00:19:23 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.0716376304626465 +- 0.0036209726240485907
Evaluating candidate model on evaluation dataset
Epoch 28 candidate mean 4.074008464813232, baseline epoch 27 mean 4.102735996246338, difference -0.02872753143310547
p-value: 1.3986012515031377e-45
Update baseline
Evaluating baseline model on evaluation dataset
Start train epoch 29, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


171


epoch: 29, train_batch_id: 0, avg_cost: 3.8759727478027344
grad_norm: 1.2635555693912366, clipped: 1.0
epoch: 29, train_batch_id: 50, avg_cost: 3.89361834526062
grad_norm: 1.6065138178873588, clipped: 1.0
epoch: 29, train_batch_id: 100, avg_cost: 3.884434223175049
grad_norm: 2.1982581898874147, clipped: 1.0
epoch: 29, train_batch_id: 150, avg_cost: 3.8970794677734375
grad_norm: 1.0885525493637438, clipped: 1.0
epoch: 29, train_batch_id: 200, avg_cost: 3.8940963745117188
grad_norm: 1.3710815650560235, clipped: 1.0
epoch: 29, train_batch_id: 250, avg_cost: 3.8737590312957764
grad_norm: 1.467669349777314, clipped: 1.0
epoch: 29, train_batch_id: 300, avg_cost: 3.89503812789917
grad_norm: 1.2368424901464137, clipped: 1.0
epoch: 29, train_batch_id: 350, avg_cost: 3.8839035034179688
grad_norm: 2.1410036877251484, clipped: 1.0
epoch: 29, train_batch_id: 400, avg_cost: 3.8717565536499023
grad_norm: 1.3835151635925782, clipped: 1.0
epoch: 29, train_batch_id: 450, avg_cost: 3.91316294670105
grad_norm: 1.1696907745866845, clipped: 1.0
epoch: 29, train_batch_id: 500, avg_cost: 3.8705015182495117
grad_norm: 2.4355794748751793, clipped: 1.0
epoch: 29, train_batch_id: 550, avg_cost: 3.8719606399536133
grad_norm: 1.5404971060027843, clipped: 1.0
epoch: 29, train_batch_id: 600, avg_cost: 3.8778269290924072
grad_norm: 1.5235083175396553, clipped: 1.0
epoch: 29, train_batch_id: 650, avg_cost: 3.9022724628448486
grad_norm: 1.8065680057434879, clipped: 1.0
epoch: 29, train_batch_id: 700, avg_cost: 3.896965265274048
grad_norm: 2.2691106831412817, clipped: 1.0
epoch: 29, train_batch_id: 750, avg_cost: 3.8766067028045654
grad_norm: 1.63203665040261, clipped: 1.0
epoch: 29, train_batch_id: 800, avg_cost: 3.870968818664551
grad_norm: 1.5231199758967864, clipped: 1.0
epoch: 29, train_batch_id: 850, avg_cost: 3.8878045082092285
grad_norm: 1.2226863509309798, clipped: 1.0
epoch: 29, train_batch_id: 900, avg_cost: 3.882016658782959
grad_norm: 1.5168413319363112, clipped: 1.0
epoch: 29, train_batch_id: 950, avg_cost: 3.880277633666992
grad_norm: 1.381233902527024, clipped: 1.0
epoch: 29, train_batch_id: 1000, avg_cost: 3.8882765769958496
grad_norm: 1.048859583686005, clipped: 1.0
epoch: 29, train_batch_id: 1050, avg_cost: 3.903696298599243
grad_norm: 1.360029135940834, clipped: 1.0
epoch: 29, train_batch_id: 1100, avg_cost: 3.885206699371338
grad_norm: 1.2926995182051733, clipped: 1.0
epoch: 29, train_batch_id: 1150, avg_cost: 3.8839545249938965
grad_norm: 1.2633026027891645, clipped: 1.0
epoch: 29, train_batch_id: 1200, avg_cost: 3.905482292175293
grad_norm: 1.7241190573731844, clipped: 1.0
epoch: 29, train_batch_id: 1250, avg_cost: 3.89475154876709
grad_norm: 1.7314026813973646, clipped: 1.0
epoch: 29, train_batch_id: 1300, avg_cost: 3.8777806758880615
grad_norm: 1.4171752664991364, clipped: 1.0
epoch: 29, train_batch_id: 1350, avg_cost: 3.8865108489990234
grad_norm: 1.636583815224028, clipped: 1.0
epoch: 29, train_batch_id: 1400, avg_cost: 3.873882293701172
grad_norm: 1.192088369389269, clipped: 1.0
epoch: 29, train_batch_id: 1450, avg_cost: 3.874460220336914
grad_norm: 1.458050562562636, clipped: 1.0
epoch: 29, train_batch_id: 1500, avg_cost: 3.8783226013183594
grad_norm: 1.5922165906068395, clipped: 1.0
epoch: 29, train_batch_id: 1550, avg_cost: 3.876737356185913
grad_norm: 1.1224229910313692, clipped: 1.0
epoch: 29, train_batch_id: 1600, avg_cost: 3.913058280944824
grad_norm: 1.1016003691259038, clipped: 1.0
epoch: 29, train_batch_id: 1650, avg_cost: 3.890925884246826
grad_norm: 1.5173480420695011, clipped: 1.0
epoch: 29, train_batch_id: 1700, avg_cost: 3.8644378185272217
grad_norm: 1.3931045549108576, clipped: 1.0
epoch: 29, train_batch_id: 1750, avg_cost: 3.8521652221679688
grad_norm: 1.2110825045552034, clipped: 1.0
epoch: 29, train_batch_id: 1800, avg_cost: 3.8771440982818604
grad_norm: 1.7184497779574017, clipped: 1.0
epoch: 29, train_batch_id: 1850, avg_cost: 3.8744077682495117
grad_norm: 1.6264832048930589, clipped: 1.0
epoch: 29, train_batch_id: 1900, avg_cost: 3.8897130489349365
grad_norm: 1.2344585505219416, clipped: 1.0
epoch: 29, train_batch_id: 1950, avg_cost: 3.8816187381744385
grad_norm: 1.4511137058643109, clipped: 1.0
epoch: 29, train_batch_id: 2000, avg_cost: 3.895371437072754
grad_norm: 1.4206891656280882, clipped: 1.0
epoch: 29, train_batch_id: 2050, avg_cost: 3.8982291221618652
grad_norm: 1.3916561952860873, clipped: 1.0
epoch: 29, train_batch_id: 2100, avg_cost: 3.881110668182373
grad_norm: 1.411840516034954, clipped: 1.0
epoch: 29, train_batch_id: 2150, avg_cost: 3.8934221267700195
grad_norm: 1.3328149232050746, clipped: 1.0
epoch: 29, train_batch_id: 2200, avg_cost: 3.8654417991638184
grad_norm: 1.2506297012326915, clipped: 1.0
epoch: 29, train_batch_id: 2250, avg_cost: 3.8836162090301514
grad_norm: 1.9615512641802957, clipped: 1.0
epoch: 29, train_batch_id: 2300, avg_cost: 3.8799784183502197
grad_norm: 2.166138917298428, clipped: 1.0
epoch: 29, train_batch_id: 2350, avg_cost: 3.864433765411377
grad_norm: 2.03021762622041, clipped: 1.0
epoch: 29, train_batch_id: 2400, avg_cost: 3.860527992248535
grad_norm: 2.0451291816131736, clipped: 1.0
epoch: 29, train_batch_id: 2450, avg_cost: 3.8678219318389893
grad_norm: 1.7072836499176667, clipped: 1.0
Finished epoch 29, took 00:19:18 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.195164203643799 +- 0.00385288055986166
Evaluating candidate model on evaluation dataset
Epoch 29 candidate mean 4.195030212402344, baseline epoch 28 mean 4.070762634277344, difference 0.124267578125
Start train epoch 30, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 30, train_batch_id: 0, avg_cost: 3.8689918518066406
grad_norm: 1.7711311039783773, clipped: 1.0
epoch: 30, train_batch_id: 50, avg_cost: 3.886904716491699
grad_norm: 1.4062921433602045, clipped: 1.0
epoch: 30, train_batch_id: 100, avg_cost: 3.8783013820648193
grad_norm: 1.7000152672226339, clipped: 1.0
epoch: 30, train_batch_id: 150, avg_cost: 3.881014108657837
grad_norm: 1.477594963578835, clipped: 1.0
epoch: 30, train_batch_id: 200, avg_cost: 3.8797285556793213
grad_norm: 1.668303683230353, clipped: 1.0
epoch: 30, train_batch_id: 250, avg_cost: 3.8842382431030273
grad_norm: 1.3221762694349661, clipped: 1.0
epoch: 30, train_batch_id: 300, avg_cost: 3.8831677436828613
grad_norm: 2.3108840192497246, clipped: 1.0
epoch: 30, train_batch_id: 350, avg_cost: 3.8769760131835938
grad_norm: 1.2213422889665941, clipped: 1.0
epoch: 30, train_batch_id: 400, avg_cost: 3.8684349060058594
grad_norm: 1.4534578945214869, clipped: 1.0
epoch: 30, train_batch_id: 450, avg_cost: 3.8915910720825195
grad_norm: 1.4054673001222289, clipped: 1.0
epoch: 30, train_batch_id: 500, avg_cost: 3.885500192642212
grad_norm: 1.8399384521913038, clipped: 1.0
epoch: 30, train_batch_id: 550, avg_cost: 3.8620922565460205
grad_norm: 1.356634757811757, clipped: 1.0
epoch: 30, train_batch_id: 600, avg_cost: 3.869871139526367
grad_norm: 1.432925686190024, clipped: 1.0
epoch: 30, train_batch_id: 650, avg_cost: 3.8767592906951904
grad_norm: 0.9198949397001988, clipped: 0.9198949397001988
epoch: 30, train_batch_id: 700, avg_cost: 3.86834716796875
grad_norm: 1.1177793785371133, clipped: 1.0
epoch: 30, train_batch_id: 750, avg_cost: 3.883131265640259
grad_norm: 1.4239783360721865, clipped: 1.0
epoch: 30, train_batch_id: 800, avg_cost: 3.8944010734558105
grad_norm: 1.5353617675728115, clipped: 1.0
epoch: 30, train_batch_id: 850, avg_cost: 3.886605739593506
grad_norm: 1.698435585264831, clipped: 1.0
epoch: 30, train_batch_id: 900, avg_cost: 3.887204647064209
grad_norm: 1.2542433134648734, clipped: 1.0
epoch: 30, train_batch_id: 950, avg_cost: 3.89389705657959
grad_norm: 1.3811696944789662, clipped: 1.0
epoch: 30, train_batch_id: 1000, avg_cost: 3.867514133453369
grad_norm: 1.6808796698119592, clipped: 1.0
epoch: 30, train_batch_id: 1050, avg_cost: 3.867928981781006
grad_norm: 1.5890460448373702, clipped: 1.0
epoch: 30, train_batch_id: 1100, avg_cost: 3.8637948036193848
grad_norm: 2.1601809730095933, clipped: 1.0
epoch: 30, train_batch_id: 1150, avg_cost: 3.8809866905212402
grad_norm: 1.5640775002858187, clipped: 1.0
epoch: 30, train_batch_id: 1200, avg_cost: 3.8950891494750977
grad_norm: 3.015657498520634, clipped: 1.0
epoch: 30, train_batch_id: 1250, avg_cost: 3.9041855335235596
grad_norm: 1.8101767503912902, clipped: 1.0
epoch: 30, train_batch_id: 1300, avg_cost: 3.896482229232788
grad_norm: 1.3088054242505809, clipped: 1.0
epoch: 30, train_batch_id: 1350, avg_cost: 3.892195701599121
grad_norm: 1.3513520666209586, clipped: 1.0
epoch: 30, train_batch_id: 1400, avg_cost: 3.8502564430236816
grad_norm: 1.5113376774399478, clipped: 1.0
epoch: 30, train_batch_id: 1450, avg_cost: 3.8796770572662354
grad_norm: 1.5221739816948656, clipped: 1.0
epoch: 30, train_batch_id: 1500, avg_cost: 3.876117706298828
grad_norm: 1.1221857452389272, clipped: 1.0
epoch: 30, train_batch_id: 1550, avg_cost: 3.8766403198242188
grad_norm: 1.2894768043323326, clipped: 1.0
epoch: 30, train_batch_id: 1600, avg_cost: 3.8862533569335938
grad_norm: 1.0959756962432108, clipped: 1.0
epoch: 30, train_batch_id: 1650, avg_cost: 3.902338743209839
grad_norm: 1.2504166838608215, clipped: 1.0
epoch: 30, train_batch_id: 1700, avg_cost: 3.8749940395355225
grad_norm: 1.3815652322765284, clipped: 1.0
epoch: 30, train_batch_id: 1750, avg_cost: 3.865017890930176
grad_norm: 1.3877926342797564, clipped: 1.0
epoch: 30, train_batch_id: 1800, avg_cost: 3.8668131828308105
grad_norm: 1.4178510499537216, clipped: 1.0
epoch: 30, train_batch_id: 1850, avg_cost: 3.876598834991455
grad_norm: 1.6231556300316576, clipped: 1.0
epoch: 30, train_batch_id: 1900, avg_cost: 3.8944578170776367
grad_norm: 1.3722118156411207, clipped: 1.0
epoch: 30, train_batch_id: 1950, avg_cost: 3.882291555404663
grad_norm: 1.418073874556162, clipped: 1.0
epoch: 30, train_batch_id: 2000, avg_cost: 3.8845949172973633
grad_norm: 0.9772949907040309, clipped: 0.9772949907040309
epoch: 30, train_batch_id: 2050, avg_cost: 3.887145519256592
grad_norm: 2.2693611903457063, clipped: 1.0
epoch: 30, train_batch_id: 2100, avg_cost: 3.888892412185669
grad_norm: 1.1197865190106353, clipped: 1.0
epoch: 30, train_batch_id: 2150, avg_cost: 3.8662734031677246
grad_norm: 1.618375722085646, clipped: 1.0
epoch: 30, train_batch_id: 2200, avg_cost: 3.898014545440674
grad_norm: 1.7515214725594896, clipped: 1.0
epoch: 30, train_batch_id: 2250, avg_cost: 3.886850118637085
grad_norm: 1.4817525989414424, clipped: 1.0
epoch: 30, train_batch_id: 2300, avg_cost: 3.8876395225524902
grad_norm: 1.6945486180951026, clipped: 1.0
epoch: 30, train_batch_id: 2350, avg_cost: 3.8752613067626953
grad_norm: 1.9901728449845222, clipped: 1.0
epoch: 30, train_batch_id: 2400, avg_cost: 3.887263536453247
grad_norm: 2.525061431326968, clipped: 1.0
epoch: 30, train_batch_id: 2450, avg_cost: 3.8778886795043945
grad_norm: 1.613288543230054, clipped: 1.0
Finished epoch 30, took 00:19:23 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.153789043426514 +- 0.003758118487894535
Evaluating candidate model on evaluation dataset
Epoch 30 candidate mean 4.155087947845459, baseline epoch 28 mean 4.070762634277344, difference 0.08432531356811523
Start train epoch 31, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


171


epoch: 31, train_batch_id: 0, avg_cost: 3.8506908416748047
grad_norm: 1.1728119777534005, clipped: 1.0
epoch: 31, train_batch_id: 50, avg_cost: 3.8822147846221924
grad_norm: 1.4851641473832393, clipped: 1.0
epoch: 31, train_batch_id: 100, avg_cost: 3.8847856521606445
grad_norm: 1.4827549801964361, clipped: 1.0
epoch: 31, train_batch_id: 150, avg_cost: 3.8601596355438232
grad_norm: 1.2434762881689354, clipped: 1.0
epoch: 31, train_batch_id: 200, avg_cost: 3.8775558471679688
grad_norm: 1.3398479050300784, clipped: 1.0
epoch: 31, train_batch_id: 250, avg_cost: 3.8793697357177734
grad_norm: 2.0954769191132887, clipped: 1.0
epoch: 31, train_batch_id: 300, avg_cost: 3.875042676925659
grad_norm: 1.240532254841969, clipped: 1.0
epoch: 31, train_batch_id: 350, avg_cost: 3.859269618988037
grad_norm: 1.6665954172465396, clipped: 1.0
epoch: 31, train_batch_id: 400, avg_cost: 3.8971266746520996
grad_norm: 1.2385485787209376, clipped: 1.0
epoch: 31, train_batch_id: 450, avg_cost: 3.88956356048584
grad_norm: 1.585355432899891, clipped: 1.0
epoch: 31, train_batch_id: 500, avg_cost: 3.8984618186950684
grad_norm: 1.7214804569417748, clipped: 1.0
epoch: 31, train_batch_id: 550, avg_cost: 3.872697591781616
grad_norm: 1.5048468087171625, clipped: 1.0
epoch: 31, train_batch_id: 600, avg_cost: 3.8800570964813232
grad_norm: 0.9390593849192042, clipped: 0.9390593849192042
epoch: 31, train_batch_id: 650, avg_cost: 3.872443675994873
grad_norm: 1.29490899888501, clipped: 1.0
epoch: 31, train_batch_id: 700, avg_cost: 3.8779377937316895
grad_norm: 1.6492818513185123, clipped: 1.0
epoch: 31, train_batch_id: 750, avg_cost: 3.8624565601348877
grad_norm: 1.6391373038894226, clipped: 1.0
epoch: 31, train_batch_id: 800, avg_cost: 3.87385892868042
grad_norm: 1.495090738530341, clipped: 1.0
epoch: 31, train_batch_id: 850, avg_cost: 3.879873752593994
grad_norm: 1.640878181821363, clipped: 1.0
epoch: 31, train_batch_id: 900, avg_cost: 3.8756699562072754
grad_norm: 1.2661388152750295, clipped: 1.0
epoch: 31, train_batch_id: 950, avg_cost: 3.8671326637268066
grad_norm: 2.054456116780275, clipped: 1.0
epoch: 31, train_batch_id: 1000, avg_cost: 3.866262435913086
grad_norm: 1.3993383293792343, clipped: 1.0
epoch: 31, train_batch_id: 1050, avg_cost: 3.895541191101074
grad_norm: 1.6255247343204324, clipped: 1.0
epoch: 31, train_batch_id: 1100, avg_cost: 3.884984254837036
grad_norm: 1.551196310010415, clipped: 1.0
epoch: 31, train_batch_id: 1150, avg_cost: 3.8581671714782715
grad_norm: 1.2582797665992422, clipped: 1.0
epoch: 31, train_batch_id: 1200, avg_cost: 3.8826065063476562
grad_norm: 1.2705979090272268, clipped: 1.0
epoch: 31, train_batch_id: 1250, avg_cost: 3.872624397277832
grad_norm: 1.4426252210552928, clipped: 1.0
epoch: 31, train_batch_id: 1300, avg_cost: 3.8905982971191406
grad_norm: 1.6986569514608065, clipped: 1.0
epoch: 31, train_batch_id: 1350, avg_cost: 3.8960089683532715
grad_norm: 1.5526252979843074, clipped: 1.0
epoch: 31, train_batch_id: 1400, avg_cost: 3.8827714920043945
grad_norm: 1.8461309990927968, clipped: 1.0
epoch: 31, train_batch_id: 1450, avg_cost: 3.8783702850341797
grad_norm: 2.746639487025223, clipped: 1.0
epoch: 31, train_batch_id: 1500, avg_cost: 3.881065607070923
grad_norm: 1.3260661658218744, clipped: 1.0
epoch: 31, train_batch_id: 1550, avg_cost: 3.8720996379852295
grad_norm: 1.1077212531552305, clipped: 1.0
epoch: 31, train_batch_id: 1600, avg_cost: 3.8700547218322754
grad_norm: 1.9501375743908622, clipped: 1.0
epoch: 31, train_batch_id: 1650, avg_cost: 3.8831419944763184
grad_norm: 2.297856876320393, clipped: 1.0
epoch: 31, train_batch_id: 1700, avg_cost: 3.907855987548828
grad_norm: 2.316910979271914, clipped: 1.0
epoch: 31, train_batch_id: 1750, avg_cost: 3.881863594055176
grad_norm: 1.6531921396180012, clipped: 1.0
epoch: 31, train_batch_id: 1800, avg_cost: 3.894367218017578
grad_norm: 2.150172739860927, clipped: 1.0
epoch: 31, train_batch_id: 1850, avg_cost: 3.867429256439209
grad_norm: 1.4196015540035833, clipped: 1.0
epoch: 31, train_batch_id: 1900, avg_cost: 3.8877944946289062
grad_norm: 2.1090732109260646, clipped: 1.0
epoch: 31, train_batch_id: 1950, avg_cost: 3.867292881011963
grad_norm: 1.395068029215669, clipped: 1.0
epoch: 31, train_batch_id: 2000, avg_cost: 3.8659026622772217
grad_norm: 1.118376151990543, clipped: 1.0
epoch: 31, train_batch_id: 2050, avg_cost: 3.86495041847229
grad_norm: 1.5104577809144972, clipped: 1.0
epoch: 31, train_batch_id: 2100, avg_cost: 3.8715648651123047
grad_norm: 1.6223351646079567, clipped: 1.0
epoch: 31, train_batch_id: 2150, avg_cost: 3.865604877471924
grad_norm: 1.2340608193603944, clipped: 1.0
epoch: 31, train_batch_id: 2200, avg_cost: 3.905200719833374
grad_norm: 10.50162167575708, clipped: 1.0
epoch: 31, train_batch_id: 2250, avg_cost: 3.892658233642578
grad_norm: 1.1804735006349962, clipped: 1.0
epoch: 31, train_batch_id: 2300, avg_cost: 3.876349449157715
grad_norm: 1.3761385426289694, clipped: 1.0
epoch: 31, train_batch_id: 2350, avg_cost: 3.8998453617095947
grad_norm: 1.2011823960051822, clipped: 1.0
epoch: 31, train_batch_id: 2400, avg_cost: 3.88205885887146
grad_norm: 1.741442758723124, clipped: 1.0
epoch: 31, train_batch_id: 2450, avg_cost: 3.871135711669922
grad_norm: 1.8665619186844147, clipped: 1.0
Finished epoch 31, took 00:19:18 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.128693580627441 +- 0.003723621368408203
Evaluating candidate model on evaluation dataset
Epoch 31 candidate mean 4.127227306365967, baseline epoch 28 mean 4.070762634277344, difference 0.05646467208862305
Start train epoch 32, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 32, train_batch_id: 0, avg_cost: 3.863284111022949
grad_norm: 1.6853523685921514, clipped: 1.0
epoch: 32, train_batch_id: 50, avg_cost: 3.857314348220825
grad_norm: 1.2967752793978282, clipped: 1.0
epoch: 32, train_batch_id: 100, avg_cost: 3.87553334236145
grad_norm: 1.7922042176313506, clipped: 1.0
epoch: 32, train_batch_id: 150, avg_cost: 3.8710222244262695
grad_norm: 1.2519405944742565, clipped: 1.0
epoch: 32, train_batch_id: 200, avg_cost: 3.8649141788482666
grad_norm: 1.6128688557761721, clipped: 1.0
epoch: 32, train_batch_id: 250, avg_cost: 3.858147382736206
grad_norm: 1.3920429189516745, clipped: 1.0
epoch: 32, train_batch_id: 300, avg_cost: 3.875086784362793
grad_norm: 1.669344878826456, clipped: 1.0
epoch: 32, train_batch_id: 350, avg_cost: 3.89383864402771
grad_norm: 1.8165559203099593, clipped: 1.0
epoch: 32, train_batch_id: 400, avg_cost: 3.8982200622558594
grad_norm: 2.881716456267842, clipped: 1.0
epoch: 32, train_batch_id: 450, avg_cost: 3.886289358139038
grad_norm: 1.1208356015567125, clipped: 1.0
epoch: 32, train_batch_id: 500, avg_cost: 3.8701601028442383
grad_norm: 1.9115098257978274, clipped: 1.0
epoch: 32, train_batch_id: 550, avg_cost: 3.893795967102051
grad_norm: 1.3776451112767534, clipped: 1.0
epoch: 32, train_batch_id: 600, avg_cost: 3.900184154510498
grad_norm: 1.5113606659698755, clipped: 1.0
epoch: 32, train_batch_id: 650, avg_cost: 3.8928937911987305
grad_norm: 1.6669408729135151, clipped: 1.0
epoch: 32, train_batch_id: 700, avg_cost: 3.884671688079834
grad_norm: 2.3457999479786036, clipped: 1.0
epoch: 32, train_batch_id: 750, avg_cost: 3.8788681030273438
grad_norm: 1.5010760654363158, clipped: 1.0
epoch: 32, train_batch_id: 800, avg_cost: 3.876646041870117
grad_norm: 2.1033226784942127, clipped: 1.0
epoch: 32, train_batch_id: 850, avg_cost: 3.880006790161133
grad_norm: 1.432287357910886, clipped: 1.0
epoch: 32, train_batch_id: 900, avg_cost: 3.8638508319854736
grad_norm: 1.0172869906480984, clipped: 1.0
epoch: 32, train_batch_id: 950, avg_cost: 3.8539154529571533
grad_norm: 1.348946750450441, clipped: 1.0
epoch: 32, train_batch_id: 1000, avg_cost: 3.892822742462158
grad_norm: 2.1187668701483466, clipped: 1.0
epoch: 32, train_batch_id: 1050, avg_cost: 3.8818397521972656
grad_norm: 1.1994347421360492, clipped: 1.0
epoch: 32, train_batch_id: 1100, avg_cost: 3.8998794555664062
grad_norm: 1.0731742019197195, clipped: 1.0
epoch: 32, train_batch_id: 1150, avg_cost: 3.8898329734802246
grad_norm: 2.2136443264674552, clipped: 1.0
epoch: 32, train_batch_id: 1200, avg_cost: 3.879274845123291
grad_norm: 1.7438612526496198, clipped: 1.0
epoch: 32, train_batch_id: 1250, avg_cost: 3.8896613121032715
grad_norm: 1.6257464048380235, clipped: 1.0
epoch: 32, train_batch_id: 1300, avg_cost: 3.902266025543213
grad_norm: 1.4028739563984363, clipped: 1.0
epoch: 32, train_batch_id: 1350, avg_cost: 3.8759756088256836
grad_norm: 1.13306340950359, clipped: 1.0
epoch: 32, train_batch_id: 1400, avg_cost: 3.8567872047424316
grad_norm: 1.9277908869299136, clipped: 1.0
epoch: 32, train_batch_id: 1450, avg_cost: 3.885035514831543
grad_norm: 1.1699962191592734, clipped: 1.0
epoch: 32, train_batch_id: 1500, avg_cost: 3.8803176879882812
grad_norm: 1.5675002051593554, clipped: 1.0
epoch: 32, train_batch_id: 1550, avg_cost: 3.8845133781433105
grad_norm: 1.3573650971234457, clipped: 1.0
epoch: 32, train_batch_id: 1600, avg_cost: 3.8522534370422363
grad_norm: 1.7609136724188164, clipped: 1.0
epoch: 32, train_batch_id: 1650, avg_cost: 3.887155532836914
grad_norm: 1.3523184230353176, clipped: 1.0
epoch: 32, train_batch_id: 1700, avg_cost: 3.854963779449463
grad_norm: 1.2978905069610425, clipped: 1.0
epoch: 32, train_batch_id: 1750, avg_cost: 3.859337568283081
grad_norm: 1.6855797473489036, clipped: 1.0
epoch: 32, train_batch_id: 1800, avg_cost: 3.864598035812378
grad_norm: 2.6225843247908376, clipped: 1.0
epoch: 32, train_batch_id: 1850, avg_cost: 3.859090805053711
grad_norm: 1.3768611865804432, clipped: 1.0
epoch: 32, train_batch_id: 1900, avg_cost: 3.8548812866210938
grad_norm: 1.6282769860753086, clipped: 1.0
epoch: 32, train_batch_id: 1950, avg_cost: 3.862205982208252
grad_norm: 1.242132098983721, clipped: 1.0
epoch: 32, train_batch_id: 2000, avg_cost: 3.874485492706299
grad_norm: 2.8147727626323142, clipped: 1.0
epoch: 32, train_batch_id: 2050, avg_cost: 3.8972039222717285
grad_norm: 1.1783405711561241, clipped: 1.0
epoch: 32, train_batch_id: 2100, avg_cost: 3.860961437225342
grad_norm: 1.2564567751700024, clipped: 1.0
epoch: 32, train_batch_id: 2150, avg_cost: 3.91408634185791
grad_norm: 2.1862022895331417, clipped: 1.0
epoch: 32, train_batch_id: 2200, avg_cost: 3.868736743927002
grad_norm: 1.211356651572483, clipped: 1.0
epoch: 32, train_batch_id: 2250, avg_cost: 3.891462802886963
grad_norm: 2.185895723403946, clipped: 1.0
epoch: 32, train_batch_id: 2300, avg_cost: 3.866793632507324
grad_norm: 1.282421059466576, clipped: 1.0
epoch: 32, train_batch_id: 2350, avg_cost: 3.8636116981506348
grad_norm: 1.1900242545713526, clipped: 1.0
epoch: 32, train_batch_id: 2400, avg_cost: 3.8797388076782227
grad_norm: 1.4180088259255172, clipped: 1.0
epoch: 32, train_batch_id: 2450, avg_cost: 3.8449268341064453
grad_norm: 2.148476930697671, clipped: 1.0
Finished epoch 32, took 00:19:22 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.1043477058410645 +- 0.0036099159624427557
Evaluating candidate model on evaluation dataset
Epoch 32 candidate mean 4.106802463531494, baseline epoch 28 mean 4.070762634277344, difference 0.03603982925415039
Start train epoch 33, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 33, train_batch_id: 0, avg_cost: 3.8589491844177246
grad_norm: 1.281827389963581, clipped: 1.0
epoch: 33, train_batch_id: 50, avg_cost: 3.8857531547546387
grad_norm: 0.9253548098044475, clipped: 0.9253548098044475
epoch: 33, train_batch_id: 100, avg_cost: 3.8946127891540527
grad_norm: 1.1104899969970439, clipped: 1.0
epoch: 33, train_batch_id: 150, avg_cost: 3.868886709213257
grad_norm: 1.8308749003682683, clipped: 1.0
epoch: 33, train_batch_id: 200, avg_cost: 3.913667678833008
grad_norm: 1.0479541684891236, clipped: 1.0
epoch: 33, train_batch_id: 250, avg_cost: 3.866004467010498
grad_norm: 1.1187847164485747, clipped: 1.0
epoch: 33, train_batch_id: 300, avg_cost: 3.8828039169311523
grad_norm: 3.8735823172851394, clipped: 1.0
epoch: 33, train_batch_id: 350, avg_cost: 3.897876739501953
grad_norm: 3.130067718335091, clipped: 1.0
epoch: 33, train_batch_id: 400, avg_cost: 3.858858108520508
grad_norm: 1.7734932769128615, clipped: 1.0
epoch: 33, train_batch_id: 450, avg_cost: 3.8983492851257324
grad_norm: 1.3192997655067236, clipped: 1.0
epoch: 33, train_batch_id: 500, avg_cost: 3.869899034500122
grad_norm: 1.71606584712883, clipped: 1.0
epoch: 33, train_batch_id: 550, avg_cost: 3.888443946838379
grad_norm: 4.460211636390691, clipped: 1.0
epoch: 33, train_batch_id: 600, avg_cost: 3.8816049098968506
grad_norm: 1.9353042215181813, clipped: 1.0
epoch: 33, train_batch_id: 650, avg_cost: 3.9071342945098877
grad_norm: 1.4306070449741752, clipped: 1.0
epoch: 33, train_batch_id: 700, avg_cost: 3.866738796234131
grad_norm: 2.4709154997399456, clipped: 1.0
epoch: 33, train_batch_id: 750, avg_cost: 3.885928153991699
grad_norm: 1.4419628694330242, clipped: 1.0
epoch: 33, train_batch_id: 800, avg_cost: 3.871344566345215
grad_norm: 1.5100024224182318, clipped: 1.0
epoch: 33, train_batch_id: 850, avg_cost: 3.878889560699463
grad_norm: 2.499039614884756, clipped: 1.0
epoch: 33, train_batch_id: 900, avg_cost: 3.889495372772217
grad_norm: 1.48200639276672, clipped: 1.0
epoch: 33, train_batch_id: 950, avg_cost: 3.8732657432556152
grad_norm: 1.0663104851206, clipped: 1.0
epoch: 33, train_batch_id: 1000, avg_cost: 3.8820443153381348
grad_norm: 1.7284307877275682, clipped: 1.0
epoch: 33, train_batch_id: 1050, avg_cost: 3.875675916671753
grad_norm: 2.376236110087963, clipped: 1.0
epoch: 33, train_batch_id: 1100, avg_cost: 3.8615145683288574
grad_norm: 1.3928197248211924, clipped: 1.0
epoch: 33, train_batch_id: 1150, avg_cost: 3.882183074951172
grad_norm: 1.2659516827250001, clipped: 1.0
epoch: 33, train_batch_id: 1200, avg_cost: 3.8858978748321533
grad_norm: 1.1679257610536404, clipped: 1.0
epoch: 33, train_batch_id: 1250, avg_cost: 3.874338150024414
grad_norm: 2.208622319711042, clipped: 1.0
epoch: 33, train_batch_id: 1300, avg_cost: 3.8632445335388184
grad_norm: 2.008437247450918, clipped: 1.0
epoch: 33, train_batch_id: 1350, avg_cost: 3.878105640411377
grad_norm: 1.9403982498618926, clipped: 1.0
epoch: 33, train_batch_id: 1400, avg_cost: 3.9035532474517822
grad_norm: 1.4422958634890917, clipped: 1.0
epoch: 33, train_batch_id: 1450, avg_cost: 3.8884572982788086
grad_norm: 1.7266967007322809, clipped: 1.0
epoch: 33, train_batch_id: 1500, avg_cost: 3.8723692893981934
grad_norm: 1.4849885747180362, clipped: 1.0
epoch: 33, train_batch_id: 1550, avg_cost: 3.872434616088867
grad_norm: 1.0295434572630138, clipped: 1.0
epoch: 33, train_batch_id: 1600, avg_cost: 3.9009132385253906
grad_norm: 1.4507705979470662, clipped: 1.0
epoch: 33, train_batch_id: 1650, avg_cost: 3.881272315979004
grad_norm: 1.495751795202116, clipped: 1.0
epoch: 33, train_batch_id: 1700, avg_cost: 3.8655855655670166
grad_norm: 1.7706122230202943, clipped: 1.0
epoch: 33, train_batch_id: 1750, avg_cost: 3.8569440841674805
grad_norm: 1.2052423934535932, clipped: 1.0
epoch: 33, train_batch_id: 1800, avg_cost: 3.880997896194458
grad_norm: 2.138847896035661, clipped: 1.0
epoch: 33, train_batch_id: 1850, avg_cost: 3.859630823135376
grad_norm: 8.42403929084647, clipped: 1.0
epoch: 33, train_batch_id: 1900, avg_cost: 3.8651559352874756
grad_norm: 1.3318121952530255, clipped: 1.0
epoch: 33, train_batch_id: 1950, avg_cost: 3.8798389434814453
grad_norm: 1.2552839557433526, clipped: 1.0
epoch: 33, train_batch_id: 2000, avg_cost: 3.9058189392089844
grad_norm: 1.3910561453547048, clipped: 1.0
epoch: 33, train_batch_id: 2050, avg_cost: 3.884340763092041
grad_norm: 1.8269837817527588, clipped: 1.0
epoch: 33, train_batch_id: 2100, avg_cost: 3.9021568298339844
grad_norm: 1.4677577675238345, clipped: 1.0
epoch: 33, train_batch_id: 2150, avg_cost: 3.8644332885742188
grad_norm: 1.1124411078883665, clipped: 1.0
epoch: 33, train_batch_id: 2200, avg_cost: 3.8475584983825684
grad_norm: 1.5063945831236998, clipped: 1.0
epoch: 33, train_batch_id: 2250, avg_cost: 3.897360324859619
grad_norm: 1.6084168593216406, clipped: 1.0
epoch: 33, train_batch_id: 2300, avg_cost: 3.849874496459961
grad_norm: 2.618597049312629, clipped: 1.0
epoch: 33, train_batch_id: 2350, avg_cost: 3.87965726852417
grad_norm: 1.5558533018697456, clipped: 1.0
epoch: 33, train_batch_id: 2400, avg_cost: 3.8932533264160156
grad_norm: 1.676950261679066, clipped: 1.0
epoch: 33, train_batch_id: 2450, avg_cost: 3.885840892791748
grad_norm: 1.7620583088147206, clipped: 1.0
Finished epoch 33, took 00:19:15 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.236340045928955 +- 0.003963874187320471
Evaluating candidate model on evaluation dataset
Epoch 33 candidate mean 4.22843599319458, baseline epoch 28 mean 4.070762634277344, difference 0.15767335891723633
Start train epoch 34, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


171


epoch: 34, train_batch_id: 0, avg_cost: 3.8848588466644287
grad_norm: 1.1427523786962213, clipped: 1.0
epoch: 34, train_batch_id: 50, avg_cost: 3.8703160285949707
grad_norm: 1.636118951974025, clipped: 1.0
epoch: 34, train_batch_id: 100, avg_cost: 3.8467986583709717
grad_norm: 1.1323024454339556, clipped: 1.0
epoch: 34, train_batch_id: 150, avg_cost: 3.892463445663452
grad_norm: 1.4927979021757822, clipped: 1.0
epoch: 34, train_batch_id: 200, avg_cost: 3.8872504234313965
grad_norm: 2.1132382406847854, clipped: 1.0
epoch: 34, train_batch_id: 250, avg_cost: 3.867767333984375
grad_norm: 1.100411666035763, clipped: 1.0
epoch: 34, train_batch_id: 300, avg_cost: 3.8680777549743652
grad_norm: 1.3278598574566183, clipped: 1.0
epoch: 34, train_batch_id: 350, avg_cost: 3.8863089084625244
grad_norm: 1.696133293548691, clipped: 1.0
epoch: 34, train_batch_id: 400, avg_cost: 3.8732380867004395
grad_norm: 1.553422927143326, clipped: 1.0
epoch: 34, train_batch_id: 450, avg_cost: 3.8840036392211914
grad_norm: 1.67058484293422, clipped: 1.0
epoch: 34, train_batch_id: 500, avg_cost: 3.9013583660125732
grad_norm: 1.411507038007468, clipped: 1.0
epoch: 34, train_batch_id: 550, avg_cost: 3.8689286708831787
grad_norm: 3.0637984952426045, clipped: 1.0
epoch: 34, train_batch_id: 600, avg_cost: 3.868656635284424
grad_norm: 1.2851018505398386, clipped: 1.0
epoch: 34, train_batch_id: 650, avg_cost: 3.8859567642211914
grad_norm: 1.2878316069450964, clipped: 1.0
epoch: 34, train_batch_id: 700, avg_cost: 3.8460135459899902
grad_norm: 1.4533784188931118, clipped: 1.0
epoch: 34, train_batch_id: 750, avg_cost: 3.914755344390869
grad_norm: 1.979385356665604, clipped: 1.0
epoch: 34, train_batch_id: 800, avg_cost: 3.896430253982544
grad_norm: 1.1942932245596674, clipped: 1.0
epoch: 34, train_batch_id: 850, avg_cost: 3.866084098815918
grad_norm: 1.2798919748948987, clipped: 1.0
epoch: 34, train_batch_id: 900, avg_cost: 3.898775577545166
grad_norm: 1.643787319244232, clipped: 1.0
epoch: 34, train_batch_id: 950, avg_cost: 3.889883041381836
grad_norm: 1.4954261712467765, clipped: 1.0
epoch: 34, train_batch_id: 1000, avg_cost: 3.8746767044067383
grad_norm: 1.4662959370134305, clipped: 1.0
epoch: 34, train_batch_id: 1050, avg_cost: 3.8678152561187744
grad_norm: 1.4022680057089725, clipped: 1.0
epoch: 34, train_batch_id: 1100, avg_cost: 3.870563507080078
grad_norm: 1.6553528824359722, clipped: 1.0
epoch: 34, train_batch_id: 1150, avg_cost: 3.875650405883789
grad_norm: 1.062256025580954, clipped: 1.0
epoch: 34, train_batch_id: 1200, avg_cost: 3.847568988800049
grad_norm: 1.3213678163785032, clipped: 1.0
epoch: 34, train_batch_id: 1250, avg_cost: 3.8742713928222656
grad_norm: 1.647590874138084, clipped: 1.0
epoch: 34, train_batch_id: 1300, avg_cost: 3.8980679512023926
grad_norm: 1.2822793241839323, clipped: 1.0
epoch: 34, train_batch_id: 1350, avg_cost: 3.8422584533691406
grad_norm: 1.256509307953737, clipped: 1.0
epoch: 34, train_batch_id: 1400, avg_cost: 3.8643698692321777
grad_norm: 1.209265926293508, clipped: 1.0
epoch: 34, train_batch_id: 1450, avg_cost: 3.873156785964966
grad_norm: 2.0040924643345677, clipped: 1.0
epoch: 34, train_batch_id: 1500, avg_cost: 3.89228892326355
grad_norm: 1.2871590923517766, clipped: 1.0
epoch: 34, train_batch_id: 1550, avg_cost: 3.8832173347473145
grad_norm: 1.4979587693077148, clipped: 1.0
epoch: 34, train_batch_id: 1600, avg_cost: 3.8695313930511475
grad_norm: 2.0528286210037754, clipped: 1.0
epoch: 34, train_batch_id: 1650, avg_cost: 3.8616979122161865
grad_norm: 1.199785686965402, clipped: 1.0
epoch: 34, train_batch_id: 1700, avg_cost: 3.867197275161743
grad_norm: 1.563652530002088, clipped: 1.0
epoch: 34, train_batch_id: 1750, avg_cost: 3.8603391647338867
grad_norm: 1.9726382591450582, clipped: 1.0
epoch: 34, train_batch_id: 1800, avg_cost: 3.871741771697998
grad_norm: 2.255889129396861, clipped: 1.0
epoch: 34, train_batch_id: 1850, avg_cost: 3.8752846717834473
grad_norm: 1.559447554092616, clipped: 1.0
epoch: 34, train_batch_id: 1900, avg_cost: 3.8891003131866455
grad_norm: 1.9302763309347557, clipped: 1.0
epoch: 34, train_batch_id: 1950, avg_cost: 3.877415180206299
grad_norm: 0.9927096275856682, clipped: 0.9927096275856682
epoch: 34, train_batch_id: 2000, avg_cost: 3.8569693565368652
grad_norm: 1.4526482521994613, clipped: 1.0
epoch: 34, train_batch_id: 2050, avg_cost: 3.8893353939056396
grad_norm: 1.9055177361937616, clipped: 1.0
epoch: 34, train_batch_id: 2100, avg_cost: 3.884925603866577
grad_norm: 1.668067887527266, clipped: 1.0
epoch: 34, train_batch_id: 2150, avg_cost: 3.8625683784484863
grad_norm: 1.3972300778082274, clipped: 1.0
epoch: 34, train_batch_id: 2200, avg_cost: 3.8909459114074707
grad_norm: 1.696278812110191, clipped: 1.0
epoch: 34, train_batch_id: 2250, avg_cost: 3.860607147216797
grad_norm: 1.3639739219410227, clipped: 1.0
epoch: 34, train_batch_id: 2300, avg_cost: 3.8689286708831787
grad_norm: 1.3502112721102701, clipped: 1.0
epoch: 34, train_batch_id: 2350, avg_cost: 3.854921817779541
grad_norm: 1.5687488240873995, clipped: 1.0
epoch: 34, train_batch_id: 2400, avg_cost: 3.8528332710266113
grad_norm: 1.1702574728633752, clipped: 1.0
epoch: 34, train_batch_id: 2450, avg_cost: 3.872870445251465
grad_norm: 4.941300154089176, clipped: 1.0
Finished epoch 34, took 00:19:17 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.224608421325684 +- 0.003997135907411575
Evaluating candidate model on evaluation dataset
Epoch 34 candidate mean 4.2209153175354, baseline epoch 28 mean 4.070762634277344, difference 0.15015268325805664
Start train epoch 35, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 35, train_batch_id: 0, avg_cost: 3.8994650840759277
grad_norm: 1.2820446567443415, clipped: 1.0
epoch: 35, train_batch_id: 50, avg_cost: 3.8836827278137207
grad_norm: 2.1128409322330897, clipped: 1.0
epoch: 35, train_batch_id: 100, avg_cost: 3.8786466121673584
grad_norm: 1.7235128718422255, clipped: 1.0
epoch: 35, train_batch_id: 150, avg_cost: 3.8701629638671875
grad_norm: 1.319740546712787, clipped: 1.0
epoch: 35, train_batch_id: 200, avg_cost: 3.879955291748047
grad_norm: 2.356775791148985, clipped: 1.0
epoch: 35, train_batch_id: 250, avg_cost: 3.8703298568725586
grad_norm: 1.2080598333906247, clipped: 1.0
epoch: 35, train_batch_id: 300, avg_cost: 3.870582103729248
grad_norm: 1.4088616297469656, clipped: 1.0
epoch: 35, train_batch_id: 350, avg_cost: 3.878495693206787
grad_norm: 1.4519386686343927, clipped: 1.0
epoch: 35, train_batch_id: 400, avg_cost: 3.8934497833251953
grad_norm: 1.5045522107370803, clipped: 1.0
epoch: 35, train_batch_id: 450, avg_cost: 3.86466121673584
grad_norm: 4.636183011726594, clipped: 1.0
epoch: 35, train_batch_id: 500, avg_cost: 3.864025354385376
grad_norm: 1.6901178929738614, clipped: 1.0
epoch: 35, train_batch_id: 550, avg_cost: 3.8663206100463867
grad_norm: 1.881090556198535, clipped: 1.0
epoch: 35, train_batch_id: 600, avg_cost: 3.8743276596069336
grad_norm: 1.6410284654937008, clipped: 1.0
epoch: 35, train_batch_id: 650, avg_cost: 3.899563789367676
grad_norm: 1.2515988126801572, clipped: 1.0
epoch: 35, train_batch_id: 700, avg_cost: 3.860170364379883
grad_norm: 1.397225379921217, clipped: 1.0
epoch: 35, train_batch_id: 750, avg_cost: 3.895742416381836
grad_norm: 1.2445509882097896, clipped: 1.0
epoch: 35, train_batch_id: 800, avg_cost: 3.8971519470214844
grad_norm: 1.4910160471922869, clipped: 1.0
epoch: 35, train_batch_id: 850, avg_cost: 3.891331195831299
grad_norm: 1.3122497716408983, clipped: 1.0
epoch: 35, train_batch_id: 900, avg_cost: 3.871314525604248
grad_norm: 1.6109712063314559, clipped: 1.0
epoch: 35, train_batch_id: 950, avg_cost: 3.8693177700042725
grad_norm: 1.0892116234360278, clipped: 1.0
epoch: 35, train_batch_id: 1000, avg_cost: 3.9110934734344482
grad_norm: 1.4538871838794805, clipped: 1.0
epoch: 35, train_batch_id: 1050, avg_cost: 3.861088752746582
grad_norm: 1.1426680130034275, clipped: 1.0
epoch: 35, train_batch_id: 1100, avg_cost: 3.8759970664978027
grad_norm: 1.229989526311155, clipped: 1.0
epoch: 35, train_batch_id: 1150, avg_cost: 3.8582587242126465
grad_norm: 1.8385154927125178, clipped: 1.0
epoch: 35, train_batch_id: 1200, avg_cost: 3.892242431640625
grad_norm: 1.1123347266876662, clipped: 1.0
epoch: 35, train_batch_id: 1250, avg_cost: 3.8843512535095215
grad_norm: 1.3334379464821324, clipped: 1.0
epoch: 35, train_batch_id: 1300, avg_cost: 3.8539156913757324
grad_norm: 2.958755775225189, clipped: 1.0
epoch: 35, train_batch_id: 1350, avg_cost: 3.873432159423828
grad_norm: 1.1638336919943166, clipped: 1.0
epoch: 35, train_batch_id: 1400, avg_cost: 3.873058319091797
grad_norm: 1.6102696517518627, clipped: 1.0
epoch: 35, train_batch_id: 1450, avg_cost: 3.8691041469573975
grad_norm: 1.6998782354639652, clipped: 1.0
epoch: 35, train_batch_id: 1500, avg_cost: 3.8735568523406982
grad_norm: 1.241702514175867, clipped: 1.0
epoch: 35, train_batch_id: 1550, avg_cost: 3.8836257457733154
grad_norm: 1.4917696957552475, clipped: 1.0
epoch: 35, train_batch_id: 1600, avg_cost: 3.888134002685547
grad_norm: 1.2866323351454492, clipped: 1.0
epoch: 35, train_batch_id: 1650, avg_cost: 3.870281219482422
grad_norm: 1.021855581730288, clipped: 1.0
epoch: 35, train_batch_id: 1700, avg_cost: 3.852931022644043
grad_norm: 1.7949531258592324, clipped: 1.0
epoch: 35, train_batch_id: 1750, avg_cost: 3.8982338905334473
grad_norm: 1.1268059367169554, clipped: 1.0
epoch: 35, train_batch_id: 1800, avg_cost: 3.8705615997314453
grad_norm: 1.5420874933725417, clipped: 1.0
epoch: 35, train_batch_id: 1850, avg_cost: 3.8907313346862793
grad_norm: 1.2142363241124425, clipped: 1.0
epoch: 35, train_batch_id: 1900, avg_cost: 3.874674081802368
grad_norm: 2.1395605185021727, clipped: 1.0
epoch: 35, train_batch_id: 1950, avg_cost: 3.8820080757141113
grad_norm: 4.966039811954533, clipped: 1.0
epoch: 35, train_batch_id: 2000, avg_cost: 3.8726115226745605
grad_norm: 1.647122755035401, clipped: 1.0
epoch: 35, train_batch_id: 2050, avg_cost: 3.8965015411376953
grad_norm: 1.3381889460555794, clipped: 1.0
epoch: 35, train_batch_id: 2100, avg_cost: 3.895211696624756
grad_norm: 2.701054066335439, clipped: 1.0
epoch: 35, train_batch_id: 2150, avg_cost: 3.8573977947235107
grad_norm: 1.6249012591230445, clipped: 1.0
epoch: 35, train_batch_id: 2200, avg_cost: 3.8667376041412354
grad_norm: 1.2303820000541787, clipped: 1.0
epoch: 35, train_batch_id: 2250, avg_cost: 3.8829565048217773
grad_norm: 1.3859705076834123, clipped: 1.0
epoch: 35, train_batch_id: 2300, avg_cost: 3.8848156929016113
grad_norm: 1.5979882412176583, clipped: 1.0
epoch: 35, train_batch_id: 2350, avg_cost: 3.8758177757263184
grad_norm: 1.764024265950028, clipped: 1.0
epoch: 35, train_batch_id: 2400, avg_cost: 3.8523709774017334
grad_norm: 1.5442345626122198, clipped: 1.0
epoch: 35, train_batch_id: 2450, avg_cost: 3.8932554721832275
grad_norm: 1.1790432919594482, clipped: 1.0
Finished epoch 35, took 00:19:20 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.163384914398193 +- 0.0037556432653218508
Evaluating candidate model on evaluation dataset
Epoch 35 candidate mean 4.160414695739746, baseline epoch 28 mean 4.070762634277344, difference 0.08965206146240234
Start train epoch 36, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


171


epoch: 36, train_batch_id: 0, avg_cost: 3.894385576248169
grad_norm: 1.4997554084408218, clipped: 1.0
epoch: 36, train_batch_id: 50, avg_cost: 3.8918187618255615
grad_norm: 1.4318409123297797, clipped: 1.0
epoch: 36, train_batch_id: 100, avg_cost: 3.8962459564208984
grad_norm: 1.5403032684314744, clipped: 1.0
epoch: 36, train_batch_id: 150, avg_cost: 3.8732223510742188
grad_norm: 1.2813152461329445, clipped: 1.0
epoch: 36, train_batch_id: 200, avg_cost: 3.891087293624878
grad_norm: 1.3796364444267086, clipped: 1.0
epoch: 36, train_batch_id: 250, avg_cost: 3.873131036758423
grad_norm: 1.8608175993193525, clipped: 1.0
epoch: 36, train_batch_id: 300, avg_cost: 3.855243682861328
grad_norm: 1.6594842124154492, clipped: 1.0
epoch: 36, train_batch_id: 350, avg_cost: 3.8712124824523926
grad_norm: 1.1117392462307065, clipped: 1.0
epoch: 36, train_batch_id: 400, avg_cost: 3.879312038421631
grad_norm: 1.2730651762698857, clipped: 1.0
epoch: 36, train_batch_id: 450, avg_cost: 3.8886027336120605
grad_norm: 1.9883750900619381, clipped: 1.0
epoch: 36, train_batch_id: 500, avg_cost: 3.8470396995544434
grad_norm: 1.7882164470056068, clipped: 1.0
epoch: 36, train_batch_id: 550, avg_cost: 3.8946566581726074
grad_norm: 1.225517984732674, clipped: 1.0
epoch: 36, train_batch_id: 600, avg_cost: 3.8765976428985596
grad_norm: 1.7403104560424298, clipped: 1.0
epoch: 36, train_batch_id: 650, avg_cost: 3.886094570159912
grad_norm: 1.7523588645526424, clipped: 1.0
epoch: 36, train_batch_id: 700, avg_cost: 3.8793094158172607
grad_norm: 1.2358890232780104, clipped: 1.0
epoch: 36, train_batch_id: 750, avg_cost: 3.8894307613372803
grad_norm: 1.5885452488180383, clipped: 1.0
epoch: 36, train_batch_id: 800, avg_cost: 3.857992649078369
grad_norm: 1.344628743617844, clipped: 1.0
epoch: 36, train_batch_id: 850, avg_cost: 3.8968708515167236
grad_norm: 1.6587219958348853, clipped: 1.0
epoch: 36, train_batch_id: 900, avg_cost: 3.8777289390563965
grad_norm: 1.5812735482516722, clipped: 1.0
epoch: 36, train_batch_id: 950, avg_cost: 3.867218494415283
grad_norm: 1.0914269172864142, clipped: 1.0
epoch: 36, train_batch_id: 1000, avg_cost: 3.8722329139709473
grad_norm: 1.8156144228355144, clipped: 1.0
epoch: 36, train_batch_id: 1050, avg_cost: 3.8712527751922607
grad_norm: 1.60422292456791, clipped: 1.0
epoch: 36, train_batch_id: 1100, avg_cost: 3.866831064224243
grad_norm: 1.8949381758033912, clipped: 1.0
epoch: 36, train_batch_id: 1150, avg_cost: 3.8462038040161133
grad_norm: 1.2063650330752897, clipped: 1.0
epoch: 36, train_batch_id: 1200, avg_cost: 3.8758792877197266
grad_norm: 1.5065038386129006, clipped: 1.0
epoch: 36, train_batch_id: 1250, avg_cost: 3.886303663253784
grad_norm: 1.4335203395897462, clipped: 1.0
epoch: 36, train_batch_id: 1300, avg_cost: 3.8772521018981934
grad_norm: 1.1498120576926707, clipped: 1.0
epoch: 36, train_batch_id: 1350, avg_cost: 3.882565975189209
grad_norm: 1.405316998749209, clipped: 1.0
epoch: 36, train_batch_id: 1400, avg_cost: 3.8853604793548584
grad_norm: 0.9046522528306054, clipped: 0.9046522528306054
epoch: 36, train_batch_id: 1450, avg_cost: 3.87483549118042
grad_norm: 1.3616188243027518, clipped: 1.0
epoch: 36, train_batch_id: 1500, avg_cost: 3.872323513031006
grad_norm: 1.1744878213957703, clipped: 1.0
epoch: 36, train_batch_id: 1550, avg_cost: 3.8895769119262695
grad_norm: 1.2655746137603943, clipped: 1.0
epoch: 36, train_batch_id: 1600, avg_cost: 3.8818321228027344
grad_norm: 1.1202468867302748, clipped: 1.0
epoch: 36, train_batch_id: 1650, avg_cost: 3.8755180835723877
grad_norm: 1.1990317521915974, clipped: 1.0
epoch: 36, train_batch_id: 1700, avg_cost: 3.88763689994812
grad_norm: 1.0368423561035656, clipped: 1.0
epoch: 36, train_batch_id: 1750, avg_cost: 3.8568196296691895
grad_norm: 1.3347874768906418, clipped: 1.0
epoch: 36, train_batch_id: 1800, avg_cost: 3.8850176334381104
grad_norm: 1.0900720762569347, clipped: 1.0
epoch: 36, train_batch_id: 1850, avg_cost: 3.873976230621338
grad_norm: 1.4454546634502357, clipped: 1.0
epoch: 36, train_batch_id: 1900, avg_cost: 3.840862274169922
grad_norm: 1.3288480212322333, clipped: 1.0
epoch: 36, train_batch_id: 1950, avg_cost: 3.865021228790283
grad_norm: 1.2454866092558037, clipped: 1.0
epoch: 36, train_batch_id: 2000, avg_cost: 3.878485679626465
grad_norm: 2.170488305230318, clipped: 1.0
epoch: 36, train_batch_id: 2050, avg_cost: 3.8515052795410156
grad_norm: 1.28403941421183, clipped: 1.0
epoch: 36, train_batch_id: 2100, avg_cost: 3.862078905105591
grad_norm: 1.7064659516318537, clipped: 1.0
epoch: 36, train_batch_id: 2150, avg_cost: 3.8729281425476074
grad_norm: 1.105002544788165, clipped: 1.0
epoch: 36, train_batch_id: 2200, avg_cost: 3.866671323776245
grad_norm: 1.1356458457437173, clipped: 1.0
epoch: 36, train_batch_id: 2250, avg_cost: 3.892871141433716
grad_norm: 1.3011050677659535, clipped: 1.0
epoch: 36, train_batch_id: 2300, avg_cost: 3.878620147705078
grad_norm: 1.2805883905198514, clipped: 1.0
epoch: 36, train_batch_id: 2350, avg_cost: 3.8611526489257812
grad_norm: 1.242954056412416, clipped: 1.0
epoch: 36, train_batch_id: 2400, avg_cost: 3.8756961822509766
grad_norm: 12.062022120985626, clipped: 1.0
epoch: 36, train_batch_id: 2450, avg_cost: 3.8705668449401855
grad_norm: 1.5572776647998094, clipped: 1.0
Finished epoch 36, took 00:19:19 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.128477573394775 +- 0.00372764328494668
Evaluating candidate model on evaluation dataset
Epoch 36 candidate mean 4.130082607269287, baseline epoch 28 mean 4.070762634277344, difference 0.05931997299194336
Start train epoch 37, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 37, train_batch_id: 0, avg_cost: 3.8485374450683594
grad_norm: 4.463805518451409, clipped: 1.0
epoch: 37, train_batch_id: 50, avg_cost: 3.884551525115967
grad_norm: 1.0268826841157384, clipped: 1.0
epoch: 37, train_batch_id: 100, avg_cost: 3.8662900924682617
grad_norm: 2.294617927896046, clipped: 1.0
epoch: 37, train_batch_id: 150, avg_cost: 3.8738269805908203
grad_norm: 1.3415463434766446, clipped: 1.0
epoch: 37, train_batch_id: 200, avg_cost: 3.867903709411621
grad_norm: 1.1948003559580223, clipped: 1.0
epoch: 37, train_batch_id: 250, avg_cost: 3.881162166595459
grad_norm: 1.0198610840435802, clipped: 1.0
epoch: 37, train_batch_id: 300, avg_cost: 3.886625289916992
grad_norm: 2.083513083407906, clipped: 1.0
epoch: 37, train_batch_id: 350, avg_cost: 3.8421010971069336
grad_norm: 2.1197486676812862, clipped: 1.0
epoch: 37, train_batch_id: 400, avg_cost: 3.896315097808838
grad_norm: 1.4835440072785377, clipped: 1.0
epoch: 37, train_batch_id: 450, avg_cost: 3.8827762603759766
grad_norm: 1.5842328083544488, clipped: 1.0
epoch: 37, train_batch_id: 500, avg_cost: 3.852698802947998
grad_norm: 1.1917105833609845, clipped: 1.0
epoch: 37, train_batch_id: 550, avg_cost: 3.8939950466156006
grad_norm: 1.147444728701266, clipped: 1.0
epoch: 37, train_batch_id: 600, avg_cost: 3.878366708755493
grad_norm: 1.3706613457108237, clipped: 1.0
epoch: 37, train_batch_id: 650, avg_cost: 3.886413812637329
grad_norm: 1.8097367039353114, clipped: 1.0
epoch: 37, train_batch_id: 700, avg_cost: 3.8914854526519775
grad_norm: 0.9979710514180979, clipped: 0.9979710514180979
epoch: 37, train_batch_id: 750, avg_cost: 3.8805277347564697
grad_norm: 1.1977307329749771, clipped: 1.0
epoch: 37, train_batch_id: 800, avg_cost: 3.8530702590942383
grad_norm: 1.1590623494525496, clipped: 1.0
epoch: 37, train_batch_id: 850, avg_cost: 3.8778014183044434
grad_norm: 1.6770050447245781, clipped: 1.0
epoch: 37, train_batch_id: 900, avg_cost: 3.8626179695129395
grad_norm: 1.1496736362297129, clipped: 1.0
epoch: 37, train_batch_id: 950, avg_cost: 3.8794453144073486
grad_norm: 1.3276943863580213, clipped: 1.0
epoch: 37, train_batch_id: 1000, avg_cost: 3.8801138401031494
grad_norm: 1.7486679361851976, clipped: 1.0
epoch: 37, train_batch_id: 1050, avg_cost: 3.8711090087890625
grad_norm: 1.3111078875541948, clipped: 1.0
epoch: 37, train_batch_id: 1100, avg_cost: 3.866518020629883
grad_norm: 1.2401059324287316, clipped: 1.0
epoch: 37, train_batch_id: 1150, avg_cost: 3.8738231658935547
grad_norm: 1.2347741531245116, clipped: 1.0
epoch: 37, train_batch_id: 1200, avg_cost: 3.8882744312286377
grad_norm: 1.0667795244465559, clipped: 1.0
epoch: 37, train_batch_id: 1250, avg_cost: 3.8928637504577637
grad_norm: 2.1399778698779213, clipped: 1.0
epoch: 37, train_batch_id: 1300, avg_cost: 3.8911962509155273
grad_norm: 2.4894050659863876, clipped: 1.0
epoch: 37, train_batch_id: 1350, avg_cost: 3.885806083679199
grad_norm: 1.2527492034513465, clipped: 1.0
epoch: 37, train_batch_id: 1400, avg_cost: 3.885019302368164
grad_norm: 1.8084496777301429, clipped: 1.0
epoch: 37, train_batch_id: 1450, avg_cost: 3.881985902786255
grad_norm: 1.4010025033276894, clipped: 1.0
epoch: 37, train_batch_id: 1500, avg_cost: 3.8672521114349365
grad_norm: 2.0538935585493663, clipped: 1.0
epoch: 37, train_batch_id: 1550, avg_cost: 3.8832297325134277
grad_norm: 4.287388635005397, clipped: 1.0
epoch: 37, train_batch_id: 1600, avg_cost: 3.872901439666748
grad_norm: 1.2500577605678647, clipped: 1.0
epoch: 37, train_batch_id: 1650, avg_cost: 3.8565456867218018
grad_norm: 1.0948522593514032, clipped: 1.0
epoch: 37, train_batch_id: 1700, avg_cost: 3.8883562088012695
grad_norm: 1.3517379743575793, clipped: 1.0
epoch: 37, train_batch_id: 1750, avg_cost: 3.8757314682006836
grad_norm: 1.3449100952937332, clipped: 1.0
epoch: 37, train_batch_id: 1800, avg_cost: 3.870922565460205
grad_norm: 1.7695412776504824, clipped: 1.0
epoch: 37, train_batch_id: 1850, avg_cost: 3.9031171798706055
grad_norm: 2.0904946258135784, clipped: 1.0
epoch: 37, train_batch_id: 1900, avg_cost: 3.860558032989502
grad_norm: 1.5657383501013804, clipped: 1.0
epoch: 37, train_batch_id: 1950, avg_cost: 3.8859288692474365
grad_norm: 2.3239037537943226, clipped: 1.0
epoch: 37, train_batch_id: 2000, avg_cost: 3.890735626220703
grad_norm: 1.6680632146832022, clipped: 1.0
epoch: 37, train_batch_id: 2050, avg_cost: 3.8847193717956543
grad_norm: 1.3093905210586232, clipped: 1.0
epoch: 37, train_batch_id: 2100, avg_cost: 3.884336471557617
grad_norm: 1.69985254789543, clipped: 1.0
epoch: 37, train_batch_id: 2150, avg_cost: 3.863645553588867
grad_norm: 1.8266074999975255, clipped: 1.0
epoch: 37, train_batch_id: 2200, avg_cost: 3.8824586868286133
grad_norm: 1.4773131183188009, clipped: 1.0
epoch: 37, train_batch_id: 2250, avg_cost: 3.8635435104370117
grad_norm: 0.9831839497681127, clipped: 0.9831839497681127
epoch: 37, train_batch_id: 2300, avg_cost: 3.8935885429382324
grad_norm: 1.475658802965967, clipped: 1.0
epoch: 37, train_batch_id: 2350, avg_cost: 3.8767428398132324
grad_norm: 1.6867051978356173, clipped: 1.0
epoch: 37, train_batch_id: 2400, avg_cost: 3.877163887023926
grad_norm: 1.6517819574871957, clipped: 1.0
epoch: 37, train_batch_id: 2450, avg_cost: 3.8930723667144775
grad_norm: 1.3106170026132173, clipped: 1.0
Finished epoch 37, took 00:19:18 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.1191840171813965 +- 0.0036804303526878357
Evaluating candidate model on evaluation dataset
Epoch 37 candidate mean 4.116085052490234, baseline epoch 28 mean 4.070762634277344, difference 0.045322418212890625
Start train epoch 38, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


epoch: 38, train_batch_id: 0, avg_cost: 3.8836584091186523
grad_norm: 1.2417581434975185, clipped: 1.0
epoch: 38, train_batch_id: 50, avg_cost: 3.8806569576263428
grad_norm: 1.6393942287167746, clipped: 1.0
epoch: 38, train_batch_id: 100, avg_cost: 3.8831188678741455
grad_norm: 1.7039467803191615, clipped: 1.0
epoch: 38, train_batch_id: 150, avg_cost: 3.8838720321655273
grad_norm: 1.0425149919388812, clipped: 1.0
epoch: 38, train_batch_id: 200, avg_cost: 3.8740882873535156
grad_norm: 1.3842329977214805, clipped: 1.0
epoch: 38, train_batch_id: 250, avg_cost: 3.857407569885254
grad_norm: 1.1581029345614227, clipped: 1.0
epoch: 38, train_batch_id: 300, avg_cost: 3.8646740913391113
grad_norm: 1.8725561755746902, clipped: 1.0
epoch: 38, train_batch_id: 350, avg_cost: 3.8913722038269043
grad_norm: 1.2119201508286717, clipped: 1.0
epoch: 38, train_batch_id: 400, avg_cost: 3.8789024353027344
grad_norm: 1.5440421930074117, clipped: 1.0
epoch: 38, train_batch_id: 450, avg_cost: 3.864990234375
grad_norm: 1.2542851348991118, clipped: 1.0
epoch: 38, train_batch_id: 500, avg_cost: 3.870330810546875
grad_norm: 1.2592352350287996, clipped: 1.0
epoch: 38, train_batch_id: 550, avg_cost: 3.878535270690918
grad_norm: 1.6653478102981092, clipped: 1.0
epoch: 38, train_batch_id: 600, avg_cost: 3.8712239265441895
grad_norm: 1.126051683417348, clipped: 1.0
epoch: 38, train_batch_id: 650, avg_cost: 3.8833842277526855
grad_norm: 1.5384725959684755, clipped: 1.0
epoch: 38, train_batch_id: 700, avg_cost: 3.8859081268310547
grad_norm: 1.1475463868579279, clipped: 1.0
epoch: 38, train_batch_id: 750, avg_cost: 3.8740367889404297
grad_norm: 2.070717696668313, clipped: 1.0
epoch: 38, train_batch_id: 800, avg_cost: 3.9034886360168457
grad_norm: 1.5011243695138607, clipped: 1.0
epoch: 38, train_batch_id: 850, avg_cost: 3.895108461380005
grad_norm: 1.4783098285664118, clipped: 1.0
epoch: 38, train_batch_id: 900, avg_cost: 3.859571933746338
grad_norm: 1.5107130378229006, clipped: 1.0
epoch: 38, train_batch_id: 950, avg_cost: 3.8828940391540527
grad_norm: 1.1351855105680186, clipped: 1.0
epoch: 38, train_batch_id: 1000, avg_cost: 3.87422251701355
grad_norm: 1.668592188288768, clipped: 1.0
epoch: 38, train_batch_id: 1050, avg_cost: 3.874849796295166
grad_norm: 1.7992283402351466, clipped: 1.0
epoch: 38, train_batch_id: 1100, avg_cost: 3.8629114627838135
grad_norm: 1.7862416404703165, clipped: 1.0
epoch: 38, train_batch_id: 1150, avg_cost: 3.8816840648651123
grad_norm: 1.0417978171353617, clipped: 1.0
epoch: 38, train_batch_id: 1200, avg_cost: 3.871683120727539
grad_norm: 1.305756102299081, clipped: 1.0
epoch: 38, train_batch_id: 1250, avg_cost: 3.893592119216919
grad_norm: 2.0490375542448933, clipped: 1.0
epoch: 38, train_batch_id: 1300, avg_cost: 3.8557372093200684
grad_norm: 1.9111837819646054, clipped: 1.0
epoch: 38, train_batch_id: 1350, avg_cost: 3.8931117057800293
grad_norm: 1.314916344995537, clipped: 1.0
epoch: 38, train_batch_id: 1400, avg_cost: 3.881591796875
grad_norm: 1.6640484886797058, clipped: 1.0
epoch: 38, train_batch_id: 1450, avg_cost: 3.8635339736938477
grad_norm: 1.7841186576205952, clipped: 1.0
epoch: 38, train_batch_id: 1500, avg_cost: 3.8767030239105225
grad_norm: 2.0714905276449977, clipped: 1.0
epoch: 38, train_batch_id: 1550, avg_cost: 3.8814501762390137
grad_norm: 1.2598467679881058, clipped: 1.0
epoch: 38, train_batch_id: 1600, avg_cost: 3.8930516242980957
grad_norm: 1.8386702438577267, clipped: 1.0
epoch: 38, train_batch_id: 1650, avg_cost: 3.892878293991089
grad_norm: 1.379727952447167, clipped: 1.0
epoch: 38, train_batch_id: 1700, avg_cost: 3.8589026927948
grad_norm: 4.119781639496723, clipped: 1.0
epoch: 38, train_batch_id: 1750, avg_cost: 3.8798041343688965
grad_norm: 1.4544904382198718, clipped: 1.0
epoch: 38, train_batch_id: 1800, avg_cost: 3.893873691558838
grad_norm: 1.6272994709829427, clipped: 1.0
epoch: 38, train_batch_id: 1850, avg_cost: 3.875913143157959
grad_norm: 1.8910280261021661, clipped: 1.0
epoch: 38, train_batch_id: 1900, avg_cost: 3.8661463260650635
grad_norm: 1.6474276356483193, clipped: 1.0
epoch: 38, train_batch_id: 1950, avg_cost: 3.885075807571411
grad_norm: 1.5256506120163251, clipped: 1.0
epoch: 38, train_batch_id: 2000, avg_cost: 3.871525526046753
grad_norm: 1.8814798848706877, clipped: 1.0
epoch: 38, train_batch_id: 2050, avg_cost: 3.859809398651123
grad_norm: 1.3696135423650426, clipped: 1.0
epoch: 38, train_batch_id: 2100, avg_cost: 3.8841967582702637
grad_norm: 1.3790582587963733, clipped: 1.0
epoch: 38, train_batch_id: 2150, avg_cost: 3.8735544681549072
grad_norm: 2.173977976027938, clipped: 1.0
epoch: 38, train_batch_id: 2200, avg_cost: 3.8860137462615967
grad_norm: 1.536841086453635, clipped: 1.0
epoch: 38, train_batch_id: 2250, avg_cost: 3.8962368965148926
grad_norm: 1.0590709240408878, clipped: 1.0
epoch: 38, train_batch_id: 2300, avg_cost: 3.862048864364624
grad_norm: 1.2123509670957047, clipped: 1.0
epoch: 38, train_batch_id: 2350, avg_cost: 3.891845226287842
grad_norm: 1.7686074541434187, clipped: 1.0
epoch: 38, train_batch_id: 2400, avg_cost: 3.863084316253662
grad_norm: 1.441584356536995, clipped: 1.0
epoch: 38, train_batch_id: 2450, avg_cost: 3.870718002319336
grad_norm: 1.798310555392321, clipped: 1.0
Finished epoch 38, took 00:19:11 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.1536760330200195 +- 0.003819122212007642
Evaluating candidate model on evaluation dataset
Epoch 38 candidate mean 4.150242805480957, baseline epoch 28 mean 4.070762634277344, difference 0.07948017120361328
Start train epoch 39, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


342


171


171


171


171


epoch: 39, train_batch_id: 0, avg_cost: 3.878833770751953
grad_norm: 1.4345934021726483, clipped: 1.0
epoch: 39, train_batch_id: 50, avg_cost: 3.858389377593994
grad_norm: 1.370869525006703, clipped: 1.0
epoch: 39, train_batch_id: 100, avg_cost: 3.8758010864257812
grad_norm: 2.161629264569539, clipped: 1.0
epoch: 39, train_batch_id: 150, avg_cost: 3.8959624767303467
grad_norm: 1.6197495480074906, clipped: 1.0
epoch: 39, train_batch_id: 200, avg_cost: 3.870755195617676
grad_norm: 1.4435043279157185, clipped: 1.0
epoch: 39, train_batch_id: 250, avg_cost: 3.8603873252868652
grad_norm: 5.066506325283814, clipped: 1.0
epoch: 39, train_batch_id: 300, avg_cost: 3.8640217781066895
grad_norm: 1.7763774477102778, clipped: 1.0
epoch: 39, train_batch_id: 350, avg_cost: 3.8786590099334717
grad_norm: 2.128719591842404, clipped: 1.0
epoch: 39, train_batch_id: 400, avg_cost: 3.854114294052124
grad_norm: 1.9168264180368375, clipped: 1.0
epoch: 39, train_batch_id: 450, avg_cost: 3.8937935829162598
grad_norm: 1.4141459406133323, clipped: 1.0
epoch: 39, train_batch_id: 500, avg_cost: 3.872870922088623
grad_norm: 1.1669057960007938, clipped: 1.0
epoch: 39, train_batch_id: 550, avg_cost: 3.8775405883789062
grad_norm: 1.0703636856681698, clipped: 1.0
epoch: 39, train_batch_id: 600, avg_cost: 3.8582160472869873
grad_norm: 1.2723742409672911, clipped: 1.0
epoch: 39, train_batch_id: 650, avg_cost: 3.8637242317199707
grad_norm: 1.4745027692095773, clipped: 1.0
epoch: 39, train_batch_id: 700, avg_cost: 3.8762130737304688
grad_norm: 1.5942072000397267, clipped: 1.0
epoch: 39, train_batch_id: 750, avg_cost: 3.876739501953125
grad_norm: 1.7451054958316583, clipped: 1.0
epoch: 39, train_batch_id: 800, avg_cost: 3.8698630332946777
grad_norm: 1.569301242722135, clipped: 1.0
epoch: 39, train_batch_id: 850, avg_cost: 3.8724236488342285
grad_norm: 1.6395675865484973, clipped: 1.0
epoch: 39, train_batch_id: 900, avg_cost: 3.871178150177002
grad_norm: 1.3402274649316421, clipped: 1.0
epoch: 39, train_batch_id: 950, avg_cost: 3.9032678604125977
grad_norm: 1.5204350594016776, clipped: 1.0
epoch: 39, train_batch_id: 1000, avg_cost: 3.865436553955078
grad_norm: 1.4254072940722442, clipped: 1.0
epoch: 39, train_batch_id: 1050, avg_cost: 3.8723459243774414
grad_norm: 1.0675975131431805, clipped: 1.0
epoch: 39, train_batch_id: 1100, avg_cost: 3.861215114593506
grad_norm: 1.9699901618082092, clipped: 1.0
epoch: 39, train_batch_id: 1150, avg_cost: 3.8948891162872314
grad_norm: 1.3582026354998689, clipped: 1.0
epoch: 39, train_batch_id: 1200, avg_cost: 3.8892312049865723
grad_norm: 2.101901648211787, clipped: 1.0
epoch: 39, train_batch_id: 1250, avg_cost: 3.8602540493011475
grad_norm: 1.2896804553580432, clipped: 1.0
epoch: 39, train_batch_id: 1300, avg_cost: 3.862403392791748
grad_norm: 1.1111276053174561, clipped: 1.0
epoch: 39, train_batch_id: 1350, avg_cost: 3.854248046875
grad_norm: 1.3680096420146053, clipped: 1.0
epoch: 39, train_batch_id: 1400, avg_cost: 3.855700731277466
grad_norm: 1.5467799303639949, clipped: 1.0
epoch: 39, train_batch_id: 1450, avg_cost: 3.876883029937744
grad_norm: 1.319391873006004, clipped: 1.0
epoch: 39, train_batch_id: 1500, avg_cost: 3.868950843811035
grad_norm: 1.1621931599004183, clipped: 1.0
epoch: 39, train_batch_id: 1550, avg_cost: 3.8441858291625977
grad_norm: 1.7617414544850762, clipped: 1.0
epoch: 39, train_batch_id: 1600, avg_cost: 3.8763327598571777
grad_norm: 1.607242348126333, clipped: 1.0
epoch: 39, train_batch_id: 1650, avg_cost: 3.865833282470703
grad_norm: 2.4855088969522665, clipped: 1.0
epoch: 39, train_batch_id: 1700, avg_cost: 3.8595125675201416
grad_norm: 1.7669827505367341, clipped: 1.0
epoch: 39, train_batch_id: 1750, avg_cost: 3.8647289276123047
grad_norm: 2.0750225019332373, clipped: 1.0
epoch: 39, train_batch_id: 1800, avg_cost: 3.8718581199645996
grad_norm: 1.2101634133390629, clipped: 1.0
epoch: 39, train_batch_id: 1850, avg_cost: 3.849571466445923
grad_norm: 1.1452465259744367, clipped: 1.0
epoch: 39, train_batch_id: 1900, avg_cost: 3.887814521789551
grad_norm: 1.56100079445932, clipped: 1.0
epoch: 39, train_batch_id: 1950, avg_cost: 3.882861614227295
grad_norm: 1.5294956487639835, clipped: 1.0
epoch: 39, train_batch_id: 2000, avg_cost: 3.869077682495117
grad_norm: 3.9420578697773303, clipped: 1.0
epoch: 39, train_batch_id: 2050, avg_cost: 3.8804879188537598
grad_norm: 1.2414929733281648, clipped: 1.0
epoch: 39, train_batch_id: 2100, avg_cost: 3.8648760318756104
grad_norm: 2.0393287916103415, clipped: 1.0
epoch: 39, train_batch_id: 2150, avg_cost: 3.859795093536377
grad_norm: 1.3543983827737052, clipped: 1.0
epoch: 39, train_batch_id: 2200, avg_cost: 3.8681740760803223
grad_norm: 4.752564138474541, clipped: 1.0
epoch: 39, train_batch_id: 2250, avg_cost: 3.86102557182312
grad_norm: 1.6523192753782174, clipped: 1.0
epoch: 39, train_batch_id: 2300, avg_cost: 3.8651185035705566
grad_norm: 1.329586311019195, clipped: 1.0
epoch: 39, train_batch_id: 2350, avg_cost: 3.8958725929260254
grad_norm: 1.3872975662897333, clipped: 1.0
epoch: 39, train_batch_id: 2400, avg_cost: 3.88033390045166
grad_norm: 1.5256862966530906, clipped: 1.0
epoch: 39, train_batch_id: 2450, avg_cost: 3.879634380340576
grad_norm: 3.1860102670202393, clipped: 1.0
Finished epoch 39, took 00:19:08 s
Saving model and state...
Validating...
Validation overall avg_cost: 4.161019325256348 +- 0.0038966822903603315
Evaluating candidate model on evaluation dataset
Epoch 39 candidate mean 4.157237529754639, baseline epoch 28 mean 4.070762634277344, difference 0.08647489547729492
Start train epoch 40, lr=0.0001 for run tsp20_attiter5_rollout_20200202T054549
Evaluating baseline on dataset...
342


342


342


342


342


342


342


342


342


342


